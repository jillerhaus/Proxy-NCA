2020-09-28 14:01:48,286 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-140145', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(80, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 14:01:48,287 Training for 20 epochs
2020-09-28 14:01:48,289 **Evaluating initial model.**
2020-09-28 14:02:04,000 NMI: 25.113
2020-09-28 14:02:06,414 R@1 : 42.839
2020-09-28 14:02:06,516 R@2 : 53.544
2020-09-28 14:02:06,619 R@4 : 65.131
2020-09-28 14:02:06,722 R@8 : 76.761
2020-09-28 14:02:42,010 Epoch: 0, loss: 3.315, time (seconds): 35.29.
2020-09-28 14:02:42,010 **Evaluating.**
2020-09-28 14:02:57,065 NMI: 32.016
2020-09-28 14:02:59,348 R@1 : 50.116
2020-09-28 14:02:59,459 R@2 : 61.809
2020-09-28 14:02:59,568 R@4 : 71.672
2020-09-28 14:02:59,673 R@8 : 80.778
2020-09-28 14:03:35,301 Epoch: 1, loss: 3.161, time (seconds): 35.62.
2020-09-28 14:03:35,301 **Evaluating.**
2020-09-28 14:03:52,922 NMI: 33.510
2020-09-28 14:03:55,443 R@1 : 50.873
2020-09-28 14:03:55,567 R@2 : 61.809
2020-09-28 14:03:55,672 R@4 : 71.819
2020-09-28 14:03:55,781 R@8 : 80.505
2020-09-28 14:04:32,383 Epoch: 2, loss: 3.047, time (seconds): 36.60.
2020-09-28 14:04:32,383 **Evaluating.**
2020-09-28 14:04:47,562 NMI: 33.687
2020-09-28 14:04:49,878 R@1 : 51.293
2020-09-28 14:04:49,982 R@2 : 62.103
2020-09-28 14:04:50,086 R@4 : 71.630
2020-09-28 14:04:50,189 R@8 : 80.252
2020-09-28 14:05:25,754 Epoch: 3, loss: 3.006, time (seconds): 35.56.
2020-09-28 14:05:25,754 **Evaluating.**
2020-09-28 14:05:41,202 NMI: 32.547
2020-09-28 14:05:43,491 R@1 : 51.672
2020-09-28 14:05:43,596 R@2 : 62.860
2020-09-28 14:05:43,704 R@4 : 72.135
2020-09-28 14:05:43,807 R@8 : 81.115
2020-09-28 14:06:19,076 Epoch: 4, loss: 2.973, time (seconds): 35.27.
2020-09-28 14:06:19,077 **Evaluating.**
2020-09-28 14:06:34,393 NMI: 32.753
2020-09-28 14:06:36,695 R@1 : 50.683
2020-09-28 14:06:36,800 R@2 : 61.346
2020-09-28 14:06:36,903 R@4 : 70.999
2020-09-28 14:06:37,006 R@8 : 80.126
2020-09-28 14:07:13,315 Epoch: 5, loss: 2.932, time (seconds): 36.31.
2020-09-28 14:07:13,316 **Evaluating.**
2020-09-28 14:07:28,864 NMI: 31.265
2020-09-28 14:07:31,267 R@1 : 51.293
2020-09-28 14:07:31,373 R@2 : 62.187
2020-09-28 14:07:31,481 R@4 : 71.525
2020-09-28 14:07:31,587 R@8 : 79.958
2020-09-28 14:08:09,324 Epoch: 6, loss: 2.911, time (seconds): 37.73.
2020-09-28 14:08:09,326 **Evaluating.**
2020-09-28 14:08:25,155 NMI: 31.848
2020-09-28 14:08:27,433 R@1 : 49.821
2020-09-28 14:08:27,535 R@2 : 60.778
2020-09-28 14:08:27,638 R@4 : 70.662
2020-09-28 14:08:27,740 R@8 : 79.369
2020-09-28 14:09:04,768 Epoch: 7, loss: 2.898, time (seconds): 37.03.
2020-09-28 14:09:04,768 **Evaluating.**
2020-09-28 14:09:20,977 NMI: 31.502
2020-09-28 14:09:23,458 R@1 : 49.989
2020-09-28 14:09:23,565 R@2 : 61.367
2020-09-28 14:09:23,673 R@4 : 71.314
2020-09-28 14:09:23,777 R@8 : 79.642
2020-09-28 14:10:00,315 Epoch: 8, loss: 2.874, time (seconds): 36.54.
2020-09-28 14:10:00,316 **Evaluating.**
2020-09-28 14:10:15,920 NMI: 30.311
2020-09-28 14:10:18,162 R@1 : 49.106
2020-09-28 14:10:18,272 R@2 : 61.009
2020-09-28 14:10:18,374 R@4 : 70.452
2020-09-28 14:10:18,475 R@8 : 78.612
2020-09-28 14:10:53,737 Epoch: 9, loss: 2.841, time (seconds): 35.26.
2020-09-28 14:10:53,738 **Evaluating.**
2020-09-28 14:11:08,817 NMI: 29.370
2020-09-28 14:11:11,076 R@1 : 48.034
2020-09-28 14:11:11,177 R@2 : 59.180
2020-09-28 14:11:11,279 R@4 : 69.737
2020-09-28 14:11:11,385 R@8 : 78.633
2020-09-28 14:11:46,595 Epoch: 10, loss: 2.836, time (seconds): 35.21.
2020-09-28 14:11:46,596 **Evaluating.**
2020-09-28 14:12:01,592 NMI: 28.494
2020-09-28 14:12:03,875 R@1 : 47.529
2020-09-28 14:12:03,985 R@2 : 59.432
2020-09-28 14:12:04,090 R@4 : 70.095
2020-09-28 14:12:04,192 R@8 : 78.780
2020-09-28 14:12:39,243 Epoch: 11, loss: 2.814, time (seconds): 35.05.
2020-09-28 14:12:39,243 **Evaluating.**
2020-09-28 14:12:54,289 NMI: 28.898
2020-09-28 14:12:56,532 R@1 : 47.256
2020-09-28 14:12:56,635 R@2 : 58.927
2020-09-28 14:12:56,742 R@4 : 70.137
2020-09-28 14:12:56,845 R@8 : 78.717
2020-09-28 14:13:32,074 Epoch: 12, loss: 2.818, time (seconds): 35.23.
2020-09-28 14:13:32,075 **Evaluating.**
2020-09-28 14:13:47,101 NMI: 28.851
2020-09-28 14:13:49,412 R@1 : 47.024
2020-09-28 14:13:49,520 R@2 : 59.264
2020-09-28 14:13:49,625 R@4 : 69.295
2020-09-28 14:13:49,727 R@8 : 77.918
2020-09-28 14:14:24,922 Epoch: 13, loss: 2.804, time (seconds): 35.19.
2020-09-28 14:14:24,922 **Evaluating.**
2020-09-28 14:14:39,996 NMI: 28.440
2020-09-28 14:14:42,307 R@1 : 46.919
2020-09-28 14:14:42,409 R@2 : 58.759
2020-09-28 14:14:42,516 R@4 : 69.758
2020-09-28 14:14:42,617 R@8 : 78.297
2020-09-28 14:15:18,071 Epoch: 14, loss: 2.793, time (seconds): 35.45.
2020-09-28 14:15:18,071 **Evaluating.**
2020-09-28 14:15:33,217 NMI: 28.084
2020-09-28 14:15:35,492 R@1 : 45.573
2020-09-28 14:15:35,606 R@2 : 57.224
2020-09-28 14:15:35,722 R@4 : 68.160
2020-09-28 14:15:35,836 R@8 : 77.518
2020-09-28 14:16:11,381 Epoch: 15, loss: 2.783, time (seconds): 35.54.
2020-09-28 14:16:11,382 **Evaluating.**
2020-09-28 14:16:27,528 NMI: 27.665
2020-09-28 14:16:29,843 R@1 : 45.216
2020-09-28 14:16:29,946 R@2 : 57.645
2020-09-28 14:16:30,049 R@4 : 68.076
2020-09-28 14:16:30,155 R@8 : 77.539
2020-09-28 14:17:06,359 Epoch: 16, loss: 2.757, time (seconds): 36.20.
2020-09-28 14:17:06,360 **Evaluating.**
2020-09-28 14:17:22,004 NMI: 28.160
2020-09-28 14:17:24,334 R@1 : 45.573
2020-09-28 14:17:24,441 R@2 : 57.371
2020-09-28 14:17:24,549 R@4 : 67.592
2020-09-28 14:17:24,655 R@8 : 77.497
2020-09-28 14:18:00,882 Epoch: 17, loss: 2.747, time (seconds): 36.22.
2020-09-28 14:18:00,883 **Evaluating.**
2020-09-28 14:18:17,138 NMI: 27.064
2020-09-28 14:18:19,422 R@1 : 44.353
2020-09-28 14:18:19,524 R@2 : 56.677
2020-09-28 14:18:19,630 R@4 : 67.571
2020-09-28 14:18:19,733 R@8 : 76.383
2020-09-28 14:18:55,435 Epoch: 18, loss: 2.771, time (seconds): 35.70.
2020-09-28 14:18:55,436 **Evaluating.**
2020-09-28 14:19:12,097 NMI: 27.313
2020-09-28 14:19:14,428 R@1 : 44.101
2020-09-28 14:19:14,537 R@2 : 56.782
2020-09-28 14:19:14,639 R@4 : 67.592
2020-09-28 14:19:14,746 R@8 : 77.098
2020-09-28 14:19:51,251 Epoch: 19, loss: 2.743, time (seconds): 36.50.
2020-09-28 14:19:51,252 **Evaluating.**
2020-09-28 14:20:07,435 NMI: 26.568
2020-09-28 14:20:09,714 R@1 : 44.395
2020-09-28 14:20:09,822 R@2 : 56.341
2020-09-28 14:20:09,928 R@4 : 67.213
2020-09-28 14:20:10,045 R@8 : 76.320
2020-09-28 14:20:10,047 Total training time (minutes): 18.36.
2020-09-28 14:20:10,831 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-140145', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(80, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 14:20:10,832 Training for 20 epochs
2020-09-28 14:20:10,834 **Evaluating initial model.**
2020-09-28 14:20:26,906 NMI: 25.113
