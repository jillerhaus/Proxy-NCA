2020-09-26 14:14:12,107 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 128, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200926-141405', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 3, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-26 14:14:12,107 Training for 20 epochs
2020-09-26 14:14:12,109 **Evaluating initial model.**
2020-09-26 14:16:52,669 NMI: 27.896
2020-09-26 14:19:43,784 R@1 : 47.275
2020-09-26 14:19:44,515 R@2 : 55.785
2020-09-26 14:19:45,244 R@4 : 64.523
2020-09-26 14:19:45,978 R@8 : 73.146
2020-09-26 14:22:09,705 Epoch: 0, loss: 2.768, time (seconds): 143.72.
2020-09-26 14:22:09,706 **Evaluating.**
2020-09-26 14:23:54,063 NMI: 27.351
2020-09-26 14:26:26,226 R@1 : 43.510
2020-09-26 14:26:26,954 R@2 : 52.582
2020-09-26 14:26:27,694 R@4 : 62.436
2020-09-26 14:26:28,422 R@8 : 71.578
2020-09-26 14:28:10,747 Epoch: 1, loss: 2.344, time (seconds): 102.32.
2020-09-26 14:28:10,748 **Evaluating.**
2020-09-26 14:29:53,288 NMI: 30.594
2020-09-26 14:32:37,061 R@1 : 47.127
2020-09-26 14:32:37,798 R@2 : 56.415
2020-09-26 14:32:38,529 R@4 : 65.757
2020-09-26 14:32:39,254 R@8 : 74.295
2020-09-26 14:34:41,700 Epoch: 2, loss: 2.120, time (seconds): 122.44.
2020-09-26 14:34:41,700 **Evaluating.**
2020-09-26 14:36:36,723 NMI: 31.830
2020-09-26 14:39:20,244 R@1 : 48.901
2020-09-26 14:39:20,968 R@2 : 57.933
2020-09-26 14:39:21,693 R@4 : 67.090
2020-09-26 14:39:22,418 R@8 : 75.581
2020-09-26 14:41:10,691 Epoch: 3, loss: 2.045, time (seconds): 108.27.
2020-09-26 14:41:10,692 **Evaluating.**
2020-09-26 14:42:54,027 NMI: 32.271
2020-09-26 14:45:40,421 R@1 : 49.459
2020-09-26 14:45:41,160 R@2 : 58.630
2020-09-26 14:45:41,933 R@4 : 67.917
2020-09-26 14:45:42,692 R@8 : 76.069
2020-09-26 14:47:33,465 Epoch: 4, loss: 1.874, time (seconds): 110.77.
2020-09-26 14:47:33,466 **Evaluating.**
2020-09-26 14:49:18,891 NMI: 32.227
2020-09-26 14:52:05,958 R@1 : 49.520
2020-09-26 14:52:06,687 R@2 : 58.949
2020-09-26 14:52:07,419 R@4 : 67.987
2020-09-26 14:52:08,159 R@8 : 76.330
2020-09-26 14:53:49,333 Epoch: 5, loss: 1.825, time (seconds): 101.17.
2020-09-26 14:53:49,333 **Evaluating.**
2020-09-26 14:55:32,245 NMI: 31.668
2020-09-26 14:58:09,371 R@1 : 49.400
2020-09-26 14:58:10,092 R@2 : 58.609
2020-09-26 14:58:10,818 R@4 : 67.638
2020-09-26 14:58:11,541 R@8 : 75.877
2020-09-26 14:59:45,906 Epoch: 6, loss: 1.774, time (seconds): 94.36.
2020-09-26 14:59:45,906 **Evaluating.**
2020-09-26 15:01:26,368 NMI: 31.602
2020-09-26 15:04:01,232 R@1 : 49.189
2020-09-26 15:04:01,959 R@2 : 58.505
2020-09-26 15:04:02,695 R@4 : 67.496
2020-09-26 15:04:03,420 R@8 : 75.875
2020-09-26 15:05:37,324 Epoch: 7, loss: 1.678, time (seconds): 93.90.
2020-09-26 15:05:37,325 **Evaluating.**
2020-09-26 15:07:15,352 NMI: 31.210
2020-09-26 15:09:51,662 R@1 : 49.302
2020-09-26 15:09:52,395 R@2 : 58.473
2020-09-26 15:09:53,123 R@4 : 67.632
2020-09-26 15:09:53,862 R@8 : 75.889
2020-09-26 15:11:27,689 Epoch: 8, loss: 1.636, time (seconds): 93.83.
2020-09-26 15:11:27,689 **Evaluating.**
2020-09-26 15:13:06,193 NMI: 31.458
2020-09-26 15:15:41,906 R@1 : 49.470
2020-09-26 15:15:42,717 R@2 : 58.720
2020-09-26 15:15:43,527 R@4 : 67.569
2020-09-26 15:15:44,337 R@8 : 76.069
2020-09-26 15:17:18,293 Epoch: 9, loss: 1.588, time (seconds): 93.95.
2020-09-26 15:17:18,293 **Evaluating.**
2020-09-26 15:18:55,661 NMI: 30.658
2020-09-26 15:21:31,616 R@1 : 48.739
2020-09-26 15:21:32,347 R@2 : 57.881
2020-09-26 15:21:33,074 R@4 : 67.214
2020-09-26 15:21:33,817 R@8 : 75.700
2020-09-26 15:23:07,925 Epoch: 10, loss: 1.562, time (seconds): 94.10.
2020-09-26 15:23:07,925 **Evaluating.**
2020-09-26 15:24:47,739 NMI: 30.576
2020-09-26 15:27:25,215 R@1 : 48.721
2020-09-26 15:27:25,948 R@2 : 57.805
2020-09-26 15:27:26,688 R@4 : 66.904
2020-09-26 15:27:27,421 R@8 : 75.166
2020-09-26 15:29:01,267 Epoch: 11, loss: 1.538, time (seconds): 93.84.
2020-09-26 15:29:01,267 **Evaluating.**
2020-09-26 15:30:40,661 NMI: 30.628
2020-09-26 15:33:16,981 R@1 : 48.413
2020-09-26 15:33:17,711 R@2 : 57.712
2020-09-26 15:33:18,437 R@4 : 66.764
2020-09-26 15:33:19,165 R@8 : 75.134
2020-09-26 15:34:53,104 Epoch: 12, loss: 1.480, time (seconds): 93.94.
2020-09-26 15:34:53,105 **Evaluating.**
2020-09-26 15:36:30,332 NMI: 30.174
2020-09-26 15:39:06,644 R@1 : 48.219
2020-09-26 15:39:07,376 R@2 : 57.512
2020-09-26 15:39:08,108 R@4 : 66.494
2020-09-26 15:39:08,850 R@8 : 74.893
2020-09-26 15:40:42,908 Epoch: 13, loss: 1.456, time (seconds): 94.05.
2020-09-26 15:40:42,909 **Evaluating.**
2020-09-26 15:42:21,043 NMI: 30.290
2020-09-26 15:44:57,756 R@1 : 48.146
2020-09-26 15:44:58,490 R@2 : 57.088
2020-09-26 15:44:59,216 R@4 : 66.007
2020-09-26 15:44:59,953 R@8 : 74.513
2020-09-26 15:46:33,668 Epoch: 14, loss: 1.394, time (seconds): 93.71.
2020-09-26 15:46:33,668 **Evaluating.**
2020-09-26 15:48:09,987 NMI: 29.943
2020-09-26 15:50:52,485 R@1 : 47.763
2020-09-26 15:50:53,213 R@2 : 56.888
2020-09-26 15:50:53,951 R@4 : 65.902
2020-09-26 15:50:54,696 R@8 : 74.446
2020-09-26 15:52:31,841 Epoch: 15, loss: 1.415, time (seconds): 97.14.
2020-09-26 15:52:31,842 **Evaluating.**
2020-09-26 15:54:11,251 NMI: 29.904
2020-09-26 15:56:55,594 R@1 : 47.673
2020-09-26 15:56:56,329 R@2 : 56.934
2020-09-26 15:56:57,057 R@4 : 65.972
2020-09-26 15:56:57,783 R@8 : 74.348
2020-09-26 15:58:34,865 Epoch: 16, loss: 1.369, time (seconds): 97.08.
2020-09-26 15:58:34,865 **Evaluating.**
2020-09-26 16:00:16,402 NMI: 30.091
2020-09-26 16:03:01,817 R@1 : 47.452
2020-09-26 16:03:02,564 R@2 : 56.618
2020-09-26 16:03:03,290 R@4 : 66.007
2020-09-26 16:03:04,024 R@8 : 74.641
2020-09-26 16:04:40,841 Epoch: 17, loss: 1.351, time (seconds): 96.81.
2020-09-26 16:04:40,842 **Evaluating.**
2020-09-26 16:06:19,908 NMI: 29.887
2020-09-26 16:09:13,527 R@1 : 47.749
2020-09-26 16:09:14,264 R@2 : 56.928
2020-09-26 16:09:15,005 R@4 : 66.059
2020-09-26 16:09:15,750 R@8 : 74.411
2020-09-26 16:11:02,195 Epoch: 18, loss: 1.358, time (seconds): 106.44.
2020-09-26 16:11:02,196 **Evaluating.**
2020-09-26 16:12:52,272 NMI: 29.404
2020-09-26 16:15:45,769 R@1 : 47.322
2020-09-26 16:15:46,508 R@2 : 56.359
2020-09-26 16:15:47,256 R@4 : 65.380
2020-09-26 16:15:48,010 R@8 : 74.237
2020-09-26 16:17:45,382 Epoch: 19, loss: 1.285, time (seconds): 117.37.
2020-09-26 16:17:45,383 **Evaluating.**
2020-09-26 16:19:46,331 NMI: 28.877
2020-09-26 16:22:43,755 R@1 : 46.204
2020-09-26 16:22:44,504 R@2 : 55.114
2020-09-26 16:22:45,249 R@4 : 64.578
2020-09-26 16:22:46,012 R@8 : 73.453
2020-09-26 16:22:46,016 Total training time (minutes): 128.57.
2020-09-26 16:22:48,279 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 128, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food-20200926-141405', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 3, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-26 16:22:48,279 Training for 20 epochs
2020-09-26 16:22:48,281 **Evaluating initial model.**
2020-09-26 16:24:39,798 NMI: 27.896
2020-09-26 16:27:36,437 R@1 : 47.275
2020-09-26 16:27:37,175 R@2 : 55.785
2020-09-26 16:27:37,916 R@4 : 64.523
2020-09-26 16:27:38,661 R@8 : 73.146
2020-09-26 16:29:39,456 Epoch: 0, loss: 2.198, time (seconds): 120.79.
2020-09-26 16:29:39,457 **Evaluating.**
2020-09-26 16:31:32,316 NMI: 31.306
