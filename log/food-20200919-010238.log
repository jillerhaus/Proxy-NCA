2020-09-19 01:02:46,488 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 40, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food-20200919-010238', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-19 01:02:46,489 Training for 40 epochs
2020-09-19 01:02:46,493 **Evaluating initial model.**
2020-09-19 01:05:47,909 NMI: 24.435
2020-09-19 01:07:23,056 R@1 : 42.006
2020-09-19 01:07:23,810 R@2 : 50.544
2020-09-19 01:07:24,555 R@4 : 59.936
2020-09-19 01:07:25,313 R@8 : 69.261
2020-09-19 01:10:10,670 Epoch: 0, loss: 2.456, time (seconds): 165.36.
2020-09-19 01:10:10,671 **Evaluating.**
2020-09-19 01:12:11,534 NMI: 28.252
2020-09-19 01:13:37,171 R@1 : 44.604
2020-09-19 01:13:37,935 R@2 : 54.037
2020-09-19 01:13:38,680 R@4 : 63.719
2020-09-19 01:13:39,426 R@8 : 72.786
2020-09-19 01:15:43,802 Epoch: 1, loss: 2.140, time (seconds): 124.37.
2020-09-19 01:15:43,803 **Evaluating.**
2020-09-19 01:17:37,474 NMI: 31.706
2020-09-19 01:19:06,082 R@1 : 49.627
2020-09-19 01:19:06,838 R@2 : 58.798
2020-09-19 01:19:07,588 R@4 : 67.688
2020-09-19 01:19:08,344 R@8 : 75.985
2020-09-19 01:21:12,973 Epoch: 2, loss: 2.002, time (seconds): 124.63.
2020-09-19 01:21:12,974 **Evaluating.**
2020-09-19 01:23:06,164 NMI: 33.012
2020-09-19 01:24:35,785 R@1 : 50.687
2020-09-19 01:24:36,566 R@2 : 59.736
2020-09-19 01:24:37,318 R@4 : 68.402
2020-09-19 01:24:38,088 R@8 : 76.603
2020-09-19 01:26:39,468 Epoch: 3, loss: 1.884, time (seconds): 121.38.
2020-09-19 01:26:39,469 **Evaluating.**
2020-09-19 01:28:30,027 NMI: 32.869
2020-09-19 01:29:59,924 R@1 : 50.753
2020-09-19 01:30:00,668 R@2 : 59.904
2020-09-19 01:30:01,416 R@4 : 68.567
2020-09-19 01:30:02,187 R@8 : 76.650
2020-09-19 01:32:04,808 Epoch: 4, loss: 1.798, time (seconds): 122.62.
2020-09-19 01:32:04,809 **Evaluating.**
2020-09-19 01:33:47,790 NMI: 32.446
2020-09-19 01:35:18,397 R@1 : 50.713
2020-09-19 01:35:19,164 R@2 : 59.898
2020-09-19 01:35:19,916 R@4 : 68.747
2020-09-19 01:35:20,663 R@8 : 76.963
2020-09-19 01:37:21,164 Epoch: 5, loss: 1.742, time (seconds): 120.50.
2020-09-19 01:37:21,166 **Evaluating.**
2020-09-19 01:39:04,070 NMI: 32.161
2020-09-19 01:40:33,534 R@1 : 50.794
2020-09-19 01:40:34,327 R@2 : 59.843
2020-09-19 01:40:35,084 R@4 : 68.530
2020-09-19 01:40:35,857 R@8 : 76.618
2020-09-19 01:42:34,067 Epoch: 6, loss: 1.691, time (seconds): 118.21.
2020-09-19 01:42:34,068 **Evaluating.**
2020-09-19 01:44:15,311 NMI: 31.998
2020-09-19 01:45:46,125 R@1 : 50.602
2020-09-19 01:45:46,933 R@2 : 59.347
2020-09-19 01:45:47,744 R@4 : 68.068
2020-09-19 01:45:48,572 R@8 : 75.994
2020-09-19 01:47:44,914 Epoch: 7, loss: 1.625, time (seconds): 116.34.
2020-09-19 01:47:44,915 **Evaluating.**
2020-09-19 01:49:26,663 NMI: 32.867
2020-09-19 01:50:57,287 R@1 : 51.241
2020-09-19 01:50:58,067 R@2 : 60.122
2020-09-19 01:50:58,833 R@4 : 68.776
2020-09-19 01:50:59,591 R@8 : 76.728
2020-09-19 01:52:57,518 Epoch: 8, loss: 1.602, time (seconds): 117.92.
2020-09-19 01:52:57,519 **Evaluating.**
2020-09-19 01:54:37,967 NMI: 32.080
2020-09-19 01:56:09,483 R@1 : 50.225
2020-09-19 01:56:10,231 R@2 : 59.254
2020-09-19 01:56:10,974 R@4 : 68.152
2020-09-19 01:56:11,724 R@8 : 75.930
2020-09-19 01:58:10,260 Epoch: 9, loss: 1.528, time (seconds): 118.53.
2020-09-19 01:58:10,261 **Evaluating.**
2020-09-19 01:59:50,164 NMI: 30.842
2020-09-19 02:01:22,135 R@1 : 50.010
2020-09-19 02:01:22,889 R@2 : 58.926
2020-09-19 02:01:23,655 R@4 : 67.377
2020-09-19 02:01:24,417 R@8 : 75.480
2020-09-19 02:03:21,284 Epoch: 10, loss: 1.472, time (seconds): 116.86.
2020-09-19 02:03:21,286 **Evaluating.**
2020-09-19 02:05:14,119 NMI: 31.493
2020-09-19 02:06:46,211 R@1 : 49.946
2020-09-19 02:06:46,961 R@2 : 58.653
2020-09-19 02:06:47,725 R@4 : 67.490
2020-09-19 02:06:48,483 R@8 : 75.605
2020-09-19 02:08:47,731 Epoch: 11, loss: 1.441, time (seconds): 119.25.
2020-09-19 02:08:47,732 **Evaluating.**
2020-09-19 02:10:27,612 NMI: 32.083
2020-09-19 02:12:00,693 R@1 : 49.461
2020-09-19 02:12:01,481 R@2 : 58.470
2020-09-19 02:12:02,237 R@4 : 67.200
2020-09-19 02:12:02,987 R@8 : 75.396
2020-09-19 02:13:47,039 Epoch: 12, loss: 1.389, time (seconds): 104.05.
2020-09-19 02:13:47,040 **Evaluating.**
2020-09-19 02:15:27,345 NMI: 31.053
2020-09-19 02:17:00,289 R@1 : 49.726
2020-09-19 02:17:01,046 R@2 : 58.403
2020-09-19 02:17:01,802 R@4 : 67.078
2020-09-19 02:17:02,563 R@8 : 75.297
2020-09-19 02:18:45,971 Epoch: 13, loss: 1.364, time (seconds): 103.40.
2020-09-19 02:18:45,972 **Evaluating.**
2020-09-19 02:20:24,862 NMI: 30.958
2020-09-19 02:21:57,474 R@1 : 49.270
2020-09-19 02:21:58,244 R@2 : 57.878
2020-09-19 02:21:59,017 R@4 : 66.625
2020-09-19 02:21:59,775 R@8 : 74.725
2020-09-19 02:23:41,920 Epoch: 14, loss: 1.334, time (seconds): 102.14.
2020-09-19 02:23:41,921 **Evaluating.**
2020-09-19 02:25:23,913 NMI: 30.455
2020-09-19 02:26:57,444 R@1 : 48.797
2020-09-19 02:26:58,202 R@2 : 57.677
2020-09-19 02:26:58,972 R@4 : 66.640
2020-09-19 02:26:59,750 R@8 : 74.713
2020-09-19 02:28:43,417 Epoch: 15, loss: 1.321, time (seconds): 103.66.
2020-09-19 02:28:43,419 **Evaluating.**
2020-09-19 02:30:23,103 NMI: 30.126
2020-09-19 02:31:56,388 R@1 : 48.300
2020-09-19 02:31:57,149 R@2 : 56.632
2020-09-19 02:31:57,915 R@4 : 65.571
2020-09-19 02:31:58,682 R@8 : 73.967
2020-09-19 02:33:41,293 Epoch: 16, loss: 1.301, time (seconds): 102.61.
2020-09-19 02:33:41,294 **Evaluating.**
2020-09-19 02:35:21,523 NMI: 29.913
2020-09-19 02:36:54,721 R@1 : 48.027
2020-09-19 02:36:55,493 R@2 : 56.751
2020-09-19 02:36:56,255 R@4 : 65.580
2020-09-19 02:36:57,033 R@8 : 73.802
2020-09-19 02:38:38,632 Epoch: 17, loss: 1.237, time (seconds): 101.60.
2020-09-19 02:38:38,633 **Evaluating.**
2020-09-19 02:40:14,731 NMI: 28.996
2020-09-19 02:41:47,908 R@1 : 47.667
2020-09-19 02:41:48,663 R@2 : 56.322
2020-09-19 02:41:49,417 R@4 : 65.057
2020-09-19 02:41:50,175 R@8 : 73.436
2020-09-19 02:43:31,506 Epoch: 18, loss: 1.263, time (seconds): 101.33.
2020-09-19 02:43:31,508 **Evaluating.**
2020-09-19 02:45:11,623 NMI: 29.458
2020-09-19 02:46:44,907 R@1 : 47.403
2020-09-19 02:46:45,725 R@2 : 56.145
2020-09-19 02:46:46,547 R@4 : 64.901
2020-09-19 02:46:47,384 R@8 : 73.090
2020-09-19 02:48:32,528 Epoch: 19, loss: 1.235, time (seconds): 105.14.
2020-09-19 02:48:32,530 **Evaluating.**
2020-09-19 02:50:13,018 NMI: 29.331
2020-09-19 02:51:46,709 R@1 : 47.441
2020-09-19 02:51:47,468 R@2 : 55.924
2020-09-19 02:51:48,237 R@4 : 64.654
2020-09-19 02:51:48,993 R@8 : 73.003
2020-09-19 02:53:30,965 Epoch: 20, loss: 1.236, time (seconds): 101.97.
2020-09-19 02:53:30,967 **Evaluating.**
2020-09-19 02:55:10,501 NMI: 29.835
2020-09-19 02:56:43,949 R@1 : 47.737
2020-09-19 02:56:44,718 R@2 : 56.371
2020-09-19 02:56:45,485 R@4 : 65.223
2020-09-19 02:56:46,267 R@8 : 73.299
2020-09-19 02:58:29,443 Epoch: 21, loss: 1.208, time (seconds): 103.17.
2020-09-19 02:58:29,444 **Evaluating.**
2020-09-19 03:00:09,984 NMI: 29.504
2020-09-19 03:01:43,944 R@1 : 47.331
2020-09-19 03:01:44,715 R@2 : 56.078
2020-09-19 03:01:45,462 R@4 : 64.845
2020-09-19 03:01:46,215 R@8 : 73.067
2020-09-19 03:03:28,611 Epoch: 22, loss: 1.201, time (seconds): 102.39.
2020-09-19 03:03:28,612 **Evaluating.**
2020-09-19 03:05:10,121 NMI: 29.329
2020-09-19 03:06:44,036 R@1 : 47.177
2020-09-19 03:06:44,792 R@2 : 55.787
2020-09-19 03:06:45,549 R@4 : 64.697
2020-09-19 03:06:46,336 R@8 : 72.992
2020-09-19 03:08:30,252 Epoch: 23, loss: 1.166, time (seconds): 103.91.
2020-09-19 03:08:30,253 **Evaluating.**
2020-09-19 03:10:10,377 NMI: 29.234
2020-09-19 03:11:44,008 R@1 : 47.017
2020-09-19 03:11:44,757 R@2 : 55.480
2020-09-19 03:11:45,514 R@4 : 64.186
2020-09-19 03:11:46,265 R@8 : 72.757
2020-09-19 03:13:28,225 Epoch: 24, loss: 1.175, time (seconds): 101.96.
2020-09-19 03:13:28,227 **Evaluating.**
2020-09-19 03:15:09,593 NMI: 29.106
2020-09-19 03:16:43,254 R@1 : 47.618
2020-09-19 03:16:44,004 R@2 : 56.255
2020-09-19 03:16:44,752 R@4 : 64.770
2020-09-19 03:16:45,529 R@8 : 73.050
2020-09-19 03:18:31,977 Epoch: 25, loss: 1.157, time (seconds): 106.45.
2020-09-19 03:18:31,978 **Evaluating.**
2020-09-19 03:20:11,192 NMI: 28.650
2020-09-19 03:21:45,108 R@1 : 47.020
2020-09-19 03:21:45,914 R@2 : 55.848
2020-09-19 03:21:46,724 R@4 : 64.468
2020-09-19 03:21:47,522 R@8 : 72.876
2020-09-19 03:23:29,343 Epoch: 26, loss: 1.127, time (seconds): 101.82.
2020-09-19 03:23:29,344 **Evaluating.**
2020-09-19 03:25:09,887 NMI: 28.762
2020-09-19 03:26:43,472 R@1 : 47.002
2020-09-19 03:26:44,236 R@2 : 55.442
2020-09-19 03:26:44,995 R@4 : 64.265
2020-09-19 03:26:45,759 R@8 : 72.838
2020-09-19 03:28:27,399 Epoch: 27, loss: 1.167, time (seconds): 101.64.
2020-09-19 03:28:27,400 **Evaluating.**
2020-09-19 03:30:06,517 NMI: 28.374
2020-09-19 03:31:41,028 R@1 : 46.730
2020-09-19 03:31:41,804 R@2 : 55.349
2020-09-19 03:31:42,567 R@4 : 63.963
2020-09-19 03:31:43,329 R@8 : 72.385
2020-09-19 03:33:25,293 Epoch: 28, loss: 1.118, time (seconds): 101.96.
2020-09-19 03:33:25,294 **Evaluating.**
2020-09-19 03:35:02,699 NMI: 28.839
2020-09-19 03:36:36,244 R@1 : 46.140
2020-09-19 03:36:36,992 R@2 : 54.911
2020-09-19 03:36:37,758 R@4 : 63.861
2020-09-19 03:36:38,515 R@8 : 72.315
2020-09-19 03:38:19,442 Epoch: 29, loss: 1.136, time (seconds): 100.92.
2020-09-19 03:38:19,442 **Evaluating.**
2020-09-19 03:39:57,443 NMI: 28.035
2020-09-19 03:41:30,923 R@1 : 46.724
2020-09-19 03:41:31,710 R@2 : 55.146
2020-09-19 03:41:32,476 R@4 : 63.771
2020-09-19 03:41:33,223 R@8 : 72.481
2020-09-19 03:43:14,568 Epoch: 30, loss: 1.120, time (seconds): 101.34.
2020-09-19 03:43:14,568 **Evaluating.**
2020-09-19 03:44:50,771 NMI: 28.347
2020-09-19 03:46:24,521 R@1 : 46.323
2020-09-19 03:46:25,281 R@2 : 55.009
2020-09-19 03:46:26,054 R@4 : 63.597
2020-09-19 03:46:26,798 R@8 : 72.170
2020-09-19 03:48:08,000 Epoch: 31, loss: 1.112, time (seconds): 101.20.
2020-09-19 03:48:08,000 **Evaluating.**
2020-09-19 03:49:44,573 NMI: 28.615
2020-09-19 03:51:18,214 R@1 : 46.187
2020-09-19 03:51:18,965 R@2 : 54.885
2020-09-19 03:51:19,737 R@4 : 63.681
2020-09-19 03:51:20,491 R@8 : 72.339
2020-09-19 03:53:00,863 Epoch: 32, loss: 1.110, time (seconds): 100.37.
2020-09-19 03:53:00,864 **Evaluating.**
2020-09-19 03:54:37,603 NMI: 28.530
2020-09-19 03:56:12,205 R@1 : 46.227
2020-09-19 03:56:12,951 R@2 : 54.789
2020-09-19 03:56:13,725 R@4 : 63.493
2020-09-19 03:56:14,482 R@8 : 72.405
2020-09-19 03:57:55,457 Epoch: 33, loss: 1.083, time (seconds): 100.97.
2020-09-19 03:57:55,458 **Evaluating.**
2020-09-19 03:59:32,910 NMI: 28.064
2020-09-19 04:01:06,969 R@1 : 46.303
2020-09-19 04:01:07,736 R@2 : 54.800
2020-09-19 04:01:08,507 R@4 : 63.763
2020-09-19 04:01:09,263 R@8 : 72.350
2020-09-19 04:02:50,263 Epoch: 34, loss: 1.095, time (seconds): 101.00.
2020-09-19 04:02:50,264 **Evaluating.**
2020-09-19 04:04:27,515 NMI: 28.230
2020-09-19 04:06:01,485 R@1 : 46.094
2020-09-19 04:06:02,257 R@2 : 54.731
2020-09-19 04:06:03,026 R@4 : 63.510
2020-09-19 04:06:03,798 R@8 : 72.292
2020-09-19 04:07:44,638 Epoch: 35, loss: 1.091, time (seconds): 100.84.
2020-09-19 04:07:44,639 **Evaluating.**
2020-09-19 04:09:22,200 NMI: 27.986
2020-09-19 04:10:55,887 R@1 : 46.129
2020-09-19 04:10:56,684 R@2 : 54.925
2020-09-19 04:10:57,443 R@4 : 63.757
2020-09-19 04:10:58,190 R@8 : 72.080
2020-09-19 04:12:39,520 Epoch: 36, loss: 1.096, time (seconds): 101.33.
2020-09-19 04:12:39,520 **Evaluating.**
2020-09-19 04:14:16,075 NMI: 27.809
2020-09-19 04:15:50,146 R@1 : 45.722
2020-09-19 04:15:50,890 R@2 : 54.548
2020-09-19 04:15:51,656 R@4 : 63.466
2020-09-19 04:15:52,411 R@8 : 72.039
2020-09-19 04:17:33,209 Epoch: 37, loss: 1.055, time (seconds): 100.80.
2020-09-19 04:17:33,210 **Evaluating.**
2020-09-19 04:19:10,652 NMI: 27.801
2020-09-19 04:20:44,270 R@1 : 45.975
2020-09-19 04:20:45,019 R@2 : 54.562
2020-09-19 04:20:45,772 R@4 : 63.289
2020-09-19 04:20:46,526 R@8 : 71.990
2020-09-19 04:22:27,563 Epoch: 38, loss: 1.058, time (seconds): 101.03.
2020-09-19 04:22:27,563 **Evaluating.**
2020-09-19 04:24:04,720 NMI: 27.168
2020-09-19 04:25:38,456 R@1 : 45.734
2020-09-19 04:25:39,223 R@2 : 54.226
2020-09-19 04:25:39,994 R@4 : 63.167
2020-09-19 04:25:40,747 R@8 : 71.723
2020-09-19 04:27:21,656 Epoch: 39, loss: 1.081, time (seconds): 100.91.
2020-09-19 04:27:21,657 **Evaluating.**
2020-09-19 04:28:58,849 NMI: 27.291
2020-09-19 04:30:32,251 R@1 : 45.531
2020-09-19 04:30:33,030 R@2 : 54.394
2020-09-19 04:30:33,785 R@4 : 63.112
2020-09-19 04:30:34,554 R@8 : 71.810
2020-09-19 04:30:34,556 Total training time (minutes): 207.80.
2020-09-19 04:30:36,856 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 40, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200919-010238', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-19 04:30:36,856 Training for 40 epochs
2020-09-19 04:30:36,858 **Evaluating initial model.**
2020-09-19 04:32:26,884 NMI: 24.435
2020-09-19 04:34:00,791 R@1 : 42.006
2020-09-19 04:34:01,591 R@2 : 50.544
2020-09-19 04:34:02,413 R@4 : 59.936
2020-09-19 04:34:03,220 R@8 : 69.261
2020-09-19 04:36:37,701 Epoch: 0, loss: 2.574, time (seconds): 154.48.
2020-09-19 04:36:37,702 **Evaluating.**
2020-09-19 04:38:37,593 NMI: 27.276
2020-09-19 04:40:04,910 R@1 : 42.517
2020-09-19 04:40:05,666 R@2 : 51.421
2020-09-19 04:40:06,420 R@4 : 61.219
2020-09-19 04:40:07,184 R@8 : 70.756
2020-09-19 04:42:40,940 Epoch: 1, loss: 2.360, time (seconds): 153.75.
2020-09-19 04:42:40,941 **Evaluating.**
2020-09-19 04:44:40,602 NMI: 28.030
2020-09-19 04:46:08,198 R@1 : 44.462
2020-09-19 04:46:08,942 R@2 : 53.645
2020-09-19 04:46:09,683 R@4 : 63.283
2020-09-19 04:46:10,424 R@8 : 72.402
2020-09-19 04:48:48,056 Epoch: 2, loss: 2.155, time (seconds): 157.63.
2020-09-19 04:48:48,057 **Evaluating.**
2020-09-19 04:50:48,780 NMI: 28.976
2020-09-19 04:52:17,765 R@1 : 45.345
2020-09-19 04:52:18,512 R@2 : 54.554
2020-09-19 04:52:19,263 R@4 : 63.771
2020-09-19 04:52:20,008 R@8 : 72.969
2020-09-19 04:54:55,969 Epoch: 3, loss: 1.950, time (seconds): 155.96.
2020-09-19 04:54:55,970 **Evaluating.**
2020-09-19 04:57:00,341 NMI: 28.472
2020-09-19 04:58:28,994 R@1 : 46.544
2020-09-19 04:58:29,779 R@2 : 55.596
2020-09-19 04:58:30,536 R@4 : 65.165
2020-09-19 04:58:31,307 R@8 : 73.839
2020-09-19 05:01:05,885 Epoch: 4, loss: 1.989, time (seconds): 154.58.
2020-09-19 05:01:05,885 **Evaluating.**
2020-09-19 05:03:16,550 NMI: 29.178
2020-09-19 05:04:50,806 R@1 : 47.415
2020-09-19 05:04:51,552 R@2 : 56.243
2020-09-19 05:04:52,309 R@4 : 65.510
2020-09-19 05:04:53,060 R@8 : 74.170
2020-09-19 05:07:35,730 Epoch: 5, loss: 1.802, time (seconds): 162.67.
2020-09-19 05:07:35,731 **Evaluating.**
2020-09-19 05:09:56,741 NMI: 28.908
2020-09-19 05:11:28,884 R@1 : 47.174
2020-09-19 05:11:29,650 R@2 : 56.293
2020-09-19 05:11:30,399 R@4 : 65.502
2020-09-19 05:11:31,153 R@8 : 74.173
2020-09-19 05:14:18,895 Epoch: 6, loss: 1.760, time (seconds): 167.74.
2020-09-19 05:14:18,895 **Evaluating.**
2020-09-19 05:16:45,735 NMI: 29.396
2020-09-19 05:18:18,784 R@1 : 47.499
2020-09-19 05:18:19,623 R@2 : 56.513
2020-09-19 05:18:20,463 R@4 : 65.742
2020-09-19 05:18:21,305 R@8 : 74.438
2020-09-19 05:21:03,909 Epoch: 7, loss: 1.735, time (seconds): 162.60.
2020-09-19 05:21:03,910 **Evaluating.**
2020-09-19 05:23:15,316 NMI: 28.691
2020-09-19 05:24:48,281 R@1 : 46.991
2020-09-19 05:24:49,026 R@2 : 56.145
2020-09-19 05:24:49,780 R@4 : 65.426
2020-09-19 05:24:50,544 R@8 : 74.252
2020-09-19 05:27:29,009 Epoch: 8, loss: 1.712, time (seconds): 158.46.
2020-09-19 05:27:29,009 **Evaluating.**
2020-09-19 05:29:45,235 NMI: 28.234
2020-09-19 05:31:22,925 R@1 : 47.252
2020-09-19 05:31:23,667 R@2 : 56.142
2020-09-19 05:31:24,420 R@4 : 65.200
2020-09-19 05:31:25,175 R@8 : 73.947
2020-09-19 05:34:03,717 Epoch: 9, loss: 1.646, time (seconds): 158.54.
2020-09-19 05:34:03,718 **Evaluating.**
2020-09-19 05:36:14,069 NMI: 28.491
2020-09-19 05:37:49,440 R@1 : 47.264
2020-09-19 05:37:50,190 R@2 : 56.388
2020-09-19 05:37:50,943 R@4 : 65.472
2020-09-19 05:37:51,710 R@8 : 74.185
2020-09-19 05:40:33,238 Epoch: 10, loss: 1.622, time (seconds): 161.53.
2020-09-19 05:40:33,239 **Evaluating.**
2020-09-19 05:42:56,014 NMI: 28.599
2020-09-19 05:44:30,568 R@1 : 47.023
2020-09-19 05:44:31,355 R@2 : 55.857
2020-09-19 05:44:32,110 R@4 : 65.060
2020-09-19 05:44:32,864 R@8 : 73.860
2020-09-19 05:47:11,371 Epoch: 11, loss: 1.486, time (seconds): 158.50.
2020-09-19 05:47:11,372 **Evaluating.**
2020-09-19 05:49:25,735 NMI: 28.393
2020-09-19 05:51:00,115 R@1 : 46.361
2020-09-19 05:51:00,867 R@2 : 55.634
2020-09-19 05:51:01,614 R@4 : 64.744
2020-09-19 05:51:02,371 R@8 : 73.628
2020-09-19 05:53:42,255 Epoch: 12, loss: 1.536, time (seconds): 159.88.
2020-09-19 05:53:42,255 **Evaluating.**
2020-09-19 05:55:58,746 NMI: 28.427
2020-09-19 05:57:33,632 R@1 : 46.852
2020-09-19 05:57:34,376 R@2 : 56.235
2020-09-19 05:57:35,121 R@4 : 65.403
2020-09-19 05:57:35,865 R@8 : 73.874
2020-09-19 06:00:14,158 Epoch: 13, loss: 1.492, time (seconds): 158.29.
2020-09-19 06:00:14,159 **Evaluating.**
2020-09-19 06:02:29,538 NMI: 27.307
2020-09-19 06:04:04,207 R@1 : 46.111
2020-09-19 06:04:04,980 R@2 : 54.998
2020-09-19 06:04:05,732 R@4 : 64.387
2020-09-19 06:04:06,488 R@8 : 73.372
2020-09-19 06:06:46,413 Epoch: 14, loss: 1.402, time (seconds): 159.92.
2020-09-19 06:06:46,414 **Evaluating.**
2020-09-19 06:09:09,414 NMI: 27.490
2020-09-19 06:10:45,123 R@1 : 46.764
2020-09-19 06:10:45,881 R@2 : 55.837
2020-09-19 06:10:46,648 R@4 : 64.831
2020-09-19 06:10:47,434 R@8 : 73.744
2020-09-19 06:13:25,469 Epoch: 15, loss: 1.394, time (seconds): 158.03.
2020-09-19 06:13:25,470 **Evaluating.**
2020-09-19 06:15:34,883 NMI: 26.836
2020-09-19 06:17:09,125 R@1 : 45.911
2020-09-19 06:17:09,866 R@2 : 54.493
2020-09-19 06:17:10,622 R@4 : 63.553
2020-09-19 06:17:11,381 R@8 : 72.219
2020-09-19 06:19:51,292 Epoch: 16, loss: 1.381, time (seconds): 159.91.
2020-09-19 06:19:51,293 **Evaluating.**
2020-09-19 06:22:07,211 NMI: 27.303
2020-09-19 06:23:43,169 R@1 : 45.850
2020-09-19 06:23:43,947 R@2 : 54.472
2020-09-19 06:23:44,739 R@4 : 63.641
2020-09-19 06:23:45,499 R@8 : 72.309
2020-09-19 06:26:27,336 Epoch: 17, loss: 1.347, time (seconds): 161.83.
2020-09-19 06:26:27,336 **Evaluating.**
2020-09-19 06:29:17,023 NMI: 27.110
2020-09-19 06:30:49,659 R@1 : 45.748
2020-09-19 06:30:50,416 R@2 : 54.673
2020-09-19 06:30:51,185 R@4 : 63.821
2020-09-19 06:30:51,937 R@8 : 72.632
2020-09-19 06:33:31,260 Epoch: 18, loss: 1.287, time (seconds): 159.32.
2020-09-19 06:33:31,261 **Evaluating.**
2020-09-19 06:35:30,593 NMI: 27.804
2020-09-19 06:37:03,137 R@1 : 45.873
2020-09-19 06:37:03,888 R@2 : 54.827
2020-09-19 06:37:04,658 R@4 : 63.969
2020-09-19 06:37:05,417 R@8 : 72.913
2020-09-19 06:39:41,720 Epoch: 19, loss: 1.250, time (seconds): 156.30.
2020-09-19 06:39:41,722 **Evaluating.**
2020-09-19 06:41:49,530 NMI: 26.608
2020-09-19 06:43:22,526 R@1 : 44.921
2020-09-19 06:43:23,281 R@2 : 53.761
2020-09-19 06:43:24,054 R@4 : 63.135
2020-09-19 06:43:24,810 R@8 : 71.897
2020-09-19 06:46:02,747 Epoch: 20, loss: 1.250, time (seconds): 157.93.
2020-09-19 06:46:02,748 **Evaluating.**
2020-09-19 06:48:08,806 NMI: 26.607
2020-09-19 06:49:42,002 R@1 : 44.930
2020-09-19 06:49:42,763 R@2 : 53.471
2020-09-19 06:49:43,523 R@4 : 62.595
2020-09-19 06:49:44,296 R@8 : 71.372
2020-09-19 06:52:20,796 Epoch: 21, loss: 1.210, time (seconds): 156.50.
2020-09-19 06:52:20,796 **Evaluating.**
2020-09-19 06:54:23,394 NMI: 26.444
2020-09-19 06:55:54,725 R@1 : 44.645
2020-09-19 06:55:55,470 R@2 : 53.604
2020-09-19 06:55:56,219 R@4 : 62.651
2020-09-19 06:55:56,968 R@8 : 71.732
2020-09-19 06:58:34,269 Epoch: 22, loss: 1.214, time (seconds): 157.30.
2020-09-19 06:58:34,270 **Evaluating.**
2020-09-19 07:00:34,499 NMI: 25.408
2020-09-19 07:02:06,109 R@1 : 43.940
2020-09-19 07:02:06,858 R@2 : 52.672
2020-09-19 07:02:07,609 R@4 : 61.986
2020-09-19 07:02:08,369 R@8 : 70.980
2020-09-19 07:04:45,035 Epoch: 23, loss: 1.206, time (seconds): 156.66.
2020-09-19 07:04:45,036 **Evaluating.**
2020-09-19 07:06:51,480 NMI: 25.571
2020-09-19 07:08:23,132 R@1 : 44.610
2020-09-19 07:08:23,896 R@2 : 53.337
2020-09-19 07:08:24,690 R@4 : 62.433
2020-09-19 07:08:25,435 R@8 : 71.491
2020-09-19 07:11:03,579 Epoch: 24, loss: 1.220, time (seconds): 158.14.
2020-09-19 07:11:03,580 **Evaluating.**
2020-09-19 07:13:01,769 NMI: 25.717
2020-09-19 07:14:35,057 R@1 : 44.195
2020-09-19 07:14:35,828 R@2 : 53.029
2020-09-19 07:14:36,594 R@4 : 61.878
2020-09-19 07:14:37,345 R@8 : 70.631
2020-09-19 07:17:13,439 Epoch: 25, loss: 1.213, time (seconds): 156.09.
2020-09-19 07:17:13,439 **Evaluating.**
2020-09-19 07:19:16,106 NMI: 25.757
2020-09-19 07:20:49,421 R@1 : 43.858
2020-09-19 07:20:50,179 R@2 : 52.649
2020-09-19 07:20:50,940 R@4 : 61.925
2020-09-19 07:20:51,693 R@8 : 71.026
2020-09-19 07:23:28,633 Epoch: 26, loss: 1.151, time (seconds): 156.94.
2020-09-19 07:23:28,634 **Evaluating.**
2020-09-19 07:25:33,632 NMI: 24.669
2020-09-19 07:27:06,691 R@1 : 43.655
2020-09-19 07:27:07,452 R@2 : 52.269
2020-09-19 07:27:08,200 R@4 : 61.489
2020-09-19 07:27:08,958 R@8 : 70.605
2020-09-19 07:29:45,489 Epoch: 27, loss: 1.175, time (seconds): 156.53.
2020-09-19 07:29:45,490 **Evaluating.**
2020-09-19 07:31:53,600 NMI: 25.920
2020-09-19 07:33:26,687 R@1 : 44.131
2020-09-19 07:33:27,436 R@2 : 52.910
2020-09-19 07:33:28,193 R@4 : 62.061
2020-09-19 07:33:28,955 R@8 : 71.322
2020-09-19 07:36:06,304 Epoch: 28, loss: 1.163, time (seconds): 157.35.
2020-09-19 07:36:06,305 **Evaluating.**
2020-09-19 07:38:10,644 NMI: 25.147
2020-09-19 07:39:43,977 R@1 : 43.725
2020-09-19 07:39:44,743 R@2 : 52.179
2020-09-19 07:39:45,488 R@4 : 61.283
2020-09-19 07:39:46,252 R@8 : 70.550
2020-09-19 07:42:20,425 Epoch: 29, loss: 1.130, time (seconds): 154.17.
2020-09-19 07:42:20,425 **Evaluating.**
2020-09-19 07:44:21,932 NMI: 25.609
2020-09-19 07:45:53,923 R@1 : 43.472
2020-09-19 07:45:54,690 R@2 : 52.042
2020-09-19 07:45:55,454 R@4 : 61.097
2020-09-19 07:45:56,199 R@8 : 70.277
2020-09-19 07:48:32,784 Epoch: 30, loss: 1.158, time (seconds): 156.58.
2020-09-19 07:48:32,785 **Evaluating.**
2020-09-19 07:50:38,643 NMI: 25.662
2020-09-19 07:52:12,501 R@1 : 43.585
2020-09-19 07:52:13,252 R@2 : 51.949
2020-09-19 07:52:14,034 R@4 : 60.868
2020-09-19 07:52:14,801 R@8 : 70.007
2020-09-19 07:54:53,822 Epoch: 31, loss: 1.128, time (seconds): 159.02.
2020-09-19 07:54:53,823 **Evaluating.**
2020-09-19 07:56:56,544 NMI: 25.137
2020-09-19 07:58:29,905 R@1 : 43.127
2020-09-19 07:58:30,667 R@2 : 51.958
2020-09-19 07:58:31,421 R@4 : 60.758
2020-09-19 07:58:32,184 R@8 : 69.836
2020-09-19 08:01:09,070 Epoch: 32, loss: 1.089, time (seconds): 156.88.
2020-09-19 08:01:09,071 **Evaluating.**
2020-09-19 08:03:14,661 NMI: 25.456
2020-09-19 08:04:47,243 R@1 : 44.024
2020-09-19 08:04:47,998 R@2 : 52.420
2020-09-19 08:04:48,770 R@4 : 61.333
2020-09-19 08:04:49,529 R@8 : 70.388
2020-09-19 08:07:26,948 Epoch: 33, loss: 1.073, time (seconds): 157.42.
2020-09-19 08:07:26,949 **Evaluating.**
2020-09-19 08:09:33,527 NMI: 25.022
2020-09-19 08:11:06,587 R@1 : 43.301
2020-09-19 08:11:07,344 R@2 : 52.019
2020-09-19 08:11:08,108 R@4 : 61.144
2020-09-19 08:11:08,869 R@8 : 70.062
2020-09-19 08:13:48,382 Epoch: 34, loss: 1.025, time (seconds): 159.51.
2020-09-19 08:13:48,382 **Evaluating.**
2020-09-19 08:15:48,917 NMI: 25.513
2020-09-19 08:17:22,296 R@1 : 43.240
2020-09-19 08:17:23,061 R@2 : 51.854
2020-09-19 08:17:23,806 R@4 : 60.967
2020-09-19 08:17:24,569 R@8 : 70.269
2020-09-19 08:20:04,433 Epoch: 35, loss: 1.081, time (seconds): 159.86.
2020-09-19 08:20:04,433 **Evaluating.**
2020-09-19 08:22:06,296 NMI: 23.935
2020-09-19 08:23:39,784 R@1 : 42.485
2020-09-19 08:23:40,531 R@2 : 50.922
2020-09-19 08:23:41,280 R@4 : 59.721
2020-09-19 08:23:42,075 R@8 : 69.084
2020-09-19 08:26:22,796 Epoch: 36, loss: 1.032, time (seconds): 160.72.
2020-09-19 08:26:22,797 **Evaluating.**
2020-09-19 08:28:22,573 NMI: 24.968
2020-09-19 08:29:56,180 R@1 : 42.485
2020-09-19 08:29:56,957 R@2 : 51.087
2020-09-19 08:29:57,716 R@4 : 60.186
2020-09-19 08:29:58,469 R@8 : 69.589
2020-09-19 08:32:36,513 Epoch: 37, loss: 1.033, time (seconds): 158.04.
2020-09-19 08:32:36,514 **Evaluating.**
2020-09-19 08:34:38,298 NMI: 25.226
2020-09-19 08:36:11,505 R@1 : 43.333
2020-09-19 08:36:12,262 R@2 : 52.037
2020-09-19 08:36:13,010 R@4 : 60.880
2020-09-19 08:36:13,763 R@8 : 69.792
2020-09-19 08:38:51,626 Epoch: 38, loss: 1.011, time (seconds): 157.86.
2020-09-19 08:38:51,626 **Evaluating.**
2020-09-19 08:40:50,516 NMI: 24.733
2020-09-19 08:42:23,571 R@1 : 43.054
2020-09-19 08:42:24,343 R@2 : 51.656
2020-09-19 08:42:25,102 R@4 : 60.688
2020-09-19 08:42:25,852 R@8 : 69.862
2020-09-19 08:45:03,270 Epoch: 39, loss: 1.042, time (seconds): 157.42.
2020-09-19 08:45:03,271 **Evaluating.**
2020-09-19 08:47:04,142 NMI: 24.622
2020-09-19 08:48:38,030 R@1 : 43.031
2020-09-19 08:48:38,776 R@2 : 51.415
2020-09-19 08:48:39,525 R@4 : 60.653
2020-09-19 08:48:40,277 R@8 : 69.833
2020-09-19 08:48:40,280 Total training time (minutes): 258.06.
2020-09-19 08:48:42,351 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 40, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200919-010238', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-19 08:48:42,351 Training for 40 epochs
2020-09-19 08:48:42,353 **Evaluating initial model.**
2020-09-19 08:50:25,539 NMI: 24.435
2020-09-19 08:51:59,242 R@1 : 42.006
2020-09-19 08:51:59,986 R@2 : 50.544
2020-09-19 08:52:00,732 R@4 : 59.936
2020-09-19 08:52:01,477 R@8 : 69.261
2020-09-19 08:54:00,330 Epoch: 0, loss: 2.772, time (seconds): 118.85.
2020-09-19 08:54:00,331 **Evaluating.**
2020-09-19 08:55:57,610 NMI: 27.080
2020-09-19 08:57:21,786 R@1 : 43.051
2020-09-19 08:57:22,531 R@2 : 52.266
2020-09-19 08:57:23,273 R@4 : 61.870
2020-09-19 08:57:24,019 R@8 : 71.488
2020-09-19 08:59:23,504 Epoch: 1, loss: 2.349, time (seconds): 119.48.
2020-09-19 08:59:23,504 **Evaluating.**
2020-09-19 09:01:19,035 NMI: 29.564
2020-09-19 09:02:44,867 R@1 : 45.751
2020-09-19 09:02:45,706 R@2 : 55.143
2020-09-19 09:02:46,549 R@4 : 64.770
2020-09-19 09:02:47,389 R@8 : 73.877
2020-09-19 09:04:47,327 Epoch: 2, loss: 2.163, time (seconds): 119.94.
2020-09-19 09:04:47,327 **Evaluating.**
2020-09-19 09:06:40,602 NMI: 30.447
2020-09-19 09:08:07,629 R@1 : 46.820
2020-09-19 09:08:08,391 R@2 : 56.365
2020-09-19 09:08:09,142 R@4 : 65.769
2020-09-19 09:08:09,905 R@8 : 74.452
2020-09-19 09:10:10,011 Epoch: 3, loss: 2.022, time (seconds): 120.10.
2020-09-19 09:10:10,012 **Evaluating.**
2020-09-19 09:12:03,802 NMI: 31.182
2020-09-19 09:13:31,589 R@1 : 48.172
2020-09-19 09:13:32,332 R@2 : 57.495
2020-09-19 09:13:33,076 R@4 : 66.454
2020-09-19 09:13:33,824 R@8 : 75.079
2020-09-19 09:15:32,096 Epoch: 4, loss: 1.903, time (seconds): 118.27.
2020-09-19 09:15:32,096 **Evaluating.**
2020-09-19 09:17:25,063 NMI: 30.266
2020-09-19 09:18:54,148 R@1 : 47.598
2020-09-19 09:18:54,891 R@2 : 56.772
2020-09-19 09:18:55,653 R@4 : 65.830
2020-09-19 09:18:56,400 R@8 : 74.379
2020-09-19 09:20:57,888 Epoch: 5, loss: 1.843, time (seconds): 121.49.
2020-09-19 09:20:57,889 **Evaluating.**
2020-09-19 09:22:52,355 NMI: 29.876
2020-09-19 09:24:21,817 R@1 : 48.161
2020-09-19 09:24:22,567 R@2 : 57.538
2020-09-19 09:24:23,330 R@4 : 66.628
2020-09-19 09:24:24,077 R@8 : 75.253
2020-09-19 09:26:22,538 Epoch: 6, loss: 1.803, time (seconds): 118.46.
2020-09-19 09:26:22,538 **Evaluating.**
2020-09-19 09:28:16,431 NMI: 30.241
2020-09-19 09:29:46,128 R@1 : 47.929
2020-09-19 09:29:46,882 R@2 : 57.016
2020-09-19 09:29:47,643 R@4 : 66.233
2020-09-19 09:29:48,422 R@8 : 74.928
2020-09-19 09:31:50,958 Epoch: 7, loss: 1.733, time (seconds): 122.53.
2020-09-19 09:31:50,959 **Evaluating.**
2020-09-19 09:33:44,400 NMI: 30.815
2020-09-19 09:35:14,504 R@1 : 48.164
2020-09-19 09:35:15,270 R@2 : 57.373
2020-09-19 09:35:16,064 R@4 : 66.788
2020-09-19 09:35:16,830 R@8 : 75.303
2020-09-19 09:37:17,726 Epoch: 8, loss: 1.697, time (seconds): 120.89.
2020-09-19 09:37:17,727 **Evaluating.**
2020-09-19 09:39:09,729 NMI: 30.302
2020-09-19 09:40:40,180 R@1 : 47.812
2020-09-19 09:40:40,946 R@2 : 56.943
2020-09-19 09:40:41,692 R@4 : 66.494
2020-09-19 09:40:42,457 R@8 : 75.009
2020-09-19 09:42:45,363 Epoch: 9, loss: 1.607, time (seconds): 122.90.
2020-09-19 09:42:45,363 **Evaluating.**
2020-09-19 09:44:39,577 NMI: 29.335
2020-09-19 09:46:10,618 R@1 : 47.534
2020-09-19 09:46:11,383 R@2 : 56.833
2020-09-19 09:46:12,128 R@4 : 66.027
2020-09-19 09:46:12,873 R@8 : 74.777
2020-09-19 09:48:12,889 Epoch: 10, loss: 1.567, time (seconds): 120.01.
2020-09-19 09:48:12,890 **Evaluating.**
2020-09-19 09:50:23,295 NMI: 29.715
2020-09-19 09:51:51,003 R@1 : 48.167
2020-09-19 09:51:51,749 R@2 : 57.384
2020-09-19 09:51:52,499 R@4 : 66.596
2020-09-19 09:51:53,256 R@8 : 75.245
2020-09-19 09:53:53,583 Epoch: 11, loss: 1.547, time (seconds): 120.32.
2020-09-19 09:53:53,584 **Evaluating.**
2020-09-19 09:55:51,462 NMI: 29.712
2020-09-19 09:57:19,735 R@1 : 47.031
2020-09-19 09:57:20,481 R@2 : 56.333
2020-09-19 09:57:21,224 R@4 : 65.844
2020-09-19 09:57:21,965 R@8 : 74.345
2020-09-19 09:59:28,412 Epoch: 12, loss: 1.487, time (seconds): 126.44.
2020-09-19 09:59:28,413 **Evaluating.**
2020-09-19 10:01:50,207 NMI: 29.415
2020-09-19 10:03:23,743 R@1 : 47.121
2020-09-19 10:03:24,483 R@2 : 56.478
2020-09-19 10:03:25,222 R@4 : 65.986
2020-09-19 10:03:25,972 R@8 : 74.734
2020-09-19 10:05:35,233 Epoch: 13, loss: 1.467, time (seconds): 129.26.
2020-09-19 10:05:35,234 **Evaluating.**
2020-09-19 10:07:45,882 NMI: 29.936
2020-09-19 10:09:16,863 R@1 : 47.583
2020-09-19 10:09:17,607 R@2 : 56.618
2020-09-19 10:09:18,348 R@4 : 65.748
2020-09-19 10:09:19,093 R@8 : 74.440
2020-09-19 10:11:28,263 Epoch: 14, loss: 1.424, time (seconds): 129.17.
2020-09-19 10:11:28,263 **Evaluating.**
2020-09-19 10:13:24,993 NMI: 29.003
2020-09-19 10:14:59,557 R@1 : 46.883
2020-09-19 10:15:00,302 R@2 : 55.970
2020-09-19 10:15:01,044 R@4 : 65.101
2020-09-19 10:15:01,789 R@8 : 74.234
2020-09-19 10:17:13,892 Epoch: 15, loss: 1.405, time (seconds): 132.10.
2020-09-19 10:17:13,893 **Evaluating.**
2020-09-19 10:19:20,177 NMI: 28.938
2020-09-19 10:20:53,113 R@1 : 46.454
2020-09-19 10:20:53,875 R@2 : 55.674
2020-09-19 10:20:54,631 R@4 : 65.014
2020-09-19 10:20:55,390 R@8 : 74.002
2020-09-19 10:23:00,161 Epoch: 16, loss: 1.385, time (seconds): 124.77.
2020-09-19 10:23:00,162 **Evaluating.**
2020-09-19 10:25:05,902 NMI: 28.001
2020-09-19 10:26:38,364 R@1 : 46.033
2020-09-19 10:26:39,121 R@2 : 55.247
2020-09-19 10:26:39,864 R@4 : 64.805
2020-09-19 10:26:40,614 R@8 : 73.825
2020-09-19 10:28:53,014 Epoch: 17, loss: 1.318, time (seconds): 132.40.
2020-09-19 10:28:53,014 **Evaluating.**
2020-09-19 10:31:02,097 NMI: 28.234
2020-09-19 10:32:34,075 R@1 : 46.056
2020-09-19 10:32:34,848 R@2 : 54.969
2020-09-19 10:32:35,600 R@4 : 64.288
2020-09-19 10:32:36,359 R@8 : 73.349
2020-09-19 10:34:41,456 Epoch: 18, loss: 1.365, time (seconds): 125.10.
2020-09-19 10:34:41,457 **Evaluating.**
2020-09-19 10:36:43,227 NMI: 28.243
2020-09-19 10:38:14,897 R@1 : 45.263
2020-09-19 10:38:15,638 R@2 : 54.661
2020-09-19 10:38:16,391 R@4 : 63.855
2020-09-19 10:38:17,144 R@8 : 72.664
2020-09-19 10:40:20,740 Epoch: 19, loss: 1.326, time (seconds): 123.59.
2020-09-19 10:40:20,741 **Evaluating.**
2020-09-19 10:42:23,787 NMI: 27.697
2020-09-19 10:43:56,656 R@1 : 45.194
2020-09-19 10:43:57,407 R@2 : 54.194
2020-09-19 10:43:58,155 R@4 : 63.658
2020-09-19 10:43:58,903 R@8 : 72.678
2020-09-19 10:46:03,404 Epoch: 20, loss: 1.309, time (seconds): 124.50.
2020-09-19 10:46:03,405 **Evaluating.**
2020-09-19 10:48:06,752 NMI: 27.960
2020-09-19 10:49:40,512 R@1 : 45.734
2020-09-19 10:49:41,258 R@2 : 54.638
2020-09-19 10:49:42,002 R@4 : 63.681
2020-09-19 10:49:42,771 R@8 : 72.806
2020-09-19 10:51:46,666 Epoch: 21, loss: 1.292, time (seconds): 123.89.
2020-09-19 10:51:46,666 **Evaluating.**
2020-09-19 10:53:39,126 NMI: 28.008
2020-09-19 10:55:09,955 R@1 : 45.867
2020-09-19 10:55:10,806 R@2 : 54.873
2020-09-19 10:55:11,662 R@4 : 64.207
2020-09-19 10:55:12,507 R@8 : 73.050
2020-09-19 10:57:03,121 Epoch: 22, loss: 1.281, time (seconds): 110.61.
2020-09-19 10:57:03,121 **Evaluating.**
2020-09-19 10:58:54,244 NMI: 27.675
2020-09-19 11:00:26,361 R@1 : 45.069
2020-09-19 11:00:27,122 R@2 : 54.063
2020-09-19 11:00:27,883 R@4 : 63.179
2020-09-19 11:00:28,637 R@8 : 72.199
2020-09-19 11:02:19,018 Epoch: 23, loss: 1.238, time (seconds): 110.38.
2020-09-19 11:02:19,019 **Evaluating.**
2020-09-19 11:04:09,172 NMI: 27.886
2020-09-19 11:05:42,475 R@1 : 45.597
2020-09-19 11:05:43,224 R@2 : 54.452
2020-09-19 11:05:43,975 R@4 : 63.716
2020-09-19 11:05:44,740 R@8 : 72.516
2020-09-19 11:07:40,008 Epoch: 24, loss: 1.247, time (seconds): 115.26.
2020-09-19 11:07:40,009 **Evaluating.**
2020-09-19 11:09:34,542 NMI: 27.095
2020-09-19 11:11:08,366 R@1 : 45.052
2020-09-19 11:11:09,111 R@2 : 53.546
2020-09-19 11:11:09,869 R@4 : 63.080
2020-09-19 11:11:10,638 R@8 : 72.156
2020-09-19 11:13:07,019 Epoch: 25, loss: 1.223, time (seconds): 116.38.
2020-09-19 11:13:07,020 **Evaluating.**
2020-09-19 11:14:58,800 NMI: 27.316
2020-09-19 11:16:31,603 R@1 : 44.866
2020-09-19 11:16:32,351 R@2 : 53.825
2020-09-19 11:16:33,104 R@4 : 63.040
2020-09-19 11:16:33,880 R@8 : 72.237
2020-09-19 11:18:30,703 Epoch: 26, loss: 1.193, time (seconds): 116.82.
2020-09-19 11:18:30,704 **Evaluating.**
2020-09-19 11:20:24,830 NMI: 27.189
2020-09-19 11:21:57,945 R@1 : 44.639
2020-09-19 11:21:58,704 R@2 : 53.581
2020-09-19 11:21:59,458 R@4 : 62.924
2020-09-19 11:22:00,222 R@8 : 72.179
2020-09-19 11:23:51,713 Epoch: 27, loss: 1.218, time (seconds): 111.49.
2020-09-19 11:23:51,714 **Evaluating.**
2020-09-19 11:25:44,611 NMI: 27.018
2020-09-19 11:27:18,504 R@1 : 44.837
2020-09-19 11:27:19,347 R@2 : 53.593
2020-09-19 11:27:20,207 R@4 : 62.921
2020-09-19 11:27:21,066 R@8 : 71.981
2020-09-19 11:29:15,994 Epoch: 28, loss: 1.169, time (seconds): 114.93.
2020-09-19 11:29:15,995 **Evaluating.**
2020-09-19 11:31:10,440 NMI: 26.936
2020-09-19 11:32:43,913 R@1 : 44.694
2020-09-19 11:32:44,658 R@2 : 53.436
2020-09-19 11:32:45,407 R@4 : 62.906
2020-09-19 11:32:46,158 R@8 : 71.973
2020-09-19 11:34:40,423 Epoch: 29, loss: 1.195, time (seconds): 114.26.
2020-09-19 11:34:40,424 **Evaluating.**
2020-09-19 11:36:31,715 NMI: 26.601
2020-09-19 11:38:05,118 R@1 : 44.503
2020-09-19 11:38:05,958 R@2 : 53.433
2020-09-19 11:38:06,796 R@4 : 62.610
2020-09-19 11:38:07,647 R@8 : 71.630
2020-09-19 11:40:00,886 Epoch: 30, loss: 1.192, time (seconds): 113.24.
2020-09-19 11:40:00,887 **Evaluating.**
2020-09-19 11:41:52,949 NMI: 26.407
2020-09-19 11:43:26,332 R@1 : 44.210
2020-09-19 11:43:27,085 R@2 : 53.000
2020-09-19 11:43:27,832 R@4 : 62.389
2020-09-19 11:43:28,580 R@8 : 71.543
2020-09-19 11:45:20,626 Epoch: 31, loss: 1.175, time (seconds): 112.04.
2020-09-19 11:45:20,627 **Evaluating.**
2020-09-19 11:47:11,536 NMI: 26.450
2020-09-19 11:48:43,845 R@1 : 43.800
2020-09-19 11:48:44,595 R@2 : 52.780
2020-09-19 11:48:45,340 R@4 : 62.212
2020-09-19 11:48:46,086 R@8 : 71.282
2020-09-19 11:50:38,792 Epoch: 32, loss: 1.171, time (seconds): 112.70.
2020-09-19 11:50:38,793 **Evaluating.**
2020-09-19 11:52:30,530 NMI: 26.661
2020-09-19 11:54:03,295 R@1 : 44.125
2020-09-19 11:54:04,045 R@2 : 53.009
2020-09-19 11:54:04,795 R@4 : 62.041
2020-09-19 11:54:05,544 R@8 : 71.163
2020-09-19 11:55:54,081 Epoch: 33, loss: 1.150, time (seconds): 108.53.
2020-09-19 11:55:54,082 **Evaluating.**
2020-09-19 11:57:44,397 NMI: 27.034
2020-09-19 11:59:15,836 R@1 : 44.282
2020-09-19 11:59:16,590 R@2 : 53.250
2020-09-19 11:59:17,335 R@4 : 62.256
2020-09-19 11:59:18,086 R@8 : 71.665
2020-09-19 12:01:14,526 Epoch: 34, loss: 1.152, time (seconds): 116.44.
2020-09-19 12:01:14,527 **Evaluating.**
2020-09-19 12:03:05,073 NMI: 26.725
2020-09-19 12:04:36,641 R@1 : 43.858
2020-09-19 12:04:37,398 R@2 : 52.559
2020-09-19 12:04:38,148 R@4 : 61.980
2020-09-19 12:04:38,897 R@8 : 71.116
2020-09-19 12:06:33,947 Epoch: 35, loss: 1.151, time (seconds): 115.05.
2020-09-19 12:06:33,948 **Evaluating.**
2020-09-19 12:08:25,981 NMI: 26.660
2020-09-19 12:09:57,049 R@1 : 43.911
2020-09-19 12:09:57,811 R@2 : 52.844
2020-09-19 12:09:58,560 R@4 : 62.198
2020-09-19 12:09:59,321 R@8 : 71.200
2020-09-19 12:11:56,633 Epoch: 36, loss: 1.159, time (seconds): 117.31.
2020-09-19 12:11:56,633 **Evaluating.**
2020-09-19 12:13:49,569 NMI: 26.018
2020-09-19 12:15:24,731 R@1 : 43.228
2020-09-19 12:15:25,490 R@2 : 52.034
2020-09-19 12:15:26,240 R@4 : 61.408
2020-09-19 12:15:26,993 R@8 : 70.585
2020-09-19 12:17:31,656 Epoch: 37, loss: 1.118, time (seconds): 124.66.
2020-09-19 12:17:31,657 **Evaluating.**
2020-09-19 12:19:23,942 NMI: 26.342
2020-09-19 12:20:58,746 R@1 : 43.536
2020-09-19 12:20:59,496 R@2 : 52.510
2020-09-19 12:21:00,252 R@4 : 61.832
2020-09-19 12:21:01,000 R@8 : 70.811
2020-09-19 12:23:02,550 Epoch: 38, loss: 1.113, time (seconds): 121.55.
2020-09-19 12:23:02,551 **Evaluating.**
2020-09-19 12:24:53,968 NMI: 26.071
2020-09-19 12:26:27,721 R@1 : 43.815
2020-09-19 12:26:28,469 R@2 : 52.594
2020-09-19 12:26:29,225 R@4 : 61.832
2020-09-19 12:26:29,969 R@8 : 71.041
2020-09-19 12:28:26,925 Epoch: 39, loss: 1.149, time (seconds): 116.95.
2020-09-19 12:28:26,925 **Evaluating.**
2020-09-19 12:30:17,791 NMI: 26.038
2020-09-19 12:31:52,310 R@1 : 43.289
2020-09-19 12:31:53,062 R@2 : 51.877
2020-09-19 12:31:53,806 R@4 : 61.330
2020-09-19 12:31:54,553 R@8 : 70.634
2020-09-19 12:31:54,555 Total training time (minutes): 223.20.
2020-09-19 12:31:56,948 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 40, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food-20200919-010238', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-19 12:31:56,948 Training for 40 epochs
2020-09-19 12:31:56,952 **Evaluating initial model.**
2020-09-19 12:33:50,499 NMI: 24.435
2020-09-19 12:35:25,571 R@1 : 42.006
2020-09-19 12:35:26,314 R@2 : 50.544
2020-09-19 12:35:27,080 R@4 : 59.936
2020-09-19 12:35:27,836 R@8 : 69.261
2020-09-19 12:37:59,611 Epoch: 0, loss: 2.305, time (seconds): 151.77.
2020-09-19 12:37:59,612 **Evaluating.**
2020-09-19 12:39:47,869 NMI: 28.771
2020-09-19 12:41:17,500 R@1 : 45.220
2020-09-19 12:41:18,255 R@2 : 54.345
2020-09-19 12:41:19,012 R@4 : 63.513
2020-09-19 12:41:19,764 R@8 : 73.027
