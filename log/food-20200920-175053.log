2020-09-20 17:50:58,422 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 10, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200920-175053', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 1, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-20 17:50:58,423 Training for 10 epochs
2020-09-20 17:50:58,425 **Evaluating initial model.**
2020-09-20 17:55:00,505 NMI: 24.322
2020-09-20 17:59:36,199 R@1 : 45.121
2020-09-20 17:59:37,825 R@2 : 53.184
2020-09-20 17:59:38,880 R@4 : 61.886
2020-09-20 17:59:39,993 R@8 : 70.698
2020-09-20 18:04:12,878 Epoch: 0, loss: 2.305, time (seconds): 272.84.
2020-09-20 18:04:12,879 **Evaluating.**
2020-09-20 18:08:18,964 NMI: 27.731
2020-09-20 18:11:27,631 R@1 : 49.608
2020-09-20 18:11:28,721 R@2 : 58.452
2020-09-20 18:11:29,733 R@4 : 67.283
2020-09-20 18:11:30,734 R@8 : 75.492
2020-09-20 18:15:26,574 Epoch: 1, loss: 2.144, time (seconds): 234.85.
2020-09-20 18:15:26,575 **Evaluating.**
2020-09-20 18:19:31,294 NMI: 29.032
2020-09-20 18:27:20,558 R@1 : 50.416
2020-09-20 18:27:21,776 R@2 : 59.188
2020-09-20 18:27:22,790 R@4 : 67.906
2020-09-20 18:27:23,801 R@8 : 76.012
2020-09-20 18:31:13,420 Epoch: 2, loss: 1.903, time (seconds): 229.41.
2020-09-20 18:31:13,421 **Evaluating.**
2020-09-20 18:35:15,586 NMI: 29.003
2020-09-20 18:39:51,270 R@1 : 50.714
2020-09-20 18:39:52,789 R@2 : 59.138
2020-09-20 18:39:53,843 R@4 : 67.738
2020-09-20 18:39:54,845 R@8 : 75.775
2020-09-20 18:43:33,080 Epoch: 3, loss: 1.847, time (seconds): 217.63.
2020-09-20 18:43:33,081 **Evaluating.**
2020-09-20 18:47:13,289 NMI: 29.113
2020-09-20 18:51:09,901 R@1 : 50.481
2020-09-20 18:51:11,260 R@2 : 59.103
2020-09-20 18:51:12,352 R@4 : 67.601
2020-09-20 18:51:13,473 R@8 : 75.616
2020-09-20 18:54:53,203 Epoch: 4, loss: 1.783, time (seconds): 219.54.
2020-09-20 18:54:53,204 **Evaluating.**
2020-09-20 18:58:35,893 NMI: 28.886
2020-09-20 19:01:16,631 R@1 : 50.699
2020-09-20 19:01:17,728 R@2 : 59.138
2020-09-20 19:01:18,732 R@4 : 67.797
2020-09-20 19:01:19,779 R@8 : 75.603
2020-09-20 19:04:58,659 Epoch: 5, loss: 1.641, time (seconds): 218.80.
2020-09-20 19:04:58,659 **Evaluating.**
2020-09-20 19:08:38,134 NMI: 29.430
2020-09-20 19:11:15,610 R@1 : 51.471
2020-09-20 19:11:16,640 R@2 : 60.115
2020-09-20 19:11:17,624 R@4 : 68.445
2020-09-20 19:11:18,610 R@8 : 76.290
2020-09-20 19:15:02,605 Epoch: 6, loss: 1.682, time (seconds): 223.84.
2020-09-20 19:15:02,605 **Evaluating.**
2020-09-20 19:18:28,744 NMI: 28.498
2020-09-20 19:21:08,981 R@1 : 50.759
2020-09-20 19:21:09,971 R@2 : 59.116
2020-09-20 19:21:10,979 R@4 : 67.814
2020-09-20 19:21:12,026 R@8 : 75.651
2020-09-20 19:24:43,153 Epoch: 7, loss: 1.621, time (seconds): 210.98.
2020-09-20 19:24:43,154 **Evaluating.**
2020-09-20 19:28:25,282 NMI: 28.783
2020-09-20 19:31:31,509 R@1 : 51.343
2020-09-20 19:31:32,532 R@2 : 59.553
2020-09-20 19:31:33,568 R@4 : 67.893
2020-09-20 19:31:34,677 R@8 : 75.577
2020-09-20 19:35:04,728 Epoch: 8, loss: 1.519, time (seconds): 209.89.
2020-09-20 19:35:04,729 **Evaluating.**
2020-09-20 19:38:48,774 NMI: 28.768
2020-09-20 19:41:55,480 R@1 : 50.209
2020-09-20 19:41:56,546 R@2 : 58.559
2020-09-20 19:41:57,566 R@4 : 66.820
2020-09-20 19:41:58,579 R@8 : 74.822
2020-09-20 19:45:31,644 Epoch: 9, loss: 1.484, time (seconds): 212.96.
2020-09-20 19:45:31,645 **Evaluating.**
2020-09-20 19:49:15,625 NMI: 28.660
2020-09-20 19:52:22,032 R@1 : 50.762
2020-09-20 19:52:23,077 R@2 : 59.153
2020-09-20 19:52:24,074 R@4 : 67.473
2020-09-20 19:52:25,084 R@8 : 75.274
2020-09-20 19:52:25,215 Total training time (minutes): 121.45.
2020-09-20 19:52:33,487 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 10, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200920-175053', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 1, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-20 19:52:33,488 Training for 10 epochs
2020-09-20 19:52:33,536 **Evaluating initial model.**
2020-09-20 19:55:39,651 NMI: 24.322
2020-09-20 19:59:15,655 R@1 : 45.121
2020-09-20 19:59:16,857 R@2 : 53.184
2020-09-20 19:59:18,046 R@4 : 61.886
2020-09-20 19:59:19,230 R@8 : 70.698
2020-09-20 20:02:28,114 Epoch: 0, loss: 2.267, time (seconds): 188.88.
2020-09-20 20:02:28,148 **Evaluating.**
2020-09-20 20:05:41,005 NMI: 31.658
