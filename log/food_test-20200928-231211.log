2020-09-28 23:12:14,231 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-231211', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 10, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 23:12:14,232 Training for 20 epochs
2020-09-28 23:12:14,234 **Evaluating initial model.**
2020-09-28 23:12:50,912 NMI: 25.916
2020-09-28 23:13:02,970 R@1 : 32.493
2020-09-28 23:13:03,233 R@2 : 41.514
2020-09-28 23:13:03,486 R@4 : 51.994
2020-09-28 23:13:03,744 R@8 : 62.736
2020-09-28 23:13:38,639 Epoch: 0, loss: 4.146, time (seconds): 34.89.
2020-09-28 23:13:38,639 **Evaluating.**
2020-09-28 23:14:15,091 NMI: 23.319
2020-09-28 23:14:26,159 R@1 : 30.321
2020-09-28 23:14:26,412 R@2 : 40.219
2020-09-28 23:14:26,669 R@4 : 51.299
2020-09-28 23:14:26,924 R@8 : 63.214
2020-09-28 23:15:01,454 Epoch: 1, loss: 3.313, time (seconds): 34.53.
2020-09-28 23:15:01,455 **Evaluating.**
2020-09-28 23:15:38,559 NMI: 26.031
2020-09-28 23:15:49,460 R@1 : 32.033
2020-09-28 23:15:49,717 R@2 : 41.905
2020-09-28 23:15:49,977 R@4 : 53.550
2020-09-28 23:15:50,234 R@8 : 64.813
2020-09-28 23:16:24,970 Epoch: 2, loss: 2.861, time (seconds): 34.73.
2020-09-28 23:16:24,971 **Evaluating.**
2020-09-28 23:17:01,647 NMI: 29.583
2020-09-28 23:17:12,782 R@1 : 35.648
2020-09-28 23:17:13,039 R@2 : 46.250
2020-09-28 23:17:13,295 R@4 : 57.209
2020-09-28 23:17:13,549 R@8 : 67.985
2020-09-28 23:17:48,089 Epoch: 3, loss: 2.630, time (seconds): 34.54.
2020-09-28 23:17:48,090 **Evaluating.**
2020-09-28 23:18:24,078 NMI: 31.541
2020-09-28 23:18:35,347 R@1 : 37.864
2020-09-28 23:18:35,601 R@2 : 48.362
2020-09-28 23:18:35,865 R@4 : 59.207
2020-09-28 23:18:36,119 R@8 : 69.992
2020-09-28 23:19:10,740 Epoch: 4, loss: 2.448, time (seconds): 34.62.
2020-09-28 23:19:10,740 **Evaluating.**
2020-09-28 23:19:47,235 NMI: 31.639
2020-09-28 23:19:58,646 R@1 : 38.785
2020-09-28 23:19:58,900 R@2 : 49.431
2020-09-28 23:19:59,152 R@4 : 60.224
2020-09-28 23:19:59,408 R@8 : 70.427
2020-09-28 23:20:34,111 Epoch: 5, loss: 2.275, time (seconds): 34.70.
2020-09-28 23:20:34,112 **Evaluating.**
2020-09-28 23:21:09,524 NMI: 31.917
2020-09-28 23:21:21,014 R@1 : 38.872
2020-09-28 23:21:21,268 R@2 : 49.787
2020-09-28 23:21:21,518 R@4 : 60.537
2020-09-28 23:21:21,771 R@8 : 70.757
2020-09-28 23:21:56,227 Epoch: 6, loss: 2.253, time (seconds): 34.45.
2020-09-28 23:21:56,228 **Evaluating.**
2020-09-28 23:22:30,906 NMI: 32.298
2020-09-28 23:22:42,239 R@1 : 39.750
2020-09-28 23:22:42,491 R@2 : 49.978
2020-09-28 23:22:42,740 R@4 : 60.980
2020-09-28 23:22:42,992 R@8 : 70.948
2020-09-28 23:23:17,423 Epoch: 7, loss: 2.192, time (seconds): 34.43.
2020-09-28 23:23:17,424 **Evaluating.**
2020-09-28 23:23:51,960 NMI: 32.476
2020-09-28 23:24:03,348 R@1 : 39.437
2020-09-28 23:24:03,597 R@2 : 50.004
2020-09-28 23:24:03,866 R@4 : 61.067
2020-09-28 23:24:04,120 R@8 : 71.157
2020-09-28 23:24:38,582 Epoch: 8, loss: 2.071, time (seconds): 34.46.
2020-09-28 23:24:38,583 **Evaluating.**
2020-09-28 23:25:13,609 NMI: 32.320
2020-09-28 23:25:25,109 R@1 : 39.724
2020-09-28 23:25:25,371 R@2 : 50.335
2020-09-28 23:25:25,622 R@4 : 61.032
2020-09-28 23:25:25,876 R@8 : 70.835
2020-09-28 23:26:00,342 Epoch: 9, loss: 2.050, time (seconds): 34.46.
2020-09-28 23:26:00,343 **Evaluating.**
2020-09-28 23:26:35,310 NMI: 31.817
2020-09-28 23:26:46,758 R@1 : 39.046
2020-09-28 23:26:47,015 R@2 : 49.387
2020-09-28 23:26:47,266 R@4 : 60.389
2020-09-28 23:26:47,520 R@8 : 71.113
2020-09-28 23:27:22,325 Epoch: 10, loss: 1.977, time (seconds): 34.80.
2020-09-28 23:27:22,326 **Evaluating.**
2020-09-28 23:27:56,735 NMI: 31.122
2020-09-28 23:28:08,236 R@1 : 38.985
2020-09-28 23:28:08,489 R@2 : 49.466
2020-09-28 23:28:08,744 R@4 : 60.068
2020-09-28 23:28:09,000 R@8 : 70.314
2020-09-28 23:28:43,727 Epoch: 11, loss: 1.937, time (seconds): 34.72.
2020-09-28 23:28:43,728 **Evaluating.**
2020-09-28 23:29:18,161 NMI: 32.003
2020-09-28 23:29:29,681 R@1 : 39.472
2020-09-28 23:29:29,937 R@2 : 50.022
2020-09-28 23:29:30,188 R@4 : 60.789
2020-09-28 23:29:30,436 R@8 : 71.009
2020-09-28 23:30:04,852 Epoch: 12, loss: 1.857, time (seconds): 34.41.
2020-09-28 23:30:04,853 **Evaluating.**
2020-09-28 23:30:39,408 NMI: 31.196
2020-09-28 23:30:51,116 R@1 : 38.516
2020-09-28 23:30:51,370 R@2 : 49.353
2020-09-28 23:30:51,624 R@4 : 60.103
2020-09-28 23:30:51,882 R@8 : 70.488
2020-09-28 23:31:26,698 Epoch: 13, loss: 1.755, time (seconds): 34.81.
2020-09-28 23:31:26,699 **Evaluating.**
2020-09-28 23:32:01,649 NMI: 31.310
2020-09-28 23:32:13,186 R@1 : 38.933
2020-09-28 23:32:13,441 R@2 : 49.387
2020-09-28 23:32:13,698 R@4 : 60.181
2020-09-28 23:32:13,950 R@8 : 70.383
2020-09-28 23:32:48,658 Epoch: 14, loss: 1.760, time (seconds): 34.70.
2020-09-28 23:32:48,658 **Evaluating.**
2020-09-28 23:33:23,408 NMI: 30.481
2020-09-28 23:33:34,903 R@1 : 38.907
2020-09-28 23:33:35,153 R@2 : 49.457
2020-09-28 23:33:35,405 R@4 : 60.198
2020-09-28 23:33:35,659 R@8 : 70.209
2020-09-28 23:34:10,368 Epoch: 15, loss: 1.681, time (seconds): 34.71.
2020-09-28 23:34:10,369 **Evaluating.**
2020-09-28 23:34:44,976 NMI: 30.547
2020-09-28 23:34:56,531 R@1 : 38.316
2020-09-28 23:34:56,783 R@2 : 49.344
2020-09-28 23:34:57,032 R@4 : 60.146
2020-09-28 23:34:57,286 R@8 : 69.940
2020-09-28 23:35:31,466 Epoch: 16, loss: 1.694, time (seconds): 34.18.
2020-09-28 23:35:31,467 **Evaluating.**
2020-09-28 23:36:05,915 NMI: 30.300
2020-09-28 23:36:17,488 R@1 : 37.942
2020-09-28 23:36:17,740 R@2 : 48.484
2020-09-28 23:36:17,989 R@4 : 58.782
2020-09-28 23:36:18,242 R@8 : 69.288
2020-09-28 23:36:52,635 Epoch: 17, loss: 1.638, time (seconds): 34.39.
2020-09-28 23:36:52,636 **Evaluating.**
2020-09-28 23:37:27,280 NMI: 29.942
2020-09-28 23:37:38,836 R@1 : 38.333
2020-09-28 23:37:39,095 R@2 : 48.614
2020-09-28 23:37:39,354 R@4 : 59.268
2020-09-28 23:37:39,607 R@8 : 69.123
2020-09-28 23:38:14,080 Epoch: 18, loss: 1.626, time (seconds): 34.47.
2020-09-28 23:38:14,081 **Evaluating.**
2020-09-28 23:38:48,394 NMI: 30.552
2020-09-28 23:38:59,932 R@1 : 38.220
2020-09-28 23:39:00,182 R@2 : 48.675
2020-09-28 23:39:00,436 R@4 : 58.842
2020-09-28 23:39:00,686 R@8 : 69.097
2020-09-28 23:39:35,123 Epoch: 19, loss: 1.580, time (seconds): 34.44.
2020-09-28 23:39:35,125 **Evaluating.**
2020-09-28 23:40:09,457 NMI: 30.158
2020-09-28 23:40:21,015 R@1 : 38.620
2020-09-28 23:40:21,265 R@2 : 48.449
2020-09-28 23:40:21,515 R@4 : 59.016
2020-09-28 23:40:21,766 R@8 : 69.210
2020-09-28 23:40:21,768 Total training time (minutes): 28.13.
