2020-09-20 20:29:26,771 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 10, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200920-202921', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 1, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-20 20:29:26,771 Training for 10 epochs
2020-09-20 20:29:26,774 **Evaluating initial model.**
2020-09-20 20:30:07,450 NMI: 25.916
2020-09-20 20:30:18,863 R@1 : 32.493
2020-09-20 20:30:19,111 R@2 : 41.514
2020-09-20 20:30:19,361 R@4 : 51.994
2020-09-20 20:30:19,610 R@8 : 62.736
2020-09-20 20:31:07,762 Epoch: 0, loss: 3.464, time (seconds): 48.15.
2020-09-20 20:31:07,763 **Evaluating.**
2020-09-20 20:31:41,110 NMI: 23.528
2020-09-20 20:31:51,667 R@1 : 30.277
2020-09-20 20:31:51,914 R@2 : 40.280
2020-09-20 20:31:52,153 R@4 : 51.195
2020-09-20 20:31:52,395 R@8 : 63.170
2020-09-20 20:32:25,778 Epoch: 1, loss: 2.689, time (seconds): 33.38.
2020-09-20 20:32:25,779 **Evaluating.**
2020-09-20 20:32:58,961 NMI: 28.252
2020-09-20 20:33:09,450 R@1 : 34.761
2020-09-20 20:33:09,691 R@2 : 45.346
2020-09-20 20:33:09,936 R@4 : 56.192
2020-09-20 20:33:10,186 R@8 : 67.107
2020-09-20 20:33:44,043 Epoch: 2, loss: 2.326, time (seconds): 33.85.
2020-09-20 20:33:44,044 **Evaluating.**
2020-09-20 20:34:17,238 NMI: 30.807
2020-09-20 20:34:28,111 R@1 : 38.177
2020-09-20 20:34:28,382 R@2 : 48.597
2020-09-20 20:34:28,651 R@4 : 59.364
2020-09-20 20:34:28,923 R@8 : 69.497
2020-09-20 20:35:02,740 Epoch: 3, loss: 2.180, time (seconds): 33.81.
2020-09-20 20:35:02,741 **Evaluating.**
2020-09-20 20:35:35,542 NMI: 32.481
2020-09-20 20:35:46,404 R@1 : 39.315
2020-09-20 20:35:46,645 R@2 : 50.178
2020-09-20 20:35:46,887 R@4 : 60.876
2020-09-20 20:35:47,128 R@8 : 70.757
2020-09-20 20:36:21,450 Epoch: 4, loss: 2.061, time (seconds): 34.32.
2020-09-20 20:36:21,451 **Evaluating.**
2020-09-20 20:36:54,823 NMI: 33.081
2020-09-20 20:37:05,810 R@1 : 40.723
2020-09-20 20:37:06,060 R@2 : 50.960
2020-09-20 20:37:06,310 R@4 : 61.423
2020-09-20 20:37:06,562 R@8 : 71.548
2020-09-20 20:37:40,461 Epoch: 5, loss: 1.909, time (seconds): 33.90.
2020-09-20 20:37:40,461 **Evaluating.**
2020-09-20 20:38:13,556 NMI: 32.945
2020-09-20 20:38:24,581 R@1 : 40.202
2020-09-20 20:38:24,829 R@2 : 50.986
2020-09-20 20:38:25,074 R@4 : 61.745
2020-09-20 20:38:25,317 R@8 : 71.539
2020-09-20 20:38:59,071 Epoch: 6, loss: 1.845, time (seconds): 33.75.
2020-09-20 20:38:59,071 **Evaluating.**
2020-09-20 20:39:32,346 NMI: 32.721
2020-09-20 20:39:43,398 R@1 : 40.323
2020-09-20 20:39:43,670 R@2 : 51.160
2020-09-20 20:39:43,940 R@4 : 61.919
2020-09-20 20:39:44,212 R@8 : 71.539
2020-09-20 20:40:18,268 Epoch: 7, loss: 1.759, time (seconds): 34.05.
2020-09-20 20:40:18,269 **Evaluating.**
2020-09-20 20:40:51,562 NMI: 33.204
2020-09-20 20:41:02,665 R@1 : 41.131
2020-09-20 20:41:02,908 R@2 : 51.829
2020-09-20 20:41:03,160 R@4 : 62.301
2020-09-20 20:41:03,407 R@8 : 72.043
2020-09-20 20:41:37,264 Epoch: 8, loss: 1.691, time (seconds): 33.85.
2020-09-20 20:41:37,265 **Evaluating.**
2020-09-20 20:42:09,991 NMI: 32.183
2020-09-20 20:42:20,956 R@1 : 40.419
2020-09-20 20:42:21,198 R@2 : 51.056
2020-09-20 20:42:21,440 R@4 : 61.606
2020-09-20 20:42:21,681 R@8 : 71.435
2020-09-20 20:42:55,151 Epoch: 9, loss: 1.603, time (seconds): 33.47.
2020-09-20 20:42:55,152 **Evaluating.**
2020-09-20 20:43:27,791 NMI: 33.254
2020-09-20 20:43:38,856 R@1 : 40.845
2020-09-20 20:43:39,106 R@2 : 51.543
2020-09-20 20:43:39,352 R@4 : 62.345
2020-09-20 20:43:39,602 R@8 : 71.704
2020-09-20 20:43:39,604 Total training time (minutes): 14.21.
