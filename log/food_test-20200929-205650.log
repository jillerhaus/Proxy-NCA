2020-09-29 20:56:53,073 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200929-205650', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 1, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 1, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-29 20:56:53,074 Training for 20 epochs
2020-09-29 20:56:53,076 **Evaluating initial model.**
2020-09-29 20:57:50,179 NMI: 26.584
2020-09-29 20:58:02,547 R@1 : 32.728
2020-09-29 20:58:02,803 R@2 : 42.287
2020-09-29 20:58:03,051 R@4 : 53.220
2020-09-29 20:58:03,302 R@8 : 64.404
2020-09-29 20:58:38,134 Epoch: 0, loss: 3.320, time (seconds): 34.83.
2020-09-29 20:58:38,135 **Evaluating.**
2020-09-29 20:59:14,075 NMI: 30.861
2020-09-29 20:59:25,845 R@1 : 38.038
2020-09-29 20:59:26,107 R@2 : 47.736
2020-09-29 20:59:26,357 R@4 : 57.956
2020-09-29 20:59:26,601 R@8 : 67.794
2020-09-29 21:00:00,387 Epoch: 1, loss: 3.142, time (seconds): 33.78.
2020-09-29 21:00:00,387 **Evaluating.**
2020-09-29 21:00:35,526 NMI: 30.799
2020-09-29 21:00:47,047 R@1 : 38.107
2020-09-29 21:00:47,295 R@2 : 48.119
2020-09-29 21:00:47,543 R@4 : 58.295
2020-09-29 21:00:47,789 R@8 : 68.028
2020-09-29 21:01:21,316 Epoch: 2, loss: 3.039, time (seconds): 33.53.
2020-09-29 21:01:21,317 **Evaluating.**
2020-09-29 21:01:56,422 NMI: 30.988
2020-09-29 21:02:07,775 R@1 : 37.960
2020-09-29 21:02:08,020 R@2 : 48.136
2020-09-29 21:02:08,265 R@4 : 57.834
2020-09-29 21:02:08,509 R@8 : 67.298
2020-09-29 21:02:42,355 Epoch: 3, loss: 2.993, time (seconds): 33.84.
2020-09-29 21:02:42,356 **Evaluating.**
2020-09-29 21:03:17,643 NMI: 30.512
2020-09-29 21:03:29,256 R@1 : 37.177
2020-09-29 21:03:29,511 R@2 : 47.258
2020-09-29 21:03:29,763 R@4 : 57.591
2020-09-29 21:03:30,031 R@8 : 66.855
2020-09-29 21:04:04,190 Epoch: 4, loss: 2.967, time (seconds): 34.16.
2020-09-29 21:04:04,191 **Evaluating.**
2020-09-29 21:04:39,863 NMI: 30.104
2020-09-29 21:04:51,141 R@1 : 36.421
2020-09-29 21:04:51,389 R@2 : 46.215
2020-09-29 21:04:51,637 R@4 : 56.809
2020-09-29 21:04:51,884 R@8 : 66.820
2020-09-29 21:05:25,419 Epoch: 5, loss: 2.937, time (seconds): 33.53.
2020-09-29 21:05:25,420 **Evaluating.**
2020-09-29 21:06:00,963 NMI: 29.900
2020-09-29 21:06:12,227 R@1 : 35.352
2020-09-29 21:06:12,471 R@2 : 45.790
2020-09-29 21:06:12,723 R@4 : 56.357
2020-09-29 21:06:12,972 R@8 : 66.464
2020-09-29 21:06:46,384 Epoch: 6, loss: 2.892, time (seconds): 33.41.
2020-09-29 21:06:46,385 **Evaluating.**
2020-09-29 21:07:20,912 NMI: 30.184
2020-09-29 21:07:32,123 R@1 : 35.352
2020-09-29 21:07:32,366 R@2 : 45.798
2020-09-29 21:07:32,612 R@4 : 56.496
2020-09-29 21:07:32,860 R@8 : 66.525
2020-09-29 21:08:06,324 Epoch: 7, loss: 2.887, time (seconds): 33.46.
2020-09-29 21:08:06,325 **Evaluating.**
2020-09-29 21:08:40,871 NMI: 28.976
2020-09-29 21:08:52,159 R@1 : 33.910
2020-09-29 21:08:52,429 R@2 : 44.347
2020-09-29 21:08:52,704 R@4 : 55.271
2020-09-29 21:08:52,956 R@8 : 65.604
2020-09-29 21:09:26,613 Epoch: 8, loss: 2.858, time (seconds): 33.66.
2020-09-29 21:09:26,614 **Evaluating.**
2020-09-29 21:10:01,711 NMI: 29.105
2020-09-29 21:10:12,981 R@1 : 34.257
2020-09-29 21:10:13,228 R@2 : 44.295
2020-09-29 21:10:13,473 R@4 : 54.628
2020-09-29 21:10:13,719 R@8 : 65.143
2020-09-29 21:10:47,718 Epoch: 9, loss: 2.854, time (seconds): 34.00.
2020-09-29 21:10:47,719 **Evaluating.**
2020-09-29 21:11:22,006 NMI: 29.312
2020-09-29 21:11:33,259 R@1 : 34.005
2020-09-29 21:11:33,503 R@2 : 43.930
2020-09-29 21:11:33,746 R@4 : 54.749
2020-09-29 21:11:33,993 R@8 : 65.291
2020-09-29 21:12:07,765 Epoch: 10, loss: 2.846, time (seconds): 33.77.
2020-09-29 21:12:07,766 **Evaluating.**
2020-09-29 21:12:41,972 NMI: 28.915
2020-09-29 21:12:53,161 R@1 : 33.119
2020-09-29 21:12:53,407 R@2 : 43.139
2020-09-29 21:12:53,652 R@4 : 53.628
2020-09-29 21:12:53,898 R@8 : 64.178
2020-09-29 21:13:27,722 Epoch: 11, loss: 2.829, time (seconds): 33.82.
2020-09-29 21:13:27,722 **Evaluating.**
2020-09-29 21:14:02,528 NMI: 28.909
2020-09-29 21:14:13,701 R@1 : 32.545
2020-09-29 21:14:13,946 R@2 : 43.035
2020-09-29 21:14:14,189 R@4 : 54.019
2020-09-29 21:14:14,445 R@8 : 64.291
2020-09-29 21:14:48,163 Epoch: 12, loss: 2.809, time (seconds): 33.71.
2020-09-29 21:14:48,164 **Evaluating.**
2020-09-29 21:15:22,807 NMI: 28.232
2020-09-29 21:15:34,023 R@1 : 32.789
2020-09-29 21:15:34,268 R@2 : 43.069
2020-09-29 21:15:34,514 R@4 : 53.906
2020-09-29 21:15:34,760 R@8 : 64.083
2020-09-29 21:16:08,470 Epoch: 13, loss: 2.796, time (seconds): 33.71.
2020-09-29 21:16:08,470 **Evaluating.**
2020-09-29 21:16:42,728 NMI: 27.804
2020-09-29 21:16:53,926 R@1 : 32.033
2020-09-29 21:16:54,173 R@2 : 42.192
2020-09-29 21:16:54,418 R@4 : 53.046
2020-09-29 21:16:54,665 R@8 : 64.213
2020-09-29 21:17:28,482 Epoch: 14, loss: 2.783, time (seconds): 33.82.
2020-09-29 21:17:28,483 **Evaluating.**
2020-09-29 21:18:02,846 NMI: 27.465
2020-09-29 21:18:14,098 R@1 : 30.981
2020-09-29 21:18:14,371 R@2 : 41.410
2020-09-29 21:18:14,644 R@4 : 52.611
2020-09-29 21:18:14,914 R@8 : 63.083
2020-09-29 21:18:48,820 Epoch: 15, loss: 2.780, time (seconds): 33.90.
2020-09-29 21:18:48,820 **Evaluating.**
2020-09-29 21:19:22,837 NMI: 27.503
2020-09-29 21:19:33,661 R@1 : 31.103
2020-09-29 21:19:33,904 R@2 : 41.123
2020-09-29 21:19:34,146 R@4 : 52.516
2020-09-29 21:19:34,389 R@8 : 63.361
2020-09-29 21:20:07,260 Epoch: 16, loss: 2.766, time (seconds): 32.87.
2020-09-29 21:20:07,261 **Evaluating.**
2020-09-29 21:20:41,821 NMI: 27.064
2020-09-29 21:20:53,134 R@1 : 31.025
2020-09-29 21:20:53,381 R@2 : 41.244
2020-09-29 21:20:53,625 R@4 : 52.107
2020-09-29 21:20:53,870 R@8 : 62.814
2020-09-29 21:21:27,782 Epoch: 17, loss: 2.764, time (seconds): 33.91.
2020-09-29 21:21:27,783 **Evaluating.**
2020-09-29 21:22:02,629 NMI: 26.933
2020-09-29 21:22:13,991 R@1 : 30.816
2020-09-29 21:22:14,235 R@2 : 40.680
2020-09-29 21:22:14,481 R@4 : 51.847
2020-09-29 21:22:14,726 R@8 : 62.918
2020-09-29 21:22:48,596 Epoch: 18, loss: 2.761, time (seconds): 33.87.
2020-09-29 21:22:48,597 **Evaluating.**
2020-09-29 21:23:22,995 NMI: 27.442
2020-09-29 21:23:34,319 R@1 : 31.007
2020-09-29 21:23:34,569 R@2 : 41.331
2020-09-29 21:23:34,815 R@4 : 52.133
2020-09-29 21:23:35,075 R@8 : 62.275
2020-09-29 21:24:08,827 Epoch: 19, loss: 2.727, time (seconds): 33.75.
2020-09-29 21:24:08,827 **Evaluating.**
2020-09-29 21:24:42,793 NMI: 27.359
2020-09-29 21:24:54,025 R@1 : 31.016
2020-09-29 21:24:54,273 R@2 : 41.227
2020-09-29 21:24:54,517 R@4 : 51.994
2020-09-29 21:24:54,765 R@8 : 62.788
2020-09-29 21:24:54,767 Total training time (minutes): 28.03.
2020-09-29 21:24:55,503 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200929-205650', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 2, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 1, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-29 21:24:55,504 Training for 20 epochs
2020-09-29 21:24:55,505 **Evaluating initial model.**
2020-09-29 21:25:29,972 NMI: 26.153
2020-09-29 21:25:41,913 R@1 : 32.893
2020-09-29 21:25:42,160 R@2 : 42.270
2020-09-29 21:25:42,407 R@4 : 52.881
2020-09-29 21:25:42,653 R@8 : 63.944
2020-09-29 21:26:16,226 Epoch: 0, loss: 3.343, time (seconds): 33.57.
2020-09-29 21:26:16,227 **Evaluating.**
2020-09-29 21:26:50,237 NMI: 30.428
2020-09-29 21:27:01,662 R@1 : 37.247
2020-09-29 21:27:01,916 R@2 : 46.893
2020-09-29 21:27:02,163 R@4 : 57.452
2020-09-29 21:27:02,410 R@8 : 67.237
2020-09-29 21:27:36,263 Epoch: 1, loss: 3.140, time (seconds): 33.85.
2020-09-29 21:27:36,264 **Evaluating.**
2020-09-29 21:28:10,581 NMI: 30.614
2020-09-29 21:28:21,901 R@1 : 37.360
2020-09-29 21:28:22,146 R@2 : 47.423
2020-09-29 21:28:22,389 R@4 : 57.487
2020-09-29 21:28:22,634 R@8 : 67.524
2020-09-29 21:28:56,458 Epoch: 2, loss: 3.059, time (seconds): 33.82.
2020-09-29 21:28:56,459 **Evaluating.**
2020-09-29 21:29:31,144 NMI: 30.878
2020-09-29 21:29:42,350 R@1 : 37.560
2020-09-29 21:29:42,597 R@2 : 47.667
2020-09-29 21:29:42,841 R@4 : 58.112
2020-09-29 21:29:43,087 R@8 : 67.654
2020-09-29 21:30:17,031 Epoch: 3, loss: 3.014, time (seconds): 33.94.
2020-09-29 21:30:17,032 **Evaluating.**
2020-09-29 21:30:51,304 NMI: 30.469
2020-09-29 21:31:02,566 R@1 : 37.151
2020-09-29 21:31:02,812 R@2 : 47.293
2020-09-29 21:31:03,059 R@4 : 57.687
2020-09-29 21:31:03,305 R@8 : 67.246
2020-09-29 21:31:37,397 Epoch: 4, loss: 2.956, time (seconds): 34.09.
2020-09-29 21:31:37,397 **Evaluating.**
2020-09-29 21:32:13,161 NMI: 30.612
2020-09-29 21:32:24,178 R@1 : 36.526
2020-09-29 21:32:24,423 R@2 : 46.719
2020-09-29 21:32:24,669 R@4 : 57.017
2020-09-29 21:32:24,913 R@8 : 66.994
2020-09-29 21:32:58,480 Epoch: 5, loss: 2.943, time (seconds): 33.56.
2020-09-29 21:32:58,481 **Evaluating.**
2020-09-29 21:33:33,574 NMI: 30.381
2020-09-29 21:33:44,889 R@1 : 36.135
2020-09-29 21:33:45,134 R@2 : 46.537
2020-09-29 21:33:45,390 R@4 : 56.574
2020-09-29 21:33:45,644 R@8 : 66.360
2020-09-29 21:34:19,451 Epoch: 6, loss: 2.904, time (seconds): 33.81.
2020-09-29 21:34:19,452 **Evaluating.**
2020-09-29 21:34:54,025 NMI: 30.335
2020-09-29 21:35:05,284 R@1 : 35.865
2020-09-29 21:35:05,528 R@2 : 46.415
2020-09-29 21:35:05,778 R@4 : 56.487
2020-09-29 21:35:06,022 R@8 : 66.664
2020-09-29 21:35:39,967 Epoch: 7, loss: 2.897, time (seconds): 33.94.
2020-09-29 21:35:39,967 **Evaluating.**
2020-09-29 21:36:15,679 NMI: 29.440
2020-09-29 21:36:26,891 R@1 : 35.344
2020-09-29 21:36:27,144 R@2 : 45.842
2020-09-29 21:36:27,392 R@4 : 56.235
2020-09-29 21:36:27,642 R@8 : 66.221
2020-09-29 21:37:02,639 Epoch: 8, loss: 2.859, time (seconds): 34.99.
2020-09-29 21:37:02,640 **Evaluating.**
2020-09-29 21:37:40,082 NMI: 29.211
2020-09-29 21:37:51,463 R@1 : 34.605
2020-09-29 21:37:51,710 R@2 : 44.573
2020-09-29 21:37:51,954 R@4 : 55.114
2020-09-29 21:37:52,199 R@8 : 65.795
2020-09-29 21:38:26,697 Epoch: 9, loss: 2.858, time (seconds): 34.50.
2020-09-29 21:38:26,698 **Evaluating.**
2020-09-29 21:39:03,460 NMI: 29.241
2020-09-29 21:39:14,981 R@1 : 34.483
2020-09-29 21:39:15,240 R@2 : 44.764
2020-09-29 21:39:15,491 R@4 : 55.045
2020-09-29 21:39:15,757 R@8 : 65.647
2020-09-29 21:39:51,422 Epoch: 10, loss: 2.839, time (seconds): 35.66.
2020-09-29 21:39:51,423 **Evaluating.**
2020-09-29 21:40:28,823 NMI: 28.701
2020-09-29 21:40:40,172 R@1 : 33.719
2020-09-29 21:40:40,422 R@2 : 43.912
2020-09-29 21:40:40,673 R@4 : 55.236
2020-09-29 21:40:40,919 R@8 : 65.864
