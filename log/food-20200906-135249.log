2020-09-06 13:52:53,701 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food-20200906-135249', 'results_filename': 'food-results.csv', '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-06 13:52:53,702 Training for 20 epochs
2020-09-06 13:52:53,704 **Evaluating initial model.**
2020-09-06 13:55:39,673 NMI: 23.712
2020-09-06 13:57:13,132 R@1 : 41.710
2020-09-06 13:57:13,872 R@2 : 49.972
2020-09-06 13:57:14,624 R@4 : 59.013
2020-09-06 13:57:15,361 R@8 : 68.489
2020-09-06 13:59:46,329 Epoch: 0, loss: 2.377, time (seconds): 150.97.
2020-09-06 13:59:46,330 **Evaluating.**
2020-09-06 14:02:30,808 NMI: 28.799
2020-09-06 14:04:02,037 R@1 : 46.480
2020-09-06 14:04:02,785 R@2 : 55.584
2020-09-06 14:04:03,535 R@4 : 65.249
2020-09-06 14:04:04,311 R@8 : 74.066
2020-09-06 14:06:37,762 Epoch: 1, loss: 2.176, time (seconds): 153.44.
2020-09-06 14:06:37,763 **Evaluating.**
2020-09-06 14:08:54,774 NMI: 30.060
2020-09-06 14:10:22,044 R@1 : 48.074
2020-09-06 14:10:22,803 R@2 : 57.045
2020-09-06 14:10:23,556 R@4 : 66.053
2020-09-06 14:10:24,304 R@8 : 74.519
2020-09-06 14:12:47,534 Epoch: 2, loss: 2.108, time (seconds): 143.23.
2020-09-06 14:12:47,535 **Evaluating.**
2020-09-06 14:15:25,777 NMI: 29.469
2020-09-06 14:16:54,666 R@1 : 47.423
2020-09-06 14:16:55,418 R@2 : 56.574
2020-09-06 14:16:56,164 R@4 : 65.693
2020-09-06 14:16:56,902 R@8 : 74.481
2020-09-06 14:19:20,080 Epoch: 3, loss: 1.827, time (seconds): 143.18.
2020-09-06 14:19:20,081 **Evaluating.**
2020-09-06 14:21:29,786 NMI: 28.742
2020-09-06 14:22:58,589 R@1 : 47.438
2020-09-06 14:22:59,355 R@2 : 56.388
2020-09-06 14:23:00,143 R@4 : 65.786
2020-09-06 14:23:00,898 R@8 : 74.226
2020-09-06 14:25:28,417 Epoch: 4, loss: 1.790, time (seconds): 147.52.
2020-09-06 14:25:28,417 **Evaluating.**
2020-09-06 14:28:05,328 NMI: 30.516
2020-09-06 14:29:36,567 R@1 : 48.788
2020-09-06 14:29:37,318 R@2 : 57.907
2020-09-06 14:29:38,058 R@4 : 66.791
2020-09-06 14:29:38,799 R@8 : 74.957
2020-09-06 14:32:03,297 Epoch: 5, loss: 1.739, time (seconds): 144.49.
2020-09-06 14:32:03,298 **Evaluating.**
2020-09-06 14:34:11,773 NMI: 30.821
2020-09-06 14:35:40,460 R@1 : 49.096
2020-09-06 14:35:41,226 R@2 : 58.014
2020-09-06 14:35:41,972 R@4 : 66.875
2020-09-06 14:35:42,752 R@8 : 75.201
2020-09-06 14:38:08,680 Epoch: 6, loss: 1.793, time (seconds): 145.92.
2020-09-06 14:38:08,681 **Evaluating.**
2020-09-06 14:40:55,042 NMI: 29.910
2020-09-06 14:42:27,534 R@1 : 49.014
2020-09-06 14:42:28,327 R@2 : 57.916
2020-09-06 14:42:29,126 R@4 : 66.982
2020-09-06 14:42:29,938 R@8 : 74.995
2020-09-06 14:45:03,600 Epoch: 7, loss: 1.726, time (seconds): 153.66.
2020-09-06 14:45:03,601 **Evaluating.**
2020-09-06 14:47:15,777 NMI: 28.832
2020-09-06 14:48:46,214 R@1 : 47.865
2020-09-06 14:48:47,121 R@2 : 56.795
2020-09-06 14:48:48,014 R@4 : 65.774
2020-09-06 14:48:48,920 R@8 : 73.927
2020-09-06 14:51:15,934 Epoch: 8, loss: 1.622, time (seconds): 147.01.
2020-09-06 14:51:15,934 **Evaluating.**
2020-09-06 14:53:58,902 NMI: 29.626
2020-09-06 14:55:28,103 R@1 : 48.257
2020-09-06 14:55:28,853 R@2 : 57.178
2020-09-06 14:55:29,595 R@4 : 66.082
2020-09-06 14:55:30,332 R@8 : 74.739
2020-09-06 14:57:54,371 Epoch: 9, loss: 1.545, time (seconds): 144.04.
2020-09-06 14:57:54,372 **Evaluating.**
2020-09-06 15:00:01,646 NMI: 29.759
2020-09-06 15:01:30,060 R@1 : 48.411
2020-09-06 15:01:30,846 R@2 : 57.268
2020-09-06 15:01:31,609 R@4 : 66.375
2020-09-06 15:01:32,370 R@8 : 74.403
2020-09-06 15:04:08,270 Epoch: 10, loss: 1.601, time (seconds): 155.90.
2020-09-06 15:04:08,270 **Evaluating.**
2020-09-06 15:06:49,917 NMI: 28.961
2020-09-06 15:08:24,541 R@1 : 47.589
2020-09-06 15:08:25,286 R@2 : 56.400
2020-09-06 15:08:26,032 R@4 : 65.464
2020-09-06 15:08:26,795 R@8 : 73.915
2020-09-06 15:10:54,855 Epoch: 11, loss: 1.465, time (seconds): 148.06.
2020-09-06 15:10:54,856 **Evaluating.**
2020-09-06 15:13:10,168 NMI: 28.178
2020-09-06 15:14:40,071 R@1 : 47.969
2020-09-06 15:14:40,815 R@2 : 56.711
2020-09-06 15:14:41,552 R@4 : 65.446
2020-09-06 15:14:42,292 R@8 : 73.973
2020-09-06 15:17:12,643 Epoch: 12, loss: 1.495, time (seconds): 150.35.
2020-09-06 15:17:12,644 **Evaluating.**
2020-09-06 15:19:50,199 NMI: 27.983
2020-09-06 15:21:20,265 R@1 : 46.788
2020-09-06 15:21:21,019 R@2 : 55.503
2020-09-06 15:21:21,766 R@4 : 64.303
2020-09-06 15:21:22,517 R@8 : 73.006
2020-09-06 15:23:53,004 Epoch: 13, loss: 1.321, time (seconds): 150.48.
2020-09-06 15:23:53,005 **Evaluating.**
2020-09-06 15:25:58,136 NMI: 28.093
2020-09-06 15:27:30,498 R@1 : 47.313
2020-09-06 15:27:31,250 R@2 : 56.208
2020-09-06 15:27:32,003 R@4 : 64.877
2020-09-06 15:27:32,756 R@8 : 73.090
2020-09-06 15:30:07,075 Epoch: 14, loss: 1.358, time (seconds): 154.32.
2020-09-06 15:30:07,076 **Evaluating.**
2020-09-06 15:32:44,108 NMI: 27.847
2020-09-06 15:34:13,928 R@1 : 46.738
2020-09-06 15:34:14,682 R@2 : 55.364
2020-09-06 15:34:15,415 R@4 : 64.154
2020-09-06 15:34:16,149 R@8 : 72.565
2020-09-06 15:36:51,063 Epoch: 15, loss: 1.345, time (seconds): 154.91.
2020-09-06 15:36:51,063 **Evaluating.**
2020-09-06 15:39:03,337 NMI: 27.213
2020-09-06 15:40:41,542 R@1 : 46.230
2020-09-06 15:40:42,416 R@2 : 55.024
2020-09-06 15:40:43,244 R@4 : 64.137
2020-09-06 15:40:44,116 R@8 : 72.417
2020-09-06 15:43:13,384 Epoch: 16, loss: 1.282, time (seconds): 149.26.
2020-09-06 15:43:13,385 **Evaluating.**
2020-09-06 15:45:47,817 NMI: 27.599
2020-09-06 15:47:24,452 R@1 : 46.288
2020-09-06 15:47:25,417 R@2 : 55.120
2020-09-06 15:47:26,390 R@4 : 63.855
2020-09-06 15:47:27,306 R@8 : 72.266
2020-09-06 15:49:59,979 Epoch: 17, loss: 1.272, time (seconds): 152.67.
2020-09-06 15:49:59,980 **Evaluating.**
2020-09-06 15:52:02,714 NMI: 27.643
2020-09-06 15:53:39,113 R@1 : 46.689
2020-09-06 15:53:39,974 R@2 : 55.285
2020-09-06 15:53:40,775 R@4 : 63.940
2020-09-06 15:53:41,593 R@8 : 72.249
2020-09-06 15:56:07,257 Epoch: 18, loss: 1.296, time (seconds): 145.66.
2020-09-06 15:56:07,258 **Evaluating.**
2020-09-06 15:58:38,560 NMI: 26.592
2020-09-06 16:00:07,057 R@1 : 45.682
2020-09-06 16:00:07,814 R@2 : 54.516
2020-09-06 16:00:08,569 R@4 : 63.179
2020-09-06 16:00:09,308 R@8 : 71.537
2020-09-06 16:02:33,794 Epoch: 19, loss: 1.194, time (seconds): 144.48.
2020-09-06 16:02:33,794 **Evaluating.**
2020-09-06 16:04:41,198 NMI: 27.093
2020-09-06 16:06:16,822 R@1 : 45.908
2020-09-06 16:06:17,642 R@2 : 54.507
2020-09-06 16:06:18,447 R@4 : 63.223
2020-09-06 16:06:19,249 R@8 : 71.772
2020-09-06 16:06:19,253 Total training time (minutes): 133.43.
