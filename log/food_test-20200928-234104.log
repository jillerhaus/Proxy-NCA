2020-09-28 23:41:06,504 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-234104', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 10, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 23:41:06,505 Training for 20 epochs
2020-09-28 23:41:06,507 **Evaluating initial model.**
2020-09-28 23:41:41,982 NMI: 25.916
2020-09-28 23:41:54,067 R@1 : 32.493
2020-09-28 23:41:54,324 R@2 : 41.514
2020-09-28 23:41:54,572 R@4 : 51.994
2020-09-28 23:41:54,831 R@8 : 62.736
2020-09-28 23:42:29,974 Epoch: 0, loss: 4.116, time (seconds): 35.14.
2020-09-28 23:42:29,975 **Evaluating.**
2020-09-28 23:43:06,169 NMI: 23.410
2020-09-28 23:43:17,484 R@1 : 30.173
2020-09-28 23:43:17,741 R@2 : 40.149
2020-09-28 23:43:17,996 R@4 : 51.482
2020-09-28 23:43:18,259 R@8 : 63.483
2020-09-28 23:43:52,915 Epoch: 1, loss: 3.220, time (seconds): 34.65.
2020-09-28 23:43:52,915 **Evaluating.**
2020-09-28 23:44:29,321 NMI: 26.996
2020-09-28 23:44:40,228 R@1 : 32.554
2020-09-28 23:44:40,481 R@2 : 42.652
2020-09-28 23:44:40,732 R@4 : 54.002
2020-09-28 23:44:40,980 R@8 : 64.787
2020-09-28 23:45:15,486 Epoch: 2, loss: 2.783, time (seconds): 34.50.
2020-09-28 23:45:15,486 **Evaluating.**
2020-09-28 23:45:51,253 NMI: 30.261
2020-09-28 23:46:02,400 R@1 : 36.708
2020-09-28 23:46:02,657 R@2 : 47.667
2020-09-28 23:46:02,914 R@4 : 58.312
2020-09-28 23:46:03,166 R@8 : 68.506
2020-09-28 23:46:37,744 Epoch: 3, loss: 2.565, time (seconds): 34.58.
2020-09-28 23:46:37,745 **Evaluating.**
2020-09-28 23:47:13,369 NMI: 31.719
2020-09-28 23:47:24,803 R@1 : 38.490
2020-09-28 23:47:25,059 R@2 : 49.448
2020-09-28 23:47:25,311 R@4 : 60.328
2020-09-28 23:47:25,564 R@8 : 70.409
2020-09-28 23:48:04,101 Epoch: 4, loss: 2.391, time (seconds): 38.54.
2020-09-28 23:48:04,102 **Evaluating.**
2020-09-28 23:48:57,399 NMI: 32.084
2020-09-28 23:49:08,803 R@1 : 39.506
2020-09-28 23:49:09,052 R@2 : 50.187
2020-09-28 23:49:09,314 R@4 : 61.085
2020-09-28 23:49:09,569 R@8 : 71.209
2020-09-28 23:49:53,388 Epoch: 5, loss: 2.229, time (seconds): 43.82.
2020-09-28 23:49:53,389 **Evaluating.**
2020-09-28 23:50:29,119 NMI: 33.056
2020-09-28 23:50:40,652 R@1 : 39.724
2020-09-28 23:50:40,906 R@2 : 50.230
2020-09-28 23:50:41,164 R@4 : 60.850
2020-09-28 23:50:41,423 R@8 : 70.957
2020-09-28 23:51:15,806 Epoch: 6, loss: 2.199, time (seconds): 34.38.
2020-09-28 23:51:15,806 **Evaluating.**
2020-09-28 23:51:51,584 NMI: 32.484
2020-09-28 23:52:03,118 R@1 : 40.462
2020-09-28 23:52:03,366 R@2 : 51.021
2020-09-28 23:52:03,618 R@4 : 60.841
2020-09-28 23:52:03,868 R@8 : 71.261
2020-09-28 23:52:38,224 Epoch: 7, loss: 2.145, time (seconds): 34.35.
2020-09-28 23:52:38,224 **Evaluating.**
2020-09-28 23:53:13,996 NMI: 32.534
2020-09-28 23:53:25,594 R@1 : 39.863
2020-09-28 23:53:25,847 R@2 : 50.873
2020-09-28 23:53:26,100 R@4 : 61.528
2020-09-28 23:53:26,353 R@8 : 71.400
2020-09-28 23:54:00,925 Epoch: 8, loss: 2.023, time (seconds): 34.57.
2020-09-28 23:54:00,926 **Evaluating.**
2020-09-28 23:54:36,520 NMI: 32.054
2020-09-28 23:54:48,152 R@1 : 39.932
2020-09-28 23:54:48,406 R@2 : 50.682
2020-09-28 23:54:48,659 R@4 : 61.206
2020-09-28 23:54:48,914 R@8 : 70.922
2020-09-28 23:55:23,540 Epoch: 9, loss: 1.996, time (seconds): 34.62.
2020-09-28 23:55:23,541 **Evaluating.**
2020-09-28 23:55:58,767 NMI: 32.001
2020-09-28 23:56:10,416 R@1 : 39.419
2020-09-28 23:56:10,673 R@2 : 50.178
2020-09-28 23:56:10,922 R@4 : 60.780
2020-09-28 23:56:11,175 R@8 : 71.157
2020-09-28 23:56:45,904 Epoch: 10, loss: 1.929, time (seconds): 34.73.
2020-09-28 23:56:45,905 **Evaluating.**
2020-09-28 23:57:21,481 NMI: 31.754
2020-09-28 23:57:33,177 R@1 : 39.272
2020-09-28 23:57:33,432 R@2 : 50.239
2020-09-28 23:57:33,689 R@4 : 60.728
2020-09-28 23:57:33,941 R@8 : 70.574
2020-09-28 23:58:08,637 Epoch: 11, loss: 1.888, time (seconds): 34.69.
2020-09-28 23:58:08,637 **Evaluating.**
2020-09-28 23:58:44,270 NMI: 31.909
2020-09-28 23:58:55,960 R@1 : 39.828
2020-09-28 23:58:56,218 R@2 : 50.135
2020-09-28 23:58:56,471 R@4 : 60.546
2020-09-28 23:58:56,721 R@8 : 70.548
2020-09-28 23:59:31,274 Epoch: 12, loss: 1.811, time (seconds): 34.55.
2020-09-28 23:59:31,274 **Evaluating.**
2020-09-29 00:00:06,324 NMI: 31.138
2020-09-29 00:00:18,110 R@1 : 39.211
2020-09-29 00:00:18,360 R@2 : 49.639
2020-09-29 00:00:18,613 R@4 : 60.650
2020-09-29 00:00:18,868 R@8 : 70.427
2020-09-29 00:00:53,416 Epoch: 13, loss: 1.717, time (seconds): 34.55.
2020-09-29 00:00:53,417 **Evaluating.**
2020-09-29 00:01:28,728 NMI: 31.117
2020-09-29 00:01:40,457 R@1 : 39.976
2020-09-29 00:01:40,711 R@2 : 50.135
2020-09-29 00:01:40,966 R@4 : 60.476
2020-09-29 00:01:41,219 R@8 : 70.418
2020-09-29 00:02:15,917 Epoch: 14, loss: 1.704, time (seconds): 34.70.
2020-09-29 00:02:15,918 **Evaluating.**
2020-09-29 00:02:51,592 NMI: 30.940
2020-09-29 00:03:03,268 R@1 : 39.194
2020-09-29 00:03:03,527 R@2 : 49.526
2020-09-29 00:03:03,779 R@4 : 59.929
2020-09-29 00:03:04,035 R@8 : 70.157
2020-09-29 00:03:39,439 Epoch: 15, loss: 1.631, time (seconds): 35.40.
2020-09-29 00:03:39,440 **Evaluating.**
2020-09-29 00:04:15,521 NMI: 30.789
2020-09-29 00:04:27,282 R@1 : 39.237
2020-09-29 00:04:27,532 R@2 : 49.674
2020-09-29 00:04:27,790 R@4 : 59.920
2020-09-29 00:04:28,042 R@8 : 69.801
2020-09-29 00:05:02,586 Epoch: 16, loss: 1.653, time (seconds): 34.54.
2020-09-29 00:05:02,587 **Evaluating.**
2020-09-29 00:05:38,553 NMI: 29.988
2020-09-29 00:05:50,306 R@1 : 38.994
2020-09-29 00:05:50,558 R@2 : 49.483
2020-09-29 00:05:50,813 R@4 : 59.685
2020-09-29 00:05:51,072 R@8 : 69.445
2020-09-29 00:06:25,714 Epoch: 17, loss: 1.596, time (seconds): 34.64.
2020-09-29 00:06:25,716 **Evaluating.**
2020-09-29 00:07:01,276 NMI: 30.558
2020-09-29 00:07:13,102 R@1 : 38.455
2020-09-29 00:07:13,355 R@2 : 48.640
2020-09-29 00:07:13,605 R@4 : 58.851
2020-09-29 00:07:13,855 R@8 : 68.897
2020-09-29 00:07:48,590 Epoch: 18, loss: 1.572, time (seconds): 34.73.
2020-09-29 00:07:48,591 **Evaluating.**
2020-09-29 00:08:24,053 NMI: 30.284
2020-09-29 00:08:35,772 R@1 : 38.203
2020-09-29 00:08:36,028 R@2 : 48.431
2020-09-29 00:08:36,288 R@4 : 58.947
2020-09-29 00:08:36,543 R@8 : 69.028
2020-09-29 00:09:11,134 Epoch: 19, loss: 1.541, time (seconds): 34.59.
2020-09-29 00:09:11,135 **Evaluating.**
2020-09-29 00:09:46,782 NMI: 29.973
2020-09-29 00:09:58,549 R@1 : 37.890
2020-09-29 00:09:58,798 R@2 : 48.544
2020-09-29 00:09:59,050 R@4 : 59.103
2020-09-29 00:09:59,304 R@8 : 69.340
2020-09-29 00:09:59,306 Total training time (minutes): 28.88.
2020-09-29 00:15:06,850 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-234104', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 0.25, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-29 00:15:06,851 Training for 20 epochs
2020-09-29 00:15:06,852 **Evaluating initial model.**
2020-09-29 00:15:42,832 NMI: 25.916
2020-09-29 00:15:54,891 R@1 : 32.493
2020-09-29 00:15:55,147 R@2 : 41.514
2020-09-29 00:15:55,403 R@4 : 51.994
2020-09-29 00:15:55,658 R@8 : 62.736
2020-09-29 00:16:30,008 Epoch: 0, loss: 0.651, time (seconds): 34.35.
2020-09-29 00:16:30,009 **Evaluating.**
2020-09-29 00:17:06,528 NMI: 23.206
2020-09-29 00:17:17,851 R@1 : 25.671
2020-09-29 00:17:18,102 R@2 : 34.753
2020-09-29 00:17:18,359 R@4 : 45.503
2020-09-29 00:17:18,613 R@8 : 57.522
2020-09-29 00:17:53,017 Epoch: 1, loss: 0.609, time (seconds): 34.40.
2020-09-29 00:17:53,018 **Evaluating.**
2020-09-29 00:18:29,566 NMI: 22.884
2020-09-29 00:18:40,889 R@1 : 23.838
2020-09-29 00:18:41,139 R@2 : 32.337
2020-09-29 00:18:41,395 R@4 : 43.808
2020-09-29 00:18:41,644 R@8 : 56.227
2020-09-29 00:19:15,991 Epoch: 2, loss: 0.599, time (seconds): 34.34.
2020-09-29 00:19:15,992 **Evaluating.**
2020-09-29 00:19:52,308 NMI: 21.374
2020-09-29 00:20:03,644 R@1 : 22.743
2020-09-29 00:20:03,901 R@2 : 31.164
2020-09-29 00:20:04,161 R@4 : 42.087
2020-09-29 00:20:04,412 R@8 : 54.758
2020-09-29 00:20:38,792 Epoch: 3, loss: 0.591, time (seconds): 34.38.
2020-09-29 00:20:38,793 **Evaluating.**
2020-09-29 00:21:14,589 NMI: 20.680
2020-09-29 00:21:25,949 R@1 : 21.378
2020-09-29 00:21:26,201 R@2 : 30.399
2020-09-29 00:21:26,453 R@4 : 40.940
2020-09-29 00:21:26,705 R@8 : 53.420
2020-09-29 00:22:01,339 Epoch: 4, loss: 0.597, time (seconds): 34.63.
2020-09-29 00:22:01,339 **Evaluating.**
2020-09-29 00:22:37,303 NMI: 20.434
2020-09-29 00:22:48,649 R@1 : 22.178
2020-09-29 00:22:48,903 R@2 : 30.868
2020-09-29 00:22:49,154 R@4 : 41.627
2020-09-29 00:22:49,409 R@8 : 53.567
2020-09-29 00:23:24,000 Epoch: 5, loss: 0.577, time (seconds): 34.59.
2020-09-29 00:23:24,001 **Evaluating.**
2020-09-29 00:24:00,673 NMI: 20.556
2020-09-29 00:24:12,303 R@1 : 21.309
2020-09-29 00:24:12,552 R@2 : 29.999
2020-09-29 00:24:12,804 R@4 : 40.462
2020-09-29 00:24:13,055 R@8 : 52.629
2020-09-29 00:24:48,157 Epoch: 6, loss: 0.551, time (seconds): 35.10.
2020-09-29 00:24:48,157 **Evaluating.**
2020-09-29 00:25:25,036 NMI: 20.146
2020-09-29 00:25:36,733 R@1 : 20.692
2020-09-29 00:25:36,993 R@2 : 29.339
2020-09-29 00:25:37,254 R@4 : 39.559
2020-09-29 00:25:37,515 R@8 : 51.317
2020-09-29 00:26:11,879 Epoch: 7, loss: 0.556, time (seconds): 34.36.
2020-09-29 00:26:11,880 **Evaluating.**
2020-09-29 00:26:47,449 NMI: 20.518
2020-09-29 00:26:58,881 R@1 : 20.596
2020-09-29 00:26:59,133 R@2 : 28.939
2020-09-29 00:26:59,385 R@4 : 39.559
2020-09-29 00:26:59,642 R@8 : 51.690
2020-09-29 00:27:34,124 Epoch: 8, loss: 0.553, time (seconds): 34.48.
2020-09-29 00:27:34,125 **Evaluating.**
2020-09-29 00:28:09,658 NMI: 19.632
2020-09-29 00:28:21,110 R@1 : 19.666
2020-09-29 00:28:21,372 R@2 : 27.705
2020-09-29 00:28:21,628 R@4 : 38.472
2020-09-29 00:28:21,883 R@8 : 50.621
2020-09-29 00:28:56,358 Epoch: 9, loss: 0.544, time (seconds): 34.47.
2020-09-29 00:28:56,359 **Evaluating.**
2020-09-29 00:29:33,140 NMI: 19.552
2020-09-29 00:29:44,532 R@1 : 19.492
2020-09-29 00:29:44,786 R@2 : 28.200
2020-09-29 00:29:45,040 R@4 : 38.889
2020-09-29 00:29:45,292 R@8 : 50.500
2020-09-29 00:30:19,816 Epoch: 10, loss: 0.547, time (seconds): 34.52.
2020-09-29 00:30:19,816 **Evaluating.**
2020-09-29 00:30:55,899 NMI: 18.785
2020-09-29 00:31:07,355 R@1 : 19.579
2020-09-29 00:31:07,628 R@2 : 27.383
2020-09-29 00:31:07,902 R@4 : 37.577
2020-09-29 00:31:08,170 R@8 : 49.909
2020-09-29 00:31:42,630 Epoch: 11, loss: 0.540, time (seconds): 34.46.
2020-09-29 00:31:42,631 **Evaluating.**
2020-09-29 00:32:19,237 NMI: 19.508
2020-09-29 00:32:30,602 R@1 : 20.309
2020-09-29 00:32:30,855 R@2 : 28.444
2020-09-29 00:32:31,109 R@4 : 38.603
2020-09-29 00:32:31,366 R@8 : 51.056
2020-09-29 00:33:05,893 Epoch: 12, loss: 0.543, time (seconds): 34.53.
2020-09-29 00:33:05,894 **Evaluating.**
2020-09-29 00:33:41,933 NMI: 19.033
2020-09-29 00:33:53,424 R@1 : 19.988
2020-09-29 00:33:53,680 R@2 : 27.844
2020-09-29 00:33:53,936 R@4 : 38.081
2020-09-29 00:33:54,190 R@8 : 50.222
2020-09-29 00:34:28,629 Epoch: 13, loss: 0.546, time (seconds): 34.44.
2020-09-29 00:34:28,630 **Evaluating.**
2020-09-29 00:35:04,712 NMI: 18.608
2020-09-29 00:35:16,113 R@1 : 19.310
2020-09-29 00:35:16,367 R@2 : 27.244
2020-09-29 00:35:16,620 R@4 : 37.725
2020-09-29 00:35:16,874 R@8 : 50.039
2020-09-29 00:35:51,203 Epoch: 14, loss: 0.543, time (seconds): 34.33.
2020-09-29 00:35:51,204 **Evaluating.**
2020-09-29 00:36:27,472 NMI: 18.478
2020-09-29 00:36:38,964 R@1 : 19.466
2020-09-29 00:36:39,223 R@2 : 27.149
2020-09-29 00:36:39,477 R@4 : 36.595
2020-09-29 00:36:39,737 R@8 : 48.901
2020-09-29 00:37:14,328 Epoch: 15, loss: 0.545, time (seconds): 34.59.
2020-09-29 00:37:14,329 **Evaluating.**
2020-09-29 00:37:50,756 NMI: 18.630
2020-09-29 00:38:02,201 R@1 : 19.371
2020-09-29 00:38:02,466 R@2 : 27.097
2020-09-29 00:38:02,733 R@4 : 37.542
2020-09-29 00:38:03,000 R@8 : 49.309
2020-09-29 00:38:37,552 Epoch: 16, loss: 0.545, time (seconds): 34.55.
2020-09-29 00:38:37,553 **Evaluating.**
2020-09-29 00:39:13,622 NMI: 18.451
2020-09-29 00:39:25,070 R@1 : 18.719
2020-09-29 00:39:25,318 R@2 : 27.123
2020-09-29 00:39:25,570 R@4 : 37.230
2020-09-29 00:39:25,827 R@8 : 48.996
2020-09-29 00:40:00,123 Epoch: 17, loss: 0.527, time (seconds): 34.29.
2020-09-29 00:40:00,123 **Evaluating.**
2020-09-29 00:40:36,019 NMI: 18.168
2020-09-29 00:40:47,372 R@1 : 18.928
2020-09-29 00:40:47,626 R@2 : 26.323
2020-09-29 00:40:47,877 R@4 : 36.699
2020-09-29 00:40:48,129 R@8 : 48.840
2020-09-29 00:41:22,476 Epoch: 18, loss: 0.529, time (seconds): 34.34.
2020-09-29 00:41:22,476 **Evaluating.**
2020-09-29 00:41:57,966 NMI: 17.883
2020-09-29 00:42:09,522 R@1 : 18.719
2020-09-29 00:42:09,781 R@2 : 26.149
2020-09-29 00:42:10,041 R@4 : 36.300
2020-09-29 00:42:10,292 R@8 : 48.449
2020-09-29 00:42:44,823 Epoch: 19, loss: 0.527, time (seconds): 34.53.
2020-09-29 00:42:44,824 **Evaluating.**
2020-09-29 00:43:21,315 NMI: 17.947
2020-09-29 00:43:32,772 R@1 : 18.163
2020-09-29 00:43:33,023 R@2 : 26.175
2020-09-29 00:43:33,278 R@4 : 36.656
2020-09-29 00:43:33,535 R@8 : 48.336
2020-09-29 00:43:33,537 Total training time (minutes): 28.44.
2020-09-29 00:43:34,326 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-234104', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 0.5, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-29 00:43:34,327 Training for 20 epochs
2020-09-29 00:43:34,328 **Evaluating initial model.**
2020-09-29 00:44:10,539 NMI: 25.916
2020-09-29 00:44:22,533 R@1 : 32.493
2020-09-29 00:44:22,783 R@2 : 41.514
2020-09-29 00:44:23,033 R@4 : 51.994
2020-09-29 00:44:23,285 R@8 : 62.736
2020-09-29 00:44:57,457 Epoch: 0, loss: 1.411, time (seconds): 34.17.
2020-09-29 00:44:57,458 **Evaluating.**
2020-09-29 00:45:33,068 NMI: 27.723
2020-09-29 00:45:44,644 R@1 : 32.015
2020-09-29 00:45:44,902 R@2 : 42.001
2020-09-29 00:45:45,154 R@4 : 53.220
2020-09-29 00:45:45,405 R@8 : 64.257
2020-09-29 00:46:20,283 Epoch: 1, loss: 1.373, time (seconds): 34.88.
2020-09-29 00:46:20,284 **Evaluating.**
2020-09-29 00:46:56,289 NMI: 27.653
2020-09-29 00:47:07,901 R@1 : 31.624
2020-09-29 00:47:08,153 R@2 : 41.775
2020-09-29 00:47:08,406 R@4 : 52.142
2020-09-29 00:47:08,660 R@8 : 63.318
2020-09-29 00:47:43,186 Epoch: 2, loss: 1.293, time (seconds): 34.52.
2020-09-29 00:47:43,186 **Evaluating.**
2020-09-29 00:48:19,179 NMI: 27.778
2020-09-29 00:48:30,585 R@1 : 31.450
2020-09-29 00:48:30,839 R@2 : 41.418
2020-09-29 00:48:31,090 R@4 : 51.951
2020-09-29 00:48:31,345 R@8 : 63.162
2020-09-29 00:49:06,015 Epoch: 3, loss: 1.298, time (seconds): 34.67.
2020-09-29 00:49:06,016 **Evaluating.**
2020-09-29 00:49:41,693 NMI: 26.959
2020-09-29 00:49:53,143 R@1 : 31.303
2020-09-29 00:49:53,395 R@2 : 40.627
2020-09-29 00:49:53,655 R@4 : 50.821
2020-09-29 00:49:53,913 R@8 : 61.945
2020-09-29 00:50:28,450 Epoch: 4, loss: 1.305, time (seconds): 34.54.
2020-09-29 00:50:28,451 **Evaluating.**
2020-09-29 00:51:04,384 NMI: 26.699
2020-09-29 00:51:15,850 R@1 : 30.694
2020-09-29 00:51:16,115 R@2 : 40.262
2020-09-29 00:51:16,379 R@4 : 50.882
2020-09-29 00:51:16,647 R@8 : 61.641
2020-09-29 00:51:51,056 Epoch: 5, loss: 1.298, time (seconds): 34.41.
2020-09-29 00:51:51,057 **Evaluating.**
2020-09-29 00:52:26,395 NMI: 26.304
2020-09-29 00:52:37,793 R@1 : 29.478
2020-09-29 00:52:38,048 R@2 : 38.811
2020-09-29 00:52:38,297 R@4 : 49.718
2020-09-29 00:52:38,548 R@8 : 60.902
2020-09-29 00:53:12,994 Epoch: 6, loss: 1.280, time (seconds): 34.44.
2020-09-29 00:53:12,995 **Evaluating.**
2020-09-29 00:53:48,207 NMI: 26.105
2020-09-29 00:53:59,580 R@1 : 29.738
2020-09-29 00:53:59,835 R@2 : 39.324
2020-09-29 00:54:00,090 R@4 : 49.744
2020-09-29 00:54:00,344 R@8 : 60.711
2020-09-29 00:54:34,998 Epoch: 7, loss: 1.242, time (seconds): 34.65.
2020-09-29 00:54:34,998 **Evaluating.**
2020-09-29 00:55:11,080 NMI: 24.554
2020-09-29 00:55:22,428 R@1 : 28.470
2020-09-29 00:55:22,685 R@2 : 37.916
2020-09-29 00:55:22,939 R@4 : 48.623
2020-09-29 00:55:23,195 R@8 : 60.033
2020-09-29 00:55:57,761 Epoch: 8, loss: 1.258, time (seconds): 34.56.
2020-09-29 00:55:57,762 **Evaluating.**
2020-09-29 00:56:33,037 NMI: 25.074
2020-09-29 00:56:44,419 R@1 : 28.313
2020-09-29 00:56:44,669 R@2 : 37.412
2020-09-29 00:56:44,924 R@4 : 48.179
2020-09-29 00:56:45,177 R@8 : 59.260
2020-09-29 00:57:19,716 Epoch: 9, loss: 1.242, time (seconds): 34.54.
2020-09-29 00:57:19,717 **Evaluating.**
2020-09-29 00:57:55,085 NMI: 24.641
2020-09-29 00:58:06,508 R@1 : 27.948
2020-09-29 00:58:06,760 R@2 : 37.568
2020-09-29 00:58:07,024 R@4 : 48.310
2020-09-29 00:58:07,279 R@8 : 59.477
2020-09-29 00:58:41,944 Epoch: 10, loss: 1.233, time (seconds): 34.66.
2020-09-29 00:58:41,945 **Evaluating.**
2020-09-29 00:59:17,606 NMI: 23.833
2020-09-29 00:59:29,070 R@1 : 27.270
2020-09-29 00:59:29,321 R@2 : 36.161
2020-09-29 00:59:29,572 R@4 : 47.015
2020-09-29 00:59:29,825 R@8 : 58.712
2020-09-29 01:00:04,399 Epoch: 11, loss: 1.224, time (seconds): 34.57.
2020-09-29 01:00:04,399 **Evaluating.**
2020-09-29 01:00:39,802 NMI: 24.276
2020-09-29 01:00:51,266 R@1 : 27.036
2020-09-29 01:00:51,515 R@2 : 36.022
2020-09-29 01:00:51,765 R@4 : 46.737
2020-09-29 01:00:52,018 R@8 : 58.069
2020-09-29 01:01:26,403 Epoch: 12, loss: 1.186, time (seconds): 34.38.
2020-09-29 01:01:26,404 **Evaluating.**
2020-09-29 01:02:01,741 NMI: 23.584
2020-09-29 01:02:13,225 R@1 : 26.280
2020-09-29 01:02:13,483 R@2 : 35.144
2020-09-29 01:02:13,744 R@4 : 45.868
2020-09-29 01:02:14,008 R@8 : 57.296
2020-09-29 01:02:48,493 Epoch: 13, loss: 1.211, time (seconds): 34.48.
2020-09-29 01:02:48,493 **Evaluating.**
2020-09-29 01:03:24,062 NMI: 23.502
2020-09-29 01:03:35,602 R@1 : 25.975
2020-09-29 01:03:35,862 R@2 : 35.231
2020-09-29 01:03:36,116 R@4 : 45.407
2020-09-29 01:03:36,365 R@8 : 57.556
2020-09-29 01:04:10,880 Epoch: 14, loss: 1.200, time (seconds): 34.51.
2020-09-29 01:04:10,881 **Evaluating.**
2020-09-29 01:04:46,419 NMI: 23.567
2020-09-29 01:04:57,957 R@1 : 25.889
2020-09-29 01:04:58,210 R@2 : 35.048
2020-09-29 01:04:58,467 R@4 : 45.372
2020-09-29 01:04:58,717 R@8 : 57.243
2020-09-29 01:05:33,146 Epoch: 15, loss: 1.201, time (seconds): 34.43.
2020-09-29 01:05:33,146 **Evaluating.**
2020-09-29 01:06:08,792 NMI: 23.223
2020-09-29 01:06:20,301 R@1 : 26.340
2020-09-29 01:06:20,561 R@2 : 35.405
2020-09-29 01:06:20,821 R@4 : 46.563
2020-09-29 01:06:21,080 R@8 : 57.878
2020-09-29 01:06:55,700 Epoch: 16, loss: 1.165, time (seconds): 34.62.
2020-09-29 01:06:55,700 **Evaluating.**
2020-09-29 01:07:31,358 NMI: 23.080
2020-09-29 01:07:43,010 R@1 : 25.150
2020-09-29 01:07:43,260 R@2 : 33.927
2020-09-29 01:07:43,514 R@4 : 44.894
2020-09-29 01:07:43,763 R@8 : 56.314
2020-09-29 01:08:18,532 Epoch: 17, loss: 1.158, time (seconds): 34.77.
2020-09-29 01:08:18,533 **Evaluating.**
2020-09-29 01:08:53,887 NMI: 22.707
2020-09-29 01:09:05,496 R@1 : 25.437
2020-09-29 01:09:05,750 R@2 : 34.544
2020-09-29 01:09:06,002 R@4 : 45.094
2020-09-29 01:09:06,256 R@8 : 56.235
2020-09-29 01:09:40,674 Epoch: 18, loss: 1.158, time (seconds): 34.42.
2020-09-29 01:09:40,675 **Evaluating.**
2020-09-29 01:10:16,170 NMI: 23.141
2020-09-29 01:10:27,722 R@1 : 26.028
2020-09-29 01:10:27,974 R@2 : 35.048
2020-09-29 01:10:28,225 R@4 : 45.120
2020-09-29 01:10:28,479 R@8 : 56.053
2020-09-29 01:11:02,820 Epoch: 19, loss: 1.174, time (seconds): 34.34.
2020-09-29 01:11:02,820 **Evaluating.**
2020-09-29 01:11:38,690 NMI: 22.180
2020-09-29 01:11:50,234 R@1 : 24.594
2020-09-29 01:11:50,486 R@2 : 33.128
2020-09-29 01:11:50,741 R@4 : 43.573
2020-09-29 01:11:50,999 R@8 : 55.418
2020-09-29 01:11:51,002 Total training time (minutes): 28.28.
2020-09-29 01:11:51,766 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-234104', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 2, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-29 01:11:51,766 Training for 20 epochs
2020-09-29 01:11:51,768 **Evaluating initial model.**
2020-09-29 01:12:27,769 NMI: 25.916
2020-09-29 01:12:39,874 R@1 : 32.493
2020-09-29 01:12:40,143 R@2 : 41.514
2020-09-29 01:12:40,413 R@4 : 51.994
2020-09-29 01:12:40,683 R@8 : 62.736
2020-09-29 01:13:15,039 Epoch: 0, loss: 3.920, time (seconds): 34.35.
2020-09-29 01:13:15,040 **Evaluating.**
2020-09-29 01:13:50,819 NMI: 29.048
2020-09-29 01:14:02,413 R@1 : 36.552
2020-09-29 01:14:02,668 R@2 : 46.832
2020-09-29 01:14:02,922 R@4 : 56.913
2020-09-29 01:14:03,178 R@8 : 67.559
2020-09-29 01:14:37,468 Epoch: 1, loss: 3.689, time (seconds): 34.29.
2020-09-29 01:14:37,469 **Evaluating.**
2020-09-29 01:15:13,238 NMI: 29.986
2020-09-29 01:15:24,704 R@1 : 36.943
2020-09-29 01:15:24,961 R@2 : 46.728
2020-09-29 01:15:25,212 R@4 : 56.861
2020-09-29 01:15:25,463 R@8 : 67.255
2020-09-29 01:15:59,783 Epoch: 2, loss: 3.574, time (seconds): 34.32.
2020-09-29 01:15:59,784 **Evaluating.**
2020-09-29 01:16:36,634 NMI: 29.832
2020-09-29 01:16:48,022 R@1 : 35.657
2020-09-29 01:16:48,276 R@2 : 45.755
2020-09-29 01:16:48,530 R@4 : 56.470
2020-09-29 01:16:48,789 R@8 : 66.803
2020-09-29 01:17:23,347 Epoch: 3, loss: 3.481, time (seconds): 34.56.
2020-09-29 01:17:23,348 **Evaluating.**
2020-09-29 01:17:59,516 NMI: 29.601
2020-09-29 01:18:10,873 R@1 : 35.735
2020-09-29 01:18:11,127 R@2 : 45.885
2020-09-29 01:18:11,380 R@4 : 56.574
2020-09-29 01:18:11,636 R@8 : 66.681
2020-09-29 01:18:46,225 Epoch: 4, loss: 3.416, time (seconds): 34.59.
2020-09-29 01:18:46,226 **Evaluating.**
2020-09-29 01:19:22,452 NMI: 29.324
2020-09-29 01:19:33,762 R@1 : 34.770
2020-09-29 01:19:34,012 R@2 : 45.338
2020-09-29 01:19:34,261 R@4 : 56.062
2020-09-29 01:19:34,513 R@8 : 66.160
2020-09-29 01:20:08,873 Epoch: 5, loss: 3.396, time (seconds): 34.36.
2020-09-29 01:20:08,874 **Evaluating.**
2020-09-29 01:20:44,346 NMI: 29.674
2020-09-29 01:20:55,626 R@1 : 34.266
2020-09-29 01:20:55,877 R@2 : 44.695
2020-09-29 01:20:56,130 R@4 : 55.358
2020-09-29 01:20:56,385 R@8 : 65.812
2020-09-29 01:21:30,923 Epoch: 6, loss: 3.348, time (seconds): 34.53.
2020-09-29 01:21:30,924 **Evaluating.**
2020-09-29 01:22:07,385 NMI: 29.470
2020-09-29 01:22:18,610 R@1 : 33.910
2020-09-29 01:22:18,865 R@2 : 44.277
2020-09-29 01:22:19,117 R@4 : 55.253
2020-09-29 01:22:19,369 R@8 : 65.717
2020-09-29 01:22:53,858 Epoch: 7, loss: 3.324, time (seconds): 34.49.
2020-09-29 01:22:53,859 **Evaluating.**
2020-09-29 01:23:29,984 NMI: 28.872
2020-09-29 01:23:41,218 R@1 : 33.371
2020-09-29 01:23:41,470 R@2 : 43.495
2020-09-29 01:23:41,721 R@4 : 54.480
2020-09-29 01:23:41,980 R@8 : 65.065
2020-09-29 01:24:16,310 Epoch: 8, loss: 3.317, time (seconds): 34.33.
2020-09-29 01:24:16,311 **Evaluating.**
2020-09-29 01:24:51,943 NMI: 28.501
2020-09-29 01:25:03,237 R@1 : 32.580
2020-09-29 01:25:03,491 R@2 : 42.809
2020-09-29 01:25:03,746 R@4 : 53.585
2020-09-29 01:25:04,004 R@8 : 64.300
2020-09-29 01:25:38,219 Epoch: 9, loss: 3.290, time (seconds): 34.21.
2020-09-29 01:25:38,219 **Evaluating.**
2020-09-29 01:26:14,210 NMI: 28.300
2020-09-29 01:26:25,508 R@1 : 32.441
2020-09-29 01:26:25,764 R@2 : 42.096
2020-09-29 01:26:26,018 R@4 : 52.777
2020-09-29 01:26:26,269 R@8 : 64.161
2020-09-29 01:27:00,740 Epoch: 10, loss: 3.289, time (seconds): 34.47.
2020-09-29 01:27:00,740 **Evaluating.**
2020-09-29 01:27:36,443 NMI: 28.449
2020-09-29 01:27:47,641 R@1 : 31.920
2020-09-29 01:27:47,896 R@2 : 42.287
2020-09-29 01:27:48,152 R@4 : 53.185
2020-09-29 01:27:48,408 R@8 : 64.048
2020-09-29 01:28:22,849 Epoch: 11, loss: 3.273, time (seconds): 34.44.
2020-09-29 01:28:22,850 **Evaluating.**
2020-09-29 01:28:59,066 NMI: 28.724
2020-09-29 01:29:10,515 R@1 : 31.589
2020-09-29 01:29:10,775 R@2 : 42.244
2020-09-29 01:29:11,033 R@4 : 53.507
2020-09-29 01:29:11,286 R@8 : 64.422
2020-09-29 01:29:46,575 Epoch: 12, loss: 3.237, time (seconds): 35.29.
2020-09-29 01:29:46,576 **Evaluating.**
2020-09-29 01:30:22,700 NMI: 28.165
2020-09-29 01:30:33,933 R@1 : 31.172
2020-09-29 01:30:34,187 R@2 : 41.444
2020-09-29 01:30:34,437 R@4 : 52.820
2020-09-29 01:30:34,693 R@8 : 63.527
2020-09-29 01:31:09,229 Epoch: 13, loss: 3.246, time (seconds): 34.53.
2020-09-29 01:31:09,230 **Evaluating.**
2020-09-29 01:31:44,895 NMI: 28.226
2020-09-29 01:31:56,042 R@1 : 30.807
2020-09-29 01:31:56,293 R@2 : 40.627
2020-09-29 01:31:56,552 R@4 : 51.994
2020-09-29 01:31:56,806 R@8 : 63.518
2020-09-29 01:32:31,213 Epoch: 14, loss: 3.237, time (seconds): 34.40.
2020-09-29 01:32:31,214 **Evaluating.**
2020-09-29 01:33:06,847 NMI: 28.165
2020-09-29 01:33:18,075 R@1 : 31.094
2020-09-29 01:33:18,329 R@2 : 41.062
2020-09-29 01:33:18,583 R@4 : 52.125
2020-09-29 01:33:18,839 R@8 : 63.396
2020-09-29 01:33:53,179 Epoch: 15, loss: 3.232, time (seconds): 34.34.
2020-09-29 01:33:53,179 **Evaluating.**
2020-09-29 01:34:28,960 NMI: 27.506
2020-09-29 01:34:40,147 R@1 : 30.347
2020-09-29 01:34:40,398 R@2 : 40.367
2020-09-29 01:34:40,651 R@4 : 51.317
2020-09-29 01:34:40,905 R@8 : 62.640
2020-09-29 01:35:15,174 Epoch: 16, loss: 3.220, time (seconds): 34.27.
2020-09-29 01:35:15,175 **Evaluating.**
2020-09-29 01:35:51,152 NMI: 27.450
2020-09-29 01:36:02,372 R@1 : 29.443
2020-09-29 01:36:02,629 R@2 : 39.724
2020-09-29 01:36:02,882 R@4 : 51.012
2020-09-29 01:36:03,134 R@8 : 62.458
2020-09-29 01:36:37,512 Epoch: 17, loss: 3.203, time (seconds): 34.38.
2020-09-29 01:36:37,513 **Evaluating.**
2020-09-29 01:37:12,708 NMI: 27.323
2020-09-29 01:37:23,895 R@1 : 29.608
2020-09-29 01:37:24,148 R@2 : 39.654
2020-09-29 01:37:24,400 R@4 : 50.917
2020-09-29 01:37:24,659 R@8 : 62.145
2020-09-29 01:37:59,156 Epoch: 18, loss: 3.192, time (seconds): 34.49.
2020-09-29 01:37:59,157 **Evaluating.**
2020-09-29 01:38:35,074 NMI: 26.535
2020-09-29 01:38:46,282 R@1 : 29.043
2020-09-29 01:38:46,534 R@2 : 39.237
2020-09-29 01:38:46,791 R@4 : 49.822
2020-09-29 01:38:47,044 R@8 : 61.528
2020-09-29 01:39:21,320 Epoch: 19, loss: 3.214, time (seconds): 34.27.
2020-09-29 01:39:21,321 **Evaluating.**
2020-09-29 01:39:56,761 NMI: 26.733
2020-09-29 01:40:07,938 R@1 : 28.965
2020-09-29 01:40:08,191 R@2 : 39.185
2020-09-29 01:40:08,443 R@4 : 50.552
2020-09-29 01:40:08,702 R@8 : 61.536
2020-09-29 01:40:08,704 Total training time (minutes): 28.28.
2020-09-29 01:40:09,503 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-234104', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 10, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-29 01:40:09,503 Training for 20 epochs
2020-09-29 01:40:09,505 **Evaluating initial model.**
2020-09-29 01:40:44,887 NMI: 25.916
2020-09-29 01:40:56,948 R@1 : 32.493
2020-09-29 01:40:57,204 R@2 : 41.514
2020-09-29 01:40:57,456 R@4 : 51.994
2020-09-29 01:40:57,709 R@8 : 62.736
2020-09-29 01:41:32,406 Epoch: 0, loss: 5.318, time (seconds): 34.70.
2020-09-29 01:41:32,406 **Evaluating.**
2020-09-29 01:42:08,026 NMI: 28.115
2020-09-29 01:42:19,605 R@1 : 34.579
2020-09-29 01:42:19,864 R@2 : 44.416
2020-09-29 01:42:20,117 R@4 : 55.427
2020-09-29 01:42:20,371 R@8 : 66.186
2020-09-29 01:42:55,057 Epoch: 1, loss: 4.899, time (seconds): 34.68.
2020-09-29 01:42:55,058 **Evaluating.**
2020-09-29 01:43:30,751 NMI: 27.818
2020-09-29 01:43:42,243 R@1 : 33.571
2020-09-29 01:43:42,495 R@2 : 43.843
2020-09-29 01:43:42,751 R@4 : 54.445
2020-09-29 01:43:43,003 R@8 : 65.525
2020-09-29 01:44:17,532 Epoch: 2, loss: 4.731, time (seconds): 34.53.
2020-09-29 01:44:17,532 **Evaluating.**
2020-09-29 01:44:53,101 NMI: 27.558
2020-09-29 01:45:04,351 R@1 : 32.580
2020-09-29 01:45:04,603 R@2 : 42.704
2020-09-29 01:45:04,865 R@4 : 53.837
2020-09-29 01:45:05,116 R@8 : 64.743
2020-09-29 01:45:39,585 Epoch: 3, loss: 4.637, time (seconds): 34.47.
2020-09-29 01:45:39,585 **Evaluating.**
2020-09-29 01:46:15,151 NMI: 27.439
2020-09-29 01:46:26,346 R@1 : 31.972
2020-09-29 01:46:26,598 R@2 : 42.157
2020-09-29 01:46:26,860 R@4 : 53.089
2020-09-29 01:46:27,115 R@8 : 63.961
2020-09-29 01:47:01,803 Epoch: 4, loss: 4.564, time (seconds): 34.69.
2020-09-29 01:47:01,804 **Evaluating.**
2020-09-29 01:47:38,264 NMI: 26.882
2020-09-29 01:47:49,294 R@1 : 30.060
2020-09-29 01:47:49,551 R@2 : 39.489
2020-09-29 01:47:49,805 R@4 : 50.717
2020-09-29 01:47:50,064 R@8 : 62.692
2020-09-29 01:48:24,636 Epoch: 5, loss: 4.506, time (seconds): 34.57.
2020-09-29 01:48:24,636 **Evaluating.**
2020-09-29 01:49:01,109 NMI: 26.420
2020-09-29 01:49:12,002 R@1 : 28.835
2020-09-29 01:49:12,269 R@2 : 38.855
2020-09-29 01:49:12,540 R@4 : 50.083
2020-09-29 01:49:12,813 R@8 : 61.797
2020-09-29 01:49:47,205 Epoch: 6, loss: 4.464, time (seconds): 34.39.
2020-09-29 01:49:47,206 **Evaluating.**
2020-09-29 01:50:23,886 NMI: 26.071
2020-09-29 01:50:34,614 R@1 : 27.687
2020-09-29 01:50:34,867 R@2 : 37.742
2020-09-29 01:50:35,125 R@4 : 49.405
2020-09-29 01:50:35,380 R@8 : 61.171
