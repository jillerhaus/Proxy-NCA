2020-09-14 00:24:29,808 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 64, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 12, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food-20200914-002423', 'results_filename': 'food-results.csv', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 128}
2020-09-14 00:24:29,809 Training for 20 epochs
2020-09-14 00:24:29,812 **Evaluating initial model.**
2020-09-14 00:26:25,563 NMI: 24.435
2020-09-14 00:28:05,015 R@1 : 42.006
2020-09-14 00:28:05,842 R@2 : 50.544
2020-09-14 00:28:06,665 R@4 : 59.936
2020-09-14 00:28:07,482 R@8 : 69.261
2020-09-14 00:30:13,886 Epoch: 0, loss: 2.992, time (seconds): 126.40.
2020-09-14 00:30:13,888 **Evaluating.**
2020-09-14 00:32:09,782 NMI: 29.664
2020-09-14 00:33:38,578 R@1 : 45.780
2020-09-14 00:33:39,300 R@2 : 54.806
2020-09-14 00:33:40,027 R@4 : 63.620
2020-09-14 00:33:40,757 R@8 : 72.527
2020-09-14 00:35:44,443 Epoch: 1, loss: 2.911, time (seconds): 123.68.
2020-09-14 00:35:44,444 **Evaluating.**
2020-09-14 00:37:36,553 NMI: 28.364
2020-09-14 00:39:05,003 R@1 : 43.092
2020-09-14 00:39:05,725 R@2 : 52.121
2020-09-14 00:39:06,451 R@4 : 61.402
2020-09-14 00:39:07,178 R@8 : 70.353
2020-09-14 00:41:11,483 Epoch: 2, loss: 2.848, time (seconds): 124.30.
2020-09-14 00:41:11,484 **Evaluating.**
2020-09-14 00:43:03,794 NMI: 27.018
2020-09-14 00:44:31,988 R@1 : 41.019
2020-09-14 00:44:32,712 R@2 : 50.298
2020-09-14 00:44:33,436 R@4 : 59.820
2020-09-14 00:44:34,158 R@8 : 69.194
2020-09-14 00:46:38,793 Epoch: 3, loss: 2.804, time (seconds): 124.63.
2020-09-14 00:46:38,794 **Evaluating.**
2020-09-14 00:48:30,814 NMI: 25.822
2020-09-14 00:49:59,088 R@1 : 39.419
2020-09-14 00:49:59,816 R@2 : 48.498
2020-09-14 00:50:00,543 R@4 : 58.075
2020-09-14 00:50:01,268 R@8 : 67.801
2020-09-14 00:52:05,499 Epoch: 4, loss: 2.772, time (seconds): 124.23.
2020-09-14 00:52:05,499 **Evaluating.**
2020-09-14 00:53:56,771 NMI: 25.755
2020-09-14 00:55:25,199 R@1 : 38.679
2020-09-14 00:55:25,913 R@2 : 47.929
2020-09-14 00:55:26,632 R@4 : 57.849
2020-09-14 00:55:27,356 R@8 : 67.197
2020-09-14 00:57:32,140 Epoch: 5, loss: 2.727, time (seconds): 124.78.
2020-09-14 00:57:32,141 **Evaluating.**
2020-09-14 00:59:25,340 NMI: 25.732
2020-09-14 01:00:53,127 R@1 : 37.808
2020-09-14 01:00:53,849 R@2 : 46.915
2020-09-14 01:00:54,570 R@4 : 56.754
2020-09-14 01:00:55,296 R@8 : 66.216
2020-09-14 01:03:00,215 Epoch: 6, loss: 2.720, time (seconds): 124.91.
2020-09-14 01:03:00,215 **Evaluating.**
2020-09-14 01:04:51,343 NMI: 25.075
2020-09-14 01:06:18,229 R@1 : 37.222
2020-09-14 01:06:18,960 R@2 : 46.277
2020-09-14 01:06:19,685 R@4 : 55.991
2020-09-14 01:06:20,411 R@8 : 65.594
2020-09-14 01:08:25,829 Epoch: 7, loss: 2.738, time (seconds): 125.42.
2020-09-14 01:08:25,830 **Evaluating.**
2020-09-14 01:10:17,476 NMI: 24.581
2020-09-14 01:11:44,895 R@1 : 36.618
2020-09-14 01:11:45,664 R@2 : 45.528
2020-09-14 01:11:46,433 R@4 : 55.297
2020-09-14 01:11:47,205 R@8 : 65.371
2020-09-14 01:13:50,763 Epoch: 8, loss: 2.720, time (seconds): 123.55.
2020-09-14 01:13:50,764 **Evaluating.**
2020-09-14 01:15:41,017 NMI: 23.924
2020-09-14 01:17:09,028 R@1 : 35.369
2020-09-14 01:17:09,752 R@2 : 44.459
2020-09-14 01:17:10,475 R@4 : 54.832
2020-09-14 01:17:11,197 R@8 : 64.657
2020-09-14 01:19:15,639 Epoch: 9, loss: 2.679, time (seconds): 124.44.
2020-09-14 01:19:15,640 **Evaluating.**
2020-09-14 01:21:05,191 NMI: 24.349
2020-09-14 01:22:33,365 R@1 : 35.581
2020-09-14 01:22:34,090 R@2 : 44.546
2020-09-14 01:22:34,816 R@4 : 54.725
2020-09-14 01:22:35,540 R@8 : 64.538
2020-09-14 01:24:39,259 Epoch: 10, loss: 2.674, time (seconds): 123.72.
2020-09-14 01:24:39,260 **Evaluating.**
2020-09-14 01:26:29,286 NMI: 25.065
2020-09-14 01:27:56,759 R@1 : 35.587
2020-09-14 01:27:57,498 R@2 : 44.387
2020-09-14 01:27:58,222 R@4 : 54.371
2020-09-14 01:27:58,949 R@8 : 64.114
2020-09-14 01:30:04,446 Epoch: 11, loss: 2.672, time (seconds): 125.49.
2020-09-14 01:30:04,447 **Evaluating.**
2020-09-14 01:31:55,800 NMI: 23.492
2020-09-14 01:33:23,293 R@1 : 34.618
2020-09-14 01:33:24,014 R@2 : 43.699
2020-09-14 01:33:24,728 R@4 : 53.587
2020-09-14 01:33:25,453 R@8 : 63.809
2020-09-14 01:35:29,936 Epoch: 12, loss: 2.638, time (seconds): 124.48.
2020-09-14 01:35:29,936 **Evaluating.**
2020-09-14 01:37:20,797 NMI: 24.056
2020-09-14 01:38:48,561 R@1 : 35.277
2020-09-14 01:38:49,286 R@2 : 44.123
2020-09-14 01:38:50,014 R@4 : 53.982
2020-09-14 01:38:50,741 R@8 : 63.861
2020-09-14 01:40:55,944 Epoch: 13, loss: 2.635, time (seconds): 125.20.
2020-09-14 01:40:55,945 **Evaluating.**
2020-09-14 01:42:45,381 NMI: 24.206
2020-09-14 01:44:13,434 R@1 : 34.824
2020-09-14 01:44:14,322 R@2 : 43.763
2020-09-14 01:44:15,216 R@4 : 53.744
2020-09-14 01:44:16,101 R@8 : 63.530
2020-09-14 01:46:19,934 Epoch: 14, loss: 2.615, time (seconds): 123.83.
2020-09-14 01:46:19,935 **Evaluating.**
2020-09-14 01:48:11,045 NMI: 23.299
2020-09-14 01:49:38,633 R@1 : 34.095
2020-09-14 01:49:39,373 R@2 : 42.854
2020-09-14 01:49:40,097 R@4 : 52.771
2020-09-14 01:49:40,816 R@8 : 62.566
2020-09-14 01:51:45,972 Epoch: 15, loss: 2.626, time (seconds): 125.15.
2020-09-14 01:51:45,973 **Evaluating.**
2020-09-14 01:53:33,453 NMI: 23.880
2020-09-14 01:55:00,529 R@1 : 33.384
2020-09-14 01:55:01,260 R@2 : 42.471
2020-09-14 01:55:01,982 R@4 : 52.156
2020-09-14 01:55:02,707 R@8 : 62.154
2020-09-14 01:57:07,938 Epoch: 16, loss: 2.576, time (seconds): 125.23.
2020-09-14 01:57:07,938 **Evaluating.**
2020-09-14 01:58:57,141 NMI: 23.208
2020-09-14 02:00:24,747 R@1 : 33.445
2020-09-14 02:00:25,474 R@2 : 41.939
2020-09-14 02:00:26,200 R@4 : 51.801
2020-09-14 02:00:26,935 R@8 : 61.983
2020-09-14 02:02:30,815 Epoch: 17, loss: 2.588, time (seconds): 123.88.
2020-09-14 02:02:30,816 **Evaluating.**
2020-09-14 02:04:19,690 NMI: 23.470
2020-09-14 02:05:47,771 R@1 : 33.282
2020-09-14 02:05:48,497 R@2 : 42.288
2020-09-14 02:05:49,225 R@4 : 52.167
2020-09-14 02:05:49,950 R@8 : 62.363
2020-09-14 02:07:54,490 Epoch: 18, loss: 2.596, time (seconds): 124.54.
2020-09-14 02:07:54,491 **Evaluating.**
2020-09-14 02:09:45,928 NMI: 23.391
2020-09-14 02:11:13,722 R@1 : 33.018
2020-09-14 02:11:14,493 R@2 : 41.873
2020-09-14 02:11:15,270 R@4 : 51.732
2020-09-14 02:11:16,039 R@8 : 61.704
2020-09-14 02:13:19,367 Epoch: 19, loss: 2.573, time (seconds): 123.32.
2020-09-14 02:13:19,368 **Evaluating.**
2020-09-14 02:15:10,188 NMI: 22.899
2020-09-14 02:16:38,452 R@1 : 33.384
2020-09-14 02:16:39,179 R@2 : 42.163
2020-09-14 02:16:39,903 R@4 : 51.694
2020-09-14 02:16:40,630 R@8 : 61.649
2020-09-14 02:16:40,633 Total training time (minutes): 112.18.
2020-09-14 02:16:42,758 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 64, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 12, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food-20200914-002423', 'results_filename': 'food-results.csv', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 128}
2020-09-14 02:16:42,759 Training for 20 epochs
2020-09-14 02:16:42,762 **Evaluating initial model.**
2020-09-14 02:18:24,711 NMI: 24.435
2020-09-14 02:20:01,016 R@1 : 42.006
2020-09-14 02:20:01,739 R@2 : 50.544
2020-09-14 02:20:02,464 R@4 : 59.936
2020-09-14 02:20:03,189 R@8 : 69.261
2020-09-14 02:22:06,885 Epoch: 0, loss: 2.181, time (seconds): 123.69.
2020-09-14 02:22:06,886 **Evaluating.**
2020-09-14 02:23:54,951 NMI: 31.464
2020-09-14 02:25:26,147 R@1 : 49.296
2020-09-14 02:25:26,872 R@2 : 58.305
2020-09-14 02:25:27,605 R@4 : 67.058
2020-09-14 02:25:28,327 R@8 : 75.146
2020-09-14 02:27:32,476 Epoch: 1, loss: 2.009, time (seconds): 124.15.
2020-09-14 02:27:32,477 **Evaluating.**
2020-09-14 02:29:25,429 NMI: 29.784
2020-09-14 02:30:57,324 R@1 : 49.133
2020-09-14 02:30:58,051 R@2 : 58.246
2020-09-14 02:30:58,778 R@4 : 66.947
2020-09-14 02:30:59,507 R@8 : 75.114
2020-09-14 02:33:04,823 Epoch: 2, loss: 1.904, time (seconds): 125.31.
2020-09-14 02:33:04,824 **Evaluating.**
2020-09-14 02:34:56,583 NMI: 29.859
2020-09-14 02:36:28,871 R@1 : 48.599
2020-09-14 02:36:29,597 R@2 : 57.767
2020-09-14 02:36:30,318 R@4 : 66.654
2020-09-14 02:36:31,043 R@8 : 74.449
2020-09-14 02:38:37,362 Epoch: 3, loss: 1.791, time (seconds): 126.32.
2020-09-14 02:38:37,363 **Evaluating.**
2020-09-14 02:40:33,498 NMI: 28.672
2020-09-14 02:42:05,142 R@1 : 47.612
2020-09-14 02:42:05,863 R@2 : 56.612
2020-09-14 02:42:06,585 R@4 : 65.557
2020-09-14 02:42:07,311 R@8 : 73.860
2020-09-14 02:44:11,378 Epoch: 4, loss: 1.758, time (seconds): 124.07.
2020-09-14 02:44:11,379 **Evaluating.**
2020-09-14 02:46:04,300 NMI: 27.920
2020-09-14 02:47:37,198 R@1 : 47.740
2020-09-14 02:47:37,970 R@2 : 56.412
2020-09-14 02:47:38,744 R@4 : 65.179
2020-09-14 02:47:39,522 R@8 : 73.279
2020-09-14 02:49:44,859 Epoch: 5, loss: 1.635, time (seconds): 125.33.
2020-09-14 02:49:44,860 **Evaluating.**
2020-09-14 02:51:37,357 NMI: 27.660
2020-09-14 02:53:08,306 R@1 : 46.349
2020-09-14 02:53:09,028 R@2 : 55.070
2020-09-14 02:53:09,752 R@4 : 63.954
2020-09-14 02:53:10,476 R@8 : 72.475
2020-09-14 02:55:15,099 Epoch: 6, loss: 1.602, time (seconds): 124.62.
2020-09-14 02:55:15,100 **Evaluating.**
2020-09-14 02:57:05,883 NMI: 27.869
2020-09-14 02:58:38,355 R@1 : 46.132
2020-09-14 02:58:39,075 R@2 : 55.157
2020-09-14 02:58:39,796 R@4 : 64.021
2020-09-14 02:58:40,523 R@8 : 72.251
2020-09-14 03:00:45,535 Epoch: 7, loss: 1.638, time (seconds): 125.01.
2020-09-14 03:00:45,536 **Evaluating.**
2020-09-14 03:02:37,074 NMI: 27.309
2020-09-14 03:04:09,966 R@1 : 45.679
2020-09-14 03:04:10,690 R@2 : 54.461
2020-09-14 03:04:11,419 R@4 : 63.327
2020-09-14 03:04:12,151 R@8 : 71.801
2020-09-14 03:06:15,879 Epoch: 8, loss: 1.605, time (seconds): 123.73.
2020-09-14 03:06:15,880 **Evaluating.**
2020-09-14 03:08:06,263 NMI: 25.656
2020-09-14 03:09:38,748 R@1 : 44.758
2020-09-14 03:09:39,472 R@2 : 53.648
2020-09-14 03:09:40,196 R@4 : 62.462
2020-09-14 03:09:40,940 R@8 : 70.989
2020-09-14 03:11:45,659 Epoch: 9, loss: 1.538, time (seconds): 124.72.
2020-09-14 03:11:45,660 **Evaluating.**
2020-09-14 03:13:35,964 NMI: 25.870
2020-09-14 03:15:09,805 R@1 : 45.005
2020-09-14 03:15:10,533 R@2 : 54.124
2020-09-14 03:15:11,263 R@4 : 62.778
2020-09-14 03:15:11,995 R@8 : 71.229
2020-09-14 03:17:16,628 Epoch: 10, loss: 1.494, time (seconds): 124.63.
2020-09-14 03:17:16,629 **Evaluating.**
2020-09-14 03:19:05,484 NMI: 25.657
2020-09-14 03:20:38,943 R@1 : 44.941
2020-09-14 03:20:39,667 R@2 : 53.398
2020-09-14 03:20:40,395 R@4 : 62.174
2020-09-14 03:20:41,128 R@8 : 70.594
2020-09-14 03:22:45,126 Epoch: 11, loss: 1.447, time (seconds): 124.00.
2020-09-14 03:22:45,127 **Evaluating.**
2020-09-14 03:24:33,364 NMI: 25.365
2020-09-14 03:26:06,386 R@1 : 43.649
2020-09-14 03:26:07,114 R@2 : 52.341
2020-09-14 03:26:07,847 R@4 : 61.298
2020-09-14 03:26:08,577 R@8 : 69.688
2020-09-14 03:28:13,216 Epoch: 12, loss: 1.389, time (seconds): 124.64.
2020-09-14 03:28:13,217 **Evaluating.**
2020-09-14 03:30:07,031 NMI: 24.947
2020-09-14 03:31:40,424 R@1 : 42.834
2020-09-14 03:31:41,147 R@2 : 51.903
2020-09-14 03:31:41,869 R@4 : 61.019
2020-09-14 03:31:42,588 R@8 : 69.543
2020-09-14 03:33:47,519 Epoch: 13, loss: 1.389, time (seconds): 124.93.
2020-09-14 03:33:47,520 **Evaluating.**
2020-09-14 03:35:39,867 NMI: 25.175
2020-09-14 03:37:13,009 R@1 : 42.915
2020-09-14 03:37:13,742 R@2 : 51.642
2020-09-14 03:37:14,470 R@4 : 60.833
2020-09-14 03:37:15,193 R@8 : 69.508
2020-09-14 03:39:20,439 Epoch: 14, loss: 1.334, time (seconds): 125.24.
2020-09-14 03:39:20,440 **Evaluating.**
2020-09-14 03:41:12,876 NMI: 24.797
2020-09-14 03:42:46,883 R@1 : 42.738
2020-09-14 03:42:47,610 R@2 : 51.206
2020-09-14 03:42:48,333 R@4 : 60.064
2020-09-14 03:42:49,052 R@8 : 68.573
2020-09-14 03:44:52,912 Epoch: 15, loss: 1.346, time (seconds): 123.86.
2020-09-14 03:44:52,913 **Evaluating.**
2020-09-14 03:46:46,687 NMI: 24.213
2020-09-14 03:48:20,768 R@1 : 41.649
2020-09-14 03:48:21,541 R@2 : 50.161
2020-09-14 03:48:22,313 R@4 : 59.126
2020-09-14 03:48:23,087 R@8 : 67.981
2020-09-14 03:50:27,619 Epoch: 16, loss: 1.234, time (seconds): 124.53.
2020-09-14 03:50:27,619 **Evaluating.**
2020-09-14 03:52:18,205 NMI: 23.807
2020-09-14 03:53:52,461 R@1 : 41.362
2020-09-14 03:53:53,186 R@2 : 49.563
2020-09-14 03:53:53,902 R@4 : 58.540
2020-09-14 03:53:54,627 R@8 : 67.290
2020-09-14 03:55:58,436 Epoch: 17, loss: 1.263, time (seconds): 123.81.
2020-09-14 03:55:58,436 **Evaluating.**
2020-09-14 03:57:48,986 NMI: 23.960
2020-09-14 03:59:22,468 R@1 : 41.388
2020-09-14 03:59:23,235 R@2 : 49.807
2020-09-14 03:59:24,002 R@4 : 58.726
2020-09-14 03:59:24,773 R@8 : 67.418
2020-09-14 04:01:29,250 Epoch: 18, loss: 1.245, time (seconds): 124.48.
2020-09-14 04:01:29,251 **Evaluating.**
2020-09-14 04:03:17,757 NMI: 23.697
2020-09-14 04:04:51,136 R@1 : 41.266
2020-09-14 04:04:51,856 R@2 : 49.781
2020-09-14 04:04:52,580 R@4 : 58.557
2020-09-14 04:04:53,303 R@8 : 67.304
2020-09-14 04:06:56,959 Epoch: 19, loss: 1.242, time (seconds): 123.65.
2020-09-14 04:06:56,960 **Evaluating.**
2020-09-14 04:08:47,946 NMI: 23.388
2020-09-14 04:10:21,096 R@1 : 40.781
2020-09-14 04:10:21,869 R@2 : 49.183
2020-09-14 04:10:22,643 R@4 : 58.101
2020-09-14 04:10:23,415 R@8 : 66.869
2020-09-14 04:10:23,418 Total training time (minutes): 113.68.
2020-09-14 04:10:25,479 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 64, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 12, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200914-002423', 'results_filename': 'food-results.csv', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 128}
2020-09-14 04:10:25,480 Training for 20 epochs
2020-09-14 04:10:25,482 **Evaluating initial model.**
2020-09-14 04:12:11,017 NMI: 24.435
2020-09-14 04:13:47,207 R@1 : 42.006
2020-09-14 04:13:47,925 R@2 : 50.544
2020-09-14 04:13:48,647 R@4 : 59.936
2020-09-14 04:13:49,369 R@8 : 69.261
2020-09-14 04:15:53,083 Epoch: 0, loss: 2.292, time (seconds): 123.71.
2020-09-14 04:15:53,084 **Evaluating.**
2020-09-14 04:17:43,679 NMI: 30.847
2020-09-14 04:19:12,716 R@1 : 47.473
2020-09-14 04:19:13,441 R@2 : 56.746
2020-09-14 04:19:14,172 R@4 : 66.129
2020-09-14 04:19:14,898 R@8 : 74.620
2020-09-14 04:21:19,585 Epoch: 1, loss: 2.060, time (seconds): 124.68.
2020-09-14 04:21:19,585 **Evaluating.**
2020-09-14 04:23:15,164 NMI: 30.986
2020-09-14 04:24:47,631 R@1 : 49.284
2020-09-14 04:24:48,447 R@2 : 58.476
2020-09-14 04:24:49,259 R@4 : 67.328
2020-09-14 04:24:50,076 R@8 : 75.439
2020-09-14 04:26:55,034 Epoch: 2, loss: 1.975, time (seconds): 124.96.
2020-09-14 04:26:55,035 **Evaluating.**
2020-09-14 04:28:48,547 NMI: 31.491
2020-09-14 04:30:21,051 R@1 : 49.572
2020-09-14 04:30:21,781 R@2 : 58.737
2020-09-14 04:30:22,506 R@4 : 67.542
2020-09-14 04:30:23,235 R@8 : 75.747
2020-09-14 04:32:27,441 Epoch: 3, loss: 1.834, time (seconds): 124.20.
2020-09-14 04:32:27,442 **Evaluating.**
2020-09-14 04:34:19,754 NMI: 31.809
2020-09-14 04:35:52,608 R@1 : 49.659
2020-09-14 04:35:53,331 R@2 : 58.908
2020-09-14 04:35:54,053 R@4 : 67.905
2020-09-14 04:35:54,777 R@8 : 76.432
2020-09-14 04:38:00,338 Epoch: 4, loss: 1.756, time (seconds): 125.56.
2020-09-14 04:38:00,340 **Evaluating.**
2020-09-14 04:39:51,182 NMI: 31.941
2020-09-14 04:41:23,799 R@1 : 50.074
2020-09-14 04:41:24,522 R@2 : 59.245
2020-09-14 04:41:25,249 R@4 : 68.170
2020-09-14 04:41:25,976 R@8 : 76.249
2020-09-14 04:43:29,987 Epoch: 5, loss: 1.663, time (seconds): 124.01.
2020-09-14 04:43:29,988 **Evaluating.**
2020-09-14 04:45:22,103 NMI: 30.672
2020-09-14 04:46:54,079 R@1 : 49.752
2020-09-14 04:46:54,804 R@2 : 58.734
2020-09-14 04:46:55,531 R@4 : 67.496
2020-09-14 04:46:56,256 R@8 : 75.822
2020-09-14 04:49:01,420 Epoch: 6, loss: 1.614, time (seconds): 125.16.
2020-09-14 04:49:01,421 **Evaluating.**
2020-09-14 04:50:54,342 NMI: 30.407
2020-09-14 04:52:26,850 R@1 : 49.398
2020-09-14 04:52:27,620 R@2 : 58.493
2020-09-14 04:52:28,382 R@4 : 67.473
2020-09-14 04:52:29,122 R@8 : 75.486
2020-09-14 04:54:34,780 Epoch: 7, loss: 1.629, time (seconds): 125.66.
2020-09-14 04:54:34,781 **Evaluating.**
2020-09-14 04:56:30,251 NMI: 30.141
2020-09-14 04:58:04,365 R@1 : 48.779
2020-09-14 04:58:05,097 R@2 : 57.791
2020-09-14 04:58:05,823 R@4 : 66.454
2020-09-14 04:58:06,551 R@8 : 74.800
2020-09-14 05:00:11,203 Epoch: 8, loss: 1.563, time (seconds): 124.65.
2020-09-14 05:00:11,204 **Evaluating.**
2020-09-14 05:02:04,542 NMI: 29.849
2020-09-14 05:03:37,950 R@1 : 48.657
2020-09-14 05:03:38,686 R@2 : 57.683
2020-09-14 05:03:39,405 R@4 : 66.375
2020-09-14 05:03:40,133 R@8 : 74.867
2020-09-14 05:05:43,832 Epoch: 9, loss: 1.516, time (seconds): 123.70.
2020-09-14 05:05:43,833 **Evaluating.**
2020-09-14 05:07:35,877 NMI: 30.773
2020-09-14 05:09:09,865 R@1 : 48.773
2020-09-14 05:09:10,583 R@2 : 57.599
2020-09-14 05:09:11,310 R@4 : 66.608
2020-09-14 05:09:12,034 R@8 : 74.870
2020-09-14 05:11:16,448 Epoch: 10, loss: 1.470, time (seconds): 124.41.
2020-09-14 05:11:16,448 **Evaluating.**
2020-09-14 05:13:08,602 NMI: 30.394
2020-09-14 05:14:42,203 R@1 : 49.107
2020-09-14 05:14:42,926 R@2 : 58.011
2020-09-14 05:14:43,652 R@4 : 66.657
2020-09-14 05:14:44,373 R@8 : 74.946
2020-09-14 05:16:48,676 Epoch: 11, loss: 1.424, time (seconds): 124.30.
2020-09-14 05:16:48,677 **Evaluating.**
2020-09-14 05:18:43,449 NMI: 30.594
2020-09-14 05:20:17,226 R@1 : 48.759
2020-09-14 05:20:17,949 R@2 : 57.300
2020-09-14 05:20:18,674 R@4 : 66.088
2020-09-14 05:20:19,395 R@8 : 74.307
2020-09-14 05:22:23,013 Epoch: 12, loss: 1.344, time (seconds): 123.61.
2020-09-14 05:22:23,014 **Evaluating.**
2020-09-14 05:24:14,990 NMI: 29.578
2020-09-14 05:25:49,291 R@1 : 47.978
2020-09-14 05:25:50,016 R@2 : 56.746
2020-09-14 05:25:50,739 R@4 : 65.397
2020-09-14 05:25:51,458 R@8 : 73.651
2020-09-14 05:27:56,867 Epoch: 13, loss: 1.350, time (seconds): 125.41.
2020-09-14 05:27:56,868 **Evaluating.**
2020-09-14 05:29:49,419 NMI: 29.602
2020-09-14 05:31:22,693 R@1 : 47.998
2020-09-14 05:31:23,418 R@2 : 56.859
2020-09-14 05:31:24,137 R@4 : 65.574
2020-09-14 05:31:24,870 R@8 : 73.874
2020-09-14 05:33:28,952 Epoch: 14, loss: 1.280, time (seconds): 124.08.
2020-09-14 05:33:28,953 **Evaluating.**
2020-09-14 05:35:22,920 NMI: 29.253
2020-09-14 05:36:57,028 R@1 : 47.853
2020-09-14 05:36:57,755 R@2 : 56.301
2020-09-14 05:36:58,476 R@4 : 65.057
2020-09-14 05:36:59,205 R@8 : 73.619
2020-09-14 05:39:04,782 Epoch: 15, loss: 1.276, time (seconds): 125.57.
2020-09-14 05:39:04,783 **Evaluating.**
2020-09-14 05:40:59,275 NMI: 28.839
2020-09-14 05:42:34,426 R@1 : 47.011
2020-09-14 05:42:35,155 R@2 : 55.474
2020-09-14 05:42:35,884 R@4 : 64.314
2020-09-14 05:42:36,614 R@8 : 72.669
2020-09-14 05:44:40,991 Epoch: 16, loss: 1.224, time (seconds): 124.37.
2020-09-14 05:44:40,992 **Evaluating.**
2020-09-14 05:46:33,182 NMI: 27.858
2020-09-14 05:48:08,897 R@1 : 46.730
2020-09-14 05:48:09,622 R@2 : 55.541
2020-09-14 05:48:10,343 R@4 : 64.375
2020-09-14 05:48:11,061 R@8 : 72.998
2020-09-14 05:50:16,207 Epoch: 17, loss: 1.240, time (seconds): 125.14.
2020-09-14 05:50:16,207 **Evaluating.**
2020-09-14 05:52:07,447 NMI: 29.211
2020-09-14 05:53:42,216 R@1 : 47.348
2020-09-14 05:53:42,945 R@2 : 55.944
2020-09-14 05:53:43,678 R@4 : 64.750
2020-09-14 05:53:44,401 R@8 : 72.971
2020-09-14 05:55:48,939 Epoch: 18, loss: 1.204, time (seconds): 124.54.
2020-09-14 05:55:48,939 **Evaluating.**
2020-09-14 05:57:42,904 NMI: 28.491
2020-09-14 05:59:18,142 R@1 : 46.831
2020-09-14 05:59:18,874 R@2 : 55.210
2020-09-14 05:59:19,602 R@4 : 64.027
2020-09-14 05:59:20,330 R@8 : 72.167
2020-09-14 06:01:24,729 Epoch: 19, loss: 1.176, time (seconds): 124.40.
2020-09-14 06:01:24,730 **Evaluating.**
2020-09-14 06:03:17,327 NMI: 28.634
2020-09-14 06:04:52,769 R@1 : 46.939
2020-09-14 06:04:53,501 R@2 : 55.427
2020-09-14 06:04:54,231 R@4 : 63.899
2020-09-14 06:04:54,963 R@8 : 72.109
2020-09-14 06:04:54,967 Total training time (minutes): 114.49.
2020-09-14 06:04:57,036 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 64, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 12, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food-20200914-002423', 'results_filename': 'food-results.csv', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 128}
2020-09-14 06:04:57,037 Training for 20 epochs
2020-09-14 06:04:57,038 **Evaluating initial model.**
2020-09-14 06:06:44,380 NMI: 24.435
2020-09-14 06:08:20,182 R@1 : 42.006
2020-09-14 06:08:20,904 R@2 : 50.544
2020-09-14 06:08:21,634 R@4 : 59.936
2020-09-14 06:08:22,357 R@8 : 69.261
2020-09-14 06:10:25,990 Epoch: 0, loss: 2.180, time (seconds): 123.63.
2020-09-14 06:10:25,990 **Evaluating.**
2020-09-14 06:12:14,355 NMI: 31.123
2020-09-14 06:13:45,499 R@1 : 49.528
2020-09-14 06:13:46,221 R@2 : 58.519
2020-09-14 06:13:46,954 R@4 : 67.383
2020-09-14 06:13:47,675 R@8 : 75.131
2020-09-14 06:15:52,622 Epoch: 1, loss: 1.994, time (seconds): 124.94.
2020-09-14 06:15:52,623 **Evaluating.**
2020-09-14 06:17:45,955 NMI: 29.827
2020-09-14 06:19:18,598 R@1 : 48.611
2020-09-14 06:19:19,491 R@2 : 57.573
2020-09-14 06:19:20,389 R@4 : 66.651
2020-09-14 06:19:21,286 R@8 : 74.710
2020-09-14 06:21:25,430 Epoch: 2, loss: 1.916, time (seconds): 124.14.
2020-09-14 06:21:25,431 **Evaluating.**
2020-09-14 06:23:17,709 NMI: 30.107
2020-09-14 06:24:49,359 R@1 : 48.434
2020-09-14 06:24:50,132 R@2 : 57.413
2020-09-14 06:24:50,909 R@4 : 66.282
2020-09-14 06:24:51,685 R@8 : 74.493
2020-09-14 06:26:56,459 Epoch: 3, loss: 1.788, time (seconds): 124.77.
2020-09-14 06:26:56,460 **Evaluating.**
2020-09-14 06:28:47,153 NMI: 28.944
2020-09-14 06:30:19,207 R@1 : 47.749
2020-09-14 06:30:19,925 R@2 : 56.557
2020-09-14 06:30:20,646 R@4 : 65.580
2020-09-14 06:30:21,376 R@8 : 73.857
2020-09-14 06:32:27,003 Epoch: 4, loss: 1.735, time (seconds): 125.62.
2020-09-14 06:32:27,003 **Evaluating.**
2020-09-14 06:34:18,983 NMI: 28.027
2020-09-14 06:35:51,423 R@1 : 47.264
2020-09-14 06:35:52,141 R@2 : 56.412
2020-09-14 06:35:52,861 R@4 : 65.351
2020-09-14 06:35:53,583 R@8 : 73.723
2020-09-14 06:37:57,654 Epoch: 5, loss: 1.644, time (seconds): 124.07.
2020-09-14 06:37:57,654 **Evaluating.**
2020-09-14 06:39:48,987 NMI: 28.243
2020-09-14 06:41:20,382 R@1 : 46.303
2020-09-14 06:41:21,109 R@2 : 55.181
2020-09-14 06:41:21,837 R@4 : 63.925
2020-09-14 06:41:22,567 R@8 : 72.440
2020-09-14 06:43:27,991 Epoch: 6, loss: 1.611, time (seconds): 125.42.
2020-09-14 06:43:27,992 **Evaluating.**
2020-09-14 06:45:20,598 NMI: 28.070
2020-09-14 06:46:51,787 R@1 : 46.294
2020-09-14 06:46:52,515 R@2 : 55.128
2020-09-14 06:46:53,235 R@4 : 64.093
2020-09-14 06:46:53,959 R@8 : 72.667
2020-09-14 06:48:58,264 Epoch: 7, loss: 1.637, time (seconds): 124.30.
2020-09-14 06:48:58,265 **Evaluating.**
2020-09-14 06:50:50,752 NMI: 27.502
2020-09-14 06:52:22,810 R@1 : 45.583
2020-09-14 06:52:23,546 R@2 : 54.365
2020-09-14 06:52:24,271 R@4 : 63.266
2020-09-14 06:52:24,997 R@8 : 71.871
2020-09-14 06:54:29,059 Epoch: 8, loss: 1.595, time (seconds): 124.06.
2020-09-14 06:54:29,060 **Evaluating.**
2020-09-14 06:56:21,304 NMI: 26.002
2020-09-14 06:57:54,395 R@1 : 44.546
2020-09-14 06:57:55,205 R@2 : 53.308
2020-09-14 06:57:56,019 R@4 : 62.453
2020-09-14 06:57:56,827 R@8 : 71.279
2020-09-14 07:00:01,886 Epoch: 9, loss: 1.512, time (seconds): 125.06.
2020-09-14 07:00:01,888 **Evaluating.**
2020-09-14 07:01:53,401 NMI: 25.510
2020-09-14 07:03:26,658 R@1 : 44.837
2020-09-14 07:03:27,382 R@2 : 53.517
2020-09-14 07:03:28,108 R@4 : 62.172
2020-09-14 07:03:28,828 R@8 : 70.890
2020-09-14 07:05:32,632 Epoch: 10, loss: 1.481, time (seconds): 123.80.
2020-09-14 07:05:32,633 **Evaluating.**
2020-09-14 07:07:25,977 NMI: 26.446
2020-09-14 07:08:57,823 R@1 : 44.488
2020-09-14 07:08:58,548 R@2 : 53.410
2020-09-14 07:08:59,267 R@4 : 62.442
2020-09-14 07:08:59,986 R@8 : 70.745
2020-09-14 07:11:05,567 Epoch: 11, loss: 1.449, time (seconds): 125.58.
2020-09-14 07:11:05,568 **Evaluating.**
2020-09-14 07:12:58,213 NMI: 25.472
2020-09-14 07:14:30,707 R@1 : 43.989
2020-09-14 07:14:31,424 R@2 : 52.565
2020-09-14 07:14:32,147 R@4 : 61.353
2020-09-14 07:14:32,872 R@8 : 70.266
2020-09-14 07:16:38,525 Epoch: 12, loss: 1.401, time (seconds): 125.65.
2020-09-14 07:16:38,526 **Evaluating.**
2020-09-14 07:18:30,849 NMI: 25.126
2020-09-14 07:20:03,035 R@1 : 43.597
2020-09-14 07:20:03,763 R@2 : 52.286
2020-09-14 07:20:04,490 R@4 : 61.054
2020-09-14 07:20:05,218 R@8 : 69.763
2020-09-14 07:22:10,890 Epoch: 13, loss: 1.404, time (seconds): 125.67.
2020-09-14 07:22:10,891 **Evaluating.**
2020-09-14 07:24:05,573 NMI: 25.302
2020-09-14 07:25:37,418 R@1 : 43.443
2020-09-14 07:25:38,147 R@2 : 52.159
2020-09-14 07:25:38,880 R@4 : 60.848
2020-09-14 07:25:39,608 R@8 : 69.430
2020-09-14 07:27:43,862 Epoch: 14, loss: 1.318, time (seconds): 124.25.
2020-09-14 07:27:43,862 **Evaluating.**
2020-09-14 07:29:35,196 NMI: 25.103
2020-09-14 07:31:08,501 R@1 : 42.781
2020-09-14 07:31:09,221 R@2 : 51.523
2020-09-14 07:31:09,946 R@4 : 60.290
2020-09-14 07:31:10,670 R@8 : 68.875
2020-09-14 07:33:16,023 Epoch: 15, loss: 1.334, time (seconds): 125.35.
2020-09-14 07:33:16,024 **Evaluating.**
2020-09-14 07:35:06,758 NMI: 24.517
2020-09-14 07:36:40,153 R@1 : 41.797
2020-09-14 07:36:40,876 R@2 : 50.280
2020-09-14 07:36:41,607 R@4 : 59.312
2020-09-14 07:36:42,331 R@8 : 68.036
2020-09-14 07:38:46,877 Epoch: 16, loss: 1.225, time (seconds): 124.54.
2020-09-14 07:38:46,878 **Evaluating.**
2020-09-14 07:40:34,036 NMI: 23.663
2020-09-14 07:42:08,193 R@1 : 41.698
2020-09-14 07:42:08,923 R@2 : 49.848
2020-09-14 07:42:09,651 R@4 : 58.778
2020-09-14 07:42:10,380 R@8 : 67.531
2020-09-14 07:44:16,251 Epoch: 17, loss: 1.245, time (seconds): 125.87.
2020-09-14 07:44:16,252 **Evaluating.**
2020-09-14 07:46:05,736 NMI: 24.243
2020-09-14 07:47:39,888 R@1 : 41.669
2020-09-14 07:47:40,609 R@2 : 49.993
2020-09-14 07:47:41,331 R@4 : 58.807
2020-09-14 07:47:42,058 R@8 : 67.754
2020-09-14 07:49:46,855 Epoch: 18, loss: 1.237, time (seconds): 124.79.
2020-09-14 07:49:46,857 **Evaluating.**
2020-09-14 07:51:38,706 NMI: 23.763
2020-09-14 07:53:12,352 R@1 : 41.004
2020-09-14 07:53:13,080 R@2 : 49.218
2020-09-14 07:53:13,809 R@4 : 58.139
2020-09-14 07:53:14,536 R@8 : 67.316
2020-09-14 07:55:19,276 Epoch: 19, loss: 1.251, time (seconds): 124.74.
2020-09-14 07:55:19,277 **Evaluating.**
2020-09-14 07:57:09,503 NMI: 23.877
2020-09-14 07:58:43,210 R@1 : 41.257
2020-09-14 07:58:43,930 R@2 : 49.403
2020-09-14 07:58:44,653 R@4 : 58.255
2020-09-14 07:58:45,378 R@8 : 67.290
2020-09-14 07:58:45,381 Total training time (minutes): 113.81.
2020-09-14 07:58:47,428 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 64, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 12, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food-20200914-002423', 'results_filename': 'food-results.csv', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 128}
2020-09-14 07:58:47,428 Training for 20 epochs
2020-09-14 07:58:47,430 **Evaluating initial model.**
2020-09-14 08:00:33,136 NMI: 24.435
2020-09-14 08:02:08,873 R@1 : 42.006
2020-09-14 08:02:09,596 R@2 : 50.544
2020-09-14 08:02:10,325 R@4 : 59.936
2020-09-14 08:02:11,055 R@8 : 69.261
2020-09-14 08:04:14,802 Epoch: 0, loss: 2.321, time (seconds): 123.75.
2020-09-14 08:04:14,803 **Evaluating.**
2020-09-14 08:06:05,060 NMI: 30.607
2020-09-14 08:07:33,946 R@1 : 46.936
2020-09-14 08:07:34,671 R@2 : 56.179
2020-09-14 08:07:35,398 R@4 : 65.644
2020-09-14 08:07:36,130 R@8 : 74.594
2020-09-14 08:09:40,413 Epoch: 1, loss: 2.096, time (seconds): 124.28.
2020-09-14 08:09:40,414 **Evaluating.**
2020-09-14 08:11:35,629 NMI: 31.292
2020-09-14 08:13:07,428 R@1 : 48.942
2020-09-14 08:13:08,323 R@2 : 57.994
2020-09-14 08:13:09,219 R@4 : 66.759
2020-09-14 08:13:10,110 R@8 : 75.184
2020-09-14 08:15:14,335 Epoch: 2, loss: 1.987, time (seconds): 124.22.
2020-09-14 08:15:14,336 **Evaluating.**
2020-09-14 08:17:07,113 NMI: 31.338
2020-09-14 08:18:39,467 R@1 : 49.264
2020-09-14 08:18:40,191 R@2 : 58.699
2020-09-14 08:18:40,913 R@4 : 67.630
2020-09-14 08:18:41,644 R@8 : 75.892
2020-09-14 08:20:46,541 Epoch: 3, loss: 1.847, time (seconds): 124.89.
2020-09-14 08:20:46,542 **Evaluating.**
2020-09-14 08:22:38,923 NMI: 31.686
2020-09-14 08:24:11,218 R@1 : 50.004
2020-09-14 08:24:11,942 R@2 : 58.595
2020-09-14 08:24:12,672 R@4 : 67.548
2020-09-14 08:24:13,402 R@8 : 75.735
2020-09-14 08:26:16,975 Epoch: 4, loss: 1.762, time (seconds): 123.57.
2020-09-14 08:26:16,976 **Evaluating.**
2020-09-14 08:28:07,327 NMI: 31.835
2020-09-14 08:29:39,578 R@1 : 49.964
2020-09-14 08:29:40,349 R@2 : 58.978
2020-09-14 08:29:41,118 R@4 : 67.876
2020-09-14 08:29:41,885 R@8 : 76.095
2020-09-14 08:31:45,775 Epoch: 5, loss: 1.682, time (seconds): 123.89.
2020-09-14 08:31:45,776 **Evaluating.**
2020-09-14 08:33:40,635 NMI: 30.779
2020-09-14 08:35:13,659 R@1 : 49.427
2020-09-14 08:35:14,388 R@2 : 58.447
2020-09-14 08:35:15,116 R@4 : 67.473
2020-09-14 08:35:15,841 R@8 : 75.817
2020-09-14 08:37:21,392 Epoch: 6, loss: 1.636, time (seconds): 125.55.
2020-09-14 08:37:21,393 **Evaluating.**
2020-09-14 08:39:17,552 NMI: 30.469
2020-09-14 08:40:50,217 R@1 : 49.598
2020-09-14 08:40:50,992 R@2 : 58.467
2020-09-14 08:40:51,764 R@4 : 67.336
2020-09-14 08:40:52,537 R@8 : 75.622
2020-09-14 08:42:56,381 Epoch: 7, loss: 1.652, time (seconds): 123.84.
2020-09-14 08:42:56,382 **Evaluating.**
2020-09-14 08:44:51,039 NMI: 30.264
2020-09-14 08:46:23,811 R@1 : 49.035
2020-09-14 08:46:24,546 R@2 : 57.727
2020-09-14 08:46:25,273 R@4 : 66.672
2020-09-14 08:46:25,996 R@8 : 75.172
2020-09-14 08:48:31,246 Epoch: 8, loss: 1.573, time (seconds): 125.25.
2020-09-14 08:48:31,247 **Evaluating.**
2020-09-14 08:50:24,256 NMI: 30.104
2020-09-14 08:51:57,881 R@1 : 48.669
2020-09-14 08:51:58,665 R@2 : 57.614
2020-09-14 08:51:59,453 R@4 : 66.431
2020-09-14 08:52:00,223 R@8 : 74.972
2020-09-14 08:54:04,469 Epoch: 9, loss: 1.534, time (seconds): 124.24.
2020-09-14 08:54:04,470 **Evaluating.**
2020-09-14 08:55:56,871 NMI: 30.653
2020-09-14 08:57:31,520 R@1 : 49.255
2020-09-14 08:57:32,247 R@2 : 57.933
2020-09-14 08:57:32,978 R@4 : 66.921
2020-09-14 08:57:33,712 R@8 : 74.983
2020-09-14 08:59:38,165 Epoch: 10, loss: 1.490, time (seconds): 124.45.
2020-09-14 08:59:38,167 **Evaluating.**
2020-09-14 09:01:30,322 NMI: 29.880
2020-09-14 09:03:03,806 R@1 : 48.936
2020-09-14 09:03:04,528 R@2 : 58.014
2020-09-14 09:03:05,248 R@4 : 66.898
2020-09-14 09:03:05,970 R@8 : 75.053
2020-09-14 09:05:09,880 Epoch: 11, loss: 1.435, time (seconds): 123.91.
2020-09-14 09:05:09,880 **Evaluating.**
2020-09-14 09:07:02,828 NMI: 30.062
2020-09-14 09:08:37,006 R@1 : 48.379
2020-09-14 09:08:37,743 R@2 : 57.280
2020-09-14 09:08:38,468 R@4 : 66.085
2020-09-14 09:08:39,194 R@8 : 74.443
2020-09-14 09:10:43,602 Epoch: 12, loss: 1.378, time (seconds): 124.40.
2020-09-14 09:10:43,603 **Evaluating.**
2020-09-14 09:12:34,246 NMI: 29.000
2020-09-14 09:14:08,158 R@1 : 48.231
2020-09-14 09:14:08,885 R@2 : 56.624
2020-09-14 09:14:09,606 R@4 : 65.452
2020-09-14 09:14:10,328 R@8 : 73.988
2020-09-14 09:16:14,403 Epoch: 13, loss: 1.363, time (seconds): 124.07.
2020-09-14 09:16:14,404 **Evaluating.**
2020-09-14 09:18:04,907 NMI: 29.604
2020-09-14 09:19:38,490 R@1 : 48.312
2020-09-14 09:19:39,213 R@2 : 56.725
2020-09-14 09:19:39,939 R@4 : 65.310
2020-09-14 09:19:40,665 R@8 : 73.886
2020-09-14 09:21:45,258 Epoch: 14, loss: 1.309, time (seconds): 124.59.
2020-09-14 09:21:45,259 **Evaluating.**
2020-09-14 09:23:34,576 NMI: 29.295
2020-09-14 09:25:08,547 R@1 : 47.952
2020-09-14 09:25:09,284 R@2 : 56.522
2020-09-14 09:25:10,018 R@4 : 65.237
2020-09-14 09:25:10,743 R@8 : 73.265
2020-09-14 09:27:15,399 Epoch: 15, loss: 1.302, time (seconds): 124.65.
2020-09-14 09:27:15,400 **Evaluating.**
2020-09-14 09:29:06,741 NMI: 28.809
2020-09-14 09:30:41,519 R@1 : 46.802
2020-09-14 09:30:42,242 R@2 : 55.413
2020-09-14 09:30:42,961 R@4 : 63.754
2020-09-14 09:30:43,684 R@8 : 72.548
2020-09-14 09:32:48,375 Epoch: 16, loss: 1.225, time (seconds): 124.69.
2020-09-14 09:32:48,376 **Evaluating.**
2020-09-14 09:34:38,747 NMI: 28.108
2020-09-14 09:36:14,468 R@1 : 46.590
2020-09-14 09:36:15,192 R@2 : 55.247
2020-09-14 09:36:15,915 R@4 : 63.884
2020-09-14 09:36:16,638 R@8 : 72.710
2020-09-14 09:38:21,815 Epoch: 17, loss: 1.230, time (seconds): 125.17.
2020-09-14 09:38:21,816 **Evaluating.**
2020-09-14 09:40:16,410 NMI: 28.580
2020-09-14 09:41:52,188 R@1 : 47.191
2020-09-14 09:41:52,918 R@2 : 55.666
2020-09-14 09:41:53,650 R@4 : 64.468
2020-09-14 09:41:54,382 R@8 : 73.105
2020-09-14 09:43:58,726 Epoch: 18, loss: 1.221, time (seconds): 124.34.
2020-09-14 09:43:58,727 **Evaluating.**
2020-09-14 09:45:48,962 NMI: 28.420
2020-09-14 09:47:25,025 R@1 : 46.309
2020-09-14 09:47:25,800 R@2 : 54.754
2020-09-14 09:47:26,575 R@4 : 63.548
2020-09-14 09:47:27,350 R@8 : 72.173
2020-09-14 09:49:32,894 Epoch: 19, loss: 1.186, time (seconds): 125.54.
2020-09-14 09:49:32,896 **Evaluating.**
2020-09-14 09:51:23,661 NMI: 28.363
2020-09-14 09:52:59,014 R@1 : 46.190
2020-09-14 09:52:59,738 R@2 : 54.789
2020-09-14 09:53:00,463 R@4 : 63.577
2020-09-14 09:53:01,189 R@8 : 72.185
2020-09-14 09:53:01,192 Total training time (minutes): 114.23.
2020-09-14 09:53:03,255 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 64, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 12, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200914-002423', 'results_filename': 'food-results.csv', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 128}
2020-09-14 09:53:03,256 Training for 20 epochs
2020-09-14 09:53:03,257 **Evaluating initial model.**
2020-09-14 09:54:49,116 NMI: 24.435
2020-09-14 09:56:24,700 R@1 : 42.006
2020-09-14 09:56:25,435 R@2 : 50.544
2020-09-14 09:56:26,154 R@4 : 59.936
2020-09-14 09:56:26,881 R@8 : 69.261
2020-09-14 09:58:30,407 Epoch: 0, loss: 2.593, time (seconds): 123.52.
2020-09-14 09:58:30,408 **Evaluating.**
2020-09-14 10:00:20,618 NMI: 28.690
2020-09-14 10:01:48,881 R@1 : 43.667
2020-09-14 10:01:49,606 R@2 : 52.948
2020-09-14 10:01:50,324 R@4 : 62.529
2020-09-14 10:01:51,042 R@8 : 72.115
2020-09-14 10:03:56,456 Epoch: 1, loss: 2.284, time (seconds): 125.41.
2020-09-14 10:03:56,457 **Evaluating.**
2020-09-14 10:05:49,922 NMI: 28.957
2020-09-14 10:07:19,083 R@1 : 45.281
2020-09-14 10:07:19,818 R@2 : 54.435
2020-09-14 10:07:20,539 R@4 : 63.855
2020-09-14 10:07:21,263 R@8 : 72.728
2020-09-14 10:09:24,921 Epoch: 2, loss: 2.110, time (seconds): 123.66.
2020-09-14 10:09:24,922 **Evaluating.**
2020-09-14 10:11:18,454 NMI: 29.739
2020-09-14 10:12:50,147 R@1 : 46.454
2020-09-14 10:12:50,866 R@2 : 55.834
2020-09-14 10:12:51,586 R@4 : 64.999
2020-09-14 10:12:52,308 R@8 : 73.808
2020-09-14 10:14:57,210 Epoch: 3, loss: 1.980, time (seconds): 124.90.
2020-09-14 10:14:57,211 **Evaluating.**
2020-09-14 10:16:50,362 NMI: 30.152
2020-09-14 10:18:21,597 R@1 : 47.650
2020-09-14 10:18:22,369 R@2 : 57.007
2020-09-14 10:18:23,141 R@4 : 66.329
2020-09-14 10:18:23,917 R@8 : 75.033
2020-09-14 10:20:27,762 Epoch: 4, loss: 1.867, time (seconds): 123.84.
2020-09-14 10:20:27,762 **Evaluating.**
2020-09-14 10:22:22,209 NMI: 30.114
2020-09-14 10:23:52,508 R@1 : 47.525
2020-09-14 10:23:53,229 R@2 : 56.624
2020-09-14 10:23:53,955 R@4 : 65.806
2020-09-14 10:23:54,684 R@8 : 74.638
2020-09-14 10:25:59,102 Epoch: 5, loss: 1.738, time (seconds): 124.42.
2020-09-14 10:25:59,103 **Evaluating.**
2020-09-14 10:27:50,957 NMI: 29.310
2020-09-14 10:29:23,213 R@1 : 47.084
2020-09-14 10:29:23,938 R@2 : 56.397
2020-09-14 10:29:24,666 R@4 : 65.864
2020-09-14 10:29:25,396 R@8 : 74.554
2020-09-14 10:31:30,057 Epoch: 6, loss: 1.705, time (seconds): 124.66.
2020-09-14 10:31:30,058 **Evaluating.**
2020-09-14 10:33:21,219 NMI: 29.032
2020-09-14 10:34:52,211 R@1 : 46.944
2020-09-14 10:34:52,936 R@2 : 56.281
2020-09-14 10:34:53,666 R@4 : 65.568
2020-09-14 10:34:54,387 R@8 : 74.313
2020-09-14 10:36:59,663 Epoch: 7, loss: 1.726, time (seconds): 125.27.
2020-09-14 10:36:59,664 **Evaluating.**
2020-09-14 10:38:50,683 NMI: 29.275
2020-09-14 10:40:23,130 R@1 : 47.380
2020-09-14 10:40:23,856 R@2 : 56.615
2020-09-14 10:40:24,584 R@4 : 65.774
2020-09-14 10:40:25,306 R@8 : 74.330
2020-09-14 10:42:29,836 Epoch: 8, loss: 1.673, time (seconds): 124.53.
2020-09-14 10:42:29,837 **Evaluating.**
2020-09-14 10:44:20,902 NMI: 28.634
2020-09-14 10:45:53,336 R@1 : 46.762
2020-09-14 10:45:54,065 R@2 : 56.031
2020-09-14 10:45:54,786 R@4 : 65.412
2020-09-14 10:45:55,510 R@8 : 74.208
2020-09-14 10:47:59,979 Epoch: 9, loss: 1.637, time (seconds): 124.47.
2020-09-14 10:47:59,980 **Evaluating.**
2020-09-14 10:49:52,668 NMI: 28.906
2020-09-14 10:51:26,168 R@1 : 46.695
2020-09-14 10:51:26,941 R@2 : 56.145
2020-09-14 10:51:27,714 R@4 : 65.217
2020-09-14 10:51:28,483 R@8 : 74.278
2020-09-14 10:53:32,812 Epoch: 10, loss: 1.553, time (seconds): 124.33.
2020-09-14 10:53:32,813 **Evaluating.**
2020-09-14 10:55:27,722 NMI: 29.355
2020-09-14 10:57:00,712 R@1 : 47.197
2020-09-14 10:57:01,435 R@2 : 56.351
2020-09-14 10:57:02,155 R@4 : 65.432
2020-09-14 10:57:02,878 R@8 : 74.034
2020-09-14 10:59:08,125 Epoch: 11, loss: 1.513, time (seconds): 125.24.
2020-09-14 10:59:08,126 **Evaluating.**
2020-09-14 11:01:02,930 NMI: 29.130
2020-09-14 11:02:36,492 R@1 : 47.023
2020-09-14 11:02:37,217 R@2 : 56.124
2020-09-14 11:02:37,937 R@4 : 65.237
2020-09-14 11:02:38,659 R@8 : 73.854
2020-09-14 11:04:43,296 Epoch: 12, loss: 1.444, time (seconds): 124.63.
2020-09-14 11:04:43,297 **Evaluating.**
2020-09-14 11:06:34,511 NMI: 28.482
2020-09-14 11:08:07,585 R@1 : 46.741
2020-09-14 11:08:08,308 R@2 : 55.933
2020-09-14 11:08:09,032 R@4 : 64.872
2020-09-14 11:08:09,759 R@8 : 73.665
2020-09-14 11:10:15,159 Epoch: 13, loss: 1.424, time (seconds): 125.40.
2020-09-14 11:10:15,160 **Evaluating.**
2020-09-14 11:12:08,078 NMI: 28.938
2020-09-14 11:13:40,863 R@1 : 46.898
2020-09-14 11:13:41,601 R@2 : 55.846
2020-09-14 11:13:42,322 R@4 : 65.069
2020-09-14 11:13:43,052 R@8 : 73.854
2020-09-14 11:15:46,423 Epoch: 14, loss: 1.379, time (seconds): 123.37.
2020-09-14 11:15:46,424 **Evaluating.**
2020-09-14 11:17:37,854 NMI: 28.209
2020-09-14 11:19:12,156 R@1 : 46.831
2020-09-14 11:19:12,881 R@2 : 55.712
2020-09-14 11:19:13,606 R@4 : 64.779
2020-09-14 11:19:14,333 R@8 : 73.378
2020-09-14 11:21:19,236 Epoch: 15, loss: 1.385, time (seconds): 124.90.
2020-09-14 11:21:19,237 **Evaluating.**
2020-09-14 11:23:11,976 NMI: 27.720
2020-09-14 11:24:45,091 R@1 : 45.699
2020-09-14 11:24:45,812 R@2 : 54.644
2020-09-14 11:24:46,539 R@4 : 63.774
2020-09-14 11:24:47,268 R@8 : 72.742
2020-09-14 11:26:51,575 Epoch: 16, loss: 1.281, time (seconds): 124.30.
2020-09-14 11:26:51,576 **Evaluating.**
2020-09-14 11:28:43,173 NMI: 26.863
2020-09-14 11:30:17,312 R@1 : 45.182
2020-09-14 11:30:18,036 R@2 : 54.333
2020-09-14 11:30:18,756 R@4 : 63.254
2020-09-14 11:30:19,477 R@8 : 72.214
2020-09-14 11:32:24,266 Epoch: 17, loss: 1.311, time (seconds): 124.79.
2020-09-14 11:32:24,267 **Evaluating.**
2020-09-14 11:34:14,683 NMI: 27.796
2020-09-14 11:35:49,254 R@1 : 45.832
2020-09-14 11:35:49,985 R@2 : 54.623
2020-09-14 11:35:50,710 R@4 : 63.957
2020-09-14 11:35:51,438 R@8 : 72.681
2020-09-14 11:37:56,194 Epoch: 18, loss: 1.296, time (seconds): 124.75.
2020-09-14 11:37:56,195 **Evaluating.**
2020-09-14 11:39:50,011 NMI: 27.781
2020-09-14 11:41:22,893 R@1 : 45.792
2020-09-14 11:41:23,618 R@2 : 54.551
2020-09-14 11:41:24,337 R@4 : 63.945
2020-09-14 11:41:25,060 R@8 : 72.672
2020-09-14 11:43:28,863 Epoch: 19, loss: 1.245, time (seconds): 123.80.
2020-09-14 11:43:28,864 **Evaluating.**
2020-09-14 11:45:20,823 NMI: 27.575
2020-09-14 11:46:54,557 R@1 : 45.600
2020-09-14 11:46:55,281 R@2 : 54.623
2020-09-14 11:46:56,004 R@4 : 63.463
2020-09-14 11:46:56,728 R@8 : 72.283
2020-09-14 11:46:56,731 Total training time (minutes): 113.89.
2020-09-14 11:46:58,802 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 64, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 12, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food-20200914-002423', 'results_filename': 'food-results.csv', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 128}
2020-09-14 11:46:58,803 Training for 20 epochs
2020-09-14 11:46:58,805 **Evaluating initial model.**
2020-09-14 11:48:46,883 NMI: 24.435
2020-09-14 11:50:22,983 R@1 : 42.006
2020-09-14 11:50:23,704 R@2 : 50.544
2020-09-14 11:50:24,426 R@4 : 59.936
2020-09-14 11:50:25,151 R@8 : 69.261
2020-09-14 11:52:26,366 Epoch: 0, loss: 2.298, time (seconds): 121.21.
2020-09-14 11:52:26,366 **Evaluating.**
2020-09-14 11:54:11,803 NMI: 30.673
2020-09-14 11:55:41,312 R@1 : 47.090
2020-09-14 11:55:42,040 R@2 : 56.336
2020-09-14 11:55:42,771 R@4 : 65.742
2020-09-14 11:55:43,498 R@8 : 74.403
2020-09-14 11:57:44,347 Epoch: 1, loss: 2.072, time (seconds): 120.85.
2020-09-14 11:57:44,348 **Evaluating.**
2020-09-14 11:59:37,525 NMI: 31.308
2020-09-14 12:01:09,687 R@1 : 49.067
2020-09-14 12:01:10,409 R@2 : 58.145
2020-09-14 12:01:11,132 R@4 : 67.304
2020-09-14 12:01:11,869 R@8 : 75.709
2020-09-14 12:03:12,588 Epoch: 2, loss: 1.973, time (seconds): 120.72.
2020-09-14 12:03:12,589 **Evaluating.**
2020-09-14 12:05:03,272 NMI: 31.579
2020-09-14 12:06:36,386 R@1 : 49.578
2020-09-14 12:06:37,159 R@2 : 58.633
2020-09-14 12:06:37,939 R@4 : 67.505
2020-09-14 12:06:38,720 R@8 : 75.912
2020-09-14 12:08:39,990 Epoch: 3, loss: 1.824, time (seconds): 121.27.
2020-09-14 12:08:39,992 **Evaluating.**
2020-09-14 12:10:32,430 NMI: 31.343
2020-09-14 12:12:05,082 R@1 : 49.589
2020-09-14 12:12:05,814 R@2 : 58.418
2020-09-14 12:12:06,539 R@4 : 67.467
2020-09-14 12:12:07,264 R@8 : 75.782
2020-09-14 12:14:07,781 Epoch: 4, loss: 1.749, time (seconds): 120.51.
2020-09-14 12:14:07,782 **Evaluating.**
2020-09-14 12:15:58,922 NMI: 31.499
2020-09-14 12:17:30,546 R@1 : 50.071
2020-09-14 12:17:31,279 R@2 : 58.911
2020-09-14 12:17:32,011 R@4 : 67.711
2020-09-14 12:17:32,740 R@8 : 76.153
2020-09-14 12:19:33,974 Epoch: 5, loss: 1.646, time (seconds): 121.23.
2020-09-14 12:19:33,976 **Evaluating.**
2020-09-14 12:21:24,221 NMI: 30.975
2020-09-14 12:22:56,691 R@1 : 49.630
2020-09-14 12:22:57,418 R@2 : 58.856
2020-09-14 12:22:58,144 R@4 : 67.673
2020-09-14 12:22:58,869 R@8 : 75.706
2020-09-14 12:24:58,942 Epoch: 6, loss: 1.608, time (seconds): 120.07.
2020-09-14 12:24:58,943 **Evaluating.**
2020-09-14 12:26:47,166 NMI: 30.428
2020-09-14 12:28:20,187 R@1 : 49.653
2020-09-14 12:28:20,908 R@2 : 58.757
2020-09-14 12:28:21,626 R@4 : 67.467
2020-09-14 12:28:22,345 R@8 : 75.480
2020-09-14 12:30:24,201 Epoch: 7, loss: 1.628, time (seconds): 121.85.
2020-09-14 12:30:24,202 **Evaluating.**
2020-09-14 12:32:16,444 NMI: 30.138
2020-09-14 12:33:50,389 R@1 : 48.991
2020-09-14 12:33:51,115 R@2 : 57.770
2020-09-14 12:33:51,840 R@4 : 66.982
2020-09-14 12:33:52,568 R@8 : 75.114
2020-09-14 12:35:53,384 Epoch: 8, loss: 1.574, time (seconds): 120.81.
2020-09-14 12:35:53,385 **Evaluating.**
2020-09-14 12:37:43,406 NMI: 30.762
2020-09-14 12:39:17,571 R@1 : 49.162
2020-09-14 12:39:18,320 R@2 : 58.136
2020-09-14 12:39:19,057 R@4 : 66.997
2020-09-14 12:39:19,797 R@8 : 75.271
2020-09-14 12:41:23,391 Epoch: 9, loss: 1.505, time (seconds): 123.59.
2020-09-14 12:41:23,392 **Evaluating.**
2020-09-14 12:43:15,293 NMI: 30.588
2020-09-14 12:44:48,829 R@1 : 49.151
2020-09-14 12:44:49,552 R@2 : 58.096
2020-09-14 12:44:50,278 R@4 : 66.654
2020-09-14 12:44:51,009 R@8 : 74.783
2020-09-14 12:46:52,251 Epoch: 10, loss: 1.487, time (seconds): 121.24.
2020-09-14 12:46:52,252 **Evaluating.**
2020-09-14 12:48:45,278 NMI: 30.573
2020-09-14 12:50:18,873 R@1 : 49.380
2020-09-14 12:50:19,601 R@2 : 58.194
2020-09-14 12:50:20,335 R@4 : 66.878
2020-09-14 12:50:21,062 R@8 : 75.076
2020-09-14 12:52:22,334 Epoch: 11, loss: 1.425, time (seconds): 121.27.
2020-09-14 12:52:22,334 **Evaluating.**
2020-09-14 12:54:16,414 NMI: 30.545
2020-09-14 12:55:50,424 R@1 : 48.550
2020-09-14 12:55:51,148 R@2 : 57.178
2020-09-14 12:55:51,871 R@4 : 65.873
2020-09-14 12:55:52,600 R@8 : 74.289
2020-09-14 12:57:54,164 Epoch: 12, loss: 1.363, time (seconds): 121.56.
2020-09-14 12:57:54,165 **Evaluating.**
2020-09-14 12:59:44,147 NMI: 28.747
2020-09-14 13:01:18,543 R@1 : 48.030
2020-09-14 13:01:19,273 R@2 : 56.667
2020-09-14 13:01:19,996 R@4 : 65.388
2020-09-14 13:01:20,723 R@8 : 73.880
2020-09-14 13:03:22,087 Epoch: 13, loss: 1.344, time (seconds): 121.36.
2020-09-14 13:03:22,088 **Evaluating.**
2020-09-14 13:05:16,344 NMI: 29.895
2020-09-14 13:06:50,400 R@1 : 48.239
2020-09-14 13:06:51,126 R@2 : 56.658
2020-09-14 13:06:51,853 R@4 : 65.484
2020-09-14 13:06:52,584 R@8 : 74.223
2020-09-14 13:08:53,811 Epoch: 14, loss: 1.297, time (seconds): 121.23.
2020-09-14 13:08:53,812 **Evaluating.**
2020-09-14 13:10:42,345 NMI: 28.675
2020-09-14 13:12:17,685 R@1 : 47.441
2020-09-14 13:12:18,429 R@2 : 56.275
2020-09-14 13:12:19,158 R@4 : 64.976
2020-09-14 13:12:19,893 R@8 : 73.308
2020-09-14 13:14:20,478 Epoch: 15, loss: 1.265, time (seconds): 120.58.
2020-09-14 13:14:20,479 **Evaluating.**
2020-09-14 13:16:09,792 NMI: 28.057
2020-09-14 13:17:44,399 R@1 : 47.020
2020-09-14 13:17:45,129 R@2 : 55.593
2020-09-14 13:17:45,857 R@4 : 64.204
2020-09-14 13:17:46,584 R@8 : 72.664
2020-09-14 13:19:46,965 Epoch: 16, loss: 1.219, time (seconds): 120.38.
2020-09-14 13:19:46,966 **Evaluating.**
2020-09-14 13:21:35,801 NMI: 28.097
2020-09-14 13:23:10,720 R@1 : 46.976
2020-09-14 13:23:11,444 R@2 : 55.413
2020-09-14 13:23:12,173 R@4 : 64.128
2020-09-14 13:23:12,904 R@8 : 72.733
2020-09-14 13:25:14,474 Epoch: 17, loss: 1.225, time (seconds): 121.57.
2020-09-14 13:25:14,475 **Evaluating.**
2020-09-14 13:27:04,183 NMI: 29.115
2020-09-14 13:28:38,362 R@1 : 47.467
2020-09-14 13:28:39,090 R@2 : 56.095
2020-09-14 13:28:39,818 R@4 : 64.741
2020-09-14 13:28:40,543 R@8 : 73.178
2020-09-14 13:30:40,736 Epoch: 18, loss: 1.229, time (seconds): 120.19.
2020-09-14 13:30:40,736 **Evaluating.**
2020-09-14 13:32:29,875 NMI: 28.334
2020-09-14 13:34:05,728 R@1 : 46.712
2020-09-14 13:34:06,456 R@2 : 55.250
2020-09-14 13:34:07,190 R@4 : 63.977
2020-09-14 13:34:07,920 R@8 : 72.530
2020-09-14 13:36:08,892 Epoch: 19, loss: 1.188, time (seconds): 120.97.
2020-09-14 13:36:08,893 **Evaluating.**
2020-09-14 13:38:02,056 NMI: 27.929
2020-09-14 13:39:36,711 R@1 : 46.460
2020-09-14 13:39:37,442 R@2 : 55.041
2020-09-14 13:39:38,170 R@4 : 63.702
2020-09-14 13:39:38,891 R@8 : 72.434
2020-09-14 13:39:38,894 Total training time (minutes): 112.67.
2020-09-14 13:39:41,034 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 64, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 12, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food-20200914-002423', 'results_filename': 'food-results.csv', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 128}
2020-09-14 13:39:41,034 Training for 20 epochs
2020-09-14 13:39:41,037 **Evaluating initial model.**
2020-09-14 13:41:25,283 NMI: 24.435
2020-09-14 13:43:00,708 R@1 : 42.006
2020-09-14 13:43:01,434 R@2 : 50.544
2020-09-14 13:43:02,158 R@4 : 59.936
2020-09-14 13:43:02,881 R@8 : 69.261
2020-09-14 13:45:03,133 Epoch: 0, loss: 2.586, time (seconds): 120.25.
2020-09-14 13:45:03,134 **Evaluating.**
2020-09-14 13:46:51,254 NMI: 28.690
2020-09-14 13:48:18,386 R@1 : 43.559
2020-09-14 13:48:19,116 R@2 : 52.873
2020-09-14 13:48:19,842 R@4 : 62.485
2020-09-14 13:48:20,572 R@8 : 71.961
2020-09-14 13:50:20,877 Epoch: 1, loss: 2.296, time (seconds): 120.30.
2020-09-14 13:50:20,879 **Evaluating.**
2020-09-14 13:52:10,103 NMI: 29.223
2020-09-14 13:53:38,707 R@1 : 45.304
2020-09-14 13:53:39,443 R@2 : 54.562
2020-09-14 13:53:40,174 R@4 : 64.085
2020-09-14 13:53:40,899 R@8 : 73.328
2020-09-14 13:55:40,871 Epoch: 2, loss: 2.101, time (seconds): 119.97.
2020-09-14 13:55:40,871 **Evaluating.**
2020-09-14 13:57:32,864 NMI: 30.068
2020-09-14 13:59:03,481 R@1 : 46.759
2020-09-14 13:59:04,210 R@2 : 55.962
2020-09-14 13:59:04,939 R@4 : 65.272
2020-09-14 13:59:05,666 R@8 : 74.156
2020-09-14 14:01:06,434 Epoch: 3, loss: 1.982, time (seconds): 120.77.
2020-09-14 14:01:06,435 **Evaluating.**
2020-09-14 14:02:57,621 NMI: 29.778
2020-09-14 14:04:30,118 R@1 : 47.740
2020-09-14 14:04:30,858 R@2 : 56.693
2020-09-14 14:04:31,586 R@4 : 65.943
2020-09-14 14:04:32,317 R@8 : 74.597
2020-09-14 14:06:33,402 Epoch: 4, loss: 1.847, time (seconds): 121.08.
2020-09-14 14:06:33,402 **Evaluating.**
2020-09-14 14:08:23,903 NMI: 29.493
2020-09-14 14:09:56,301 R@1 : 47.667
2020-09-14 14:09:57,032 R@2 : 56.926
2020-09-14 14:09:57,753 R@4 : 65.908
2020-09-14 14:09:58,482 R@8 : 74.725
2020-09-14 14:11:59,104 Epoch: 5, loss: 1.756, time (seconds): 120.62.
2020-09-14 14:11:59,105 **Evaluating.**
2020-09-14 14:13:48,009 NMI: 29.753
2020-09-14 14:15:20,895 R@1 : 47.002
2020-09-14 14:15:21,671 R@2 : 56.409
2020-09-14 14:15:22,446 R@4 : 65.667
2020-09-14 14:15:23,222 R@8 : 74.211
2020-09-14 14:17:23,886 Epoch: 6, loss: 1.705, time (seconds): 120.66.
2020-09-14 14:17:23,887 **Evaluating.**
2020-09-14 14:19:12,351 NMI: 29.578
2020-09-14 14:20:43,490 R@1 : 48.033
2020-09-14 14:20:44,219 R@2 : 57.071
2020-09-14 14:20:44,944 R@4 : 66.024
2020-09-14 14:20:45,675 R@8 : 74.600
2020-09-14 14:22:46,482 Epoch: 7, loss: 1.722, time (seconds): 120.80.
2020-09-14 14:22:46,483 **Evaluating.**
2020-09-14 14:24:36,909 NMI: 29.285
2020-09-14 14:26:09,081 R@1 : 47.307
2020-09-14 14:26:09,806 R@2 : 56.357
2020-09-14 14:26:10,532 R@4 : 65.652
2020-09-14 14:26:11,260 R@8 : 74.310
2020-09-14 14:28:12,084 Epoch: 8, loss: 1.667, time (seconds): 120.82.
2020-09-14 14:28:12,085 **Evaluating.**
2020-09-14 14:30:08,594 NMI: 28.537
2020-09-14 14:31:41,643 R@1 : 46.788
2020-09-14 14:31:42,374 R@2 : 56.325
2020-09-14 14:31:43,102 R@4 : 65.490
2020-09-14 14:31:43,837 R@8 : 74.162
2020-09-14 14:33:44,736 Epoch: 9, loss: 1.606, time (seconds): 120.90.
2020-09-14 14:33:44,737 **Evaluating.**
2020-09-14 14:35:38,564 NMI: 29.473
2020-09-14 14:37:11,778 R@1 : 47.676
2020-09-14 14:37:12,504 R@2 : 56.795
2020-09-14 14:37:13,234 R@4 : 66.004
2020-09-14 14:37:13,961 R@8 : 74.481
2020-09-14 14:39:13,249 Epoch: 10, loss: 1.563, time (seconds): 119.28.
2020-09-14 14:39:13,250 **Evaluating.**
2020-09-14 14:41:05,258 NMI: 29.196
2020-09-14 14:42:37,645 R@1 : 47.580
2020-09-14 14:42:38,366 R@2 : 56.336
2020-09-14 14:42:39,095 R@4 : 65.635
2020-09-14 14:42:39,820 R@8 : 74.562
2020-09-14 14:44:40,282 Epoch: 11, loss: 1.506, time (seconds): 120.46.
2020-09-14 14:44:40,283 **Evaluating.**
2020-09-14 14:46:32,114 NMI: 28.917
2020-09-14 14:48:06,826 R@1 : 47.058
2020-09-14 14:48:07,556 R@2 : 56.403
2020-09-14 14:48:08,283 R@4 : 65.507
2020-09-14 14:48:09,010 R@8 : 74.182
2020-09-14 14:50:07,874 Epoch: 12, loss: 1.441, time (seconds): 118.86.
2020-09-14 14:50:07,875 **Evaluating.**
2020-09-14 14:52:02,491 NMI: 28.005
2020-09-14 14:53:36,448 R@1 : 46.976
2020-09-14 14:53:37,171 R@2 : 56.200
2020-09-14 14:53:37,895 R@4 : 65.095
2020-09-14 14:53:38,621 R@8 : 73.625
2020-09-14 14:55:40,880 Epoch: 13, loss: 1.419, time (seconds): 122.26.
2020-09-14 14:55:40,881 **Evaluating.**
2020-09-14 14:57:38,969 NMI: 29.151
2020-09-14 14:59:11,956 R@1 : 47.171
2020-09-14 14:59:12,674 R@2 : 56.145
2020-09-14 14:59:13,408 R@4 : 65.121
2020-09-14 14:59:14,130 R@8 : 73.898
2020-09-14 15:01:16,316 Epoch: 14, loss: 1.378, time (seconds): 122.18.
2020-09-14 15:01:16,317 **Evaluating.**
2020-09-14 15:03:16,644 NMI: 28.377
2020-09-14 15:04:50,631 R@1 : 46.544
2020-09-14 15:04:51,352 R@2 : 55.573
2020-09-14 15:04:52,071 R@4 : 64.671
2020-09-14 15:04:52,789 R@8 : 73.372
2020-09-14 15:06:59,646 Epoch: 15, loss: 1.358, time (seconds): 126.85.
2020-09-14 15:06:59,647 **Evaluating.**
2020-09-14 15:09:02,065 NMI: 27.831
2020-09-14 15:10:35,208 R@1 : 45.287
2020-09-14 15:10:35,936 R@2 : 54.266
2020-09-14 15:10:36,662 R@4 : 64.027
2020-09-14 15:10:37,385 R@8 : 72.748
2020-09-14 15:12:40,438 Epoch: 16, loss: 1.277, time (seconds): 123.05.
2020-09-14 15:12:40,439 **Evaluating.**
2020-09-14 15:14:41,879 NMI: 27.385
2020-09-14 15:16:15,073 R@1 : 45.490
2020-09-14 15:16:15,793 R@2 : 54.696
2020-09-14 15:16:16,515 R@4 : 63.742
2020-09-14 15:16:17,240 R@8 : 72.519
2020-09-14 15:18:19,468 Epoch: 17, loss: 1.295, time (seconds): 122.23.
2020-09-14 15:18:19,469 **Evaluating.**
2020-09-14 15:20:21,310 NMI: 27.808
2020-09-14 15:21:55,858 R@1 : 45.670
2020-09-14 15:21:56,578 R@2 : 54.594
2020-09-14 15:21:57,305 R@4 : 63.986
2020-09-14 15:21:58,026 R@8 : 72.742
2020-09-14 15:24:01,479 Epoch: 18, loss: 1.285, time (seconds): 123.45.
2020-09-14 15:24:01,480 **Evaluating.**
2020-09-14 15:26:00,250 NMI: 26.904
2020-09-14 15:27:34,364 R@1 : 45.255
2020-09-14 15:27:35,093 R@2 : 54.162
2020-09-14 15:27:35,815 R@4 : 63.005
2020-09-14 15:27:36,534 R@8 : 71.906
2020-09-14 15:29:39,172 Epoch: 19, loss: 1.258, time (seconds): 122.64.
2020-09-14 15:29:39,172 **Evaluating.**
2020-09-14 15:31:38,941 NMI: 27.397
2020-09-14 15:33:12,983 R@1 : 45.118
2020-09-14 15:33:13,706 R@2 : 53.767
2020-09-14 15:33:14,424 R@4 : 63.196
2020-09-14 15:33:15,144 R@8 : 72.286
2020-09-14 15:33:15,147 Total training time (minutes): 113.57.
2020-09-14 15:33:17,276 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 64, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 12, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200914-002423', 'results_filename': 'food-results.csv', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 128}
2020-09-14 15:33:17,277 Training for 20 epochs
2020-09-14 15:33:17,279 **Evaluating initial model.**
2020-09-14 15:34:58,113 NMI: 24.435
2020-09-14 15:36:34,188 R@1 : 42.006
2020-09-14 15:36:34,924 R@2 : 50.544
2020-09-14 15:36:35,658 R@4 : 59.936
2020-09-14 15:36:36,384 R@8 : 69.261
2020-09-14 15:38:39,289 Epoch: 0, loss: 3.245, time (seconds): 122.90.
2020-09-14 15:38:39,290 **Evaluating.**
2020-09-14 15:40:36,702 NMI: 27.316
2020-09-14 15:42:04,159 R@1 : 42.169
2020-09-14 15:42:04,883 R@2 : 51.259
2020-09-14 15:42:05,615 R@4 : 60.987
2020-09-14 15:42:06,339 R@8 : 70.788
2020-09-14 15:44:10,214 Epoch: 1, loss: 2.763, time (seconds): 123.87.
2020-09-14 15:44:10,215 **Evaluating.**
2020-09-14 15:46:16,355 NMI: 27.540
2020-09-14 15:47:46,146 R@1 : 43.792
2020-09-14 15:47:46,931 R@2 : 53.204
2020-09-14 15:47:47,701 R@4 : 62.903
2020-09-14 15:47:48,474 R@8 : 72.440
2020-09-14 15:49:51,796 Epoch: 2, loss: 2.376, time (seconds): 123.32.
2020-09-14 15:49:51,797 **Evaluating.**
2020-09-14 15:51:54,083 NMI: 29.409
2020-09-14 15:53:23,896 R@1 : 46.526
2020-09-14 15:53:24,628 R@2 : 55.517
2020-09-14 15:53:25,353 R@4 : 65.002
2020-09-14 15:53:26,078 R@8 : 73.958
2020-09-14 15:55:29,691 Epoch: 3, loss: 2.142, time (seconds): 123.61.
2020-09-14 15:55:29,692 **Evaluating.**
2020-09-14 15:57:39,113 NMI: 29.315
2020-09-14 15:59:10,505 R@1 : 46.462
2020-09-14 15:59:11,237 R@2 : 55.573
2020-09-14 15:59:11,967 R@4 : 65.220
2020-09-14 15:59:12,695 R@8 : 74.115
2020-09-14 16:01:14,070 Epoch: 4, loss: 2.018, time (seconds): 121.37.
2020-09-14 16:01:14,071 **Evaluating.**
2020-09-14 16:03:17,441 NMI: 29.748
2020-09-14 16:04:47,666 R@1 : 46.971
2020-09-14 16:04:48,379 R@2 : 56.136
2020-09-14 16:04:49,103 R@4 : 65.554
2020-09-14 16:04:49,824 R@8 : 74.342
2020-09-14 16:06:49,885 Epoch: 5, loss: 1.915, time (seconds): 120.06.
2020-09-14 16:06:49,886 **Evaluating.**
2020-09-14 16:08:50,980 NMI: 27.940
2020-09-14 16:10:20,625 R@1 : 46.242
2020-09-14 16:10:21,342 R@2 : 55.425
2020-09-14 16:10:22,061 R@4 : 65.031
2020-09-14 16:10:22,775 R@8 : 73.874
2020-09-14 16:12:23,056 Epoch: 6, loss: 1.819, time (seconds): 120.28.
2020-09-14 16:12:23,057 **Evaluating.**
2020-09-14 16:14:26,266 NMI: 28.720
2020-09-14 16:15:55,158 R@1 : 46.137
2020-09-14 16:15:55,880 R@2 : 55.517
2020-09-14 16:15:56,598 R@4 : 65.002
2020-09-14 16:15:57,313 R@8 : 73.831
2020-09-14 16:17:57,586 Epoch: 7, loss: 1.812, time (seconds): 120.27.
2020-09-14 16:17:57,587 **Evaluating.**
2020-09-14 16:20:00,038 NMI: 28.643
2020-09-14 16:21:29,758 R@1 : 46.509
2020-09-14 16:21:30,485 R@2 : 55.689
2020-09-14 16:21:31,213 R@4 : 65.043
2020-09-14 16:21:31,938 R@8 : 73.880
2020-09-14 16:23:31,746 Epoch: 8, loss: 1.733, time (seconds): 119.81.
2020-09-14 16:23:31,747 **Evaluating.**
2020-09-14 16:25:34,316 NMI: 28.400
2020-09-14 16:27:04,803 R@1 : 46.953
2020-09-14 16:27:05,527 R@2 : 56.441
2020-09-14 16:27:06,250 R@4 : 65.490
2020-09-14 16:27:06,981 R@8 : 74.379
2020-09-14 16:29:08,631 Epoch: 9, loss: 1.660, time (seconds): 121.65.
2020-09-14 16:29:08,632 **Evaluating.**
2020-09-14 16:31:12,522 NMI: 29.340
2020-09-14 16:32:44,539 R@1 : 47.275
2020-09-14 16:32:45,264 R@2 : 56.441
2020-09-14 16:32:45,990 R@4 : 65.342
2020-09-14 16:32:46,723 R@8 : 74.339
2020-09-14 16:34:49,214 Epoch: 10, loss: 1.617, time (seconds): 122.49.
2020-09-14 16:34:49,215 **Evaluating.**
2020-09-14 16:36:54,304 NMI: 28.796
2020-09-14 16:38:26,054 R@1 : 46.660
2020-09-14 16:38:26,785 R@2 : 55.767
2020-09-14 16:38:27,506 R@4 : 65.142
2020-09-14 16:38:28,233 R@8 : 73.900
2020-09-14 16:40:27,457 Epoch: 11, loss: 1.553, time (seconds): 119.22.
2020-09-14 16:40:27,458 **Evaluating.**
2020-09-14 16:42:34,838 NMI: 28.442
2020-09-14 16:44:10,151 R@1 : 46.181
2020-09-14 16:44:10,878 R@2 : 55.436
2020-09-14 16:44:11,611 R@4 : 64.721
2020-09-14 16:44:12,356 R@8 : 73.688
2020-09-14 16:46:19,122 Epoch: 12, loss: 1.511, time (seconds): 126.76.
2020-09-14 16:46:19,123 **Evaluating.**
2020-09-14 16:48:25,386 NMI: 28.260
2020-09-14 16:49:59,603 R@1 : 46.155
2020-09-14 16:50:00,494 R@2 : 55.294
2020-09-14 16:50:01,384 R@4 : 65.037
2020-09-14 16:50:02,285 R@8 : 73.770
2020-09-14 16:52:02,937 Epoch: 13, loss: 1.487, time (seconds): 120.65.
2020-09-14 16:52:02,938 **Evaluating.**
2020-09-14 16:54:11,048 NMI: 28.804
2020-09-14 16:55:42,325 R@1 : 46.634
2020-09-14 16:55:43,048 R@2 : 55.770
2020-09-14 16:55:43,773 R@4 : 65.412
2020-09-14 16:55:44,495 R@8 : 74.365
2020-09-14 16:57:46,813 Epoch: 14, loss: 1.414, time (seconds): 122.31.
2020-09-14 16:57:46,814 **Evaluating.**
2020-09-14 16:59:55,392 NMI: 27.325
2020-09-14 17:01:31,512 R@1 : 45.716
2020-09-14 17:01:32,293 R@2 : 54.789
2020-09-14 17:01:33,073 R@4 : 64.265
2020-09-14 17:01:33,856 R@8 : 73.088
2020-09-14 17:03:39,206 Epoch: 15, loss: 1.415, time (seconds): 125.35.
2020-09-14 17:03:39,207 **Evaluating.**
2020-09-14 17:05:42,307 NMI: 27.402
2020-09-14 17:07:15,380 R@1 : 45.043
2020-09-14 17:07:16,114 R@2 : 54.211
2020-09-14 17:07:16,835 R@4 : 63.916
2020-09-14 17:07:17,560 R@8 : 72.905
2020-09-14 17:09:17,205 Epoch: 16, loss: 1.325, time (seconds): 119.64.
2020-09-14 17:09:17,206 **Evaluating.**
2020-09-14 17:11:20,261 NMI: 26.855
2020-09-14 17:12:52,993 R@1 : 45.057
2020-09-14 17:12:53,714 R@2 : 54.469
2020-09-14 17:12:54,443 R@4 : 63.928
2020-09-14 17:12:55,167 R@8 : 72.783
2020-09-14 17:14:53,880 Epoch: 17, loss: 1.309, time (seconds): 118.71.
2020-09-14 17:14:53,882 **Evaluating.**
2020-09-14 17:16:50,044 NMI: 27.069
2020-09-14 17:18:22,609 R@1 : 45.560
2020-09-14 17:18:23,331 R@2 : 54.452
2020-09-14 17:18:24,051 R@4 : 63.829
2020-09-14 17:18:24,775 R@8 : 72.971
2020-09-14 17:20:22,906 Epoch: 18, loss: 1.316, time (seconds): 118.13.
2020-09-14 17:20:22,907 **Evaluating.**
2020-09-14 17:22:20,466 NMI: 27.334
2020-09-14 17:23:53,681 R@1 : 45.214
2020-09-14 17:23:54,566 R@2 : 54.202
2020-09-14 17:23:55,451 R@4 : 63.612
2020-09-14 17:23:56,332 R@8 : 72.626
2020-09-14 17:25:55,219 Epoch: 19, loss: 1.293, time (seconds): 118.89.
2020-09-14 17:25:55,220 **Evaluating.**
2020-09-14 17:27:56,454 NMI: 27.089
2020-09-14 17:29:28,236 R@1 : 45.249
2020-09-14 17:29:29,005 R@2 : 54.022
2020-09-14 17:29:29,782 R@4 : 63.162
2020-09-14 17:29:30,549 R@8 : 72.176
2020-09-14 17:29:30,553 Total training time (minutes): 116.22.
