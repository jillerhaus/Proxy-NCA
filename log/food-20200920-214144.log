2020-09-20 21:41:47,320 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 10, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200920-214144', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 2, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-20 21:41:47,323 Training for 10 epochs
2020-09-20 21:41:47,324 **Evaluating initial model.**
2020-09-20 21:42:28,009 NMI: 25.916
2020-09-20 21:42:40,019 R@1 : 32.493
2020-09-20 21:42:40,276 R@2 : 41.514
2020-09-20 21:42:40,533 R@4 : 51.994
2020-09-20 21:42:40,781 R@8 : 62.736
2020-09-20 21:43:31,837 Epoch: 0, loss: 2.729, time (seconds): 51.06.
2020-09-20 21:43:31,837 **Evaluating.**
2020-09-20 21:44:11,373 NMI: 27.167
2020-09-20 21:44:22,631 R@1 : 31.746
2020-09-20 21:44:22,912 R@2 : 42.148
2020-09-20 21:44:23,187 R@4 : 53.350
2020-09-20 21:44:23,464 R@8 : 64.370
2020-09-20 21:45:14,689 Epoch: 1, loss: 2.368, time (seconds): 51.22.
2020-09-20 21:45:14,690 **Evaluating.**
2020-09-20 21:45:54,309 NMI: 28.867
2020-09-20 21:46:05,781 R@1 : 35.292
2020-09-20 21:46:06,031 R@2 : 45.398
2020-09-20 21:46:06,282 R@4 : 56.348
2020-09-20 21:46:06,534 R@8 : 67.150
2020-09-20 21:46:58,254 Epoch: 2, loss: 2.161, time (seconds): 51.72.
2020-09-20 21:46:58,255 **Evaluating.**
2020-09-20 21:47:37,871 NMI: 30.296
2020-09-20 21:47:49,358 R@1 : 36.621
2020-09-20 21:47:49,607 R@2 : 47.258
2020-09-20 21:47:49,860 R@4 : 58.269
2020-09-20 21:47:50,114 R@8 : 68.506
2020-09-20 21:48:40,684 Epoch: 3, loss: 2.201, time (seconds): 50.57.
2020-09-20 21:48:40,685 **Evaluating.**
2020-09-20 21:49:19,465 NMI: 29.216
2020-09-20 21:49:31,021 R@1 : 37.117
2020-09-20 21:49:31,270 R@2 : 47.771
2020-09-20 21:49:31,517 R@4 : 58.504
2020-09-20 21:49:31,767 R@8 : 68.541
2020-09-20 21:50:22,686 Epoch: 4, loss: 1.939, time (seconds): 50.92.
2020-09-20 21:50:22,688 **Evaluating.**
2020-09-20 21:51:01,730 NMI: 29.714
2020-09-20 21:51:13,459 R@1 : 36.699
2020-09-20 21:51:13,709 R@2 : 46.745
2020-09-20 21:51:13,952 R@4 : 57.930
2020-09-20 21:51:14,202 R@8 : 68.298
2020-09-20 21:52:05,815 Epoch: 5, loss: 1.949, time (seconds): 51.61.
2020-09-20 21:52:05,816 **Evaluating.**
2020-09-20 21:52:44,354 NMI: 29.544
2020-09-20 21:52:55,458 R@1 : 37.308
2020-09-20 21:52:55,702 R@2 : 47.389
2020-09-20 21:52:55,946 R@4 : 58.069
2020-09-20 21:52:56,189 R@8 : 68.437
2020-09-20 21:53:48,496 Epoch: 6, loss: 1.751, time (seconds): 52.31.
2020-09-20 21:53:48,497 **Evaluating.**
2020-09-20 21:54:28,335 NMI: 30.130
2020-09-20 21:54:40,079 R@1 : 37.360
2020-09-20 21:54:40,356 R@2 : 47.910
2020-09-20 21:54:40,606 R@4 : 59.034
2020-09-20 21:54:40,854 R@8 : 69.297
2020-09-20 21:55:33,731 Epoch: 7, loss: 1.701, time (seconds): 52.87.
2020-09-20 21:55:33,732 **Evaluating.**
2020-09-20 21:56:10,979 NMI: 30.770
2020-09-20 21:56:21,854 R@1 : 37.742
2020-09-20 21:56:22,094 R@2 : 48.092
2020-09-20 21:56:22,342 R@4 : 58.869
2020-09-20 21:56:22,589 R@8 : 69.679
2020-09-20 21:57:15,763 Epoch: 8, loss: 1.627, time (seconds): 53.17.
2020-09-20 21:57:15,764 **Evaluating.**
2020-09-20 21:57:52,503 NMI: 30.279
2020-09-20 21:58:03,969 R@1 : 37.403
2020-09-20 21:58:04,216 R@2 : 48.006
2020-09-20 21:58:04,458 R@4 : 58.121
2020-09-20 21:58:04,699 R@8 : 68.628
2020-09-20 21:58:56,741 Epoch: 9, loss: 1.665, time (seconds): 52.04.
2020-09-20 21:58:56,741 **Evaluating.**
2020-09-20 21:59:33,579 NMI: 30.243
2020-09-20 21:59:44,516 R@1 : 37.629
2020-09-20 21:59:44,763 R@2 : 47.736
2020-09-20 21:59:45,007 R@4 : 58.981
2020-09-20 21:59:45,255 R@8 : 69.549
2020-09-20 21:59:45,257 Total training time (minutes): 17.97.
2020-09-20 21:59:46,029 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 10, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200920-214144', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 2, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-20 21:59:46,029 Training for 10 epochs
2020-09-20 21:59:46,031 **Evaluating initial model.**
2020-09-20 22:00:20,780 NMI: 25.916
2020-09-20 22:00:32,409 R@1 : 32.493
2020-09-20 22:00:32,662 R@2 : 41.514
2020-09-20 22:00:32,917 R@4 : 51.994
2020-09-20 22:00:33,174 R@8 : 62.736
2020-09-20 22:01:07,768 Epoch: 0, loss: 3.464, time (seconds): 34.59.
2020-09-20 22:01:07,769 **Evaluating.**
2020-09-20 22:01:42,199 NMI: 23.528
2020-09-20 22:01:52,958 R@1 : 30.277
2020-09-20 22:01:53,214 R@2 : 40.280
2020-09-20 22:01:53,471 R@4 : 51.195
2020-09-20 22:01:53,728 R@8 : 63.170
2020-09-20 22:02:27,801 Epoch: 1, loss: 2.689, time (seconds): 34.07.
2020-09-20 22:02:27,801 **Evaluating.**
2020-09-20 22:03:01,762 NMI: 28.252
2020-09-20 22:03:12,519 R@1 : 34.761
2020-09-20 22:03:12,761 R@2 : 45.346
2020-09-20 22:03:13,020 R@4 : 56.192
2020-09-20 22:03:13,265 R@8 : 67.107
2020-09-20 22:03:47,293 Epoch: 2, loss: 2.326, time (seconds): 34.03.
2020-09-20 22:03:47,294 **Evaluating.**
2020-09-20 22:04:21,361 NMI: 30.807
