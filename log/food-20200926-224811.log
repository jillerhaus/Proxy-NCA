2020-09-26 22:48:18,451 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 128, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200926-224811', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 3, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-26 22:48:18,452 Training for 20 epochs
2020-09-26 22:48:18,454 **Evaluating initial model.**
2020-09-26 22:50:53,973 NMI: 27.896
2020-09-26 22:53:52,273 R@1 : 47.275
2020-09-26 22:53:53,025 R@2 : 55.785
2020-09-26 22:53:53,770 R@4 : 64.523
2020-09-26 22:53:54,525 R@8 : 73.146
2020-09-26 22:56:32,759 Epoch: 0, loss: 3.297, time (seconds): 158.23.
2020-09-26 22:56:32,760 **Evaluating.**
2020-09-26 22:58:43,661 NMI: 26.246
2020-09-26 23:01:25,979 R@1 : 42.929
2020-09-26 23:01:26,723 R@2 : 51.944
2020-09-26 23:01:27,462 R@4 : 61.684
2020-09-26 23:01:28,201 R@8 : 71.177
2020-09-26 23:03:44,319 Epoch: 1, loss: 2.537, time (seconds): 136.11.
2020-09-26 23:03:44,319 **Evaluating.**
2020-09-26 23:06:13,459 NMI: 29.381
2020-09-26 23:08:59,231 R@1 : 46.230
2020-09-26 23:08:59,981 R@2 : 55.381
2020-09-26 23:09:00,730 R@4 : 64.590
2020-09-26 23:09:01,471 R@8 : 73.384
2020-09-26 23:11:19,100 Epoch: 2, loss: 2.394, time (seconds): 137.63.
2020-09-26 23:11:19,100 **Evaluating.**
2020-09-26 23:13:27,858 NMI: 30.659
2020-09-26 23:16:14,750 R@1 : 47.284
2020-09-26 23:16:15,517 R@2 : 56.687
2020-09-26 23:16:16,269 R@4 : 65.795
2020-09-26 23:16:17,008 R@8 : 74.397
2020-09-26 23:18:29,976 Epoch: 3, loss: 2.184, time (seconds): 132.96.
2020-09-26 23:18:29,977 **Evaluating.**
2020-09-26 23:20:33,233 NMI: 31.597
2020-09-26 23:23:19,932 R@1 : 48.399
2020-09-26 23:23:20,668 R@2 : 57.509
2020-09-26 23:23:21,395 R@4 : 66.686
2020-09-26 23:23:22,134 R@8 : 75.343
2020-09-26 23:25:31,694 Epoch: 4, loss: 2.037, time (seconds): 129.56.
2020-09-26 23:25:31,695 **Evaluating.**
2020-09-26 23:27:34,430 NMI: 31.487
2020-09-26 23:30:22,751 R@1 : 48.579
2020-09-26 23:30:23,491 R@2 : 57.686
2020-09-26 23:30:24,236 R@4 : 66.936
2020-09-26 23:30:24,970 R@8 : 75.480
2020-09-26 23:32:33,016 Epoch: 5, loss: 2.036, time (seconds): 128.04.
2020-09-26 23:32:33,017 **Evaluating.**
2020-09-26 23:34:37,123 NMI: 30.920
2020-09-26 23:37:25,368 R@1 : 47.929
2020-09-26 23:37:26,114 R@2 : 57.207
2020-09-26 23:37:26,854 R@4 : 66.732
2020-09-26 23:37:27,591 R@8 : 74.908
2020-09-26 23:39:37,217 Epoch: 6, loss: 1.913, time (seconds): 129.62.
2020-09-26 23:39:37,218 **Evaluating.**
2020-09-26 23:41:41,971 NMI: 30.972
2020-09-26 23:44:31,019 R@1 : 48.138
2020-09-26 23:44:31,856 R@2 : 57.309
2020-09-26 23:44:32,691 R@4 : 66.561
2020-09-26 23:44:33,523 R@8 : 74.768
2020-09-26 23:46:36,768 Epoch: 7, loss: 1.762, time (seconds): 123.24.
2020-09-26 23:46:36,769 **Evaluating.**
2020-09-26 23:48:39,492 NMI: 30.486
2020-09-26 23:51:29,193 R@1 : 48.384
2020-09-26 23:51:29,934 R@2 : 57.503
2020-09-26 23:51:30,669 R@4 : 66.561
2020-09-26 23:51:31,405 R@8 : 75.021
2020-09-26 23:53:36,080 Epoch: 8, loss: 1.703, time (seconds): 124.67.
2020-09-26 23:53:36,080 **Evaluating.**
2020-09-26 23:55:41,214 NMI: 31.399
2020-09-26 23:58:30,316 R@1 : 48.898
2020-09-26 23:58:31,057 R@2 : 57.930
2020-09-26 23:58:31,806 R@4 : 66.936
2020-09-26 23:58:32,554 R@8 : 75.448
2020-09-27 00:00:41,226 Epoch: 9, loss: 1.651, time (seconds): 128.67.
2020-09-27 00:00:41,227 **Evaluating.**
2020-09-27 00:02:45,536 NMI: 30.957
2020-09-27 00:05:34,922 R@1 : 48.498
2020-09-27 00:05:35,665 R@2 : 57.463
2020-09-27 00:05:36,415 R@4 : 66.703
2020-09-27 00:05:37,160 R@8 : 75.120
2020-09-27 00:07:44,054 Epoch: 10, loss: 1.612, time (seconds): 126.89.
2020-09-27 00:07:44,055 **Evaluating.**
2020-09-27 00:09:48,405 NMI: 30.628
2020-09-27 00:12:40,485 R@1 : 48.106
2020-09-27 00:12:41,316 R@2 : 57.187
2020-09-27 00:12:42,152 R@4 : 66.460
2020-09-27 00:12:42,986 R@8 : 75.099
2020-09-27 00:14:51,327 Epoch: 11, loss: 1.584, time (seconds): 128.34.
2020-09-27 00:14:51,328 **Evaluating.**
2020-09-27 00:16:59,695 NMI: 30.421
2020-09-27 00:19:51,317 R@1 : 48.236
2020-09-27 00:19:52,061 R@2 : 57.175
2020-09-27 00:19:52,798 R@4 : 66.100
2020-09-27 00:19:53,544 R@8 : 74.771
2020-09-27 00:22:00,787 Epoch: 12, loss: 1.537, time (seconds): 127.24.
2020-09-27 00:22:00,787 **Evaluating.**
2020-09-27 00:24:07,467 NMI: 30.286
2020-09-27 00:26:59,830 R@1 : 48.291
2020-09-27 00:27:00,568 R@2 : 57.492
2020-09-27 00:27:01,312 R@4 : 66.195
2020-09-27 00:27:02,047 R@8 : 74.623
2020-09-27 00:29:10,723 Epoch: 13, loss: 1.516, time (seconds): 128.67.
2020-09-27 00:29:10,723 **Evaluating.**
2020-09-27 00:31:21,256 NMI: 30.194
2020-09-27 00:34:12,451 R@1 : 47.583
2020-09-27 00:34:13,187 R@2 : 56.554
2020-09-27 00:34:13,918 R@4 : 65.957
2020-09-27 00:34:14,653 R@8 : 74.568
2020-09-27 00:36:17,590 Epoch: 14, loss: 1.447, time (seconds): 122.93.
2020-09-27 00:36:17,591 **Evaluating.**
2020-09-27 00:38:20,774 NMI: 30.180
2020-09-27 00:41:12,410 R@1 : 47.641
2020-09-27 00:41:13,144 R@2 : 56.743
2020-09-27 00:41:13,892 R@4 : 65.844
2020-09-27 00:41:14,640 R@8 : 74.510
2020-09-27 00:43:16,683 Epoch: 15, loss: 1.434, time (seconds): 122.04.
2020-09-27 00:43:16,684 **Evaluating.**
2020-09-27 00:45:20,546 NMI: 30.013
2020-09-27 00:48:12,506 R@1 : 47.493
2020-09-27 00:48:13,251 R@2 : 56.519
2020-09-27 00:48:13,995 R@4 : 65.801
2020-09-27 00:48:14,738 R@8 : 74.426
2020-09-27 00:50:20,403 Epoch: 16, loss: 1.405, time (seconds): 125.66.
2020-09-27 00:50:20,404 **Evaluating.**
2020-09-27 00:52:23,529 NMI: 29.922
2020-09-27 00:55:16,054 R@1 : 47.174
2020-09-27 00:55:16,791 R@2 : 56.400
2020-09-27 00:55:17,537 R@4 : 65.478
2020-09-27 00:55:18,276 R@8 : 74.240
2020-09-27 00:57:22,451 Epoch: 17, loss: 1.387, time (seconds): 124.17.
2020-09-27 00:57:22,452 **Evaluating.**
2020-09-27 00:59:26,988 NMI: 29.713
2020-09-27 01:02:19,742 R@1 : 47.078
2020-09-27 01:02:20,477 R@2 : 56.171
2020-09-27 01:02:21,217 R@4 : 65.327
2020-09-27 01:02:21,965 R@8 : 74.046
2020-09-27 01:04:33,149 Epoch: 18, loss: 1.387, time (seconds): 131.18.
2020-09-27 01:04:33,150 **Evaluating.**
2020-09-27 01:06:39,617 NMI: 29.409
2020-09-27 01:09:32,070 R@1 : 46.886
2020-09-27 01:09:32,810 R@2 : 56.098
2020-09-27 01:09:33,557 R@4 : 65.330
2020-09-27 01:09:34,304 R@8 : 73.880
2020-09-27 01:11:41,777 Epoch: 19, loss: 1.319, time (seconds): 127.47.
2020-09-27 01:11:41,778 **Evaluating.**
2020-09-27 01:13:45,100 NMI: 29.286
2020-09-27 01:16:38,181 R@1 : 46.660
2020-09-27 01:16:38,912 R@2 : 55.599
2020-09-27 01:16:39,669 R@4 : 64.883
2020-09-27 01:16:40,414 R@8 : 73.921
2020-09-27 01:16:40,417 Total training time (minutes): 148.37.
