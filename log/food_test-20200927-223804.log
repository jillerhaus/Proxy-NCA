2020-09-27 22:38:10,454 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-223804', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-27 22:38:10,455 Training for 20 epochs
2020-09-27 22:38:10,457 **Evaluating initial model.**
2020-09-27 22:39:14,430 NMI: 25.916
2020-09-27 22:39:26,269 R@1 : 32.493
2020-09-27 22:39:26,521 R@2 : 41.514
2020-09-27 22:39:26,774 R@4 : 51.994
2020-09-27 22:39:27,027 R@8 : 62.736
2020-09-27 22:40:24,125 Epoch: 0, loss: 2.488, time (seconds): 57.10.
2020-09-27 22:40:24,126 **Evaluating.**
2020-09-27 22:41:02,203 NMI: 29.915
2020-09-27 22:41:12,841 R@1 : 37.681
2020-09-27 22:41:13,090 R@2 : 48.310
2020-09-27 22:41:13,343 R@4 : 58.799
2020-09-27 22:41:13,596 R@8 : 68.680
2020-09-27 22:42:06,770 Epoch: 1, loss: 2.242, time (seconds): 53.17.
2020-09-27 22:42:06,770 **Evaluating.**
2020-09-27 22:42:45,741 NMI: 29.774
2020-09-27 22:42:57,594 R@1 : 38.116
2020-09-27 22:42:57,850 R@2 : 48.657
2020-09-27 22:42:58,103 R@4 : 58.764
2020-09-27 22:42:58,354 R@8 : 68.871
2020-09-27 22:43:51,445 Epoch: 2, loss: 2.107, time (seconds): 53.09.
2020-09-27 22:43:51,446 **Evaluating.**
2020-09-27 22:44:29,774 NMI: 29.813
2020-09-27 22:44:41,183 R@1 : 37.212
2020-09-27 22:44:41,438 R@2 : 47.910
2020-09-27 22:44:41,688 R@4 : 58.643
2020-09-27 22:44:41,943 R@8 : 68.610
2020-09-27 22:45:34,762 Epoch: 3, loss: 2.058, time (seconds): 52.82.
2020-09-27 22:45:34,762 **Evaluating.**
2020-09-27 22:46:12,923 NMI: 29.027
2020-09-27 22:46:24,441 R@1 : 36.352
2020-09-27 22:46:24,689 R@2 : 46.363
2020-09-27 22:46:24,938 R@4 : 57.087
2020-09-27 22:46:25,186 R@8 : 67.090
2020-09-27 22:47:17,762 Epoch: 4, loss: 1.885, time (seconds): 52.57.
2020-09-27 22:47:17,763 **Evaluating.**
2020-09-27 22:47:56,187 NMI: 27.519
2020-09-27 22:48:07,794 R@1 : 35.848
2020-09-27 22:48:08,058 R@2 : 45.338
2020-09-27 22:48:08,309 R@4 : 55.653
2020-09-27 22:48:08,562 R@8 : 65.725
2020-09-27 22:49:02,287 Epoch: 5, loss: 1.921, time (seconds): 53.72.
2020-09-27 22:49:02,288 **Evaluating.**
2020-09-27 22:49:40,176 NMI: 26.883
2020-09-27 22:49:51,676 R@1 : 35.135
2020-09-27 22:49:51,927 R@2 : 44.842
2020-09-27 22:49:52,185 R@4 : 54.888
2020-09-27 22:49:52,436 R@8 : 65.430
2020-09-27 22:50:45,635 Epoch: 6, loss: 1.722, time (seconds): 53.20.
2020-09-27 22:50:45,636 **Evaluating.**
2020-09-27 22:51:23,681 NMI: 26.598
2020-09-27 22:51:35,411 R@1 : 35.040
2020-09-27 22:51:35,669 R@2 : 45.129
2020-09-27 22:51:35,922 R@4 : 55.836
2020-09-27 22:51:36,175 R@8 : 65.586
2020-09-27 22:52:29,699 Epoch: 7, loss: 1.686, time (seconds): 53.52.
2020-09-27 22:52:29,700 **Evaluating.**
2020-09-27 22:53:08,253 NMI: 27.170
2020-09-27 22:53:19,876 R@1 : 35.013
2020-09-27 22:53:20,130 R@2 : 44.947
2020-09-27 22:53:20,387 R@4 : 55.227
2020-09-27 22:53:20,642 R@8 : 64.934
2020-09-27 22:54:13,502 Epoch: 8, loss: 1.615, time (seconds): 52.86.
2020-09-27 22:54:13,503 **Evaluating.**
2020-09-27 22:54:52,282 NMI: 25.733
2020-09-27 22:55:03,952 R@1 : 33.545
2020-09-27 22:55:04,223 R@2 : 44.104
2020-09-27 22:55:04,499 R@4 : 53.958
2020-09-27 22:55:04,750 R@8 : 64.170
2020-09-27 22:56:01,772 Epoch: 9, loss: 1.662, time (seconds): 57.02.
2020-09-27 22:56:01,773 **Evaluating.**
2020-09-27 22:56:40,457 NMI: 26.272
2020-09-27 22:56:52,098 R@1 : 33.945
2020-09-27 22:56:52,346 R@2 : 44.086
2020-09-27 22:56:52,597 R@4 : 54.489
2020-09-27 22:56:52,846 R@8 : 65.013
2020-09-27 22:57:45,404 Epoch: 10, loss: 1.543, time (seconds): 52.56.
2020-09-27 22:57:45,405 **Evaluating.**
2020-09-27 22:58:24,779 NMI: 26.243
2020-09-27 22:58:36,740 R@1 : 33.432
2020-09-27 22:58:37,002 R@2 : 43.669
2020-09-27 22:58:37,254 R@4 : 53.985
2020-09-27 22:58:37,506 R@8 : 64.370
2020-09-27 22:59:31,357 Epoch: 11, loss: 1.479, time (seconds): 53.85.
2020-09-27 22:59:31,357 **Evaluating.**
2020-09-27 23:00:11,416 NMI: 25.184
2020-09-27 23:00:23,250 R@1 : 32.763
2020-09-27 23:00:23,511 R@2 : 42.930
2020-09-27 23:00:23,767 R@4 : 53.089
2020-09-27 23:00:24,015 R@8 : 62.814
2020-09-27 23:01:18,830 Epoch: 12, loss: 1.441, time (seconds): 54.81.
2020-09-27 23:01:18,831 **Evaluating.**
2020-09-27 23:01:59,978 NMI: 24.554
2020-09-27 23:02:12,050 R@1 : 31.998
2020-09-27 23:02:12,300 R@2 : 41.722
2020-09-27 23:02:12,553 R@4 : 52.629
2020-09-27 23:02:12,804 R@8 : 63.005
2020-09-27 23:03:05,976 Epoch: 13, loss: 1.476, time (seconds): 53.17.
2020-09-27 23:03:05,977 **Evaluating.**
2020-09-27 23:03:44,467 NMI: 23.958
2020-09-27 23:03:56,109 R@1 : 31.815
2020-09-27 23:03:56,354 R@2 : 41.123
2020-09-27 23:03:56,601 R@4 : 51.264
2020-09-27 23:03:56,852 R@8 : 61.788
2020-09-27 23:04:50,037 Epoch: 14, loss: 1.405, time (seconds): 53.18.
2020-09-27 23:04:50,037 **Evaluating.**
2020-09-27 23:05:27,552 NMI: 24.037
2020-09-27 23:05:39,146 R@1 : 31.581
2020-09-27 23:05:39,419 R@2 : 40.827
2020-09-27 23:05:39,690 R@4 : 50.769
2020-09-27 23:05:39,955 R@8 : 61.258
2020-09-27 23:06:33,729 Epoch: 15, loss: 1.357, time (seconds): 53.77.
2020-09-27 23:06:33,729 **Evaluating.**
2020-09-27 23:07:13,126 NMI: 23.399
2020-09-27 23:07:25,075 R@1 : 30.190
2020-09-27 23:07:25,322 R@2 : 39.863
2020-09-27 23:07:25,578 R@4 : 49.648
2020-09-27 23:07:25,837 R@8 : 60.424
2020-09-27 23:08:19,854 Epoch: 16, loss: 1.321, time (seconds): 54.01.
2020-09-27 23:08:19,855 **Evaluating.**
2020-09-27 23:09:00,264 NMI: 22.970
2020-09-27 23:09:12,718 R@1 : 30.529
2020-09-27 23:09:12,981 R@2 : 40.080
2020-09-27 23:09:13,236 R@4 : 49.996
2020-09-27 23:09:13,490 R@8 : 60.563
2020-09-27 23:10:10,741 Epoch: 17, loss: 1.269, time (seconds): 57.25.
2020-09-27 23:10:10,742 **Evaluating.**
2020-09-27 23:10:51,531 NMI: 22.509
2020-09-27 23:11:03,562 R@1 : 30.112
2020-09-27 23:11:03,815 R@2 : 38.707
2020-09-27 23:11:04,062 R@4 : 48.614
2020-09-27 23:11:04,326 R@8 : 59.173
2020-09-27 23:12:00,081 Epoch: 18, loss: 1.217, time (seconds): 55.75.
2020-09-27 23:12:00,083 **Evaluating.**
2020-09-27 23:12:38,356 NMI: 21.436
2020-09-27 23:12:50,208 R@1 : 28.565
2020-09-27 23:12:50,463 R@2 : 37.777
2020-09-27 23:12:50,716 R@4 : 47.536
2020-09-27 23:12:50,986 R@8 : 58.008
2020-09-27 23:13:46,509 Epoch: 19, loss: 1.229, time (seconds): 55.52.
2020-09-27 23:13:46,510 **Evaluating.**
2020-09-27 23:14:25,754 NMI: 23.359
2020-09-27 23:14:37,489 R@1 : 30.616
2020-09-27 23:14:37,738 R@2 : 38.924
2020-09-27 23:14:37,997 R@4 : 48.953
2020-09-27 23:14:38,292 R@8 : 59.364
2020-09-27 23:14:38,295 Total training time (minutes): 36.46.
2020-09-27 23:14:39,090 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-223804', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-27 23:14:39,091 Training for 20 epochs
2020-09-27 23:14:39,093 **Evaluating initial model.**
2020-09-27 23:15:19,312 NMI: 25.916
2020-09-27 23:15:31,425 R@1 : 32.493
2020-09-27 23:15:31,682 R@2 : 41.514
2020-09-27 23:15:31,951 R@4 : 51.994
2020-09-27 23:15:32,215 R@8 : 62.736
2020-09-27 23:16:25,823 Epoch: 0, loss: 2.729, time (seconds): 53.61.
2020-09-27 23:16:25,824 **Evaluating.**
2020-09-27 23:17:05,587 NMI: 27.167
2020-09-27 23:17:16,911 R@1 : 31.746
2020-09-27 23:17:17,166 R@2 : 42.148
2020-09-27 23:17:17,420 R@4 : 53.350
2020-09-27 23:17:17,676 R@8 : 64.370
