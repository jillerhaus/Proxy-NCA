2020-09-26 00:14:33,490 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 128, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food-20200926-001426', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 3, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-26 00:14:33,490 Training for 20 epochs
2020-09-26 00:14:33,493 **Evaluating initial model.**
2020-09-26 00:17:08,764 NMI: 27.896
2020-09-26 00:20:06,113 R@1 : 47.275
2020-09-26 00:20:06,853 R@2 : 55.785
2020-09-26 00:20:07,598 R@4 : 64.523
2020-09-26 00:20:08,344 R@8 : 73.146
2020-09-26 00:22:39,629 Epoch: 0, loss: 3.096, time (seconds): 151.28.
2020-09-26 00:22:39,630 **Evaluating.**
2020-09-26 00:25:02,894 NMI: 29.581
2020-09-26 00:27:51,403 R@1 : 47.958
2020-09-26 00:27:52,167 R@2 : 56.850
2020-09-26 00:27:52,923 R@4 : 65.655
2020-09-26 00:27:53,668 R@8 : 73.706
2020-09-26 00:30:45,929 Epoch: 1, loss: 2.975, time (seconds): 172.25.
2020-09-26 00:30:45,930 **Evaluating.**
2020-09-26 00:33:41,940 NMI: 29.205
2020-09-26 00:36:26,134 R@1 : 46.663
2020-09-26 00:36:26,905 R@2 : 55.674
2020-09-26 00:36:27,649 R@4 : 64.509
2020-09-26 00:36:28,397 R@8 : 72.736
2020-09-26 00:39:23,817 Epoch: 2, loss: 2.894, time (seconds): 175.41.
2020-09-26 00:39:23,819 **Evaluating.**
2020-09-26 00:42:15,726 NMI: 29.269
2020-09-26 00:44:56,770 R@1 : 44.962
2020-09-26 00:44:57,514 R@2 : 54.260
2020-09-26 00:44:58,267 R@4 : 63.246
2020-09-26 00:44:59,031 R@8 : 71.912
2020-09-26 00:47:54,494 Epoch: 3, loss: 2.872, time (seconds): 175.46.
2020-09-26 00:47:54,496 **Evaluating.**
2020-09-26 00:51:09,480 NMI: 28.226
2020-09-26 00:53:51,236 R@1 : 44.059
2020-09-26 00:53:51,981 R@2 : 53.021
2020-09-26 00:53:52,722 R@4 : 62.444
2020-09-26 00:53:53,465 R@8 : 71.076
2020-09-26 00:56:38,038 Epoch: 4, loss: 2.821, time (seconds): 164.57.
2020-09-26 00:56:38,039 **Evaluating.**
2020-09-26 00:59:57,910 NMI: 27.808
2020-09-26 01:02:33,527 R@1 : 42.656
2020-09-26 01:02:34,275 R@2 : 51.694
2020-09-26 01:02:35,017 R@4 : 61.129
2020-09-26 01:02:35,761 R@8 : 69.935
2020-09-26 01:05:00,964 Epoch: 5, loss: 2.803, time (seconds): 145.20.
2020-09-26 01:05:00,965 **Evaluating.**
2020-09-26 01:08:15,863 NMI: 27.675
2020-09-26 01:10:51,607 R@1 : 41.797
2020-09-26 01:10:52,345 R@2 : 50.681
2020-09-26 01:10:53,082 R@4 : 60.119
2020-09-26 01:10:53,831 R@8 : 69.177
2020-09-26 01:13:17,912 Epoch: 6, loss: 2.779, time (seconds): 144.08.
2020-09-26 01:13:17,912 **Evaluating.**
2020-09-26 01:15:34,299 NMI: 26.601
2020-09-26 01:18:10,560 R@1 : 40.781
2020-09-26 01:18:11,307 R@2 : 49.911
2020-09-26 01:18:12,055 R@4 : 59.512
2020-09-26 01:18:12,806 R@8 : 68.503
2020-09-26 01:20:56,996 Epoch: 7, loss: 2.757, time (seconds): 164.19.
2020-09-26 01:20:56,997 **Evaluating.**
2020-09-26 01:23:15,277 NMI: 25.931
2020-09-26 01:25:48,829 R@1 : 40.247
2020-09-26 01:25:49,593 R@2 : 49.168
2020-09-26 01:25:50,339 R@4 : 58.485
2020-09-26 01:25:51,085 R@8 : 67.722
2020-09-26 01:28:48,450 Epoch: 8, loss: 2.737, time (seconds): 177.36.
2020-09-26 01:28:48,451 **Evaluating.**
2020-09-26 01:31:52,103 NMI: 26.535
2020-09-26 01:34:25,621 R@1 : 39.805
2020-09-26 01:34:26,418 R@2 : 48.974
2020-09-26 01:34:27,163 R@4 : 58.908
2020-09-26 01:34:27,921 R@8 : 68.007
2020-09-26 01:37:12,715 Epoch: 9, loss: 2.734, time (seconds): 164.79.
2020-09-26 01:37:12,716 **Evaluating.**
2020-09-26 01:40:27,347 NMI: 25.650
2020-09-26 01:43:00,426 R@1 : 38.743
2020-09-26 01:43:01,170 R@2 : 47.818
2020-09-26 01:43:01,914 R@4 : 57.364
2020-09-26 01:43:02,660 R@8 : 67.046
2020-09-26 01:45:33,087 Epoch: 10, loss: 2.701, time (seconds): 150.42.
2020-09-26 01:45:33,088 **Evaluating.**
2020-09-26 01:48:49,322 NMI: 25.349
2020-09-26 01:51:23,371 R@1 : 37.945
2020-09-26 01:51:24,119 R@2 : 46.982
2020-09-26 01:51:24,867 R@4 : 56.920
2020-09-26 01:51:25,619 R@8 : 66.465
2020-09-26 01:53:53,072 Epoch: 11, loss: 2.706, time (seconds): 147.45.
2020-09-26 01:53:53,073 **Evaluating.**
2020-09-26 01:56:23,822 NMI: 25.005
2020-09-26 01:58:57,710 R@1 : 37.927
2020-09-26 01:58:58,451 R@2 : 46.782
2020-09-26 01:58:59,193 R@4 : 56.165
2020-09-26 01:58:59,935 R@8 : 66.027
2020-09-26 02:01:24,797 Epoch: 12, loss: 2.677, time (seconds): 144.86.
2020-09-26 02:01:24,798 **Evaluating.**
2020-09-26 02:04:11,850 NMI: 25.377
2020-09-26 02:06:44,517 R@1 : 37.576
2020-09-26 02:06:45,255 R@2 : 46.791
2020-09-26 02:06:46,007 R@4 : 56.388
2020-09-26 02:06:46,758 R@8 : 65.847
2020-09-26 02:09:12,112 Epoch: 13, loss: 2.679, time (seconds): 145.35.
2020-09-26 02:09:12,113 **Evaluating.**
2020-09-26 02:11:57,718 NMI: 24.861
2020-09-26 02:14:22,756 R@1 : 37.225
2020-09-26 02:14:23,494 R@2 : 46.169
2020-09-26 02:14:24,234 R@4 : 55.895
2020-09-26 02:14:24,973 R@8 : 65.014
2020-09-26 02:16:29,727 Epoch: 14, loss: 2.649, time (seconds): 124.75.
2020-09-26 02:16:29,727 **Evaluating.**
2020-09-26 02:18:18,733 NMI: 24.646
2020-09-26 02:20:42,740 R@1 : 36.618
2020-09-26 02:20:43,487 R@2 : 45.798
2020-09-26 02:20:44,239 R@4 : 55.547
2020-09-26 02:20:44,991 R@8 : 65.098
2020-09-26 02:22:32,055 Epoch: 15, loss: 2.661, time (seconds): 107.06.
2020-09-26 02:22:32,056 **Evaluating.**
2020-09-26 02:24:08,989 NMI: 24.365
2020-09-26 02:26:33,526 R@1 : 36.867
2020-09-26 02:26:34,267 R@2 : 45.690
2020-09-26 02:26:35,011 R@4 : 55.497
2020-09-26 02:26:35,754 R@8 : 64.863
2020-09-26 02:28:22,622 Epoch: 16, loss: 2.645, time (seconds): 106.87.
2020-09-26 02:28:22,623 **Evaluating.**
2020-09-26 02:29:58,743 NMI: 24.435
2020-09-26 02:32:23,980 R@1 : 36.127
2020-09-26 02:32:24,724 R@2 : 44.726
2020-09-26 02:32:25,470 R@4 : 54.728
2020-09-26 02:32:26,220 R@8 : 64.462
2020-09-26 02:34:18,231 Epoch: 17, loss: 2.641, time (seconds): 112.01.
2020-09-26 02:34:18,232 **Evaluating.**
2020-09-26 02:35:53,712 NMI: 24.244
2020-09-26 02:38:18,572 R@1 : 35.991
2020-09-26 02:38:19,313 R@2 : 44.953
2020-09-26 02:38:20,051 R@4 : 54.539
2020-09-26 02:38:20,796 R@8 : 64.358
2020-09-26 02:40:04,925 Epoch: 18, loss: 2.629, time (seconds): 104.12.
2020-09-26 02:40:04,925 **Evaluating.**
2020-09-26 02:41:40,939 NMI: 24.450
2020-09-26 02:44:03,865 R@1 : 35.953
2020-09-26 02:44:04,607 R@2 : 44.933
2020-09-26 02:44:05,349 R@4 : 54.435
2020-09-26 02:44:06,091 R@8 : 64.160
2020-09-26 02:45:55,746 Epoch: 19, loss: 2.616, time (seconds): 109.65.
2020-09-26 02:45:55,747 **Evaluating.**
2020-09-26 02:47:30,531 NMI: 23.766
2020-09-26 02:49:55,691 R@1 : 35.329
2020-09-26 02:49:56,486 R@2 : 43.945
2020-09-26 02:49:57,288 R@4 : 53.558
2020-09-26 02:49:58,074 R@8 : 63.295
2020-09-26 02:49:58,077 Total training time (minutes): 155.41.
2020-09-26 02:50:00,842 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 128, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food-20200926-001426', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 3, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-26 02:50:00,843 Training for 20 epochs
2020-09-26 02:50:00,846 **Evaluating initial model.**
2020-09-26 02:51:38,440 NMI: 27.896
2020-09-26 02:54:17,237 R@1 : 47.275
2020-09-26 02:54:17,983 R@2 : 55.785
2020-09-26 02:54:18,733 R@4 : 64.523
2020-09-26 02:54:19,484 R@8 : 73.146
2020-09-26 02:56:08,028 Epoch: 0, loss: 2.179, time (seconds): 108.54.
2020-09-26 02:56:08,028 **Evaluating.**
2020-09-26 02:57:46,139 NMI: 32.056
2020-09-26 03:00:17,369 R@1 : 50.611
2020-09-26 03:00:18,125 R@2 : 59.422
2020-09-26 03:00:18,882 R@4 : 67.836
2020-09-26 03:00:19,632 R@8 : 75.663
2020-09-26 03:02:08,364 Epoch: 1, loss: 2.021, time (seconds): 108.73.
2020-09-26 03:02:08,365 **Evaluating.**
2020-09-26 03:03:45,391 NMI: 32.007
2020-09-26 03:06:17,791 R@1 : 50.777
2020-09-26 03:06:18,576 R@2 : 59.733
2020-09-26 03:06:19,357 R@4 : 68.335
2020-09-26 03:06:20,138 R@8 : 76.089
2020-09-26 03:08:06,163 Epoch: 2, loss: 1.866, time (seconds): 106.02.
2020-09-26 03:08:06,164 **Evaluating.**
2020-09-26 03:09:41,208 NMI: 31.201
2020-09-26 03:12:13,267 R@1 : 50.286
2020-09-26 03:12:14,012 R@2 : 59.271
2020-09-26 03:12:14,758 R@4 : 67.720
2020-09-26 03:12:15,507 R@8 : 75.578
2020-09-26 03:14:07,879 Epoch: 3, loss: 1.842, time (seconds): 112.37.
2020-09-26 03:14:07,879 **Evaluating.**
2020-09-26 03:15:47,807 NMI: 30.710
2020-09-26 03:18:20,026 R@1 : 50.109
2020-09-26 03:18:20,773 R@2 : 59.074
2020-09-26 03:18:21,514 R@4 : 67.688
2020-09-26 03:18:22,259 R@8 : 75.793
2020-09-26 03:20:07,640 Epoch: 4, loss: 1.730, time (seconds): 105.38.
2020-09-26 03:20:07,640 **Evaluating.**
2020-09-26 03:21:42,360 NMI: 30.206
2020-09-26 03:24:15,162 R@1 : 49.212
2020-09-26 03:24:15,909 R@2 : 58.261
2020-09-26 03:24:16,655 R@4 : 66.956
2020-09-26 03:24:17,406 R@8 : 74.885
2020-09-26 03:26:07,886 Epoch: 5, loss: 1.714, time (seconds): 110.48.
2020-09-26 03:26:07,886 **Evaluating.**
2020-09-26 03:27:58,497 NMI: 29.857
2020-09-26 03:30:32,678 R@1 : 48.689
2020-09-26 03:30:33,431 R@2 : 57.521
2020-09-26 03:30:34,179 R@4 : 66.413
2020-09-26 03:30:34,925 R@8 : 74.580
2020-09-26 03:32:27,584 Epoch: 6, loss: 1.650, time (seconds): 112.66.
2020-09-26 03:32:27,584 **Evaluating.**
2020-09-26 03:34:15,086 NMI: 28.553
2020-09-26 03:36:49,440 R@1 : 48.082
2020-09-26 03:36:50,183 R@2 : 56.899
2020-09-26 03:36:50,923 R@4 : 65.551
2020-09-26 03:36:51,668 R@8 : 73.747
2020-09-26 03:38:37,957 Epoch: 7, loss: 1.581, time (seconds): 106.29.
2020-09-26 03:38:37,958 **Evaluating.**
2020-09-26 03:40:17,904 NMI: 27.779
2020-09-26 03:42:51,645 R@1 : 47.386
2020-09-26 03:42:52,397 R@2 : 56.278
2020-09-26 03:42:53,151 R@4 : 64.964
2020-09-26 03:42:53,904 R@8 : 73.134
2020-09-26 03:44:43,574 Epoch: 8, loss: 1.545, time (seconds): 109.67.
2020-09-26 03:44:43,574 **Evaluating.**
2020-09-26 03:46:17,370 NMI: 28.289
2020-09-26 03:48:50,733 R@1 : 47.095
2020-09-26 03:48:51,482 R@2 : 56.066
2020-09-26 03:48:52,234 R@4 : 64.962
2020-09-26 03:48:52,985 R@8 : 73.215
2020-09-26 03:50:39,086 Epoch: 9, loss: 1.524, time (seconds): 106.10.
2020-09-26 03:50:39,087 **Evaluating.**
2020-09-26 03:52:12,576 NMI: 27.254
2020-09-26 03:54:45,848 R@1 : 46.431
2020-09-26 03:54:46,597 R@2 : 55.288
2020-09-26 03:54:47,351 R@4 : 63.966
2020-09-26 03:54:48,100 R@8 : 72.121
2020-09-26 03:56:33,149 Epoch: 10, loss: 1.477, time (seconds): 105.05.
2020-09-26 03:56:33,150 **Evaluating.**
2020-09-26 03:58:07,957 NMI: 26.683
2020-09-26 04:00:41,767 R@1 : 46.320
2020-09-26 04:00:42,511 R@2 : 54.957
2020-09-26 04:00:43,255 R@4 : 63.733
2020-09-26 04:00:44,012 R@8 : 72.010
2020-09-26 04:02:33,198 Epoch: 11, loss: 1.466, time (seconds): 109.18.
2020-09-26 04:02:33,198 **Evaluating.**
2020-09-26 04:04:09,006 NMI: 27.204
2020-09-26 04:06:42,264 R@1 : 45.783
2020-09-26 04:06:43,050 R@2 : 54.594
2020-09-26 04:06:43,840 R@4 : 63.304
2020-09-26 04:06:44,633 R@8 : 71.720
2020-09-26 04:08:29,821 Epoch: 12, loss: 1.435, time (seconds): 105.18.
2020-09-26 04:08:29,822 **Evaluating.**
2020-09-26 04:10:08,154 NMI: 26.954
2020-09-26 04:12:42,400 R@1 : 45.417
2020-09-26 04:12:43,149 R@2 : 53.999
2020-09-26 04:12:43,892 R@4 : 62.924
2020-09-26 04:12:44,637 R@8 : 71.270
2020-09-26 04:14:34,469 Epoch: 13, loss: 1.411, time (seconds): 109.83.
2020-09-26 04:14:34,469 **Evaluating.**
2020-09-26 04:16:08,415 NMI: 25.872
2020-09-26 04:18:43,354 R@1 : 44.207
2020-09-26 04:18:44,099 R@2 : 52.693
2020-09-26 04:18:44,851 R@4 : 61.675
2020-09-26 04:18:45,593 R@8 : 70.347
2020-09-26 04:20:30,497 Epoch: 14, loss: 1.351, time (seconds): 104.90.
2020-09-26 04:20:30,497 **Evaluating.**
2020-09-26 04:22:05,217 NMI: 25.951
2020-09-26 04:24:38,831 R@1 : 43.919
2020-09-26 04:24:39,578 R@2 : 52.579
2020-09-26 04:24:40,326 R@4 : 61.524
2020-09-26 04:24:41,075 R@8 : 70.254
2020-09-26 04:26:27,703 Epoch: 15, loss: 1.355, time (seconds): 106.62.
2020-09-26 04:26:27,704 **Evaluating.**
2020-09-26 04:28:01,935 NMI: 25.203
2020-09-26 04:30:35,946 R@1 : 44.024
2020-09-26 04:30:36,699 R@2 : 52.347
2020-09-26 04:30:37,453 R@4 : 61.399
2020-09-26 04:30:38,204 R@8 : 70.318
2020-09-26 04:32:28,473 Epoch: 16, loss: 1.342, time (seconds): 110.27.
2020-09-26 04:32:28,474 **Evaluating.**
2020-09-26 04:34:03,570 NMI: 25.813
2020-09-26 04:36:37,558 R@1 : 43.702
2020-09-26 04:36:38,304 R@2 : 52.402
2020-09-26 04:36:39,048 R@4 : 61.362
2020-09-26 04:36:39,791 R@8 : 70.071
2020-09-26 04:38:28,182 Epoch: 17, loss: 1.329, time (seconds): 108.39.
2020-09-26 04:38:28,183 **Evaluating.**
2020-09-26 04:40:02,039 NMI: 24.983
2020-09-26 04:42:37,283 R@1 : 43.722
2020-09-26 04:42:38,030 R@2 : 52.208
2020-09-26 04:42:38,777 R@4 : 60.978
2020-09-26 04:42:39,526 R@8 : 69.560
2020-09-26 04:44:27,189 Epoch: 18, loss: 1.297, time (seconds): 107.66.
2020-09-26 04:44:27,189 **Evaluating.**
2020-09-26 04:46:01,415 NMI: 25.644
2020-09-26 04:48:35,726 R@1 : 43.051
2020-09-26 04:48:36,476 R@2 : 51.630
2020-09-26 04:48:37,227 R@4 : 60.534
2020-09-26 04:48:37,972 R@8 : 69.337
2020-09-26 04:50:24,272 Epoch: 19, loss: 1.265, time (seconds): 106.30.
2020-09-26 04:50:24,273 **Evaluating.**
2020-09-26 04:51:59,327 NMI: 24.267
2020-09-26 04:54:34,490 R@1 : 42.386
2020-09-26 04:54:35,291 R@2 : 50.835
2020-09-26 04:54:36,080 R@4 : 59.625
2020-09-26 04:54:36,877 R@8 : 68.344
2020-09-26 04:54:36,880 Total training time (minutes): 124.60.
2020-09-26 04:54:39,004 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 128, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200926-001426', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 3, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-26 04:54:39,005 Training for 20 epochs
2020-09-26 04:54:39,007 **Evaluating initial model.**
2020-09-26 04:56:17,551 NMI: 27.896
2020-09-26 04:58:56,573 R@1 : 47.275
2020-09-26 04:58:57,312 R@2 : 55.785
2020-09-26 04:58:58,050 R@4 : 64.523
2020-09-26 04:58:58,793 R@8 : 73.146
2020-09-26 05:00:50,194 Epoch: 0, loss: 2.201, time (seconds): 111.40.
2020-09-26 05:00:50,195 **Evaluating.**
2020-09-26 05:02:31,071 NMI: 31.282
2020-09-26 05:05:00,332 R@1 : 49.633
2020-09-26 05:05:01,073 R@2 : 58.868
2020-09-26 05:05:01,813 R@4 : 67.847
2020-09-26 05:05:02,554 R@8 : 76.049
2020-09-26 05:06:48,097 Epoch: 1, loss: 2.033, time (seconds): 105.54.
2020-09-26 05:06:48,098 **Evaluating.**
2020-09-26 05:08:24,862 NMI: 33.885
2020-09-26 05:10:55,018 R@1 : 51.999
2020-09-26 05:10:55,766 R@2 : 61.211
2020-09-26 05:10:56,509 R@4 : 69.755
2020-09-26 05:10:57,252 R@8 : 77.518
2020-09-26 05:12:49,581 Epoch: 2, loss: 1.860, time (seconds): 112.33.
2020-09-26 05:12:49,582 **Evaluating.**
2020-09-26 05:14:38,029 NMI: 33.692
2020-09-26 05:17:08,866 R@1 : 52.031
2020-09-26 05:17:09,608 R@2 : 60.973
2020-09-26 05:17:10,347 R@4 : 69.592
2020-09-26 05:17:11,086 R@8 : 77.367
2020-09-26 05:18:56,252 Epoch: 3, loss: 1.833, time (seconds): 105.16.
2020-09-26 05:18:56,253 **Evaluating.**
2020-09-26 05:20:34,850 NMI: 33.383
2020-09-26 05:23:06,002 R@1 : 52.484
2020-09-26 05:23:06,754 R@2 : 61.486
2020-09-26 05:23:07,506 R@4 : 69.920
2020-09-26 05:23:08,261 R@8 : 77.436
2020-09-26 05:24:55,858 Epoch: 4, loss: 1.724, time (seconds): 107.60.
2020-09-26 05:24:55,859 **Evaluating.**
2020-09-26 05:26:34,886 NMI: 34.406
2020-09-26 05:29:06,491 R@1 : 52.484
2020-09-26 05:29:07,227 R@2 : 61.521
2020-09-26 05:29:07,966 R@4 : 70.071
2020-09-26 05:29:08,704 R@8 : 77.457
2020-09-26 05:30:54,108 Epoch: 5, loss: 1.689, time (seconds): 105.40.
2020-09-26 05:30:54,109 **Evaluating.**
2020-09-26 05:32:42,010 NMI: 33.925
2020-09-26 05:35:14,762 R@1 : 51.769
2020-09-26 05:35:15,510 R@2 : 60.586
2020-09-26 05:35:16,261 R@4 : 69.011
2020-09-26 05:35:17,007 R@8 : 77.059
2020-09-26 05:37:05,542 Epoch: 6, loss: 1.626, time (seconds): 108.53.
2020-09-26 05:37:05,543 **Evaluating.**
2020-09-26 05:38:42,653 NMI: 33.201
2020-09-26 05:41:15,479 R@1 : 51.531
2020-09-26 05:41:16,224 R@2 : 60.360
2020-09-26 05:41:16,971 R@4 : 69.110
2020-09-26 05:41:17,714 R@8 : 77.047
2020-09-26 05:43:08,621 Epoch: 7, loss: 1.542, time (seconds): 110.90.
2020-09-26 05:43:08,622 **Evaluating.**
2020-09-26 05:44:54,617 NMI: 32.975
2020-09-26 05:47:27,973 R@1 : 51.569
2020-09-26 05:47:28,718 R@2 : 60.276
2020-09-26 05:47:29,460 R@4 : 68.855
2020-09-26 05:47:30,213 R@8 : 76.722
2020-09-26 05:49:18,388 Epoch: 8, loss: 1.497, time (seconds): 108.17.
2020-09-26 05:49:18,389 **Evaluating.**
2020-09-26 05:51:00,843 NMI: 32.685
2020-09-26 05:53:33,972 R@1 : 51.401
2020-09-26 05:53:34,717 R@2 : 60.084
2020-09-26 05:53:35,464 R@4 : 68.628
2020-09-26 05:53:36,209 R@8 : 76.566
2020-09-26 05:55:24,162 Epoch: 9, loss: 1.477, time (seconds): 107.95.
2020-09-26 05:55:24,163 **Evaluating.**
2020-09-26 05:57:01,133 NMI: 32.332
2020-09-26 05:59:35,498 R@1 : 51.081
2020-09-26 05:59:36,245 R@2 : 59.681
2020-09-26 05:59:36,990 R@4 : 68.126
2020-09-26 05:59:37,734 R@8 : 76.104
2020-09-26 06:01:25,104 Epoch: 10, loss: 1.420, time (seconds): 107.37.
2020-09-26 06:01:25,105 **Evaluating.**
2020-09-26 06:03:15,527 NMI: 32.687
2020-09-26 06:05:51,095 R@1 : 50.785
2020-09-26 06:05:51,841 R@2 : 59.385
2020-09-26 06:05:52,588 R@4 : 67.966
2020-09-26 06:05:53,340 R@8 : 75.828
2020-09-26 06:07:38,153 Epoch: 11, loss: 1.383, time (seconds): 104.81.
2020-09-26 06:07:38,153 **Evaluating.**
2020-09-26 06:09:16,235 NMI: 32.164
2020-09-26 06:11:50,746 R@1 : 50.417
2020-09-26 06:11:51,486 R@2 : 59.054
2020-09-26 06:11:52,229 R@4 : 67.923
2020-09-26 06:11:52,970 R@8 : 75.918
2020-09-26 06:13:39,123 Epoch: 12, loss: 1.372, time (seconds): 106.15.
2020-09-26 06:13:39,124 **Evaluating.**
2020-09-26 06:15:16,555 NMI: 32.207
2020-09-26 06:17:51,658 R@1 : 50.466
2020-09-26 06:17:52,409 R@2 : 58.987
2020-09-26 06:17:53,160 R@4 : 67.322
2020-09-26 06:17:53,913 R@8 : 75.157
2020-09-26 06:19:44,005 Epoch: 13, loss: 1.350, time (seconds): 110.09.
2020-09-26 06:19:44,005 **Evaluating.**
2020-09-26 06:21:21,428 NMI: 31.249
2020-09-26 06:23:56,485 R@1 : 49.740
2020-09-26 06:23:57,235 R@2 : 58.322
2020-09-26 06:23:57,982 R@4 : 66.808
2020-09-26 06:23:58,736 R@8 : 74.879
2020-09-26 06:25:43,596 Epoch: 14, loss: 1.283, time (seconds): 104.86.
2020-09-26 06:25:43,596 **Evaluating.**
2020-09-26 06:27:33,765 NMI: 31.770
2020-09-26 06:30:08,939 R@1 : 49.874
2020-09-26 06:30:09,679 R@2 : 58.551
2020-09-26 06:30:10,422 R@4 : 67.304
2020-09-26 06:30:11,165 R@8 : 75.099
2020-09-26 06:31:57,592 Epoch: 15, loss: 1.280, time (seconds): 106.42.
2020-09-26 06:31:57,593 **Evaluating.**
2020-09-26 06:33:35,149 NMI: 31.271
2020-09-26 06:36:10,531 R@1 : 49.543
2020-09-26 06:36:11,282 R@2 : 58.313
2020-09-26 06:36:12,026 R@4 : 66.764
2020-09-26 06:36:12,773 R@8 : 74.530
2020-09-26 06:38:06,206 Epoch: 16, loss: 1.273, time (seconds): 113.43.
2020-09-26 06:38:06,206 **Evaluating.**
2020-09-26 06:39:57,360 NMI: 30.738
2020-09-26 06:42:33,882 R@1 : 49.551
2020-09-26 06:42:34,628 R@2 : 58.014
2020-09-26 06:42:35,373 R@4 : 66.590
2020-09-26 06:42:36,125 R@8 : 74.771
2020-09-26 06:44:25,054 Epoch: 17, loss: 1.261, time (seconds): 108.93.
2020-09-26 06:44:25,054 **Evaluating.**
2020-09-26 06:46:10,381 NMI: 31.034
2020-09-26 06:48:46,689 R@1 : 49.952
2020-09-26 06:48:47,431 R@2 : 58.540
2020-09-26 06:48:48,174 R@4 : 66.994
2020-09-26 06:48:48,920 R@8 : 75.041
2020-09-26 06:50:39,443 Epoch: 18, loss: 1.235, time (seconds): 110.52.
2020-09-26 06:50:39,443 **Evaluating.**
2020-09-26 06:52:17,489 NMI: 30.888
2020-09-26 06:54:53,509 R@1 : 49.607
2020-09-26 06:54:54,255 R@2 : 58.258
2020-09-26 06:54:55,002 R@4 : 66.489
2020-09-26 06:54:55,754 R@8 : 74.484
2020-09-26 06:56:44,074 Epoch: 19, loss: 1.184, time (seconds): 108.32.
2020-09-26 06:56:44,075 **Evaluating.**
2020-09-26 06:58:36,716 NMI: 30.481
2020-09-26 07:01:12,752 R@1 : 49.017
2020-09-26 07:01:13,499 R@2 : 57.814
2020-09-26 07:01:14,249 R@4 : 66.259
2020-09-26 07:01:14,992 R@8 : 74.336
2020-09-26 07:01:14,995 Total training time (minutes): 126.60.
2020-09-26 07:01:17,094 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 128, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food-20200926-001426', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 3, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-26 07:01:17,095 Training for 20 epochs
2020-09-26 07:01:17,097 **Evaluating initial model.**
2020-09-26 07:02:54,820 NMI: 27.896
2020-09-26 07:05:34,413 R@1 : 47.275
2020-09-26 07:05:35,153 R@2 : 55.785
2020-09-26 07:05:35,893 R@4 : 64.523
2020-09-26 07:05:36,635 R@8 : 73.146
2020-09-26 07:07:29,227 Epoch: 0, loss: 2.180, time (seconds): 112.59.
2020-09-26 07:07:29,228 **Evaluating.**
2020-09-26 07:09:24,904 NMI: 32.280
2020-09-26 07:11:56,229 R@1 : 50.518
2020-09-26 07:11:56,971 R@2 : 59.370
2020-09-26 07:11:57,713 R@4 : 67.862
2020-09-26 07:11:58,459 R@8 : 75.689
2020-09-26 07:13:45,439 Epoch: 1, loss: 2.022, time (seconds): 106.98.
2020-09-26 07:13:45,440 **Evaluating.**
2020-09-26 07:15:25,213 NMI: 31.659
2020-09-26 07:17:57,294 R@1 : 50.852
2020-09-26 07:17:58,041 R@2 : 59.646
2020-09-26 07:17:58,788 R@4 : 68.321
2020-09-26 07:17:59,530 R@8 : 76.342
2020-09-26 07:19:51,443 Epoch: 2, loss: 1.865, time (seconds): 111.91.
2020-09-26 07:19:51,444 **Evaluating.**
2020-09-26 07:21:26,212 NMI: 31.419
2020-09-26 07:23:57,797 R@1 : 50.196
2020-09-26 07:23:58,539 R@2 : 58.839
2020-09-26 07:23:59,287 R@4 : 67.595
2020-09-26 07:24:00,033 R@8 : 75.523
2020-09-26 07:25:45,856 Epoch: 3, loss: 1.843, time (seconds): 105.82.
2020-09-26 07:25:45,857 **Evaluating.**
2020-09-26 07:27:36,170 NMI: 31.022
2020-09-26 07:30:07,979 R@1 : 50.335
2020-09-26 07:30:08,717 R@2 : 59.228
2020-09-26 07:30:09,462 R@4 : 67.557
2020-09-26 07:30:10,213 R@8 : 75.706
2020-09-26 07:31:56,203 Epoch: 4, loss: 1.733, time (seconds): 105.99.
2020-09-26 07:31:56,203 **Evaluating.**
2020-09-26 07:33:31,590 NMI: 30.597
2020-09-26 07:36:03,894 R@1 : 49.247
2020-09-26 07:36:04,631 R@2 : 58.287
2020-09-26 07:36:05,369 R@4 : 66.985
2020-09-26 07:36:06,109 R@8 : 74.954
2020-09-26 07:37:53,116 Epoch: 5, loss: 1.710, time (seconds): 107.00.
2020-09-26 07:37:53,117 **Evaluating.**
2020-09-26 07:39:27,803 NMI: 29.420
2020-09-26 07:42:00,003 R@1 : 48.808
2020-09-26 07:42:00,790 R@2 : 57.791
2020-09-26 07:42:01,580 R@4 : 66.343
2020-09-26 07:42:02,372 R@8 : 74.330
2020-09-26 07:43:54,572 Epoch: 6, loss: 1.651, time (seconds): 112.20.
2020-09-26 07:43:54,572 **Evaluating.**
2020-09-26 07:45:35,910 NMI: 28.538
2020-09-26 07:48:08,713 R@1 : 47.850
2020-09-26 07:48:09,462 R@2 : 56.545
2020-09-26 07:48:10,205 R@4 : 65.420
2020-09-26 07:48:10,946 R@8 : 73.628
2020-09-26 07:49:57,084 Epoch: 7, loss: 1.588, time (seconds): 106.14.
2020-09-26 07:49:57,085 **Evaluating.**
2020-09-26 07:51:47,284 NMI: 28.135
2020-09-26 07:54:20,445 R@1 : 47.223
2020-09-26 07:54:21,192 R@2 : 56.194
2020-09-26 07:54:21,939 R@4 : 65.043
2020-09-26 07:54:22,688 R@8 : 73.349
2020-09-26 07:56:11,556 Epoch: 8, loss: 1.545, time (seconds): 108.87.
2020-09-26 07:56:11,556 **Evaluating.**
2020-09-26 07:57:47,211 NMI: 28.341
2020-09-26 08:00:20,878 R@1 : 47.505
2020-09-26 08:00:21,624 R@2 : 56.081
2020-09-26 08:00:22,375 R@4 : 64.970
2020-09-26 08:00:23,122 R@8 : 73.160
2020-09-26 08:02:10,906 Epoch: 9, loss: 1.529, time (seconds): 107.78.
2020-09-26 08:02:10,907 **Evaluating.**
2020-09-26 08:03:58,698 NMI: 27.200
2020-09-26 08:06:32,537 R@1 : 46.091
2020-09-26 08:06:33,283 R@2 : 55.044
2020-09-26 08:06:34,028 R@4 : 63.911
2020-09-26 08:06:34,771 R@8 : 72.278
2020-09-26 08:08:19,592 Epoch: 10, loss: 1.479, time (seconds): 104.82.
2020-09-26 08:08:19,592 **Evaluating.**
2020-09-26 08:09:53,030 NMI: 27.149
2020-09-26 08:12:27,003 R@1 : 45.864
2020-09-26 08:12:27,764 R@2 : 54.896
2020-09-26 08:12:28,508 R@4 : 63.893
2020-09-26 08:12:29,251 R@8 : 72.182
2020-09-26 08:14:20,204 Epoch: 11, loss: 1.468, time (seconds): 110.95.
2020-09-26 08:14:20,204 **Evaluating.**
2020-09-26 08:15:58,940 NMI: 26.746
2020-09-26 08:18:31,758 R@1 : 45.400
2020-09-26 08:18:32,507 R@2 : 54.095
2020-09-26 08:18:33,254 R@4 : 63.292
2020-09-26 08:18:34,009 R@8 : 71.694
2020-09-26 08:20:20,395 Epoch: 12, loss: 1.429, time (seconds): 106.38.
2020-09-26 08:20:20,396 **Evaluating.**
2020-09-26 08:22:11,069 NMI: 26.820
2020-09-26 08:24:44,468 R@1 : 45.705
2020-09-26 08:24:45,232 R@2 : 54.281
2020-09-26 08:24:45,980 R@4 : 62.851
2020-09-26 08:24:46,729 R@8 : 71.227
2020-09-26 08:26:35,471 Epoch: 13, loss: 1.421, time (seconds): 108.74.
2020-09-26 08:26:35,471 **Evaluating.**
2020-09-26 08:28:09,351 NMI: 25.737
2020-09-26 08:30:43,649 R@1 : 44.555
2020-09-26 08:30:44,482 R@2 : 53.157
2020-09-26 08:30:45,315 R@4 : 62.102
2020-09-26 08:30:46,146 R@8 : 70.495
2020-09-26 08:32:38,254 Epoch: 14, loss: 1.348, time (seconds): 112.11.
2020-09-26 08:32:38,254 **Evaluating.**
2020-09-26 08:34:25,808 NMI: 25.731
2020-09-26 08:36:59,250 R@1 : 43.821
2020-09-26 08:36:59,992 R@2 : 52.664
2020-09-26 08:37:00,733 R@4 : 61.701
2020-09-26 08:37:01,473 R@8 : 70.269
2020-09-26 08:38:49,991 Epoch: 15, loss: 1.359, time (seconds): 108.51.
2020-09-26 08:38:49,992 **Evaluating.**
2020-09-26 08:40:27,405 NMI: 25.533
2020-09-26 08:43:01,115 R@1 : 43.937
2020-09-26 08:43:01,905 R@2 : 52.690
2020-09-26 08:43:02,695 R@4 : 61.553
2020-09-26 08:43:03,488 R@8 : 69.874
2020-09-26 08:44:57,517 Epoch: 16, loss: 1.339, time (seconds): 114.03.
2020-09-26 08:44:57,518 **Evaluating.**
2020-09-26 08:46:32,123 NMI: 25.603
2020-09-26 08:49:06,728 R@1 : 43.879
2020-09-26 08:49:07,462 R@2 : 52.382
2020-09-26 08:49:08,198 R@4 : 61.179
2020-09-26 08:49:08,934 R@8 : 69.792
2020-09-26 08:50:57,880 Epoch: 17, loss: 1.322, time (seconds): 108.94.
2020-09-26 08:50:57,881 **Evaluating.**
2020-09-26 08:52:48,475 NMI: 24.655
2020-09-26 08:55:23,475 R@1 : 43.890
2020-09-26 08:55:24,214 R@2 : 52.219
2020-09-26 08:55:24,966 R@4 : 61.135
2020-09-26 08:55:25,714 R@8 : 69.874
2020-09-26 08:57:10,445 Epoch: 18, loss: 1.305, time (seconds): 104.73.
2020-09-26 08:57:10,445 **Evaluating.**
2020-09-26 08:58:43,270 NMI: 25.280
2020-09-26 09:01:17,398 R@1 : 42.979
2020-09-26 09:01:18,187 R@2 : 51.592
2020-09-26 09:01:18,980 R@4 : 60.523
2020-09-26 09:01:19,775 R@8 : 69.357
2020-09-26 09:03:09,696 Epoch: 19, loss: 1.266, time (seconds): 109.92.
2020-09-26 09:03:09,697 **Evaluating.**
2020-09-26 09:05:04,907 NMI: 24.313
2020-09-26 09:07:39,880 R@1 : 42.465
2020-09-26 09:07:40,623 R@2 : 50.785
2020-09-26 09:07:41,371 R@4 : 59.611
2020-09-26 09:07:42,118 R@8 : 68.245
2020-09-26 09:07:42,121 Total training time (minutes): 126.42.
2020-09-26 09:07:44,237 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 128, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food-20200926-001426', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 3, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-26 09:07:44,238 Training for 20 epochs
2020-09-26 09:07:44,239 **Evaluating initial model.**
2020-09-26 09:09:21,681 NMI: 27.896
2020-09-26 09:12:00,395 R@1 : 47.275
2020-09-26 09:12:01,143 R@2 : 55.785
2020-09-26 09:12:01,889 R@4 : 64.523
2020-09-26 09:12:02,636 R@8 : 73.146
2020-09-26 09:13:53,450 Epoch: 0, loss: 2.239, time (seconds): 110.81.
2020-09-26 09:13:53,452 **Evaluating.**
2020-09-26 09:15:41,777 NMI: 31.173
2020-09-26 09:18:09,206 R@1 : 48.739
2020-09-26 09:18:09,950 R@2 : 58.084
2020-09-26 09:18:10,694 R@4 : 67.258
2020-09-26 09:18:11,439 R@8 : 75.671
2020-09-26 09:19:57,941 Epoch: 1, loss: 2.046, time (seconds): 106.50.
2020-09-26 09:19:57,942 **Evaluating.**
2020-09-26 09:21:52,863 NMI: 33.533
2020-09-26 09:24:22,897 R@1 : 51.386
2020-09-26 09:24:23,641 R@2 : 60.624
2020-09-26 09:24:24,387 R@4 : 69.232
2020-09-26 09:24:25,133 R@8 : 77.262
2020-09-26 09:26:17,985 Epoch: 2, loss: 1.883, time (seconds): 112.85.
2020-09-26 09:26:17,985 **Evaluating.**
2020-09-26 09:27:54,975 NMI: 33.791
2020-09-26 09:30:24,889 R@1 : 52.042
2020-09-26 09:30:25,637 R@2 : 60.996
2020-09-26 09:30:26,386 R@4 : 69.740
2020-09-26 09:30:27,139 R@8 : 77.492
2020-09-26 09:32:20,476 Epoch: 3, loss: 1.846, time (seconds): 113.33.
2020-09-26 09:32:20,477 **Evaluating.**
2020-09-26 09:34:14,890 NMI: 33.474
2020-09-26 09:36:46,341 R@1 : 52.202
2020-09-26 09:36:47,092 R@2 : 61.211
2020-09-26 09:36:47,832 R@4 : 69.984
2020-09-26 09:36:48,575 R@8 : 77.677
2020-09-26 09:38:34,657 Epoch: 4, loss: 1.733, time (seconds): 106.08.
2020-09-26 09:38:34,657 **Evaluating.**
2020-09-26 09:40:12,268 NMI: 34.364
2020-09-26 09:42:44,081 R@1 : 52.594
2020-09-26 09:42:44,836 R@2 : 61.469
2020-09-26 09:42:45,582 R@4 : 70.039
2020-09-26 09:42:46,330 R@8 : 77.799
2020-09-26 09:44:38,772 Epoch: 5, loss: 1.707, time (seconds): 112.44.
2020-09-26 09:44:38,772 **Evaluating.**
2020-09-26 09:46:20,571 NMI: 33.737
2020-09-26 09:48:53,575 R@1 : 51.703
2020-09-26 09:48:54,401 R@2 : 60.764
2020-09-26 09:48:55,226 R@4 : 69.212
2020-09-26 09:48:56,053 R@8 : 77.074
2020-09-26 09:50:45,753 Epoch: 6, loss: 1.646, time (seconds): 109.70.
2020-09-26 09:50:45,754 **Evaluating.**
2020-09-26 09:52:39,410 NMI: 32.744
2020-09-26 09:55:12,318 R@1 : 51.436
2020-09-26 09:55:13,058 R@2 : 60.302
2020-09-26 09:55:13,804 R@4 : 69.006
2020-09-26 09:55:14,547 R@8 : 76.943
2020-09-26 09:57:05,200 Epoch: 7, loss: 1.565, time (seconds): 110.65.
2020-09-26 09:57:05,201 **Evaluating.**
2020-09-26 09:58:57,974 NMI: 32.944
2020-09-26 10:01:31,545 R@1 : 51.529
2020-09-26 10:01:32,285 R@2 : 60.409
2020-09-26 10:01:33,026 R@4 : 68.927
2020-09-26 10:01:33,767 R@8 : 76.955
2020-09-26 10:03:20,503 Epoch: 8, loss: 1.503, time (seconds): 106.73.
2020-09-26 10:03:20,504 **Evaluating.**
2020-09-26 10:04:57,732 NMI: 33.107
2020-09-26 10:07:31,612 R@1 : 51.264
2020-09-26 10:07:32,356 R@2 : 60.087
2020-09-26 10:07:33,104 R@4 : 68.712
2020-09-26 10:07:33,850 R@8 : 76.554
2020-09-26 10:09:25,756 Epoch: 9, loss: 1.495, time (seconds): 111.90.
2020-09-26 10:09:25,757 **Evaluating.**
2020-09-26 10:11:08,029 NMI: 32.276
2020-09-26 10:13:41,039 R@1 : 50.512
2020-09-26 10:13:41,787 R@2 : 59.515
2020-09-26 10:13:42,532 R@4 : 68.326
2020-09-26 10:13:43,282 R@8 : 76.162
2020-09-26 10:15:30,777 Epoch: 10, loss: 1.439, time (seconds): 107.49.
2020-09-26 10:15:30,778 **Evaluating.**
2020-09-26 10:17:26,627 NMI: 32.009
2020-09-26 10:20:01,849 R@1 : 50.637
2020-09-26 10:20:02,590 R@2 : 59.251
2020-09-26 10:20:03,340 R@4 : 67.963
2020-09-26 10:20:04,091 R@8 : 75.738
2020-09-26 10:21:53,585 Epoch: 11, loss: 1.397, time (seconds): 109.49.
2020-09-26 10:21:53,586 **Evaluating.**
2020-09-26 10:23:31,877 NMI: 32.442
2020-09-26 10:26:07,023 R@1 : 50.120
2020-09-26 10:26:07,766 R@2 : 58.923
2020-09-26 10:26:08,513 R@4 : 67.711
2020-09-26 10:26:09,258 R@8 : 75.950
2020-09-26 10:28:00,590 Epoch: 12, loss: 1.381, time (seconds): 111.33.
2020-09-26 10:28:00,591 **Evaluating.**
2020-09-26 10:29:54,122 NMI: 32.124
2020-09-26 10:32:28,338 R@1 : 50.324
2020-09-26 10:32:29,078 R@2 : 58.955
2020-09-26 10:32:29,821 R@4 : 67.542
2020-09-26 10:32:30,574 R@8 : 75.651
2020-09-26 10:34:18,513 Epoch: 13, loss: 1.360, time (seconds): 107.94.
2020-09-26 10:34:18,513 **Evaluating.**
2020-09-26 10:36:02,393 NMI: 31.563
2020-09-26 10:38:37,640 R@1 : 49.731
2020-09-26 10:38:38,386 R@2 : 58.374
2020-09-26 10:38:39,127 R@4 : 66.921
2020-09-26 10:38:39,870 R@8 : 75.361
2020-09-26 10:40:31,041 Epoch: 14, loss: 1.297, time (seconds): 111.17.
2020-09-26 10:40:31,041 **Evaluating.**
2020-09-26 10:42:08,205 NMI: 30.936
2020-09-26 10:44:43,240 R@1 : 49.868
2020-09-26 10:44:44,024 R@2 : 58.432
2020-09-26 10:44:44,813 R@4 : 66.767
2020-09-26 10:44:45,601 R@8 : 75.288
2020-09-26 10:46:32,836 Epoch: 15, loss: 1.292, time (seconds): 107.23.
2020-09-26 10:46:32,836 **Evaluating.**
2020-09-26 10:48:26,620 NMI: 31.094
2020-09-26 10:51:02,962 R@1 : 49.430
2020-09-26 10:51:03,701 R@2 : 58.125
2020-09-26 10:51:04,445 R@4 : 66.692
2020-09-26 10:51:05,195 R@8 : 74.943
2020-09-26 10:52:56,656 Epoch: 16, loss: 1.270, time (seconds): 111.46.
2020-09-26 10:52:56,656 **Evaluating.**
2020-09-26 10:54:35,498 NMI: 30.620
2020-09-26 10:57:12,096 R@1 : 49.386
2020-09-26 10:57:12,843 R@2 : 57.956
2020-09-26 10:57:13,589 R@4 : 66.605
2020-09-26 10:57:14,337 R@8 : 74.957
2020-09-26 10:59:09,772 Epoch: 17, loss: 1.269, time (seconds): 115.43.
2020-09-26 10:59:09,773 **Evaluating.**
2020-09-26 11:01:07,447 NMI: 30.945
2020-09-26 11:03:52,787 R@1 : 49.380
2020-09-26 11:03:53,539 R@2 : 58.078
2020-09-26 11:03:54,284 R@4 : 66.576
2020-09-26 11:03:55,035 R@8 : 74.760
2020-09-26 11:05:48,547 Epoch: 18, loss: 1.241, time (seconds): 113.51.
2020-09-26 11:05:48,548 **Evaluating.**
2020-09-26 11:07:43,608 NMI: 30.945
2020-09-26 11:10:35,779 R@1 : 49.014
2020-09-26 11:10:36,523 R@2 : 57.855
2020-09-26 11:10:37,271 R@4 : 66.436
2020-09-26 11:10:38,018 R@8 : 74.684
2020-09-26 11:12:41,224 Epoch: 19, loss: 1.187, time (seconds): 123.20.
2020-09-26 11:12:41,224 **Evaluating.**
2020-09-26 11:15:16,211 NMI: 30.313
2020-09-26 11:18:11,548 R@1 : 48.631
2020-09-26 11:18:12,304 R@2 : 57.196
2020-09-26 11:18:13,060 R@4 : 65.838
2020-09-26 11:18:13,819 R@8 : 73.985
2020-09-26 11:18:13,822 Total training time (minutes): 130.49.
2020-09-26 11:18:15,915 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 128, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200926-001426', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 3, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-26 11:18:15,915 Training for 20 epochs
2020-09-26 11:18:15,917 **Evaluating initial model.**
2020-09-26 11:20:03,942 NMI: 27.896
2020-09-26 11:22:58,218 R@1 : 47.275
2020-09-26 11:22:58,955 R@2 : 55.785
2020-09-26 11:22:59,705 R@4 : 64.523
2020-09-26 11:23:00,442 R@8 : 73.146
2020-09-26 11:25:16,458 Epoch: 0, loss: 2.768, time (seconds): 136.01.
2020-09-26 11:25:16,459 **Evaluating.**
2020-09-26 11:27:31,028 NMI: 27.351
2020-09-26 11:30:11,333 R@1 : 43.510
2020-09-26 11:30:12,083 R@2 : 52.582
2020-09-26 11:30:12,836 R@4 : 62.436
2020-09-26 11:30:13,585 R@8 : 71.578
2020-09-26 11:32:22,994 Epoch: 1, loss: 2.344, time (seconds): 129.41.
2020-09-26 11:32:22,995 **Evaluating.**
2020-09-26 11:34:28,952 NMI: 30.594
2020-09-26 11:37:12,665 R@1 : 47.127
2020-09-26 11:37:13,412 R@2 : 56.415
2020-09-26 11:37:14,160 R@4 : 65.757
2020-09-26 11:37:14,910 R@8 : 74.295
