2020-09-27 18:55:51,967 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-185548', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-27 18:55:51,968 Training for 20 epochs
2020-09-27 18:55:51,971 **Evaluating initial model.**
2020-09-27 18:56:56,954 NMI: 25.916
2020-09-27 18:57:09,365 R@1 : 32.493
2020-09-27 18:57:09,643 R@2 : 41.514
2020-09-27 18:57:09,917 R@4 : 51.994
2020-09-27 18:57:10,193 R@8 : 62.736
2020-09-27 18:58:09,860 Epoch: 0, loss: 3.115, time (seconds): 59.67.
2020-09-27 18:58:09,861 **Evaluating.**
2020-09-27 18:58:51,327 NMI: 29.476
2020-09-27 18:59:02,810 R@1 : 36.578
2020-09-27 18:59:03,058 R@2 : 46.841
2020-09-27 18:59:03,320 R@4 : 57.556
2020-09-27 18:59:03,585 R@8 : 67.142
2020-09-27 19:00:00,093 Epoch: 1, loss: 2.991, time (seconds): 56.50.
2020-09-27 19:00:00,094 **Evaluating.**
2020-09-27 19:00:40,798 NMI: 29.101
2020-09-27 19:00:52,589 R@1 : 34.761
2020-09-27 19:00:52,844 R@2 : 45.259
2020-09-27 19:00:53,100 R@4 : 55.549
2020-09-27 19:00:53,375 R@8 : 65.777
2020-09-27 19:01:49,432 Epoch: 2, loss: 2.958, time (seconds): 56.05.
2020-09-27 19:01:49,433 **Evaluating.**
2020-09-27 19:02:29,928 NMI: 28.959
2020-09-27 19:02:41,440 R@1 : 33.293
2020-09-27 19:02:41,699 R@2 : 44.051
2020-09-27 19:02:41,970 R@4 : 54.993
2020-09-27 19:02:42,256 R@8 : 65.282
2020-09-27 19:03:38,485 Epoch: 3, loss: 2.913, time (seconds): 56.23.
2020-09-27 19:03:38,486 **Evaluating.**
2020-09-27 19:04:18,612 NMI: 27.752
2020-09-27 19:04:30,048 R@1 : 32.033
2020-09-27 19:04:30,299 R@2 : 41.870
2020-09-27 19:04:30,559 R@4 : 52.490
2020-09-27 19:04:30,807 R@8 : 63.057
2020-09-27 19:05:26,288 Epoch: 4, loss: 2.854, time (seconds): 55.48.
2020-09-27 19:05:26,288 **Evaluating.**
2020-09-27 19:06:07,533 NMI: 26.065
2020-09-27 19:06:18,979 R@1 : 30.833
2020-09-27 19:06:19,239 R@2 : 40.497
2020-09-27 19:06:19,512 R@4 : 50.708
2020-09-27 19:06:19,786 R@8 : 62.119
2020-09-27 19:07:15,936 Epoch: 5, loss: 2.834, time (seconds): 56.15.
2020-09-27 19:07:15,938 **Evaluating.**
2020-09-27 19:07:55,486 NMI: 26.255
2020-09-27 19:08:06,834 R@1 : 29.547
2020-09-27 19:08:07,083 R@2 : 39.376
2020-09-27 19:08:07,331 R@4 : 50.326
2020-09-27 19:08:07,584 R@8 : 60.876
2020-09-27 19:09:03,637 Epoch: 6, loss: 2.771, time (seconds): 56.05.
2020-09-27 19:09:03,638 **Evaluating.**
2020-09-27 19:09:42,534 NMI: 26.389
2020-09-27 19:09:53,877 R@1 : 30.260
2020-09-27 19:09:54,126 R@2 : 39.967
2020-09-27 19:09:54,375 R@4 : 50.274
2020-09-27 19:09:54,644 R@8 : 61.458
2020-09-27 19:10:49,794 Epoch: 7, loss: 2.779, time (seconds): 55.15.
2020-09-27 19:10:49,796 **Evaluating.**
2020-09-27 19:11:28,060 NMI: 25.665
2020-09-27 19:11:39,331 R@1 : 28.617
2020-09-27 19:11:39,580 R@2 : 37.786
2020-09-27 19:11:39,849 R@4 : 48.927
2020-09-27 19:11:40,095 R@8 : 60.389
2020-09-27 19:12:35,023 Epoch: 8, loss: 2.751, time (seconds): 54.92.
2020-09-27 19:12:35,023 **Evaluating.**
2020-09-27 19:13:13,803 NMI: 24.639
2020-09-27 19:13:25,228 R@1 : 27.505
2020-09-27 19:13:25,518 R@2 : 36.725
2020-09-27 19:13:25,808 R@4 : 47.736
2020-09-27 19:13:26,094 R@8 : 58.677
2020-09-27 19:14:21,696 Epoch: 9, loss: 2.755, time (seconds): 55.60.
2020-09-27 19:14:21,697 **Evaluating.**
2020-09-27 19:15:00,447 NMI: 24.893
2020-09-27 19:15:11,842 R@1 : 28.235
2020-09-27 19:15:12,096 R@2 : 37.812
2020-09-27 19:15:12,360 R@4 : 48.371
2020-09-27 19:15:12,613 R@8 : 58.842
2020-09-27 19:16:07,666 Epoch: 10, loss: 2.704, time (seconds): 55.05.
2020-09-27 19:16:07,667 **Evaluating.**
2020-09-27 19:16:46,717 NMI: 25.505
2020-09-27 19:16:58,048 R@1 : 27.809
2020-09-27 19:16:58,306 R@2 : 37.647
2020-09-27 19:16:58,555 R@4 : 48.371
2020-09-27 19:16:58,819 R@8 : 59.060
2020-09-27 19:17:53,688 Epoch: 11, loss: 2.677, time (seconds): 54.87.
2020-09-27 19:17:53,689 **Evaluating.**
2020-09-27 19:18:32,673 NMI: 24.984
2020-09-27 19:18:44,079 R@1 : 26.367
2020-09-27 19:18:44,334 R@2 : 35.917
2020-09-27 19:18:44,598 R@4 : 46.546
2020-09-27 19:18:44,853 R@8 : 57.539
2020-09-27 19:19:39,878 Epoch: 12, loss: 2.691, time (seconds): 55.02.
2020-09-27 19:19:39,879 **Evaluating.**
2020-09-27 19:20:18,274 NMI: 23.959
2020-09-27 19:20:29,631 R@1 : 26.080
2020-09-27 19:20:29,881 R@2 : 35.213
2020-09-27 19:20:30,127 R@4 : 45.650
2020-09-27 19:20:30,378 R@8 : 56.731
2020-09-27 19:21:25,271 Epoch: 13, loss: 2.695, time (seconds): 54.89.
2020-09-27 19:21:25,272 **Evaluating.**
2020-09-27 19:22:04,415 NMI: 24.619
2020-09-27 19:22:15,738 R@1 : 26.749
2020-09-27 19:22:16,007 R@2 : 35.856
2020-09-27 19:22:16,287 R@4 : 45.911
2020-09-27 19:22:16,556 R@8 : 56.809
2020-09-27 19:23:11,935 Epoch: 14, loss: 2.651, time (seconds): 55.38.
2020-09-27 19:23:11,936 **Evaluating.**
2020-09-27 19:23:50,584 NMI: 24.232
2020-09-27 19:24:01,877 R@1 : 26.028
2020-09-27 19:24:02,125 R@2 : 34.996
2020-09-27 19:24:02,388 R@4 : 45.459
2020-09-27 19:24:02,650 R@8 : 56.479
2020-09-27 19:24:57,856 Epoch: 15, loss: 2.644, time (seconds): 55.20.
2020-09-27 19:24:57,857 **Evaluating.**
2020-09-27 19:25:36,348 NMI: 23.152
2020-09-27 19:25:47,678 R@1 : 24.611
2020-09-27 19:25:47,940 R@2 : 33.658
2020-09-27 19:25:48,207 R@4 : 43.991
2020-09-27 19:25:48,464 R@8 : 55.436
2020-09-27 19:26:43,276 Epoch: 16, loss: 2.625, time (seconds): 54.81.
2020-09-27 19:26:43,277 **Evaluating.**
2020-09-27 19:27:22,432 NMI: 23.397
2020-09-27 19:27:33,817 R@1 : 24.403
2020-09-27 19:27:34,072 R@2 : 33.684
2020-09-27 19:27:34,320 R@4 : 43.930
2020-09-27 19:27:34,576 R@8 : 55.227
2020-09-27 19:28:29,555 Epoch: 17, loss: 2.590, time (seconds): 54.98.
2020-09-27 19:28:29,556 **Evaluating.**
2020-09-27 19:29:07,900 NMI: 22.673
2020-09-27 19:29:19,253 R@1 : 25.011
2020-09-27 19:29:19,532 R@2 : 33.354
2020-09-27 19:29:19,807 R@4 : 43.721
2020-09-27 19:29:20,083 R@8 : 54.975
2020-09-27 19:30:14,941 Epoch: 18, loss: 2.585, time (seconds): 54.86.
2020-09-27 19:30:14,942 **Evaluating.**
2020-09-27 19:30:53,595 NMI: 23.106
2020-09-27 19:31:05,004 R@1 : 23.959
2020-09-27 19:31:05,252 R@2 : 32.459
2020-09-27 19:31:05,520 R@4 : 42.435
2020-09-27 19:31:05,782 R@8 : 54.315
2020-09-27 19:32:00,898 Epoch: 19, loss: 2.599, time (seconds): 55.11.
2020-09-27 19:32:00,900 **Evaluating.**
2020-09-27 19:32:39,416 NMI: 22.434
2020-09-27 19:32:50,816 R@1 : 23.221
2020-09-27 19:32:51,077 R@2 : 32.050
2020-09-27 19:32:51,327 R@4 : 41.974
2020-09-27 19:32:51,596 R@8 : 53.863
2020-09-27 19:32:51,598 Total training time (minutes): 36.99.
2020-09-27 19:32:52,359 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-185548', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-27 19:32:52,360 Training for 20 epochs
2020-09-27 19:32:52,361 **Evaluating initial model.**
2020-09-27 19:33:31,772 NMI: 25.916
2020-09-27 19:33:43,996 R@1 : 32.493
2020-09-27 19:33:44,262 R@2 : 41.514
2020-09-27 19:33:44,530 R@4 : 51.994
2020-09-27 19:33:44,819 R@8 : 62.736
2020-09-27 19:34:40,554 Epoch: 0, loss: 2.488, time (seconds): 55.73.
2020-09-27 19:34:40,555 **Evaluating.**
2020-09-27 19:35:19,694 NMI: 29.915
2020-09-27 19:35:31,303 R@1 : 37.681
2020-09-27 19:35:31,558 R@2 : 48.310
2020-09-27 19:35:31,803 R@4 : 58.799
2020-09-27 19:35:32,057 R@8 : 68.680
2020-09-27 19:36:27,813 Epoch: 1, loss: 2.242, time (seconds): 55.75.
2020-09-27 19:36:27,814 **Evaluating.**
