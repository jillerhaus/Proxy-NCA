2020-09-18 18:30:02,515 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 40, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food-20200918-182955', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-18 18:30:02,516 Training for 40 epochs
2020-09-18 18:30:02,518 **Evaluating initial model.**
2020-09-18 18:32:43,232 NMI: 24.435
2020-09-18 18:34:19,527 R@1 : 42.006
2020-09-18 18:34:20,259 R@2 : 50.544
2020-09-18 18:34:20,994 R@4 : 59.936
2020-09-18 18:34:21,749 R@8 : 69.261
2020-09-18 18:36:38,877 Epoch: 0, loss: 2.456, time (seconds): 137.13.
2020-09-18 18:36:38,878 **Evaluating.**
2020-09-18 18:38:31,983 NMI: 28.252
2020-09-18 18:39:54,018 R@1 : 44.604
2020-09-18 18:39:54,741 R@2 : 54.037
2020-09-18 18:39:55,465 R@4 : 63.719
2020-09-18 18:39:56,190 R@8 : 72.786
2020-09-18 18:41:47,402 Epoch: 1, loss: 2.140, time (seconds): 111.21.
2020-09-18 18:41:47,403 **Evaluating.**
2020-09-18 18:43:37,658 NMI: 31.706
2020-09-18 18:45:03,494 R@1 : 49.627
2020-09-18 18:45:04,220 R@2 : 58.798
2020-09-18 18:45:04,945 R@4 : 67.688
2020-09-18 18:45:05,677 R@8 : 75.985
2020-09-18 18:47:00,504 Epoch: 2, loss: 2.002, time (seconds): 114.82.
2020-09-18 18:47:00,505 **Evaluating.**
2020-09-18 18:48:36,306 NMI: 33.012
2020-09-18 18:50:02,663 R@1 : 50.687
2020-09-18 18:50:03,424 R@2 : 59.736
2020-09-18 18:50:04,183 R@4 : 68.402
2020-09-18 18:50:04,940 R@8 : 76.603
2020-09-18 18:51:58,269 Epoch: 3, loss: 1.884, time (seconds): 113.33.
2020-09-18 18:51:58,269 **Evaluating.**
2020-09-18 18:54:24,691 NMI: 32.869
2020-09-18 18:55:56,182 R@1 : 50.753
2020-09-18 18:55:56,908 R@2 : 59.904
2020-09-18 18:55:57,635 R@4 : 68.567
2020-09-18 18:55:58,363 R@8 : 76.650
2020-09-18 18:57:49,036 Epoch: 4, loss: 1.798, time (seconds): 110.67.
2020-09-18 18:57:49,036 **Evaluating.**
2020-09-18 18:59:28,226 NMI: 32.446
2020-09-18 19:00:59,134 R@1 : 50.713
2020-09-18 19:00:59,859 R@2 : 59.898
2020-09-18 19:01:00,602 R@4 : 68.747
2020-09-18 19:01:01,334 R@8 : 76.963
2020-09-18 19:02:51,388 Epoch: 5, loss: 1.742, time (seconds): 110.05.
2020-09-18 19:02:51,388 **Evaluating.**
2020-09-18 19:04:29,339 NMI: 32.161
2020-09-18 19:05:59,196 R@1 : 50.794
2020-09-18 19:05:59,930 R@2 : 59.843
2020-09-18 19:06:00,660 R@4 : 68.530
2020-09-18 19:06:01,391 R@8 : 76.618
2020-09-18 19:07:43,101 Epoch: 6, loss: 1.691, time (seconds): 101.71.
2020-09-18 19:07:43,101 **Evaluating.**
2020-09-18 19:09:20,203 NMI: 31.998
2020-09-18 19:10:50,765 R@1 : 50.602
2020-09-18 19:10:51,520 R@2 : 59.347
2020-09-18 19:10:52,265 R@4 : 68.068
2020-09-18 19:10:52,994 R@8 : 75.994
2020-09-18 19:12:39,810 Epoch: 7, loss: 1.625, time (seconds): 106.81.
2020-09-18 19:12:39,811 **Evaluating.**
2020-09-18 19:14:23,210 NMI: 32.867
2020-09-18 19:15:53,387 R@1 : 51.241
2020-09-18 19:15:54,111 R@2 : 60.122
2020-09-18 19:15:54,843 R@4 : 68.776
2020-09-18 19:15:55,575 R@8 : 76.728
2020-09-18 19:17:46,204 Epoch: 8, loss: 1.602, time (seconds): 110.63.
2020-09-18 19:17:46,205 **Evaluating.**
2020-09-18 19:19:23,689 NMI: 32.080
2020-09-18 19:20:53,584 R@1 : 50.225
2020-09-18 19:20:54,365 R@2 : 59.254
2020-09-18 19:20:55,145 R@4 : 68.152
2020-09-18 19:20:55,925 R@8 : 75.930
2020-09-18 19:22:31,379 Epoch: 9, loss: 1.528, time (seconds): 95.45.
2020-09-18 19:22:31,380 **Evaluating.**
2020-09-18 19:24:03,432 NMI: 30.842
2020-09-18 19:25:31,716 R@1 : 50.010
2020-09-18 19:25:32,445 R@2 : 58.926
2020-09-18 19:25:33,172 R@4 : 67.377
2020-09-18 19:25:33,899 R@8 : 75.480
2020-09-18 19:27:09,037 Epoch: 10, loss: 1.472, time (seconds): 95.13.
2020-09-18 19:27:09,038 **Evaluating.**
2020-09-18 19:28:42,075 NMI: 31.493
2020-09-18 19:30:09,662 R@1 : 49.946
2020-09-18 19:30:10,388 R@2 : 58.653
2020-09-18 19:30:11,114 R@4 : 67.490
2020-09-18 19:30:11,840 R@8 : 75.605
2020-09-18 19:31:49,188 Epoch: 11, loss: 1.441, time (seconds): 97.34.
2020-09-18 19:31:49,188 **Evaluating.**
2020-09-18 19:33:48,832 NMI: 32.083
2020-09-18 19:35:17,690 R@1 : 49.461
2020-09-18 19:35:18,417 R@2 : 58.470
2020-09-18 19:35:19,146 R@4 : 67.200
2020-09-18 19:35:19,872 R@8 : 75.396
2020-09-18 19:37:18,935 Epoch: 12, loss: 1.389, time (seconds): 119.06.
2020-09-18 19:37:18,935 **Evaluating.**
2020-09-18 19:39:04,556 NMI: 31.053
2020-09-18 19:40:32,817 R@1 : 49.726
2020-09-18 19:40:33,569 R@2 : 58.403
2020-09-18 19:40:34,326 R@4 : 67.078
2020-09-18 19:40:35,076 R@8 : 75.297
2020-09-18 19:42:17,670 Epoch: 13, loss: 1.364, time (seconds): 102.59.
2020-09-18 19:42:17,671 **Evaluating.**
2020-09-18 19:43:49,562 NMI: 30.958
2020-09-18 19:45:18,097 R@1 : 49.270
2020-09-18 19:45:18,831 R@2 : 57.878
2020-09-18 19:45:19,570 R@4 : 66.625
2020-09-18 19:45:20,300 R@8 : 74.725
2020-09-18 19:46:58,588 Epoch: 14, loss: 1.334, time (seconds): 98.29.
2020-09-18 19:46:58,589 **Evaluating.**
2020-09-18 19:48:33,111 NMI: 30.455
2020-09-18 19:50:03,282 R@1 : 48.797
2020-09-18 19:50:04,031 R@2 : 57.677
2020-09-18 19:50:04,759 R@4 : 66.640
2020-09-18 19:50:05,491 R@8 : 74.713
2020-09-18 19:51:59,698 Epoch: 15, loss: 1.321, time (seconds): 114.20.
2020-09-18 19:51:59,699 **Evaluating.**
2020-09-18 19:53:34,850 NMI: 30.126
2020-09-18 19:55:06,837 R@1 : 48.300
2020-09-18 19:55:07,569 R@2 : 56.632
2020-09-18 19:55:08,304 R@4 : 65.571
2020-09-18 19:55:09,040 R@8 : 73.967
2020-09-18 19:56:47,897 Epoch: 16, loss: 1.301, time (seconds): 98.85.
2020-09-18 19:56:47,898 **Evaluating.**
2020-09-18 19:58:23,878 NMI: 29.913
2020-09-18 19:59:55,959 R@1 : 48.027
2020-09-18 19:59:56,700 R@2 : 56.751
2020-09-18 19:59:57,424 R@4 : 65.580
2020-09-18 19:59:58,153 R@8 : 73.802
2020-09-18 20:01:37,838 Epoch: 17, loss: 1.237, time (seconds): 99.68.
2020-09-18 20:01:37,839 **Evaluating.**
2020-09-18 20:03:12,744 NMI: 28.996
2020-09-18 20:04:46,205 R@1 : 47.667
2020-09-18 20:04:46,937 R@2 : 56.322
2020-09-18 20:04:47,674 R@4 : 65.057
2020-09-18 20:04:48,408 R@8 : 73.436
