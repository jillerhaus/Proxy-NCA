2020-09-06 21:13:22,993 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 15, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': False, 'scaling_x': 3.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200906-211316', 'results_filename': 'food-results.csv', '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-06 21:13:22,994 Training for 15 epochs
2020-09-06 21:13:22,995 **Evaluating initial model.**
2020-09-06 21:16:50,843 R@1 : 41.710
2020-09-06 21:16:51,583 R@2 : 49.972
2020-09-06 21:16:52,323 R@4 : 59.013
2020-09-06 21:16:53,065 R@8 : 68.489
2020-09-06 21:19:22,450 Epoch: 0, loss: 2.621, time (seconds): 149.38.
2020-09-06 21:19:22,450 **Evaluating.**
2020-09-06 21:23:11,800 R@1 : 43.034
2020-09-06 21:23:12,648 R@2 : 52.222
2020-09-06 21:23:13,524 R@4 : 62.041
2020-09-06 21:23:14,452 R@8 : 71.174
2020-09-06 21:25:49,946 Epoch: 1, loss: 2.375, time (seconds): 155.49.
2020-09-06 21:25:49,947 **Evaluating.**
2020-09-06 21:29:36,316 R@1 : 45.679
2020-09-06 21:29:37,241 R@2 : 55.143
2020-09-06 21:29:38,256 R@4 : 64.416
2020-09-06 21:29:39,114 R@8 : 73.601
2020-09-06 21:32:15,337 Epoch: 2, loss: 2.234, time (seconds): 156.22.
2020-09-06 21:32:15,337 **Evaluating.**
2020-09-06 21:35:47,989 R@1 : 46.111
2020-09-06 21:35:48,729 R@2 : 55.178
2020-09-06 21:35:49,462 R@4 : 64.491
2020-09-06 21:35:50,199 R@8 : 73.410
2020-09-06 21:38:15,422 Epoch: 3, loss: 1.917, time (seconds): 145.22.
2020-09-06 21:38:15,423 **Evaluating.**
2020-09-06 21:42:07,542 R@1 : 46.541
2020-09-06 21:42:08,480 R@2 : 55.866
2020-09-06 21:42:09,320 R@4 : 65.130
2020-09-06 21:42:10,181 R@8 : 73.808
2020-09-06 21:44:46,413 Epoch: 4, loss: 1.880, time (seconds): 156.23.
2020-09-06 21:44:46,414 **Evaluating.**
2020-09-06 21:48:32,495 R@1 : 46.811
2020-09-06 21:48:33,376 R@2 : 56.174
2020-09-06 21:48:34,213 R@4 : 65.382
2020-09-06 21:48:35,084 R@8 : 74.002
2020-09-06 21:51:09,123 Epoch: 5, loss: 1.840, time (seconds): 154.03.
2020-09-06 21:51:09,123 **Evaluating.**
2020-09-06 21:54:45,014 R@1 : 47.490
2020-09-06 21:54:45,791 R@2 : 56.876
2020-09-06 21:54:46,537 R@4 : 65.731
2020-09-06 21:54:47,273 R@8 : 74.487
2020-09-06 21:57:21,948 Epoch: 6, loss: 1.905, time (seconds): 154.67.
2020-09-06 21:57:21,948 **Evaluating.**
2020-09-06 22:01:06,313 R@1 : 47.415
2020-09-06 22:01:07,138 R@2 : 56.400
2020-09-06 22:01:08,019 R@4 : 65.621
2020-09-06 22:01:08,878 R@8 : 74.452
2020-09-06 22:03:38,914 Epoch: 7, loss: 1.787, time (seconds): 150.03.
2020-09-06 22:03:38,915 **Evaluating.**
2020-09-06 22:07:37,286 R@1 : 47.098
2020-09-06 22:07:38,193 R@2 : 56.057
2020-09-06 22:07:39,027 R@4 : 65.130
2020-09-06 22:07:39,875 R@8 : 74.017
2020-09-06 22:10:10,563 Epoch: 8, loss: 1.694, time (seconds): 150.69.
2020-09-06 22:10:10,563 **Evaluating.**
2020-09-06 22:13:46,651 R@1 : 47.316
2020-09-06 22:13:47,391 R@2 : 56.237
2020-09-06 22:13:48,133 R@4 : 65.229
2020-09-06 22:13:48,881 R@8 : 73.932
2020-09-06 22:16:24,602 Epoch: 9, loss: 1.592, time (seconds): 155.72.
2020-09-06 22:16:24,603 **Evaluating.**
2020-09-06 22:20:18,573 R@1 : 47.389
2020-09-06 22:20:19,330 R@2 : 56.304
2020-09-06 22:20:20,107 R@4 : 65.182
2020-09-06 22:20:20,866 R@8 : 74.156
2020-09-06 22:22:51,148 Epoch: 10, loss: 1.649, time (seconds): 150.28.
2020-09-06 22:22:51,149 **Evaluating.**
2020-09-06 22:26:30,088 R@1 : 47.400
2020-09-06 22:26:30,851 R@2 : 56.449
2020-09-06 22:26:31,595 R@4 : 65.470
2020-09-06 22:26:32,350 R@8 : 74.397
2020-09-06 22:29:04,159 Epoch: 11, loss: 1.495, time (seconds): 151.81.
2020-09-06 22:29:04,160 **Evaluating.**
2020-09-06 22:32:44,439 R@1 : 46.402
2020-09-06 22:32:45,175 R@2 : 55.471
2020-09-06 22:32:45,921 R@4 : 64.555
2020-09-06 22:32:46,671 R@8 : 73.430
2020-09-06 22:35:24,288 Epoch: 12, loss: 1.522, time (seconds): 157.62.
2020-09-06 22:35:24,288 **Evaluating.**
2020-09-06 22:39:09,677 R@1 : 45.766
2020-09-06 22:39:10,417 R@2 : 54.832
2020-09-06 22:39:11,154 R@4 : 63.977
2020-09-06 22:39:11,903 R@8 : 72.893
2020-09-06 22:41:41,906 Epoch: 13, loss: 1.343, time (seconds): 150.00.
2020-09-06 22:41:41,907 **Evaluating.**
2020-09-06 22:45:24,257 R@1 : 46.747
2020-09-06 22:45:24,999 R@2 : 55.741
2020-09-06 22:45:25,746 R@4 : 64.979
2020-09-06 22:45:26,490 R@8 : 73.831
2020-09-06 22:47:55,558 Epoch: 14, loss: 1.403, time (seconds): 149.07.
2020-09-06 22:47:55,558 **Evaluating.**
2020-09-06 22:51:35,194 R@1 : 45.818
2020-09-06 22:51:35,931 R@2 : 54.766
2020-09-06 22:51:36,677 R@4 : 63.879
2020-09-06 22:51:37,422 R@8 : 72.847
2020-09-06 22:51:37,425 Total training time (minutes): 98.24.
2020-09-06 22:51:40,723 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 15, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': False, 'scaling_x': 8.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food-20200906-211316', 'results_filename': 'food-results.csv', '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-06 22:51:40,723 Training for 15 epochs
2020-09-06 22:51:40,725 **Evaluating initial model.**
2020-09-06 22:55:10,113 R@1 : 41.841
2020-09-06 22:55:10,866 R@2 : 50.167
2020-09-06 22:55:11,668 R@4 : 59.396
2020-09-06 22:55:12,433 R@8 : 68.945
2020-09-06 22:57:45,758 Epoch: 0, loss: 2.608, time (seconds): 153.32.
2020-09-06 22:57:45,758 **Evaluating.**
2020-09-06 23:01:29,075 R@1 : 40.476
2020-09-06 23:01:29,817 R@2 : 49.308
2020-09-06 23:01:30,569 R@4 : 59.193
2020-09-06 23:01:31,313 R@8 : 69.189
2020-09-06 23:04:01,273 Epoch: 1, loss: 2.351, time (seconds): 149.96.
2020-09-06 23:04:01,274 **Evaluating.**
2020-09-06 23:07:37,922 R@1 : 43.281
2020-09-06 23:07:38,661 R@2 : 52.388
2020-09-06 23:07:39,399 R@4 : 62.111
2020-09-06 23:07:40,152 R@8 : 71.485
2020-09-06 23:10:17,317 Epoch: 2, loss: 2.216, time (seconds): 157.16.
2020-09-06 23:10:17,318 **Evaluating.**
2020-09-06 23:13:58,332 R@1 : 44.038
2020-09-06 23:13:59,103 R@2 : 52.879
2020-09-06 23:13:59,848 R@4 : 62.703
2020-09-06 23:14:01,086 R@8 : 72.394
2020-09-06 23:16:25,135 Epoch: 3, loss: 1.897, time (seconds): 144.05.
2020-09-06 23:16:25,136 **Evaluating.**
2020-09-06 23:20:05,233 R@1 : 46.056
2020-09-06 23:20:05,993 R@2 : 55.259
2020-09-06 23:20:06,737 R@4 : 64.578
2020-09-06 23:20:07,491 R@8 : 73.720
2020-09-06 23:22:36,647 Epoch: 4, loss: 1.880, time (seconds): 149.15.
2020-09-06 23:22:36,647 **Evaluating.**
2020-09-06 23:26:21,556 R@1 : 46.558
2020-09-06 23:26:22,302 R@2 : 55.753
2020-09-06 23:26:23,048 R@4 : 64.979
2020-09-06 23:26:23,792 R@8 : 73.758
2020-09-06 23:28:50,415 Epoch: 5, loss: 1.835, time (seconds): 146.62.
2020-09-06 23:28:50,416 **Evaluating.**
2020-09-06 23:32:25,568 R@1 : 47.075
2020-09-06 23:32:26,308 R@2 : 56.400
2020-09-06 23:32:27,047 R@4 : 65.385
2020-09-06 23:32:27,793 R@8 : 74.348
2020-09-06 23:35:05,497 Epoch: 6, loss: 1.770, time (seconds): 157.70.
2020-09-06 23:35:05,498 **Evaluating.**
2020-09-06 23:38:48,932 R@1 : 46.303
2020-09-06 23:38:49,673 R@2 : 55.422
2020-09-06 23:38:50,410 R@4 : 64.532
2020-09-06 23:38:51,146 R@8 : 73.279
2020-09-06 23:41:23,409 Epoch: 7, loss: 1.651, time (seconds): 152.26.
2020-09-06 23:41:23,410 **Evaluating.**
2020-09-06 23:45:04,915 R@1 : 46.044
2020-09-06 23:45:05,692 R@2 : 55.207
2020-09-06 23:45:06,455 R@4 : 64.543
2020-09-06 23:45:07,201 R@8 : 73.477
2020-09-06 23:47:30,227 Epoch: 8, loss: 1.699, time (seconds): 143.02.
2020-09-06 23:47:30,228 **Evaluating.**
2020-09-06 23:51:16,027 R@1 : 46.297
2020-09-06 23:51:16,767 R@2 : 55.320
2020-09-06 23:51:17,520 R@4 : 64.340
2020-09-06 23:51:18,264 R@8 : 72.998
2020-09-06 23:53:52,931 Epoch: 9, loss: 1.672, time (seconds): 154.67.
2020-09-06 23:53:52,932 **Evaluating.**
2020-09-06 23:57:27,833 R@1 : 46.730
2020-09-06 23:57:28,581 R@2 : 55.712
2020-09-06 23:57:29,321 R@4 : 65.066
2020-09-06 23:57:30,069 R@8 : 73.654
2020-09-06 23:59:57,270 Epoch: 10, loss: 1.603, time (seconds): 147.20.
2020-09-06 23:59:57,271 **Evaluating.**
2020-09-07 00:03:49,146 R@1 : 46.332
2020-09-07 00:03:49,887 R@2 : 55.419
2020-09-07 00:03:50,643 R@4 : 64.680
2020-09-07 00:03:51,391 R@8 : 73.593
2020-09-07 00:06:33,650 Epoch: 11, loss: 1.608, time (seconds): 162.26.
2020-09-07 00:06:33,650 **Evaluating.**
2020-09-07 00:10:20,817 R@1 : 46.105
2020-09-07 00:10:21,563 R@2 : 54.960
2020-09-07 00:10:22,310 R@4 : 64.294
2020-09-07 00:10:23,068 R@8 : 72.719
2020-09-07 00:12:56,734 Epoch: 12, loss: 1.508, time (seconds): 153.66.
2020-09-07 00:12:56,734 **Evaluating.**
2020-09-07 00:16:44,268 R@1 : 46.329
2020-09-07 00:16:45,013 R@2 : 55.430
2020-09-07 00:16:45,754 R@4 : 64.532
2020-09-07 00:16:46,507 R@8 : 73.207
2020-09-07 00:19:19,020 Epoch: 13, loss: 1.453, time (seconds): 152.51.
2020-09-07 00:19:19,020 **Evaluating.**
2020-09-07 00:22:57,482 R@1 : 45.310
2020-09-07 00:22:58,227 R@2 : 54.281
2020-09-07 00:22:58,972 R@4 : 63.580
2020-09-07 00:22:59,748 R@8 : 72.606
2020-09-07 00:25:36,588 Epoch: 14, loss: 1.494, time (seconds): 156.84.
2020-09-07 00:25:36,589 **Evaluating.**
2020-09-07 00:29:29,213 R@1 : 46.059
2020-09-07 00:29:30,085 R@2 : 55.242
2020-09-07 00:29:30,952 R@4 : 64.195
2020-09-07 00:29:31,774 R@8 : 72.977
2020-09-07 00:29:31,776 Total training time (minutes): 97.85.
2020-09-07 00:29:35,416 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 15, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': False, 'scaling_x': 8.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200906-211316', 'results_filename': 'food-results.csv', '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-07 00:29:35,416 Training for 15 epochs
2020-09-07 00:29:35,418 **Evaluating initial model.**
2020-09-07 00:33:11,428 R@1 : 41.852
2020-09-07 00:33:12,258 R@2 : 50.057
2020-09-07 00:33:13,110 R@4 : 58.955
2020-09-07 00:33:13,913 R@8 : 68.390
2020-09-07 00:35:52,473 Epoch: 0, loss: 3.825, time (seconds): 158.56.
2020-09-07 00:35:52,474 **Evaluating.**
2020-09-07 00:39:25,128 R@1 : 25.147
2020-09-07 00:39:25,877 R@2 : 31.459
2020-09-07 00:39:26,630 R@4 : 40.064
2020-09-07 00:39:27,392 R@8 : 51.732
2020-09-07 00:41:57,715 Epoch: 1, loss: 3.011, time (seconds): 150.32.
2020-09-07 00:41:57,715 **Evaluating.**
2020-09-07 00:45:27,550 R@1 : 31.154
2020-09-07 00:45:28,297 R@2 : 38.885
2020-09-07 00:45:29,038 R@4 : 48.187
2020-09-07 00:45:29,785 R@8 : 59.576
2020-09-07 00:48:03,872 Epoch: 2, loss: 2.530, time (seconds): 154.08.
2020-09-07 00:48:03,873 **Evaluating.**
2020-09-07 00:51:43,190 R@1 : 37.886
2020-09-07 00:51:43,926 R@2 : 46.526
2020-09-07 00:51:44,665 R@4 : 56.452
2020-09-07 00:51:45,405 R@8 : 66.901
2020-09-07 00:54:05,487 Epoch: 3, loss: 2.339, time (seconds): 140.08.
2020-09-07 00:54:05,488 **Evaluating.**
2020-09-07 00:57:34,596 R@1 : 40.845
2020-09-07 00:57:35,333 R@2 : 49.668
2020-09-07 00:57:36,073 R@4 : 59.448
2020-09-07 00:57:36,815 R@8 : 69.456
2020-09-07 01:00:06,967 Epoch: 4, loss: 2.196, time (seconds): 150.15.
2020-09-07 01:00:06,968 **Evaluating.**
2020-09-07 01:03:56,248 R@1 : 41.907
2020-09-07 01:03:56,995 R@2 : 50.861
2020-09-07 01:03:57,761 R@4 : 60.525
2020-09-07 01:03:58,507 R@8 : 70.399
2020-09-07 01:06:22,815 Epoch: 5, loss: 2.057, time (seconds): 144.31.
2020-09-07 01:06:22,816 **Evaluating.**
2020-09-07 01:09:58,052 R@1 : 43.487
2020-09-07 01:09:58,796 R@2 : 52.545
2020-09-07 01:09:59,547 R@4 : 62.079
2020-09-07 01:10:00,290 R@8 : 71.401
2020-09-07 01:12:34,051 Epoch: 6, loss: 1.974, time (seconds): 153.76.
2020-09-07 01:12:34,051 **Evaluating.**
2020-09-07 01:16:22,615 R@1 : 44.317
2020-09-07 01:16:23,370 R@2 : 53.436
2020-09-07 01:16:24,116 R@4 : 62.790
2020-09-07 01:16:24,859 R@8 : 71.949
2020-09-07 01:18:59,495 Epoch: 7, loss: 1.991, time (seconds): 154.63.
2020-09-07 01:18:59,496 **Evaluating.**
2020-09-07 01:22:31,849 R@1 : 44.297
2020-09-07 01:22:32,612 R@2 : 53.445
2020-09-07 01:22:33,360 R@4 : 62.720
2020-09-07 01:22:34,108 R@8 : 72.005
2020-09-07 01:25:11,760 Epoch: 8, loss: 1.869, time (seconds): 157.65.
2020-09-07 01:25:11,761 **Evaluating.**
2020-09-07 01:29:04,956 R@1 : 44.863
2020-09-07 01:29:05,700 R@2 : 54.075
2020-09-07 01:29:06,448 R@4 : 63.434
2020-09-07 01:29:07,194 R@8 : 72.458
2020-09-07 01:31:39,461 Epoch: 9, loss: 1.710, time (seconds): 152.27.
2020-09-07 01:31:39,462 **Evaluating.**
2020-09-07 01:35:16,650 R@1 : 44.773
2020-09-07 01:35:17,406 R@2 : 53.990
2020-09-07 01:35:18,156 R@4 : 63.530
2020-09-07 01:35:18,908 R@8 : 72.797
2020-09-07 01:37:49,952 Epoch: 10, loss: 1.778, time (seconds): 151.04.
2020-09-07 01:37:49,953 **Evaluating.**
2020-09-07 01:41:46,230 R@1 : 43.998
2020-09-07 01:41:47,016 R@2 : 52.948
2020-09-07 01:41:47,808 R@4 : 62.415
2020-09-07 01:41:48,596 R@8 : 71.499
2020-09-07 01:44:26,062 Epoch: 11, loss: 1.741, time (seconds): 157.46.
2020-09-07 01:44:26,063 **Evaluating.**
2020-09-07 01:48:04,510 R@1 : 44.093
2020-09-07 01:48:05,265 R@2 : 53.201
2020-09-07 01:48:06,024 R@4 : 62.639
2020-09-07 01:48:06,786 R@8 : 71.636
2020-09-07 01:50:41,265 Epoch: 12, loss: 1.669, time (seconds): 154.48.
2020-09-07 01:50:41,266 **Evaluating.**
2020-09-07 01:54:27,831 R@1 : 44.001
2020-09-07 01:54:28,580 R@2 : 52.893
2020-09-07 01:54:29,317 R@4 : 62.442
2020-09-07 01:54:30,051 R@8 : 71.746
2020-09-07 01:57:06,235 Epoch: 13, loss: 1.656, time (seconds): 156.18.
2020-09-07 01:57:06,235 **Evaluating.**
2020-09-07 02:00:53,531 R@1 : 43.797
2020-09-07 02:00:54,363 R@2 : 52.684
2020-09-07 02:00:55,228 R@4 : 62.201
2020-09-07 02:00:56,094 R@8 : 71.468
2020-09-07 02:03:25,487 Epoch: 14, loss: 1.610, time (seconds): 149.39.
2020-09-07 02:03:25,487 **Evaluating.**
2020-09-07 02:07:20,301 R@1 : 43.077
2020-09-07 02:07:21,053 R@2 : 51.993
2020-09-07 02:07:21,811 R@4 : 61.341
2020-09-07 02:07:22,563 R@8 : 70.646
2020-09-07 02:07:22,566 Total training time (minutes): 97.79.
2020-09-07 02:07:25,774 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 15, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': False, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 10, 'log_filename': 'food-20200906-211316', 'results_filename': 'food-results.csv', '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-07 02:07:25,775 Training for 15 epochs
2020-09-07 02:07:25,776 **Evaluating initial model.**
2020-09-07 02:10:58,392 R@1 : 42.595
2020-09-07 02:10:59,139 R@2 : 50.930
2020-09-07 02:10:59,932 R@4 : 59.956
2020-09-07 02:11:00,700 R@8 : 69.641
2020-09-07 02:13:46,871 Epoch: 0, loss: 2.949, time (seconds): 166.17.
2020-09-07 02:13:46,872 **Evaluating.**
2020-09-07 02:17:35,488 R@1 : 40.578
2020-09-07 02:17:36,237 R@2 : 49.897
2020-09-07 02:17:36,982 R@4 : 59.530
2020-09-07 02:17:37,726 R@8 : 69.035
2020-09-07 02:20:08,986 Epoch: 1, loss: 2.865, time (seconds): 151.26.
2020-09-07 02:20:08,987 **Evaluating.**
2020-09-07 02:23:41,635 R@1 : 38.891
2020-09-07 02:23:42,377 R@2 : 48.094
2020-09-07 02:23:43,145 R@4 : 58.145
2020-09-07 02:23:43,894 R@8 : 67.650
2020-09-07 02:26:23,361 Epoch: 2, loss: 2.859, time (seconds): 159.46.
2020-09-07 02:26:23,362 **Evaluating.**
2020-09-07 02:30:15,375 R@1 : 37.695
2020-09-07 02:30:16,125 R@2 : 46.953
2020-09-07 02:30:16,876 R@4 : 56.821
2020-09-07 02:30:17,626 R@8 : 66.393
2020-09-07 02:32:56,094 Epoch: 3, loss: 2.844, time (seconds): 158.47.
2020-09-07 02:32:56,095 **Evaluating.**
2020-09-07 02:36:25,154 R@1 : 37.132
2020-09-07 02:36:25,911 R@2 : 46.134
2020-09-07 02:36:26,652 R@4 : 56.005
2020-09-07 02:36:27,393 R@8 : 65.728
2020-09-07 02:39:11,170 Epoch: 4, loss: 2.762, time (seconds): 163.77.
2020-09-07 02:39:11,171 **Evaluating.**
2020-09-07 02:42:54,769 R@1 : 35.657
2020-09-07 02:42:55,512 R@2 : 44.880
2020-09-07 02:42:56,256 R@4 : 55.050
2020-09-07 02:42:57,042 R@8 : 64.793
2020-09-07 02:45:28,751 Epoch: 5, loss: 2.768, time (seconds): 151.71.
2020-09-07 02:45:28,752 **Evaluating.**
2020-09-07 02:48:59,739 R@1 : 36.255
2020-09-07 02:49:00,485 R@2 : 45.307
2020-09-07 02:49:01,225 R@4 : 55.581
2020-09-07 02:49:01,966 R@8 : 65.525
2020-09-07 02:51:43,950 Epoch: 6, loss: 2.754, time (seconds): 161.98.
2020-09-07 02:51:43,950 **Evaluating.**
2020-09-07 02:55:26,995 R@1 : 35.732
2020-09-07 02:55:27,734 R@2 : 44.744
2020-09-07 02:55:28,471 R@4 : 54.458
2020-09-07 02:55:29,237 R@8 : 64.276
2020-09-07 02:58:00,144 Epoch: 7, loss: 2.704, time (seconds): 150.90.
2020-09-07 02:58:00,145 **Evaluating.**
2020-09-07 03:01:34,214 R@1 : 35.950
2020-09-07 03:01:35,028 R@2 : 44.561
2020-09-07 03:01:35,860 R@4 : 54.748
2020-09-07 03:01:36,723 R@8 : 64.567
2020-09-07 03:04:14,722 Epoch: 8, loss: 2.716, time (seconds): 158.00.
2020-09-07 03:04:14,724 **Evaluating.**
2020-09-07 03:08:03,681 R@1 : 34.414
2020-09-07 03:08:04,431 R@2 : 43.257
2020-09-07 03:08:05,174 R@4 : 52.745
2020-09-07 03:08:05,920 R@8 : 62.741
2020-09-07 03:10:37,655 Epoch: 9, loss: 2.675, time (seconds): 151.73.
2020-09-07 03:10:37,656 **Evaluating.**
2020-09-07 03:14:07,790 R@1 : 34.818
2020-09-07 03:14:08,531 R@2 : 43.673
2020-09-07 03:14:09,280 R@4 : 53.764
2020-09-07 03:14:10,021 R@8 : 63.818
2020-09-07 03:16:48,219 Epoch: 10, loss: 2.688, time (seconds): 158.20.
2020-09-07 03:16:48,220 **Evaluating.**
2020-09-07 03:20:30,646 R@1 : 33.979
2020-09-07 03:20:31,386 R@2 : 42.738
2020-09-07 03:20:32,135 R@4 : 52.852
2020-09-07 03:20:32,884 R@8 : 63.127
2020-09-07 03:22:56,970 Epoch: 11, loss: 2.680, time (seconds): 144.08.
2020-09-07 03:22:56,970 **Evaluating.**
2020-09-07 03:26:27,663 R@1 : 34.705
2020-09-07 03:26:28,470 R@2 : 43.461
2020-09-07 03:26:29,211 R@4 : 53.572
2020-09-07 03:26:29,957 R@8 : 63.562
2020-09-07 03:29:09,261 Epoch: 12, loss: 2.655, time (seconds): 159.30.
2020-09-07 03:29:09,261 **Evaluating.**
2020-09-07 03:32:47,013 R@1 : 34.022
2020-09-07 03:32:47,766 R@2 : 42.651
2020-09-07 03:32:48,514 R@4 : 52.350
2020-09-07 03:32:49,256 R@8 : 62.421
2020-09-07 03:35:13,451 Epoch: 13, loss: 2.654, time (seconds): 144.19.
2020-09-07 03:35:13,451 **Evaluating.**
2020-09-07 03:38:44,204 R@1 : 32.309
2020-09-07 03:38:44,948 R@2 : 40.903
2020-09-07 03:38:45,694 R@4 : 50.591
2020-09-07 03:38:46,447 R@8 : 60.813
2020-09-07 03:41:14,409 Epoch: 14, loss: 2.623, time (seconds): 147.96.
2020-09-07 03:41:14,410 **Evaluating.**
2020-09-07 03:44:52,881 R@1 : 34.255
2020-09-07 03:44:53,622 R@2 : 43.112
2020-09-07 03:44:54,371 R@4 : 52.969
2020-09-07 03:44:55,118 R@8 : 63.083
2020-09-07 03:44:55,120 Total training time (minutes): 97.49.
2020-09-07 03:44:58,496 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 15, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': False, 'scaling_x': 1.0, 'scaling_p': 3.0, 'lr_proxynca': 10, 'log_filename': 'food-20200906-211316', 'results_filename': 'food-results.csv', '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-07 03:44:58,497 Training for 15 epochs
2020-09-07 03:44:58,498 **Evaluating initial model.**
2020-09-07 03:48:30,412 R@1 : 42.442
2020-09-07 03:48:31,186 R@2 : 50.771
2020-09-07 03:48:31,942 R@4 : 59.614
2020-09-07 03:48:32,698 R@8 : 69.580
2020-09-07 03:51:08,960 Epoch: 0, loss: 2.228, time (seconds): 156.26.
2020-09-07 03:51:08,960 **Evaluating.**
2020-09-07 03:54:55,803 R@1 : 46.503
2020-09-07 03:54:56,548 R@2 : 55.480
2020-09-07 03:54:57,296 R@4 : 64.477
2020-09-07 03:54:58,051 R@8 : 73.265
2020-09-07 03:57:20,101 Epoch: 1, loss: 2.109, time (seconds): 142.05.
2020-09-07 03:57:20,102 **Evaluating.**
2020-09-07 04:00:57,678 R@1 : 46.143
2020-09-07 04:00:58,420 R@2 : 55.311
2020-09-07 04:00:59,158 R@4 : 64.305
2020-09-07 04:00:59,916 R@8 : 72.908
2020-09-07 04:03:40,110 Epoch: 2, loss: 1.990, time (seconds): 160.19.
2020-09-07 04:03:40,111 **Evaluating.**
2020-09-07 04:07:19,031 R@1 : 45.307
2020-09-07 04:07:19,771 R@2 : 54.136
2020-09-07 04:07:20,508 R@4 : 63.060
2020-09-07 04:07:21,245 R@8 : 71.494
2020-09-07 04:09:54,508 Epoch: 3, loss: 1.792, time (seconds): 153.26.
2020-09-07 04:09:54,509 **Evaluating.**
2020-09-07 04:13:27,682 R@1 : 46.349
2020-09-07 04:13:28,424 R@2 : 55.192
2020-09-07 04:13:29,166 R@4 : 64.410
2020-09-07 04:13:29,911 R@8 : 72.736
2020-09-07 04:16:08,556 Epoch: 4, loss: 1.821, time (seconds): 158.64.
2020-09-07 04:16:08,557 **Evaluating.**
2020-09-07 04:20:05,493 R@1 : 44.802
2020-09-07 04:20:06,346 R@2 : 53.697
2020-09-07 04:20:07,174 R@4 : 62.735
2020-09-07 04:20:08,016 R@8 : 71.456
2020-09-07 04:22:38,271 Epoch: 5, loss: 1.852, time (seconds): 150.25.
2020-09-07 04:22:38,272 **Evaluating.**
2020-09-07 04:26:29,239 R@1 : 45.240
2020-09-07 04:26:29,991 R@2 : 54.182
2020-09-07 04:26:30,735 R@4 : 63.214
2020-09-07 04:26:31,480 R@8 : 71.935
2020-09-07 04:29:11,224 Epoch: 6, loss: 1.833, time (seconds): 159.74.
2020-09-07 04:29:11,224 **Evaluating.**
2020-09-07 04:32:58,143 R@1 : 43.266
2020-09-07 04:32:58,893 R@2 : 51.871
2020-09-07 04:32:59,646 R@4 : 60.653
2020-09-07 04:33:00,399 R@8 : 69.511
2020-09-07 04:35:37,903 Epoch: 7, loss: 1.632, time (seconds): 157.50.
2020-09-07 04:35:37,904 **Evaluating.**
2020-09-07 04:39:26,825 R@1 : 44.070
2020-09-07 04:39:27,624 R@2 : 52.516
2020-09-07 04:39:28,433 R@4 : 61.759
2020-09-07 04:39:29,229 R@8 : 70.510
2020-09-07 04:42:05,440 Epoch: 8, loss: 1.722, time (seconds): 156.21.
2020-09-07 04:42:05,441 **Evaluating.**
2020-09-07 04:45:51,435 R@1 : 44.320
2020-09-07 04:45:52,180 R@2 : 53.038
2020-09-07 04:45:52,926 R@4 : 62.131
2020-09-07 04:45:53,670 R@8 : 70.849
2020-09-07 04:48:20,770 Epoch: 9, loss: 1.626, time (seconds): 147.10.
2020-09-07 04:48:20,771 **Evaluating.**
2020-09-07 04:52:00,448 R@1 : 43.980
2020-09-07 04:52:01,190 R@2 : 52.408
2020-09-07 04:52:01,939 R@4 : 61.472
2020-09-07 04:52:02,701 R@8 : 70.292
2020-09-07 04:54:39,599 Epoch: 10, loss: 1.468, time (seconds): 156.90.
2020-09-07 04:54:39,599 **Evaluating.**
2020-09-07 04:58:31,189 R@1 : 43.159
2020-09-07 04:58:31,934 R@2 : 51.383
2020-09-07 04:58:32,695 R@4 : 60.409
2020-09-07 04:58:33,442 R@8 : 69.406
2020-09-07 05:01:11,047 Epoch: 11, loss: 1.592, time (seconds): 157.60.
2020-09-07 05:01:11,047 **Evaluating.**
2020-09-07 05:04:56,269 R@1 : 42.976
2020-09-07 05:04:57,010 R@2 : 51.639
2020-09-07 05:04:57,765 R@4 : 60.755
2020-09-07 05:04:58,511 R@8 : 69.662
2020-09-07 05:07:31,760 Epoch: 12, loss: 1.464, time (seconds): 153.25.
2020-09-07 05:07:31,761 **Evaluating.**
2020-09-07 05:11:17,666 R@1 : 43.077
2020-09-07 05:11:18,412 R@2 : 51.642
2020-09-07 05:11:19,168 R@4 : 60.447
2020-09-07 05:11:19,916 R@8 : 69.322
2020-09-07 05:13:50,415 Epoch: 13, loss: 1.410, time (seconds): 150.50.
2020-09-07 05:13:50,416 **Evaluating.**
2020-09-07 05:17:27,311 R@1 : 42.610
2020-09-07 05:17:28,055 R@2 : 51.035
2020-09-07 05:17:28,790 R@4 : 59.988
2020-09-07 05:17:29,529 R@8 : 68.861
2020-09-07 05:20:05,906 Epoch: 14, loss: 1.438, time (seconds): 156.37.
2020-09-07 05:20:05,907 **Evaluating.**
2020-09-07 05:23:51,385 R@1 : 41.367
2020-09-07 05:23:52,157 R@2 : 49.961
2020-09-07 05:23:52,897 R@4 : 58.868
2020-09-07 05:23:53,633 R@8 : 67.772
2020-09-07 05:23:53,636 Total training time (minutes): 98.92.
2020-09-07 05:23:56,830 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 15, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': False, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 10, 'log_filename': 'food-20200906-211316', 'results_filename': 'food-results.csv', '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-07 05:23:56,830 Training for 15 epochs
2020-09-07 05:23:56,832 **Evaluating initial model.**
2020-09-07 05:27:30,197 R@1 : 42.038
2020-09-07 05:27:31,066 R@2 : 50.364
2020-09-07 05:27:31,884 R@4 : 59.634
2020-09-07 05:27:32,766 R@8 : 69.267
2020-09-07 05:30:12,675 Epoch: 0, loss: 2.449, time (seconds): 159.91.
2020-09-07 05:30:12,675 **Evaluating.**
2020-09-07 05:34:00,371 R@1 : 44.602
2020-09-07 05:34:01,170 R@2 : 53.593
2020-09-07 05:34:01,971 R@4 : 63.016
2020-09-07 05:34:02,766 R@8 : 72.431
2020-09-07 05:36:34,647 Epoch: 1, loss: 2.145, time (seconds): 151.88.
2020-09-07 05:36:34,648 **Evaluating.**
2020-09-07 05:40:15,623 R@1 : 46.509
2020-09-07 05:40:16,442 R@2 : 55.419
2020-09-07 05:40:17,251 R@4 : 64.831
2020-09-07 05:40:18,074 R@8 : 73.538
2020-09-07 05:42:49,280 Epoch: 2, loss: 1.988, time (seconds): 151.20.
2020-09-07 05:42:49,281 **Evaluating.**
2020-09-07 05:46:42,416 R@1 : 47.058
2020-09-07 05:46:43,232 R@2 : 56.258
2020-09-07 05:46:43,995 R@4 : 65.606
2020-09-07 05:46:44,799 R@8 : 74.284
2020-09-07 05:49:17,380 Epoch: 3, loss: 1.919, time (seconds): 152.58.
2020-09-07 05:49:17,381 **Evaluating.**
2020-09-07 05:52:53,004 R@1 : 47.069
2020-09-07 05:52:53,745 R@2 : 56.084
2020-09-07 05:52:54,486 R@4 : 65.377
2020-09-07 05:52:55,227 R@8 : 74.098
2020-09-07 05:55:29,471 Epoch: 4, loss: 1.908, time (seconds): 154.24.
2020-09-07 05:55:29,471 **Evaluating.**
2020-09-07 05:59:17,693 R@1 : 48.425
2020-09-07 05:59:18,428 R@2 : 57.390
2020-09-07 05:59:19,191 R@4 : 66.454
2020-09-07 05:59:19,928 R@8 : 74.975
2020-09-07 06:01:41,902 Epoch: 5, loss: 1.753, time (seconds): 141.97.
2020-09-07 06:01:41,902 **Evaluating.**
2020-09-07 06:05:17,229 R@1 : 47.670
2020-09-07 06:05:17,983 R@2 : 56.528
2020-09-07 06:05:18,742 R@4 : 65.568
2020-09-07 06:05:19,491 R@8 : 74.208
2020-09-07 06:07:48,326 Epoch: 6, loss: 1.665, time (seconds): 148.83.
2020-09-07 06:07:48,327 **Evaluating.**
2020-09-07 06:11:31,163 R@1 : 48.268
2020-09-07 06:11:31,917 R@2 : 57.521
2020-09-07 06:11:32,675 R@4 : 66.367
2020-09-07 06:11:33,428 R@8 : 74.937
2020-09-07 06:14:06,248 Epoch: 7, loss: 1.715, time (seconds): 152.82.
2020-09-07 06:14:06,249 **Evaluating.**
2020-09-07 06:17:37,273 R@1 : 47.194
2020-09-07 06:17:38,086 R@2 : 55.991
2020-09-07 06:17:38,840 R@4 : 65.322
2020-09-07 06:17:39,579 R@8 : 74.031
2020-09-07 06:20:11,835 Epoch: 8, loss: 1.610, time (seconds): 152.25.
2020-09-07 06:20:11,836 **Evaluating.**
2020-09-07 06:24:00,019 R@1 : 48.210
2020-09-07 06:24:00,803 R@2 : 56.946
2020-09-07 06:24:01,585 R@4 : 66.088
2020-09-07 06:24:02,373 R@8 : 74.438
2020-09-07 06:26:34,420 Epoch: 9, loss: 1.586, time (seconds): 152.05.
2020-09-07 06:26:34,421 **Evaluating.**
2020-09-07 06:30:04,055 R@1 : 47.714
2020-09-07 06:30:04,797 R@2 : 56.792
2020-09-07 06:30:05,537 R@4 : 65.940
2020-09-07 06:30:06,279 R@8 : 74.408
2020-09-07 06:32:40,095 Epoch: 10, loss: 1.543, time (seconds): 153.81.
2020-09-07 06:32:40,096 **Evaluating.**
2020-09-07 06:36:24,667 R@1 : 47.917
2020-09-07 06:36:25,414 R@2 : 56.525
2020-09-07 06:36:26,170 R@4 : 65.406
2020-09-07 06:36:26,914 R@8 : 74.031
2020-09-07 06:38:48,317 Epoch: 11, loss: 1.508, time (seconds): 141.40.
2020-09-07 06:38:48,318 **Evaluating.**
2020-09-07 06:42:19,603 R@1 : 47.630
2020-09-07 06:42:20,367 R@2 : 56.359
2020-09-07 06:42:21,104 R@4 : 65.658
2020-09-07 06:42:21,849 R@8 : 73.799
2020-09-07 06:44:56,333 Epoch: 12, loss: 1.432, time (seconds): 154.48.
2020-09-07 06:44:56,333 **Evaluating.**
2020-09-07 06:48:43,594 R@1 : 46.857
2020-09-07 06:48:44,331 R@2 : 55.587
2020-09-07 06:48:45,071 R@4 : 64.796
2020-09-07 06:48:45,812 R@8 : 73.430
2020-09-07 06:51:06,072 Epoch: 13, loss: 1.403, time (seconds): 140.26.
2020-09-07 06:51:06,073 **Evaluating.**
2020-09-07 06:54:38,262 R@1 : 47.081
2020-09-07 06:54:39,019 R@2 : 55.883
2020-09-07 06:54:39,776 R@4 : 64.813
2020-09-07 06:54:40,522 R@8 : 73.212
2020-09-07 06:57:13,753 Epoch: 14, loss: 1.395, time (seconds): 153.23.
2020-09-07 06:57:13,754 **Evaluating.**
2020-09-07 07:01:02,522 R@1 : 46.341
2020-09-07 07:01:03,272 R@2 : 54.876
2020-09-07 07:01:04,039 R@4 : 63.850
2020-09-07 07:01:04,781 R@8 : 72.417
2020-09-07 07:01:04,784 Total training time (minutes): 97.13.
2020-09-07 07:01:08,032 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 15, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': False, 'scaling_x': 3.0, 'scaling_p': 1.0, 'lr_proxynca': 10, 'log_filename': 'food-20200906-211316', 'results_filename': 'food-results.csv', '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-07 07:01:08,032 Training for 15 epochs
2020-09-07 07:01:08,034 **Evaluating initial model.**
2020-09-07 07:04:22,540 R@1 : 42.221
2020-09-07 07:04:23,285 R@2 : 50.457
2020-09-07 07:04:24,021 R@4 : 59.710
2020-09-07 07:04:24,766 R@8 : 69.203
2020-09-07 07:07:01,216 Epoch: 0, loss: 2.138, time (seconds): 156.45.
2020-09-07 07:07:01,217 **Evaluating.**
2020-09-07 07:10:47,765 R@1 : 47.574
2020-09-07 07:10:48,505 R@2 : 56.499
2020-09-07 07:10:49,254 R@4 : 65.493
2020-09-07 07:10:49,995 R@8 : 73.924
2020-09-07 07:13:17,760 Epoch: 1, loss: 2.151, time (seconds): 147.76.
2020-09-07 07:13:17,761 **Evaluating.**
2020-09-07 07:16:38,991 R@1 : 46.216
2020-09-07 07:16:39,735 R@2 : 55.277
2020-09-07 07:16:40,473 R@4 : 64.250
2020-09-07 07:16:41,218 R@8 : 72.585
2020-09-07 07:19:15,613 Epoch: 2, loss: 2.056, time (seconds): 154.39.
2020-09-07 07:19:15,614 **Evaluating.**
2020-09-07 07:23:02,840 R@1 : 45.362
2020-09-07 07:23:03,579 R@2 : 54.397
2020-09-07 07:23:04,319 R@4 : 63.649
2020-09-07 07:23:05,060 R@8 : 72.124
2020-09-07 07:25:28,755 Epoch: 3, loss: 1.930, time (seconds): 143.69.
2020-09-07 07:25:28,755 **Evaluating.**
2020-09-07 07:28:50,953 R@1 : 45.510
2020-09-07 07:28:51,688 R@2 : 54.469
2020-09-07 07:28:52,430 R@4 : 63.249
2020-09-07 07:28:53,176 R@8 : 72.063
2020-09-07 07:31:17,585 Epoch: 4, loss: 1.811, time (seconds): 144.41.
2020-09-07 07:31:17,585 **Evaluating.**
2020-09-07 07:35:05,534 R@1 : 46.134
2020-09-07 07:35:06,270 R@2 : 54.908
2020-09-07 07:35:07,008 R@4 : 63.699
2020-09-07 07:35:07,749 R@8 : 72.100
2020-09-07 07:37:35,992 Epoch: 5, loss: 1.781, time (seconds): 148.24.
2020-09-07 07:37:35,993 **Evaluating.**
2020-09-07 07:41:01,254 R@1 : 45.687
2020-09-07 07:41:01,998 R@2 : 54.557
2020-09-07 07:41:02,738 R@4 : 63.594
2020-09-07 07:41:03,478 R@8 : 72.048
2020-09-07 07:43:37,947 Epoch: 6, loss: 1.727, time (seconds): 154.47.
2020-09-07 07:43:37,948 **Evaluating.**
2020-09-07 07:47:30,292 R@1 : 45.957
2020-09-07 07:47:31,033 R@2 : 54.864
2020-09-07 07:47:31,771 R@4 : 63.731
2020-09-07 07:47:32,512 R@8 : 72.339
2020-09-07 07:50:00,954 Epoch: 7, loss: 1.671, time (seconds): 148.44.
2020-09-07 07:50:00,955 **Evaluating.**
2020-09-07 07:53:28,027 R@1 : 45.475
2020-09-07 07:53:28,765 R@2 : 54.028
2020-09-07 07:53:29,504 R@4 : 63.353
2020-09-07 07:53:30,243 R@8 : 72.034
2020-09-07 07:55:55,754 Epoch: 8, loss: 1.623, time (seconds): 145.51.
2020-09-07 07:55:55,755 **Evaluating.**
2020-09-07 07:59:44,754 R@1 : 43.675
2020-09-07 07:59:45,495 R@2 : 52.559
2020-09-07 07:59:46,232 R@4 : 61.794
2020-09-07 07:59:46,969 R@8 : 70.422
2020-09-07 08:02:09,692 Epoch: 9, loss: 1.621, time (seconds): 142.72.
2020-09-07 08:02:09,693 **Evaluating.**
2020-09-07 08:05:35,650 R@1 : 43.733
2020-09-07 08:05:36,435 R@2 : 52.597
2020-09-07 08:05:37,181 R@4 : 61.501
2020-09-07 08:05:37,916 R@8 : 70.356
2020-09-07 08:08:11,268 Epoch: 10, loss: 1.461, time (seconds): 153.35.
2020-09-07 08:08:11,268 **Evaluating.**
2020-09-07 08:12:03,016 R@1 : 43.713
2020-09-07 08:12:03,766 R@2 : 52.199
2020-09-07 08:12:04,510 R@4 : 61.405
2020-09-07 08:12:05,243 R@8 : 70.123
2020-09-07 08:14:30,169 Epoch: 11, loss: 1.548, time (seconds): 144.92.
2020-09-07 08:14:30,170 **Evaluating.**
2020-09-07 08:17:55,790 R@1 : 43.060
2020-09-07 08:17:56,534 R@2 : 52.022
2020-09-07 08:17:57,279 R@4 : 61.036
2020-09-07 08:17:58,019 R@8 : 69.807
2020-09-07 08:20:35,473 Epoch: 12, loss: 1.467, time (seconds): 157.45.
2020-09-07 08:20:35,474 **Evaluating.**
2020-09-07 08:24:31,007 R@1 : 43.414
2020-09-07 08:24:31,773 R@2 : 51.865
2020-09-07 08:24:32,536 R@4 : 60.798
2020-09-07 08:24:33,299 R@8 : 69.607
2020-09-07 08:26:54,918 Epoch: 13, loss: 1.400, time (seconds): 141.62.
2020-09-07 08:26:54,919 **Evaluating.**
2020-09-07 08:30:20,921 R@1 : 42.317
2020-09-07 08:30:21,664 R@2 : 50.901
2020-09-07 08:30:22,405 R@4 : 59.779
2020-09-07 08:30:23,143 R@8 : 68.622
2020-09-07 08:32:58,698 Epoch: 14, loss: 1.405, time (seconds): 155.55.
2020-09-07 08:32:58,699 **Evaluating.**
2020-09-07 08:36:49,663 R@1 : 42.598
2020-09-07 08:36:50,399 R@2 : 51.302
2020-09-07 08:36:51,136 R@4 : 60.415
2020-09-07 08:36:51,902 R@8 : 69.467
2020-09-07 08:36:51,905 Total training time (minutes): 95.73.
2020-09-07 08:36:55,260 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 15, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': False, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 10, 'log_filename': 'food-20200906-211316', 'results_filename': 'food-results.csv', '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-07 08:36:55,261 Training for 15 epochs
2020-09-07 08:36:55,262 **Evaluating initial model.**
2020-09-07 08:40:19,022 R@1 : 42.630
2020-09-07 08:40:19,761 R@2 : 50.849
2020-09-07 08:40:20,493 R@4 : 60.000
2020-09-07 08:40:21,233 R@8 : 69.412
2020-09-07 08:43:00,495 Epoch: 0, loss: 2.334, time (seconds): 159.26.
2020-09-07 08:43:00,496 **Evaluating.**
2020-09-07 08:46:47,194 R@1 : 44.160
2020-09-07 08:46:47,934 R@2 : 53.236
2020-09-07 08:46:48,677 R@4 : 63.022
2020-09-07 08:46:49,419 R@8 : 71.723
2020-09-07 08:49:10,816 Epoch: 1, loss: 2.152, time (seconds): 141.39.
2020-09-07 08:49:10,817 **Evaluating.**
2020-09-07 08:52:39,145 R@1 : 45.931
2020-09-07 08:52:39,886 R@2 : 54.835
2020-09-07 08:52:40,630 R@4 : 64.363
2020-09-07 08:52:41,368 R@8 : 72.945
2020-09-07 08:55:20,191 Epoch: 2, loss: 1.995, time (seconds): 158.82.
2020-09-07 08:55:20,191 **Evaluating.**
2020-09-07 08:59:06,018 R@1 : 47.148
2020-09-07 08:59:06,763 R@2 : 56.267
2020-09-07 08:59:07,500 R@4 : 65.533
2020-09-07 08:59:08,240 R@8 : 74.115
2020-09-07 09:01:32,196 Epoch: 3, loss: 1.916, time (seconds): 143.95.
2020-09-07 09:01:32,196 **Evaluating.**
2020-09-07 09:05:00,301 R@1 : 48.538
2020-09-07 09:05:01,038 R@2 : 57.512
2020-09-07 09:05:01,775 R@4 : 66.648
2020-09-07 09:05:02,514 R@8 : 75.027
2020-09-07 09:07:41,842 Epoch: 4, loss: 1.792, time (seconds): 159.33.
2020-09-07 09:07:41,843 **Evaluating.**
2020-09-07 09:11:32,002 R@1 : 48.561
2020-09-07 09:11:32,740 R@2 : 57.654
2020-09-07 09:11:33,482 R@4 : 66.660
2020-09-07 09:11:34,217 R@8 : 75.216
2020-09-07 09:13:57,907 Epoch: 5, loss: 1.769, time (seconds): 143.69.
2020-09-07 09:13:57,907 **Evaluating.**
2020-09-07 09:17:29,117 R@1 : 47.635
2020-09-07 09:17:29,860 R@2 : 56.760
2020-09-07 09:17:30,603 R@4 : 65.893
2020-09-07 09:17:31,350 R@8 : 74.150
2020-09-07 09:20:10,237 Epoch: 6, loss: 1.716, time (seconds): 158.88.
2020-09-07 09:20:10,237 **Evaluating.**
2020-09-07 09:23:59,119 R@1 : 47.673
2020-09-07 09:23:59,858 R@2 : 56.882
2020-09-07 09:24:00,598 R@4 : 65.905
2020-09-07 09:24:01,339 R@8 : 74.510
2020-09-07 09:26:23,810 Epoch: 7, loss: 1.699, time (seconds): 142.47.
2020-09-07 09:26:23,811 **Evaluating.**
2020-09-07 09:29:53,750 R@1 : 48.036
2020-09-07 09:29:54,487 R@2 : 56.879
2020-09-07 09:29:55,224 R@4 : 66.071
2020-09-07 09:29:55,967 R@8 : 74.760
2020-09-07 09:32:28,486 Epoch: 8, loss: 1.635, time (seconds): 152.52.
2020-09-07 09:32:28,487 **Evaluating.**
2020-09-07 09:36:19,737 R@1 : 48.260
2020-09-07 09:36:20,486 R@2 : 57.239
2020-09-07 09:36:21,223 R@4 : 66.210
2020-09-07 09:36:21,963 R@8 : 74.487
2020-09-07 09:38:50,675 Epoch: 9, loss: 1.600, time (seconds): 148.71.
2020-09-07 09:38:50,675 **Evaluating.**
2020-09-07 09:42:19,941 R@1 : 47.386
2020-09-07 09:42:20,681 R@2 : 56.237
2020-09-07 09:42:21,424 R@4 : 65.310
2020-09-07 09:42:22,161 R@8 : 73.924
2020-09-07 09:45:03,343 Epoch: 10, loss: 1.525, time (seconds): 161.18.
2020-09-07 09:45:03,344 **Evaluating.**
2020-09-07 09:48:54,192 R@1 : 47.299
2020-09-07 09:48:54,933 R@2 : 56.182
2020-09-07 09:48:55,671 R@4 : 65.234
2020-09-07 09:48:56,407 R@8 : 73.834
2020-09-07 09:51:16,885 Epoch: 11, loss: 1.526, time (seconds): 140.48.
2020-09-07 09:51:16,886 **Evaluating.**
2020-09-07 09:54:50,982 R@1 : 47.232
2020-09-07 09:54:51,732 R@2 : 55.909
2020-09-07 09:54:52,468 R@4 : 65.127
2020-09-07 09:54:53,212 R@8 : 73.616
2020-09-07 09:57:31,975 Epoch: 12, loss: 1.465, time (seconds): 158.76.
2020-09-07 09:57:31,976 **Evaluating.**
2020-09-07 10:01:21,810 R@1 : 47.737
2020-09-07 10:01:22,548 R@2 : 56.516
2020-09-07 10:01:23,292 R@4 : 65.615
2020-09-07 10:01:24,032 R@8 : 73.956
2020-09-07 10:03:48,877 Epoch: 13, loss: 1.414, time (seconds): 144.84.
2020-09-07 10:03:48,878 **Evaluating.**
2020-09-07 10:07:20,554 R@1 : 47.142
2020-09-07 10:07:21,288 R@2 : 55.700
2020-09-07 10:07:22,020 R@4 : 64.561
2020-09-07 10:07:22,783 R@8 : 72.992
2020-09-07 10:10:00,881 Epoch: 14, loss: 1.409, time (seconds): 158.09.
2020-09-07 10:10:00,882 **Evaluating.**
2020-09-07 10:13:50,690 R@1 : 46.576
2020-09-07 10:13:51,458 R@2 : 55.140
2020-09-07 10:13:52,203 R@4 : 63.937
2020-09-07 10:13:52,981 R@8 : 72.609
2020-09-07 10:13:52,984 Total training time (minutes): 96.96.
2020-09-07 10:13:56,318 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 15, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': False, 'scaling_x': 3.0, 'scaling_p': 8.0, 'lr_proxynca': 10, 'log_filename': 'food-20200906-211316', 'results_filename': 'food-results.csv', '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-07 10:13:56,319 Training for 15 epochs
2020-09-07 10:13:56,320 **Evaluating initial model.**
2020-09-07 10:17:20,741 R@1 : 42.590
2020-09-07 10:17:21,510 R@2 : 51.084
2020-09-07 10:17:22,249 R@4 : 60.311
2020-09-07 10:17:22,986 R@8 : 69.760
2020-09-07 10:19:58,221 Epoch: 0, loss: 2.682, time (seconds): 155.23.
2020-09-07 10:19:58,221 **Evaluating.**
2020-09-07 10:23:41,990 R@1 : 42.343
2020-09-07 10:23:42,734 R@2 : 51.378
2020-09-07 10:23:43,480 R@4 : 61.222
2020-09-07 10:23:44,220 R@8 : 70.881
2020-09-07 10:26:05,775 Epoch: 1, loss: 2.315, time (seconds): 141.55.
2020-09-07 10:26:05,776 **Evaluating.**
2020-09-07 10:29:35,720 R@1 : 44.570
2020-09-07 10:29:36,454 R@2 : 53.688
2020-09-07 10:29:37,189 R@4 : 63.211
2020-09-07 10:29:37,925 R@8 : 72.376
2020-09-07 10:32:07,606 Epoch: 2, loss: 2.112, time (seconds): 149.68.
2020-09-07 10:32:07,607 **Evaluating.**
2020-09-07 10:35:56,773 R@1 : 44.790
2020-09-07 10:35:57,516 R@2 : 53.738
2020-09-07 10:35:58,255 R@4 : 63.191
2020-09-07 10:35:58,990 R@8 : 72.902
2020-09-07 10:38:27,215 Epoch: 3, loss: 1.933, time (seconds): 148.22.
2020-09-07 10:38:27,216 **Evaluating.**
2020-09-07 10:41:50,788 R@1 : 45.269
2020-09-07 10:41:51,537 R@2 : 54.417
2020-09-07 10:41:52,303 R@4 : 63.649
2020-09-07 10:41:53,064 R@8 : 72.716
2020-09-07 10:44:27,501 Epoch: 4, loss: 1.937, time (seconds): 154.43.
2020-09-07 10:44:27,502 **Evaluating.**
2020-09-07 10:48:15,549 R@1 : 45.246
2020-09-07 10:48:16,288 R@2 : 54.281
2020-09-07 10:48:17,027 R@4 : 63.632
2020-09-07 10:48:17,767 R@8 : 72.568
2020-09-07 10:50:44,650 Epoch: 5, loss: 1.865, time (seconds): 146.88.
2020-09-07 10:50:44,651 **Evaluating.**
2020-09-07 10:54:50,995 R@1 : 46.593
2020-09-07 10:54:51,734 R@2 : 55.532
2020-09-07 10:54:52,478 R@4 : 64.604
2020-09-07 10:54:53,220 R@8 : 73.395
