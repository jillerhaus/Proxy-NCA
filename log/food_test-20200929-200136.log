2020-09-29 20:01:39,056 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200929-200136', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 1, 'train_classes': range(0, 50), 'eval_classes': range(0, 50), 'p_c': 1, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-29 20:01:39,056 Training for 20 epochs
2020-09-29 20:01:39,058 **Evaluating initial model.**
2020-09-29 20:02:14,322 NMI: 24.495
2020-09-29 20:02:25,861 R@1 : 33.072
2020-09-29 20:02:26,102 R@2 : 42.734
2020-09-29 20:02:26,346 R@4 : 54.082
2020-09-29 20:02:26,605 R@8 : 65.867
2020-09-29 20:03:00,974 Epoch: 0, loss: 3.320, time (seconds): 34.37.
2020-09-29 20:03:00,975 **Evaluating.**
2020-09-29 20:03:35,175 NMI: 43.813
2020-09-29 20:03:45,767 R@1 : 49.826
2020-09-29 20:03:46,012 R@2 : 60.594
2020-09-29 20:03:46,258 R@4 : 69.756
2020-09-29 20:03:46,514 R@8 : 77.126
2020-09-29 20:04:20,583 Epoch: 1, loss: 3.142, time (seconds): 34.07.
2020-09-29 20:04:20,583 **Evaluating.**
2020-09-29 20:04:54,475 NMI: 48.047
2020-09-29 20:05:04,938 R@1 : 54.644
2020-09-29 20:05:05,197 R@2 : 64.609
2020-09-29 20:05:05,456 R@4 : 72.727
2020-09-29 20:05:05,727 R@8 : 79.597
2020-09-29 20:05:39,996 Epoch: 2, loss: 3.039, time (seconds): 34.27.
2020-09-29 20:05:39,997 **Evaluating.**
2020-09-29 20:06:14,049 NMI: 50.669
2020-09-29 20:06:24,361 R@1 : 57.356
2020-09-29 20:06:24,602 R@2 : 67.053
2020-09-29 20:06:24,844 R@4 : 74.449
2020-09-29 20:06:25,085 R@8 : 80.382
2020-09-29 20:06:59,210 Epoch: 3, loss: 2.993, time (seconds): 34.12.
2020-09-29 20:06:59,211 **Evaluating.**
2020-09-29 20:07:33,308 NMI: 52.777
2020-09-29 20:07:43,607 R@1 : 58.587
2020-09-29 20:07:43,848 R@2 : 68.052
2020-09-29 20:07:44,099 R@4 : 75.975
2020-09-29 20:07:44,339 R@8 : 81.524
2020-09-29 20:08:18,360 Epoch: 4, loss: 2.967, time (seconds): 34.02.
2020-09-29 20:08:18,361 **Evaluating.**
2020-09-29 20:08:52,365 NMI: 54.985
2020-09-29 20:09:02,544 R@1 : 59.791
2020-09-29 20:09:02,790 R@2 : 69.560
2020-09-29 20:09:03,031 R@4 : 76.885
2020-09-29 20:09:03,272 R@8 : 82.416
2020-09-29 20:09:37,346 Epoch: 5, loss: 2.937, time (seconds): 34.07.
2020-09-29 20:09:37,347 **Evaluating.**
2020-09-29 20:10:10,784 NMI: 57.041
2020-09-29 20:10:20,873 R@1 : 61.504
2020-09-29 20:10:21,115 R@2 : 70.961
2020-09-29 20:10:21,356 R@4 : 78.455
2020-09-29 20:10:21,598 R@8 : 83.388
2020-09-29 20:10:55,788 Epoch: 6, loss: 2.892, time (seconds): 34.19.
2020-09-29 20:10:55,789 **Evaluating.**
2020-09-29 20:11:29,523 NMI: 58.894
2020-09-29 20:11:39,496 R@1 : 62.432
2020-09-29 20:11:39,746 R@2 : 71.782
2020-09-29 20:11:39,994 R@4 : 78.517
2020-09-29 20:11:40,236 R@8 : 83.594
2020-09-29 20:12:14,252 Epoch: 7, loss: 2.887, time (seconds): 34.01.
2020-09-29 20:12:14,253 **Evaluating.**
2020-09-29 20:12:47,920 NMI: 59.446
2020-09-29 20:12:57,817 R@1 : 63.235
2020-09-29 20:12:58,062 R@2 : 71.996
2020-09-29 20:12:58,307 R@4 : 78.705
2020-09-29 20:12:58,549 R@8 : 84.093
2020-09-29 20:13:32,731 Epoch: 8, loss: 2.858, time (seconds): 34.18.
2020-09-29 20:13:32,732 **Evaluating.**
2020-09-29 20:14:06,421 NMI: 61.623
2020-09-29 20:14:16,438 R@1 : 64.653
2020-09-29 20:14:16,683 R@2 : 73.334
2020-09-29 20:14:16,938 R@4 : 79.748
2020-09-29 20:14:17,183 R@8 : 84.691
2020-09-29 20:14:51,362 Epoch: 9, loss: 2.854, time (seconds): 34.18.
2020-09-29 20:14:51,363 **Evaluating.**
2020-09-29 20:15:25,009 NMI: 62.418
2020-09-29 20:15:34,744 R@1 : 65.224
2020-09-29 20:15:34,986 R@2 : 74.110
2020-09-29 20:15:35,235 R@4 : 80.418
2020-09-29 20:15:35,478 R@8 : 85.119
2020-09-29 20:16:09,536 Epoch: 10, loss: 2.846, time (seconds): 34.06.
2020-09-29 20:16:09,537 **Evaluating.**
2020-09-29 20:16:42,608 NMI: 64.099
2020-09-29 20:16:52,354 R@1 : 66.456
2020-09-29 20:16:52,599 R@2 : 74.761
2020-09-29 20:16:52,854 R@4 : 81.203
2020-09-29 20:16:53,096 R@8 : 85.663
2020-09-29 20:17:27,308 Epoch: 11, loss: 2.829, time (seconds): 34.21.
2020-09-29 20:17:27,308 **Evaluating.**
2020-09-29 20:18:00,632 NMI: 64.684
2020-09-29 20:18:10,353 R@1 : 66.973
2020-09-29 20:18:10,594 R@2 : 75.564
2020-09-29 20:18:10,838 R@4 : 81.765
2020-09-29 20:18:11,078 R@8 : 86.270
2020-09-29 20:18:45,266 Epoch: 12, loss: 2.809, time (seconds): 34.19.
2020-09-29 20:18:45,267 **Evaluating.**
2020-09-29 20:19:18,900 NMI: 65.762
2020-09-29 20:19:28,571 R@1 : 67.196
2020-09-29 20:19:28,811 R@2 : 76.296
2020-09-29 20:19:29,053 R@4 : 82.345
2020-09-29 20:19:29,303 R@8 : 86.484
2020-09-29 20:20:03,339 Epoch: 13, loss: 2.796, time (seconds): 34.03.
2020-09-29 20:20:03,340 **Evaluating.**
2020-09-29 20:20:36,555 NMI: 66.033
2020-09-29 20:20:46,112 R@1 : 68.374
2020-09-29 20:20:46,354 R@2 : 77.010
2020-09-29 20:20:46,596 R@4 : 82.684
2020-09-29 20:20:46,835 R@8 : 86.796
2020-09-29 20:21:21,104 Epoch: 14, loss: 2.783, time (seconds): 34.27.
2020-09-29 20:21:21,105 **Evaluating.**
2020-09-29 20:21:54,553 NMI: 66.953
2020-09-29 20:22:04,099 R@1 : 69.132
2020-09-29 20:22:04,341 R@2 : 77.465
2020-09-29 20:22:04,581 R@4 : 83.281
2020-09-29 20:22:04,822 R@8 : 87.323
2020-09-29 20:22:38,933 Epoch: 15, loss: 2.780, time (seconds): 34.11.
2020-09-29 20:22:38,933 **Evaluating.**
2020-09-29 20:23:12,258 NMI: 68.621
2020-09-29 20:23:21,803 R@1 : 69.578
2020-09-29 20:23:22,045 R@2 : 78.205
2020-09-29 20:23:22,286 R@4 : 83.995
2020-09-29 20:23:22,525 R@8 : 87.688
2020-09-29 20:23:56,683 Epoch: 16, loss: 2.766, time (seconds): 34.16.
2020-09-29 20:23:56,683 **Evaluating.**
2020-09-29 20:24:30,177 NMI: 68.745
2020-09-29 20:24:39,721 R@1 : 69.881
2020-09-29 20:24:39,971 R@2 : 78.499
2020-09-29 20:24:40,211 R@4 : 84.031
2020-09-29 20:24:40,450 R@8 : 87.796
2020-09-29 20:25:14,737 Epoch: 17, loss: 2.764, time (seconds): 34.28.
2020-09-29 20:25:14,737 **Evaluating.**
2020-09-29 20:25:48,028 NMI: 69.928
2020-09-29 20:25:57,464 R@1 : 71.086
2020-09-29 20:25:57,712 R@2 : 79.142
2020-09-29 20:25:57,953 R@4 : 84.512
2020-09-29 20:25:58,194 R@8 : 88.393
2020-09-29 20:26:32,424 Epoch: 18, loss: 2.761, time (seconds): 34.23.
2020-09-29 20:26:32,425 **Evaluating.**
2020-09-29 20:27:05,584 NMI: 70.543
2020-09-29 20:27:15,127 R@1 : 71.773
2020-09-29 20:27:15,386 R@2 : 80.096
2020-09-29 20:27:15,650 R@4 : 85.199
2020-09-29 20:27:15,912 R@8 : 88.777
2020-09-29 20:27:50,008 Epoch: 19, loss: 2.727, time (seconds): 34.09.
2020-09-29 20:27:50,009 **Evaluating.**
2020-09-29 20:28:23,302 NMI: 70.972
2020-09-29 20:28:32,753 R@1 : 72.103
2020-09-29 20:28:32,992 R@2 : 80.248
2020-09-29 20:28:33,239 R@4 : 85.342
2020-09-29 20:28:33,481 R@8 : 88.893
2020-09-29 20:28:33,483 Total training time (minutes): 26.91.
2020-09-29 20:28:34,232 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200929-200136', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 2, 'train_classes': range(0, 50), 'eval_classes': range(0, 50), 'p_c': 1, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-29 20:28:34,232 Training for 20 epochs
2020-09-29 20:28:34,234 **Evaluating initial model.**
2020-09-29 20:29:08,462 NMI: 23.449
2020-09-29 20:29:19,883 R@1 : 31.519
2020-09-29 20:29:20,124 R@2 : 41.181
2020-09-29 20:29:20,362 R@4 : 52.360
2020-09-29 20:29:20,602 R@8 : 64.252
2020-09-29 20:29:54,843 Epoch: 0, loss: 3.343, time (seconds): 34.24.
2020-09-29 20:29:54,843 **Evaluating.**
2020-09-29 20:30:28,757 NMI: 43.243
2020-09-29 20:30:39,333 R@1 : 48.943
2020-09-29 20:30:39,570 R@2 : 59.640
2020-09-29 20:30:39,811 R@4 : 68.534
2020-09-29 20:30:40,050 R@8 : 76.340
2020-09-29 20:31:14,502 Epoch: 1, loss: 3.140, time (seconds): 34.45.
2020-09-29 20:31:14,502 **Evaluating.**
2020-09-29 20:31:48,331 NMI: 47.829
2020-09-29 20:31:58,772 R@1 : 54.064
2020-09-29 20:31:59,020 R@2 : 64.118
2020-09-29 20:31:59,265 R@4 : 72.513
2020-09-29 20:31:59,524 R@8 : 78.937
2020-09-29 20:32:33,728 Epoch: 2, loss: 3.059, time (seconds): 34.20.
2020-09-29 20:32:33,729 **Evaluating.**
2020-09-29 20:33:07,606 NMI: 50.826
2020-09-29 20:33:17,910 R@1 : 56.383
2020-09-29 20:33:18,153 R@2 : 66.456
2020-09-29 20:33:18,393 R@4 : 73.958
2020-09-29 20:33:18,638 R@8 : 80.114
2020-09-29 20:33:52,727 Epoch: 3, loss: 3.014, time (seconds): 34.09.
2020-09-29 20:33:52,728 **Evaluating.**
2020-09-29 20:34:26,212 NMI: 53.498
2020-09-29 20:34:36,435 R@1 : 58.507
2020-09-29 20:34:36,677 R@2 : 68.418
2020-09-29 20:34:36,919 R@4 : 75.591
2020-09-29 20:34:37,158 R@8 : 80.971
2020-09-29 20:35:11,435 Epoch: 4, loss: 2.956, time (seconds): 34.27.
2020-09-29 20:35:11,435 **Evaluating.**
2020-09-29 20:35:44,799 NMI: 55.411
2020-09-29 20:35:54,958 R@1 : 59.631
2020-09-29 20:35:55,213 R@2 : 69.061
2020-09-29 20:35:55,473 R@4 : 76.447
2020-09-29 20:35:55,731 R@8 : 81.809
2020-09-29 20:36:29,868 Epoch: 5, loss: 2.943, time (seconds): 34.13.
2020-09-29 20:36:29,868 **Evaluating.**
2020-09-29 20:37:03,275 NMI: 56.843
2020-09-29 20:37:13,318 R@1 : 60.157
2020-09-29 20:37:13,561 R@2 : 70.069
2020-09-29 20:37:13,803 R@4 : 76.956
2020-09-29 20:37:14,051 R@8 : 82.443
2020-09-29 20:37:48,304 Epoch: 6, loss: 2.904, time (seconds): 34.25.
2020-09-29 20:37:48,305 **Evaluating.**
2020-09-29 20:38:21,950 NMI: 59.001
2020-09-29 20:38:31,887 R@1 : 62.593
2020-09-29 20:38:32,131 R@2 : 71.773
2020-09-29 20:38:32,372 R@4 : 77.750
2020-09-29 20:38:32,615 R@8 : 83.397
2020-09-29 20:39:07,161 Epoch: 7, loss: 2.897, time (seconds): 34.54.
2020-09-29 20:39:07,162 **Evaluating.**
2020-09-29 20:39:40,959 NMI: 59.907
2020-09-29 20:39:50,804 R@1 : 63.815
2020-09-29 20:39:51,047 R@2 : 72.558
2020-09-29 20:39:51,291 R@4 : 78.972
2020-09-29 20:39:51,540 R@8 : 83.754
2020-09-29 20:40:25,728 Epoch: 8, loss: 2.859, time (seconds): 34.19.
2020-09-29 20:40:25,728 **Evaluating.**
2020-09-29 20:40:59,241 NMI: 61.107
2020-09-29 20:41:09,116 R@1 : 64.091
2020-09-29 20:41:09,364 R@2 : 73.147
2020-09-29 20:41:09,606 R@4 : 79.606
2020-09-29 20:41:09,850 R@8 : 84.459
2020-09-29 20:41:44,168 Epoch: 9, loss: 2.858, time (seconds): 34.31.
2020-09-29 20:41:44,169 **Evaluating.**
2020-09-29 20:42:17,537 NMI: 62.821
2020-09-29 20:42:27,219 R@1 : 64.760
2020-09-29 20:42:27,457 R@2 : 74.003
2020-09-29 20:42:27,704 R@4 : 80.043
2020-09-29 20:42:27,944 R@8 : 84.869
2020-09-29 20:43:02,102 Epoch: 10, loss: 2.839, time (seconds): 34.16.
2020-09-29 20:43:02,103 **Evaluating.**
2020-09-29 20:43:35,537 NMI: 62.963
2020-09-29 20:43:45,229 R@1 : 66.331
2020-09-29 20:43:45,471 R@2 : 75.297
2020-09-29 20:43:45,712 R@4 : 81.006
2020-09-29 20:43:45,954 R@8 : 85.449
2020-09-29 20:44:20,109 Epoch: 11, loss: 2.805, time (seconds): 34.15.
2020-09-29 20:44:20,110 **Evaluating.**
2020-09-29 20:44:53,325 NMI: 64.520
2020-09-29 20:45:03,074 R@1 : 67.044
2020-09-29 20:45:03,331 R@2 : 75.885
2020-09-29 20:45:03,586 R@4 : 81.738
2020-09-29 20:45:03,843 R@8 : 86.100
2020-09-29 20:45:37,955 Epoch: 12, loss: 2.827, time (seconds): 34.11.
2020-09-29 20:45:37,957 **Evaluating.**
2020-09-29 20:46:11,651 NMI: 65.799
2020-09-29 20:46:21,326 R@1 : 67.821
2020-09-29 20:46:21,569 R@2 : 76.385
2020-09-29 20:46:21,809 R@4 : 82.336
2020-09-29 20:46:22,049 R@8 : 86.208
2020-09-29 20:46:56,390 Epoch: 13, loss: 2.801, time (seconds): 34.34.
2020-09-29 20:46:56,391 **Evaluating.**
2020-09-29 20:47:29,832 NMI: 66.725
2020-09-29 20:47:39,353 R@1 : 68.534
2020-09-29 20:47:39,593 R@2 : 76.929
2020-09-29 20:47:39,834 R@4 : 82.568
2020-09-29 20:47:40,081 R@8 : 86.529
2020-09-29 20:48:14,116 Epoch: 14, loss: 2.793, time (seconds): 34.03.
2020-09-29 20:48:14,117 **Evaluating.**
2020-09-29 20:48:47,222 NMI: 66.593
2020-09-29 20:48:56,814 R@1 : 68.650
2020-09-29 20:48:57,054 R@2 : 77.331
2020-09-29 20:48:57,292 R@4 : 83.023
2020-09-29 20:48:57,533 R@8 : 87.117
2020-09-29 20:49:31,747 Epoch: 15, loss: 2.793, time (seconds): 34.21.
2020-09-29 20:49:31,748 **Evaluating.**
2020-09-29 20:50:04,970 NMI: 67.843
2020-09-29 20:50:14,481 R@1 : 69.275
2020-09-29 20:50:14,725 R@2 : 78.098
2020-09-29 20:50:14,967 R@4 : 83.567
2020-09-29 20:50:15,209 R@8 : 87.349
2020-09-29 20:50:49,634 Epoch: 16, loss: 2.774, time (seconds): 34.42.
2020-09-29 20:50:49,634 **Evaluating.**
2020-09-29 20:51:22,713 NMI: 68.782
2020-09-29 20:51:32,311 R@1 : 70.568
2020-09-29 20:51:32,598 R@2 : 78.589
2020-09-29 20:51:32,872 R@4 : 84.084
2020-09-29 20:51:33,140 R@8 : 87.876
2020-09-29 20:52:07,240 Epoch: 17, loss: 2.773, time (seconds): 34.10.
2020-09-29 20:52:07,240 **Evaluating.**
2020-09-29 20:52:40,683 NMI: 69.780
2020-09-29 20:52:50,187 R@1 : 70.952
2020-09-29 20:52:50,427 R@2 : 79.418
2020-09-29 20:52:50,673 R@4 : 84.620
2020-09-29 20:52:50,917 R@8 : 88.349
2020-09-29 20:53:25,212 Epoch: 18, loss: 2.756, time (seconds): 34.29.
2020-09-29 20:53:25,213 **Evaluating.**
2020-09-29 20:53:58,374 NMI: 69.825
2020-09-29 20:54:07,840 R@1 : 71.773
2020-09-29 20:54:08,083 R@2 : 79.882
2020-09-29 20:54:08,322 R@4 : 84.959
2020-09-29 20:54:08,566 R@8 : 88.259
2020-09-29 20:54:42,851 Epoch: 19, loss: 2.768, time (seconds): 34.28.
2020-09-29 20:54:42,851 **Evaluating.**
2020-09-29 20:55:16,317 NMI: 70.606
2020-09-29 20:55:25,738 R@1 : 72.816
2020-09-29 20:55:25,985 R@2 : 80.498
2020-09-29 20:55:26,227 R@4 : 85.458
2020-09-29 20:55:26,469 R@8 : 88.839
2020-09-29 20:55:26,471 Total training time (minutes): 26.87.
2020-09-29 20:55:27,263 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200929-200136', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 3, 'train_classes': range(0, 50), 'eval_classes': range(0, 50), 'p_c': 1, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-29 20:55:27,263 Training for 20 epochs
2020-09-29 20:55:27,265 **Evaluating initial model.**
2020-09-29 20:56:01,343 NMI: 22.610
2020-09-29 20:56:12,831 R@1 : 31.385
2020-09-29 20:56:13,080 R@2 : 41.208
2020-09-29 20:56:13,320 R@4 : 52.217
2020-09-29 20:56:13,563 R@8 : 64.555
