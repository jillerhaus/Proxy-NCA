2020-09-28 17:21:39,598 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-172137', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 2, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 17:21:39,598 Training for 20 epochs
2020-09-28 17:21:39,601 **Evaluating initial model.**
2020-09-28 17:22:36,633 NMI: 25.916
2020-09-28 17:22:49,451 R@1 : 32.493
2020-09-28 17:22:49,754 R@2 : 41.514
2020-09-28 17:22:50,015 R@4 : 51.994
2020-09-28 17:22:50,302 R@8 : 62.736
2020-09-28 17:23:46,856 Epoch: 0, loss: 3.758, time (seconds): 56.55.
2020-09-28 17:23:46,857 **Evaluating.**
2020-09-28 17:24:32,409 NMI: 24.486
2020-09-28 17:24:43,944 R@1 : 30.303
2020-09-28 17:24:44,216 R@2 : 40.254
2020-09-28 17:24:44,467 R@4 : 51.065
2020-09-28 17:24:44,736 R@8 : 62.605
2020-09-28 17:25:21,534 Epoch: 1, loss: 2.998, time (seconds): 36.79.
2020-09-28 17:25:21,534 **Evaluating.**
2020-09-28 17:25:58,151 NMI: 27.336
2020-09-28 17:26:09,102 R@1 : 32.589
2020-09-28 17:26:09,362 R@2 : 42.861
2020-09-28 17:26:09,608 R@4 : 53.793
2020-09-28 17:26:09,852 R@8 : 65.065
2020-09-28 17:26:45,022 Epoch: 2, loss: 2.626, time (seconds): 35.17.
2020-09-28 17:26:45,023 **Evaluating.**
2020-09-28 17:27:20,171 NMI: 29.872
2020-09-28 17:27:31,058 R@1 : 35.222
2020-09-28 17:27:31,302 R@2 : 45.911
2020-09-28 17:27:31,560 R@4 : 56.965
2020-09-28 17:27:31,805 R@8 : 67.429
2020-09-28 17:28:06,149 Epoch: 3, loss: 2.404, time (seconds): 34.34.
2020-09-28 17:28:06,150 **Evaluating.**
2020-09-28 17:28:40,994 NMI: 31.479
2020-09-28 17:28:52,027 R@1 : 37.847
2020-09-28 17:28:52,282 R@2 : 48.275
2020-09-28 17:28:52,530 R@4 : 59.042
2020-09-28 17:28:52,787 R@8 : 69.479
2020-09-28 17:29:27,625 Epoch: 4, loss: 2.197, time (seconds): 34.84.
2020-09-28 17:29:27,625 **Evaluating.**
2020-09-28 17:30:02,410 NMI: 32.143
2020-09-28 17:30:13,719 R@1 : 39.246
2020-09-28 17:30:13,991 R@2 : 49.813
2020-09-28 17:30:14,258 R@4 : 60.216
2020-09-28 17:30:14,533 R@8 : 70.244
2020-09-28 17:30:49,144 Epoch: 5, loss: 2.127, time (seconds): 34.61.
2020-09-28 17:30:49,144 **Evaluating.**
2020-09-28 17:31:22,734 NMI: 32.273
2020-09-28 17:31:33,882 R@1 : 40.002
2020-09-28 17:31:34,126 R@2 : 50.630
2020-09-28 17:31:34,371 R@4 : 61.145
2020-09-28 17:31:34,615 R@8 : 71.052
2020-09-28 17:32:08,817 Epoch: 6, loss: 2.004, time (seconds): 34.20.
2020-09-28 17:32:08,818 **Evaluating.**
2020-09-28 17:32:42,394 NMI: 32.886
2020-09-28 17:32:53,552 R@1 : 40.071
2020-09-28 17:32:53,796 R@2 : 50.978
2020-09-28 17:32:54,041 R@4 : 61.371
2020-09-28 17:32:54,299 R@8 : 71.374
2020-09-28 17:33:28,215 Epoch: 7, loss: 1.920, time (seconds): 33.91.
2020-09-28 17:33:28,216 **Evaluating.**
2020-09-28 17:34:02,024 NMI: 32.617
2020-09-28 17:34:13,120 R@1 : 39.941
2020-09-28 17:34:13,379 R@2 : 50.908
2020-09-28 17:34:13,646 R@4 : 61.145
2020-09-28 17:34:13,914 R@8 : 71.044
2020-09-28 17:34:47,737 Epoch: 8, loss: 1.866, time (seconds): 33.82.
2020-09-28 17:34:47,738 **Evaluating.**
2020-09-28 17:35:21,228 NMI: 32.591
2020-09-28 17:35:32,320 R@1 : 39.367
2020-09-28 17:35:32,563 R@2 : 49.700
2020-09-28 17:35:32,807 R@4 : 60.633
2020-09-28 17:35:33,050 R@8 : 70.922
2020-09-28 17:36:07,285 Epoch: 9, loss: 1.765, time (seconds): 34.23.
2020-09-28 17:36:07,286 **Evaluating.**
2020-09-28 17:36:40,757 NMI: 32.263
2020-09-28 17:36:51,920 R@1 : 39.437
2020-09-28 17:36:52,199 R@2 : 50.178
2020-09-28 17:36:52,473 R@4 : 60.276
2020-09-28 17:36:52,750 R@8 : 70.505
2020-09-28 17:37:27,136 Epoch: 10, loss: 1.736, time (seconds): 34.38.
2020-09-28 17:37:27,137 **Evaluating.**
2020-09-28 17:38:00,471 NMI: 31.902
2020-09-28 17:38:11,726 R@1 : 39.037
2020-09-28 17:38:11,992 R@2 : 49.804
2020-09-28 17:38:12,251 R@4 : 60.876
2020-09-28 17:38:12,509 R@8 : 71.018
2020-09-28 17:38:46,773 Epoch: 11, loss: 1.699, time (seconds): 34.26.
2020-09-28 17:38:46,774 **Evaluating.**
2020-09-28 17:39:21,242 NMI: 31.924
2020-09-28 17:39:32,432 R@1 : 39.932
2020-09-28 17:39:32,681 R@2 : 50.569
2020-09-28 17:39:32,928 R@4 : 60.972
2020-09-28 17:39:33,173 R@8 : 71.087
2020-09-28 17:40:07,339 Epoch: 12, loss: 1.603, time (seconds): 34.16.
2020-09-28 17:40:07,339 **Evaluating.**
2020-09-28 17:40:40,585 NMI: 32.312
2020-09-28 17:40:51,719 R@1 : 39.628
2020-09-28 17:40:51,967 R@2 : 50.265
2020-09-28 17:40:52,212 R@4 : 61.119
2020-09-28 17:40:52,460 R@8 : 71.000
2020-09-28 17:41:26,358 Epoch: 13, loss: 1.567, time (seconds): 33.90.
2020-09-28 17:41:26,359 **Evaluating.**
2020-09-28 17:41:59,787 NMI: 32.302
2020-09-28 17:42:11,184 R@1 : 39.706
2020-09-28 17:42:11,428 R@2 : 50.726
2020-09-28 17:42:11,684 R@4 : 61.276
2020-09-28 17:42:11,928 R@8 : 71.061
2020-09-28 17:42:45,824 Epoch: 14, loss: 1.532, time (seconds): 33.89.
2020-09-28 17:42:45,825 **Evaluating.**
2020-09-28 17:43:19,601 NMI: 32.272
2020-09-28 17:43:30,991 R@1 : 39.385
2020-09-28 17:43:31,238 R@2 : 49.796
2020-09-28 17:43:31,489 R@4 : 60.085
2020-09-28 17:43:31,734 R@8 : 70.375
2020-09-28 17:44:05,929 Epoch: 15, loss: 1.471, time (seconds): 34.19.
2020-09-28 17:44:05,929 **Evaluating.**
2020-09-28 17:44:39,549 NMI: 31.589
2020-09-28 17:44:50,775 R@1 : 38.829
2020-09-28 17:44:51,037 R@2 : 49.552
2020-09-28 17:44:51,304 R@4 : 60.146
2020-09-28 17:44:51,563 R@8 : 69.618
2020-09-28 17:45:25,491 Epoch: 16, loss: 1.465, time (seconds): 33.93.
2020-09-28 17:45:25,492 **Evaluating.**
2020-09-28 17:45:58,304 NMI: 31.165
2020-09-28 17:46:09,446 R@1 : 38.776
2020-09-28 17:46:09,694 R@2 : 49.040
2020-09-28 17:46:09,941 R@4 : 59.320
2020-09-28 17:46:10,192 R@8 : 69.280
2020-09-28 17:46:43,816 Epoch: 17, loss: 1.423, time (seconds): 33.62.
2020-09-28 17:46:43,816 **Evaluating.**
2020-09-28 17:47:18,032 NMI: 31.494
2020-09-28 17:47:29,499 R@1 : 38.742
2020-09-28 17:47:29,780 R@2 : 48.927
2020-09-28 17:47:30,058 R@4 : 59.625
2020-09-28 17:47:30,334 R@8 : 69.723
2020-09-28 17:48:04,143 Epoch: 18, loss: 1.379, time (seconds): 33.81.
2020-09-28 17:48:04,143 **Evaluating.**
2020-09-28 17:48:37,412 NMI: 31.256
2020-09-28 17:48:48,751 R@1 : 38.646
2020-09-28 17:48:49,000 R@2 : 48.831
2020-09-28 17:48:49,245 R@4 : 59.564
2020-09-28 17:48:49,492 R@8 : 69.983
2020-09-28 17:49:23,514 Epoch: 19, loss: 1.402, time (seconds): 34.02.
2020-09-28 17:49:23,515 **Evaluating.**
2020-09-28 17:49:57,918 NMI: 31.522
2020-09-28 17:50:09,333 R@1 : 39.437
2020-09-28 17:50:09,594 R@2 : 49.500
2020-09-28 17:50:09,865 R@4 : 59.659
2020-09-28 17:50:10,126 R@8 : 69.749
2020-09-28 17:50:10,128 Total training time (minutes): 28.51.
2020-09-28 17:50:59,854 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-172137', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 0.51, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 17:50:59,855 Training for 20 epochs
2020-09-28 17:50:59,856 **Evaluating initial model.**
