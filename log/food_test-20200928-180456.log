2020-09-28 18:04:59,327 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-180456', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 0.25, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 18:04:59,328 Training for 20 epochs
2020-09-28 18:04:59,330 **Evaluating initial model.**
2020-09-28 18:05:33,159 NMI: 25.916
2020-09-28 18:05:44,671 R@1 : 32.493
2020-09-28 18:05:44,921 R@2 : 41.514
2020-09-28 18:05:45,165 R@4 : 51.994
2020-09-28 18:05:45,407 R@8 : 62.736
2020-09-28 18:06:19,239 Epoch: 0, loss: 0.700, time (seconds): 33.83.
2020-09-28 18:06:19,240 **Evaluating.**
2020-09-28 18:06:53,599 NMI: 19.410
2020-09-28 18:07:04,077 R@1 : 20.170
2020-09-28 18:07:04,323 R@2 : 28.869
2020-09-28 18:07:04,566 R@4 : 39.559
2020-09-28 18:07:04,814 R@8 : 52.255
2020-09-28 18:07:38,906 Epoch: 1, loss: 0.594, time (seconds): 34.09.
2020-09-28 18:07:38,906 **Evaluating.**
2020-09-28 18:08:13,242 NMI: 22.510
2020-09-28 18:08:24,153 R@1 : 23.490
2020-09-28 18:08:24,465 R@2 : 32.363
2020-09-28 18:08:24,767 R@4 : 43.825
2020-09-28 18:08:25,077 R@8 : 56.470
2020-09-28 18:08:59,106 Epoch: 2, loss: 0.569, time (seconds): 34.03.
2020-09-28 18:08:59,107 **Evaluating.**
2020-09-28 18:09:33,339 NMI: 21.803
2020-09-28 18:09:44,007 R@1 : 23.516
2020-09-28 18:09:44,264 R@2 : 32.815
2020-09-28 18:09:44,508 R@4 : 44.051
2020-09-28 18:09:44,751 R@8 : 56.175
2020-09-28 18:10:18,986 Epoch: 3, loss: 0.551, time (seconds): 34.23.
2020-09-28 18:10:18,987 **Evaluating.**
2020-09-28 18:10:53,119 NMI: 21.568
2020-09-28 18:11:03,913 R@1 : 22.812
2020-09-28 18:11:04,155 R@2 : 31.503
2020-09-28 18:11:04,399 R@4 : 42.296
2020-09-28 18:11:04,651 R@8 : 54.993
2020-09-28 18:11:39,098 Epoch: 4, loss: 0.542, time (seconds): 34.45.
2020-09-28 18:11:39,099 **Evaluating.**
2020-09-28 18:12:13,739 NMI: 21.476
2020-09-28 18:12:24,540 R@1 : 22.412
2020-09-28 18:12:24,785 R@2 : 30.851
2020-09-28 18:12:25,029 R@4 : 41.801
2020-09-28 18:12:25,275 R@8 : 54.210
2020-09-28 18:12:59,412 Epoch: 5, loss: 0.522, time (seconds): 34.14.
2020-09-28 18:12:59,413 **Evaluating.**
2020-09-28 18:13:33,732 NMI: 20.433
2020-09-28 18:13:44,546 R@1 : 21.370
2020-09-28 18:13:44,788 R@2 : 29.704
2020-09-28 18:13:45,030 R@4 : 40.315
2020-09-28 18:13:45,274 R@8 : 53.202
2020-09-28 18:14:19,621 Epoch: 6, loss: 0.496, time (seconds): 34.34.
2020-09-28 18:14:19,622 **Evaluating.**
2020-09-28 18:14:54,022 NMI: 19.656
2020-09-28 18:15:04,926 R@1 : 20.249
2020-09-28 18:15:05,179 R@2 : 28.339
2020-09-28 18:15:05,424 R@4 : 38.811
2020-09-28 18:15:05,679 R@8 : 51.212
2020-09-28 18:15:40,026 Epoch: 7, loss: 0.493, time (seconds): 34.35.
2020-09-28 18:15:40,027 **Evaluating.**
2020-09-28 18:16:14,617 NMI: 19.470
2020-09-28 18:16:25,568 R@1 : 19.710
2020-09-28 18:16:25,813 R@2 : 27.618
2020-09-28 18:16:26,057 R@4 : 38.212
2020-09-28 18:16:26,302 R@8 : 50.613
2020-09-28 18:17:00,705 Epoch: 8, loss: 0.487, time (seconds): 34.40.
2020-09-28 18:17:00,706 **Evaluating.**
2020-09-28 18:17:35,482 NMI: 19.093
2020-09-28 18:17:46,424 R@1 : 19.762
2020-09-28 18:17:46,667 R@2 : 27.531
2020-09-28 18:17:46,908 R@4 : 37.673
2020-09-28 18:17:47,150 R@8 : 49.996
2020-09-28 18:18:21,491 Epoch: 9, loss: 0.473, time (seconds): 34.34.
2020-09-28 18:18:21,492 **Evaluating.**
2020-09-28 18:18:55,596 NMI: 18.291
2020-09-28 18:19:06,452 R@1 : 19.527
2020-09-28 18:19:06,698 R@2 : 27.149
2020-09-28 18:19:06,949 R@4 : 37.247
2020-09-28 18:19:07,200 R@8 : 48.953
2020-09-28 18:19:41,683 Epoch: 10, loss: 0.464, time (seconds): 34.48.
2020-09-28 18:19:41,684 **Evaluating.**
2020-09-28 18:20:16,110 NMI: 17.327
2020-09-28 18:20:27,208 R@1 : 17.893
2020-09-28 18:20:27,452 R@2 : 25.167
2020-09-28 18:20:27,697 R@4 : 35.318
2020-09-28 18:20:27,939 R@8 : 48.266
2020-09-28 18:21:02,230 Epoch: 11, loss: 0.463, time (seconds): 34.29.
2020-09-28 18:21:02,231 **Evaluating.**
2020-09-28 18:21:36,588 NMI: 18.186
2020-09-28 18:21:47,451 R@1 : 18.841
2020-09-28 18:21:47,695 R@2 : 26.054
2020-09-28 18:21:47,936 R@4 : 35.726
2020-09-28 18:21:48,179 R@8 : 48.110
2020-09-28 18:22:22,649 Epoch: 12, loss: 0.465, time (seconds): 34.47.
2020-09-28 18:22:22,649 **Evaluating.**
2020-09-28 18:22:56,683 NMI: 17.392
2020-09-28 18:23:07,633 R@1 : 18.015
2020-09-28 18:23:07,878 R@2 : 25.298
2020-09-28 18:23:08,119 R@4 : 35.100
2020-09-28 18:23:08,374 R@8 : 48.014
2020-09-28 18:23:42,977 Epoch: 13, loss: 0.460, time (seconds): 34.60.
2020-09-28 18:23:42,978 **Evaluating.**
2020-09-28 18:24:17,121 NMI: 16.548
2020-09-28 18:24:28,104 R@1 : 17.720
2020-09-28 18:24:28,346 R@2 : 24.785
2020-09-28 18:24:28,587 R@4 : 34.310
2020-09-28 18:24:28,829 R@8 : 46.450
2020-09-28 18:25:03,234 Epoch: 14, loss: 0.459, time (seconds): 34.40.
2020-09-28 18:25:03,235 **Evaluating.**
2020-09-28 18:25:37,510 NMI: 16.104
2020-09-28 18:25:48,502 R@1 : 17.381
2020-09-28 18:25:48,746 R@2 : 23.942
2020-09-28 18:25:48,993 R@4 : 33.519
2020-09-28 18:25:49,243 R@8 : 45.868
2020-09-28 18:26:23,511 Epoch: 15, loss: 0.461, time (seconds): 34.27.
2020-09-28 18:26:23,512 **Evaluating.**
2020-09-28 18:26:57,777 NMI: 16.897
2020-09-28 18:27:08,797 R@1 : 17.615
2020-09-28 18:27:09,042 R@2 : 24.550
2020-09-28 18:27:09,290 R@4 : 34.440
2020-09-28 18:27:09,533 R@8 : 47.102
2020-09-28 18:27:44,288 Epoch: 16, loss: 0.458, time (seconds): 34.75.
2020-09-28 18:27:44,289 **Evaluating.**
2020-09-28 18:28:18,594 NMI: 16.292
2020-09-28 18:28:29,549 R@1 : 17.198
2020-09-28 18:28:29,828 R@2 : 23.890
2020-09-28 18:28:30,097 R@4 : 33.275
2020-09-28 18:28:30,376 R@8 : 45.094
2020-09-28 18:29:05,003 Epoch: 17, loss: 0.444, time (seconds): 34.63.
2020-09-28 18:29:05,004 **Evaluating.**
2020-09-28 18:29:39,069 NMI: 15.872
2020-09-28 18:29:50,219 R@1 : 16.885
2020-09-28 18:29:50,491 R@2 : 23.629
2020-09-28 18:29:50,764 R@4 : 33.519
2020-09-28 18:29:51,036 R@8 : 45.155
2020-09-28 18:30:25,299 Epoch: 18, loss: 0.439, time (seconds): 34.26.
2020-09-28 18:30:25,299 **Evaluating.**
2020-09-28 18:31:00,125 NMI: 14.901
2020-09-28 18:31:11,081 R@1 : 16.068
2020-09-28 18:31:11,333 R@2 : 22.517
2020-09-28 18:31:11,582 R@4 : 32.250
2020-09-28 18:31:11,827 R@8 : 44.356
2020-09-28 18:31:46,021 Epoch: 19, loss: 0.443, time (seconds): 34.19.
2020-09-28 18:31:46,022 **Evaluating.**
2020-09-28 18:32:20,263 NMI: 15.399
2020-09-28 18:32:31,266 R@1 : 16.442
2020-09-28 18:32:31,507 R@2 : 22.812
2020-09-28 18:32:31,749 R@4 : 32.389
2020-09-28 18:32:31,993 R@8 : 44.217
2020-09-28 18:32:31,995 Total training time (minutes): 27.54.
2020-09-28 18:32:32,738 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-180456', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 0.5, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 18:32:32,739 Training for 20 epochs
2020-09-28 18:32:32,740 **Evaluating initial model.**
2020-09-28 18:33:06,464 NMI: 25.916
2020-09-28 18:33:17,946 R@1 : 32.493
2020-09-28 18:33:18,188 R@2 : 41.514
2020-09-28 18:33:18,433 R@4 : 51.994
2020-09-28 18:33:18,675 R@8 : 62.736
2020-09-28 18:33:52,829 Epoch: 0, loss: 1.467, time (seconds): 34.15.
2020-09-28 18:33:52,830 **Evaluating.**
2020-09-28 18:34:27,603 NMI: 21.765
2020-09-28 18:34:38,146 R@1 : 26.367
2020-09-28 18:34:38,389 R@2 : 35.978
2020-09-28 18:34:38,637 R@4 : 47.232
2020-09-28 18:34:38,886 R@8 : 59.729
2020-09-28 18:35:13,074 Epoch: 1, loss: 1.218, time (seconds): 34.18.
2020-09-28 18:35:13,075 **Evaluating.**
2020-09-28 18:35:47,264 NMI: 25.799
2020-09-28 18:35:57,873 R@1 : 30.390
2020-09-28 18:35:58,113 R@2 : 40.680
2020-09-28 18:35:58,359 R@4 : 51.777
2020-09-28 18:35:58,599 R@8 : 63.918
2020-09-28 18:36:32,994 Epoch: 2, loss: 1.061, time (seconds): 34.39.
2020-09-28 18:36:32,995 **Evaluating.**
2020-09-28 18:37:07,000 NMI: 28.316
2020-09-28 18:37:17,838 R@1 : 33.319
2020-09-28 18:37:18,080 R@2 : 43.791
2020-09-28 18:37:18,322 R@4 : 54.393
2020-09-28 18:37:18,564 R@8 : 65.812
2020-09-28 18:37:52,849 Epoch: 3, loss: 1.021, time (seconds): 34.28.
2020-09-28 18:37:52,849 **Evaluating.**
2020-09-28 18:38:26,756 NMI: 28.394
2020-09-28 18:38:37,703 R@1 : 33.076
2020-09-28 18:38:37,943 R@2 : 42.948
2020-09-28 18:38:38,196 R@4 : 54.297
2020-09-28 18:38:38,450 R@8 : 65.404
2020-09-28 18:39:13,076 Epoch: 4, loss: 1.004, time (seconds): 34.62.
2020-09-28 18:39:13,077 **Evaluating.**
2020-09-28 18:39:46,609 NMI: 27.988
2020-09-28 18:39:57,585 R@1 : 32.450
2020-09-28 18:39:57,831 R@2 : 42.783
2020-09-28 18:39:58,080 R@4 : 54.106
2020-09-28 18:39:58,326 R@8 : 65.777
2020-09-28 18:40:32,518 Epoch: 5, loss: 0.960, time (seconds): 34.19.
2020-09-28 18:40:32,519 **Evaluating.**
