2020-09-28 22:09:36,171 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-220933', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 0.25, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 22:09:36,172 Training for 20 epochs
2020-09-28 22:09:36,174 **Evaluating initial model.**
2020-09-28 22:10:19,309 NMI: 25.916
2020-09-28 22:10:31,963 R@1 : 32.493
2020-09-28 22:10:32,233 R@2 : 41.514
2020-09-28 22:10:32,503 R@4 : 51.994
2020-09-28 22:10:32,769 R@8 : 62.736
2020-09-28 22:11:18,610 Epoch: 0, loss: 0.708, time (seconds): 45.84.
2020-09-28 22:11:18,612 **Evaluating.**
2020-09-28 22:11:57,555 NMI: 18.843
2020-09-28 22:12:08,961 R@1 : 19.736
2020-09-28 22:12:09,221 R@2 : 28.105
2020-09-28 22:12:09,482 R@4 : 38.776
2020-09-28 22:12:09,749 R@8 : 51.412
2020-09-28 22:12:45,193 Epoch: 1, loss: 0.607, time (seconds): 35.44.
2020-09-28 22:12:45,194 **Evaluating.**
2020-09-28 22:13:25,584 NMI: 22.174
2020-09-28 22:13:37,095 R@1 : 22.960
2020-09-28 22:13:37,349 R@2 : 32.241
2020-09-28 22:13:37,600 R@4 : 43.626
2020-09-28 22:13:37,860 R@8 : 55.966
2020-09-28 22:14:12,886 Epoch: 2, loss: 0.574, time (seconds): 35.02.
2020-09-28 22:14:12,887 **Evaluating.**
2020-09-28 22:14:52,825 NMI: 22.224
2020-09-28 22:15:04,529 R@1 : 23.742
2020-09-28 22:15:04,792 R@2 : 32.519
2020-09-28 22:15:05,066 R@4 : 43.487
2020-09-28 22:15:05,320 R@8 : 56.053
2020-09-28 22:15:41,329 Epoch: 3, loss: 0.557, time (seconds): 36.01.
2020-09-28 22:15:41,330 **Evaluating.**
2020-09-28 22:16:21,193 NMI: 21.939
2020-09-28 22:16:33,055 R@1 : 22.734
2020-09-28 22:16:33,315 R@2 : 31.668
2020-09-28 22:16:33,579 R@4 : 42.739
2020-09-28 22:16:33,848 R@8 : 55.036
2020-09-28 22:17:09,437 Epoch: 4, loss: 0.547, time (seconds): 35.59.
2020-09-28 22:17:09,438 **Evaluating.**
2020-09-28 22:17:48,447 NMI: 21.370
2020-09-28 22:18:00,276 R@1 : 22.517
2020-09-28 22:18:00,558 R@2 : 31.233
2020-09-28 22:18:00,828 R@4 : 42.426
2020-09-28 22:18:01,102 R@8 : 54.697
2020-09-28 22:18:36,602 Epoch: 5, loss: 0.526, time (seconds): 35.50.
2020-09-28 22:18:36,602 **Evaluating.**
2020-09-28 22:19:15,465 NMI: 20.804
2020-09-28 22:19:27,224 R@1 : 21.795
2020-09-28 22:19:27,481 R@2 : 30.242
2020-09-28 22:19:27,750 R@4 : 41.036
2020-09-28 22:19:28,018 R@8 : 53.785
2020-09-28 22:20:03,705 Epoch: 6, loss: 0.500, time (seconds): 35.68.
2020-09-28 22:20:03,706 **Evaluating.**
2020-09-28 22:20:42,610 NMI: 19.915
2020-09-28 22:20:54,563 R@1 : 20.666
2020-09-28 22:20:54,861 R@2 : 28.696
2020-09-28 22:20:55,160 R@4 : 38.976
2020-09-28 22:20:55,446 R@8 : 51.577
2020-09-28 22:21:30,857 Epoch: 7, loss: 0.496, time (seconds): 35.41.
2020-09-28 22:21:30,858 **Evaluating.**
2020-09-28 22:22:10,046 NMI: 19.711
2020-09-28 22:22:21,910 R@1 : 19.823
2020-09-28 22:22:22,168 R@2 : 28.044
2020-09-28 22:22:22,433 R@4 : 38.637
2020-09-28 22:22:22,708 R@8 : 51.134
2020-09-28 22:22:58,228 Epoch: 8, loss: 0.491, time (seconds): 35.52.
2020-09-28 22:22:58,229 **Evaluating.**
2020-09-28 22:23:37,387 NMI: 19.253
2020-09-28 22:23:49,202 R@1 : 20.266
2020-09-28 22:23:49,461 R@2 : 28.313
2020-09-28 22:23:49,739 R@4 : 38.437
2020-09-28 22:23:49,998 R@8 : 50.621
2020-09-28 22:24:25,329 Epoch: 9, loss: 0.475, time (seconds): 35.33.
2020-09-28 22:24:25,329 **Evaluating.**
2020-09-28 22:25:03,730 NMI: 18.695
2020-09-28 22:25:15,521 R@1 : 19.597
2020-09-28 22:25:15,786 R@2 : 26.949
2020-09-28 22:25:16,052 R@4 : 37.482
2020-09-28 22:25:16,312 R@8 : 49.978
2020-09-28 22:25:51,942 Epoch: 10, loss: 0.467, time (seconds): 35.63.
2020-09-28 22:25:51,943 **Evaluating.**
2020-09-28 22:26:30,724 NMI: 17.936
2020-09-28 22:26:42,591 R@1 : 18.623
2020-09-28 22:26:42,850 R@2 : 26.167
2020-09-28 22:26:43,115 R@4 : 36.178
2020-09-28 22:26:43,379 R@8 : 48.631
2020-09-28 22:27:18,881 Epoch: 11, loss: 0.465, time (seconds): 35.50.
2020-09-28 22:27:18,882 **Evaluating.**
2020-09-28 22:27:57,625 NMI: 18.280
2020-09-28 22:28:09,539 R@1 : 18.884
2020-09-28 22:28:09,831 R@2 : 26.254
2020-09-28 22:28:10,115 R@4 : 36.230
2020-09-28 22:28:10,411 R@8 : 48.840
2020-09-28 22:28:46,002 Epoch: 12, loss: 0.468, time (seconds): 35.59.
2020-09-28 22:28:46,002 **Evaluating.**
2020-09-28 22:29:24,389 NMI: 17.876
2020-09-28 22:29:36,261 R@1 : 18.076
2020-09-28 22:29:36,530 R@2 : 25.810
2020-09-28 22:29:36,790 R@4 : 35.848
2020-09-28 22:29:37,054 R@8 : 48.640
2020-09-28 22:30:12,657 Epoch: 13, loss: 0.463, time (seconds): 35.60.
2020-09-28 22:30:12,658 **Evaluating.**
2020-09-28 22:30:51,222 NMI: 17.361
2020-09-28 22:31:03,350 R@1 : 17.702
2020-09-28 22:31:03,613 R@2 : 25.237
2020-09-28 22:31:03,883 R@4 : 35.144
2020-09-28 22:31:04,148 R@8 : 47.258
2020-09-28 22:31:39,640 Epoch: 14, loss: 0.462, time (seconds): 35.49.
2020-09-28 22:31:39,641 **Evaluating.**
2020-09-28 22:32:18,028 NMI: 16.591
2020-09-28 22:32:29,968 R@1 : 17.824
2020-09-28 22:32:30,239 R@2 : 24.628
2020-09-28 22:32:30,494 R@4 : 34.457
2020-09-28 22:32:30,757 R@8 : 46.502
2020-09-28 22:33:06,121 Epoch: 15, loss: 0.465, time (seconds): 35.36.
2020-09-28 22:33:06,122 **Evaluating.**
2020-09-28 22:33:44,168 NMI: 17.033
2020-09-28 22:33:56,032 R@1 : 17.589
2020-09-28 22:33:56,300 R@2 : 24.802
2020-09-28 22:33:56,556 R@4 : 35.135
2020-09-28 22:33:56,824 R@8 : 47.623
2020-09-28 22:34:32,282 Epoch: 16, loss: 0.460, time (seconds): 35.45.
2020-09-28 22:34:32,283 **Evaluating.**
2020-09-28 22:35:10,669 NMI: 16.581
2020-09-28 22:35:22,487 R@1 : 17.363
2020-09-28 22:35:22,752 R@2 : 24.142
2020-09-28 22:35:23,010 R@4 : 33.493
2020-09-28 22:35:23,272 R@8 : 45.929
2020-09-28 22:35:58,686 Epoch: 17, loss: 0.446, time (seconds): 35.41.
2020-09-28 22:35:58,687 **Evaluating.**
2020-09-28 22:36:36,783 NMI: 15.810
2020-09-28 22:36:48,763 R@1 : 17.077
2020-09-28 22:36:49,022 R@2 : 23.898
2020-09-28 22:36:49,283 R@4 : 33.901
2020-09-28 22:36:49,550 R@8 : 46.076
2020-09-28 22:37:25,721 Epoch: 18, loss: 0.441, time (seconds): 36.17.
2020-09-28 22:37:25,722 **Evaluating.**
2020-09-28 22:38:04,297 NMI: 15.238
2020-09-28 22:38:16,242 R@1 : 16.312
2020-09-28 22:38:16,508 R@2 : 22.943
2020-09-28 22:38:16,779 R@4 : 32.319
2020-09-28 22:38:17,042 R@8 : 44.199
2020-09-28 22:38:52,491 Epoch: 19, loss: 0.445, time (seconds): 35.45.
2020-09-28 22:38:52,492 **Evaluating.**
2020-09-28 22:39:31,116 NMI: 15.559
2020-09-28 22:39:43,117 R@1 : 15.912
2020-09-28 22:39:43,375 R@2 : 23.229
2020-09-28 22:39:43,642 R@4 : 32.441
2020-09-28 22:39:43,905 R@8 : 44.816
2020-09-28 22:39:43,907 Total training time (minutes): 30.13.
2020-09-28 22:39:44,991 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-220933', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 0.5, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 22:39:44,992 Training for 20 epochs
2020-09-28 22:39:44,994 **Evaluating initial model.**
2020-09-28 22:40:23,025 NMI: 25.916
2020-09-28 22:40:35,504 R@1 : 32.493
2020-09-28 22:40:35,778 R@2 : 41.514
2020-09-28 22:40:36,033 R@4 : 51.994
2020-09-28 22:40:36,303 R@8 : 62.736
2020-09-28 22:41:11,872 Epoch: 0, loss: 1.491, time (seconds): 35.57.
2020-09-28 22:41:11,873 **Evaluating.**
2020-09-28 22:41:50,971 NMI: 21.515
2020-09-28 22:42:02,655 R@1 : 25.680
2020-09-28 22:42:02,937 R@2 : 35.144
2020-09-28 22:42:03,207 R@4 : 46.415
2020-09-28 22:42:03,463 R@8 : 59.103
2020-09-28 22:42:38,791 Epoch: 1, loss: 1.247, time (seconds): 35.32.
2020-09-28 22:42:38,791 **Evaluating.**
2020-09-28 22:43:17,422 NMI: 25.358
2020-09-28 22:43:29,055 R@1 : 30.129
2020-09-28 22:43:29,315 R@2 : 39.924
2020-09-28 22:43:29,572 R@4 : 51.212
2020-09-28 22:43:29,838 R@8 : 63.275
2020-09-28 22:44:05,100 Epoch: 2, loss: 1.080, time (seconds): 35.26.
2020-09-28 22:44:05,100 **Evaluating.**
2020-09-28 22:44:43,393 NMI: 28.101
2020-09-28 22:44:55,135 R@1 : 32.823
2020-09-28 22:44:55,417 R@2 : 43.434
2020-09-28 22:44:55,677 R@4 : 54.271
2020-09-28 22:44:55,935 R@8 : 65.352
2020-09-28 22:45:31,049 Epoch: 3, loss: 1.034, time (seconds): 35.11.
2020-09-28 22:45:31,049 **Evaluating.**
2020-09-28 22:46:08,944 NMI: 28.384
2020-09-28 22:46:20,913 R@1 : 32.780
2020-09-28 22:46:21,175 R@2 : 42.974
2020-09-28 22:46:21,435 R@4 : 54.680
2020-09-28 22:46:21,698 R@8 : 66.038
2020-09-28 22:46:57,053 Epoch: 4, loss: 1.019, time (seconds): 35.35.
2020-09-28 22:46:57,054 **Evaluating.**
2020-09-28 22:47:35,070 NMI: 27.883
2020-09-28 22:47:47,000 R@1 : 32.598
2020-09-28 22:47:47,259 R@2 : 42.765
2020-09-28 22:47:47,520 R@4 : 54.158
2020-09-28 22:47:47,783 R@8 : 65.647
2020-09-28 22:48:23,251 Epoch: 5, loss: 0.976, time (seconds): 35.46.
2020-09-28 22:48:23,251 **Evaluating.**
2020-09-28 22:49:01,589 NMI: 27.676
2020-09-28 22:49:13,719 R@1 : 31.911
2020-09-28 22:49:13,986 R@2 : 41.905
2020-09-28 22:49:14,251 R@4 : 53.089
2020-09-28 22:49:14,514 R@8 : 65.360
2020-09-28 22:49:49,847 Epoch: 6, loss: 0.948, time (seconds): 35.33.
2020-09-28 22:49:49,848 **Evaluating.**
2020-09-28 22:50:28,043 NMI: 27.061
2020-09-28 22:50:40,073 R@1 : 32.702
2020-09-28 22:50:40,335 R@2 : 42.861
2020-09-28 22:50:40,594 R@4 : 53.889
2020-09-28 22:50:40,863 R@8 : 65.421
2020-09-28 22:51:16,471 Epoch: 7, loss: 0.904, time (seconds): 35.61.
2020-09-28 22:51:16,472 **Evaluating.**
2020-09-28 22:51:54,126 NMI: 25.966
2020-09-28 22:52:06,347 R@1 : 30.886
2020-09-28 22:52:06,608 R@2 : 40.836
2020-09-28 22:52:06,871 R@4 : 52.290
2020-09-28 22:52:07,127 R@8 : 64.509
2020-09-28 22:52:42,258 Epoch: 8, loss: 0.864, time (seconds): 35.13.
2020-09-28 22:52:42,259 **Evaluating.**
2020-09-28 22:53:20,086 NMI: 25.830
2020-09-28 22:53:32,272 R@1 : 30.747
2020-09-28 22:53:32,538 R@2 : 41.288
2020-09-28 22:53:32,805 R@4 : 52.194
2020-09-28 22:53:33,074 R@8 : 63.457
2020-09-28 22:54:08,240 Epoch: 9, loss: 0.851, time (seconds): 35.16.
2020-09-28 22:54:08,241 **Evaluating.**
2020-09-28 22:54:46,645 NMI: 25.215
2020-09-28 22:54:58,892 R@1 : 30.729
2020-09-28 22:54:59,157 R@2 : 40.514
2020-09-28 22:54:59,416 R@4 : 51.534
2020-09-28 22:54:59,680 R@8 : 62.944
2020-09-28 22:55:35,293 Epoch: 10, loss: 0.845, time (seconds): 35.61.
2020-09-28 22:55:35,294 **Evaluating.**
2020-09-28 22:56:13,764 NMI: 24.298
2020-09-28 22:56:26,094 R@1 : 29.252
2020-09-28 22:56:26,354 R@2 : 38.594
2020-09-28 22:56:26,617 R@4 : 50.004
2020-09-28 22:56:26,881 R@8 : 61.771
2020-09-28 22:57:02,453 Epoch: 11, loss: 0.819, time (seconds): 35.57.
2020-09-28 22:57:02,454 **Evaluating.**
2020-09-28 22:57:40,333 NMI: 24.900
2020-09-28 22:57:52,840 R@1 : 30.216
2020-09-28 22:57:53,119 R@2 : 39.446
2020-09-28 22:57:53,400 R@4 : 50.752
2020-09-28 22:57:53,672 R@8 : 62.336
2020-09-28 22:58:29,350 Epoch: 12, loss: 0.773, time (seconds): 35.68.
2020-09-28 22:58:29,351 **Evaluating.**
2020-09-28 22:59:08,739 NMI: 24.145
2020-09-28 22:59:20,962 R@1 : 29.295
2020-09-28 22:59:21,253 R@2 : 38.872
2020-09-28 22:59:21,538 R@4 : 49.135
2020-09-28 22:59:21,831 R@8 : 61.024
2020-09-28 22:59:57,243 Epoch: 13, loss: 0.776, time (seconds): 35.41.
2020-09-28 22:59:57,243 **Evaluating.**
2020-09-28 23:00:35,427 NMI: 24.458
2020-09-28 23:00:47,615 R@1 : 29.443
2020-09-28 23:00:47,877 R@2 : 38.863
2020-09-28 23:00:48,135 R@4 : 49.770
2020-09-28 23:00:48,400 R@8 : 60.972
2020-09-28 23:01:23,841 Epoch: 14, loss: 0.758, time (seconds): 35.44.
2020-09-28 23:01:23,842 **Evaluating.**
2020-09-28 23:02:01,862 NMI: 24.060
2020-09-28 23:02:14,115 R@1 : 28.869
2020-09-28 23:02:14,374 R@2 : 37.873
2020-09-28 23:02:14,641 R@4 : 48.388
2020-09-28 23:02:14,917 R@8 : 59.798
2020-09-28 23:02:50,370 Epoch: 15, loss: 0.753, time (seconds): 35.45.
2020-09-28 23:02:50,371 **Evaluating.**
2020-09-28 23:03:27,941 NMI: 23.787
2020-09-28 23:03:40,495 R@1 : 28.704
2020-09-28 23:03:40,828 R@2 : 38.116
2020-09-28 23:03:41,148 R@4 : 48.701
2020-09-28 23:03:41,467 R@8 : 60.328
2020-09-28 23:04:16,780 Epoch: 16, loss: 0.732, time (seconds): 35.31.
2020-09-28 23:04:16,780 **Evaluating.**
2020-09-28 23:04:54,729 NMI: 24.042
2020-09-28 23:05:06,989 R@1 : 28.200
2020-09-28 23:05:07,257 R@2 : 37.325
2020-09-28 23:05:07,519 R@4 : 48.075
2020-09-28 23:05:07,771 R@8 : 59.642
2020-09-28 23:05:42,813 Epoch: 17, loss: 0.721, time (seconds): 35.04.
2020-09-28 23:05:42,814 **Evaluating.**
2020-09-28 23:06:21,238 NMI: 23.944
2020-09-28 23:06:33,530 R@1 : 28.000
2020-09-28 23:06:33,791 R@2 : 37.482
2020-09-28 23:06:34,060 R@4 : 48.162
2020-09-28 23:06:34,327 R@8 : 59.885
2020-09-28 23:07:09,659 Epoch: 18, loss: 0.697, time (seconds): 35.33.
2020-09-28 23:07:09,660 **Evaluating.**
2020-09-28 23:07:47,214 NMI: 23.640
2020-09-28 23:07:59,450 R@1 : 27.766
2020-09-28 23:07:59,720 R@2 : 36.821
2020-09-28 23:07:59,978 R@4 : 47.484
2020-09-28 23:08:00,257 R@8 : 59.034
2020-09-28 23:08:35,503 Epoch: 19, loss: 0.714, time (seconds): 35.24.
2020-09-28 23:08:35,503 **Evaluating.**
2020-09-28 23:09:13,470 NMI: 22.519
2020-09-28 23:09:25,829 R@1 : 27.027
2020-09-28 23:09:26,106 R@2 : 35.570
2020-09-28 23:09:26,366 R@4 : 46.389
2020-09-28 23:09:26,632 R@8 : 58.086
2020-09-28 23:09:26,634 Total training time (minutes): 29.69.
