2020-09-28 10:00:50,222 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-100047', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 80), 'eval_classes': range(80, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 10:00:50,223 Training for 20 epochs
2020-09-28 10:00:50,225 **Evaluating initial model.**
2020-09-28 10:01:04,950 NMI: 25.113
2020-09-28 10:01:07,218 R@1 : 42.839
2020-09-28 10:01:07,320 R@2 : 53.544
2020-09-28 10:01:07,422 R@4 : 65.131
2020-09-28 10:01:07,527 R@8 : 76.761
2020-09-28 10:02:02,203 Epoch: 0, loss: 2.158, time (seconds): 54.68.
2020-09-28 10:02:02,204 **Evaluating.**
2020-09-28 10:02:16,373 NMI: 31.841
2020-09-28 10:02:18,568 R@1 : 50.200
2020-09-28 10:02:18,681 R@2 : 60.673
2020-09-28 10:02:18,795 R@4 : 71.041
2020-09-28 10:02:18,910 R@8 : 80.400
2020-09-28 10:03:13,666 Epoch: 1, loss: 2.061, time (seconds): 54.75.
2020-09-28 10:03:13,666 **Evaluating.**
2020-09-28 10:03:27,873 NMI: 32.501
2020-09-28 10:03:30,078 R@1 : 51.966
2020-09-28 10:03:30,185 R@2 : 62.482
2020-09-28 10:03:30,290 R@4 : 71.756
2020-09-28 10:03:30,393 R@8 : 79.790
2020-09-28 10:04:24,714 Epoch: 2, loss: 2.009, time (seconds): 54.32.
2020-09-28 10:04:24,715 **Evaluating.**
2020-09-28 10:04:38,859 NMI: 32.609
2020-09-28 10:04:41,069 R@1 : 51.630
2020-09-28 10:04:41,177 R@2 : 62.019
2020-09-28 10:04:41,280 R@4 : 72.093
2020-09-28 10:04:41,382 R@8 : 80.273
2020-09-28 10:05:35,927 Epoch: 3, loss: 2.048, time (seconds): 54.54.
2020-09-28 10:05:35,928 **Evaluating.**
2020-09-28 10:05:50,065 NMI: 31.779
2020-09-28 10:05:52,251 R@1 : 51.230
2020-09-28 10:05:52,352 R@2 : 62.313
2020-09-28 10:05:52,460 R@4 : 72.093
2020-09-28 10:05:52,563 R@8 : 80.715
2020-09-28 10:06:47,323 Epoch: 4, loss: 1.997, time (seconds): 54.76.
2020-09-28 10:06:47,324 **Evaluating.**
2020-09-28 10:07:01,471 NMI: 31.430
2020-09-28 10:07:03,677 R@1 : 50.032
2020-09-28 10:07:03,790 R@2 : 60.925
2020-09-28 10:07:03,904 R@4 : 70.578
2020-09-28 10:07:04,018 R@8 : 79.327
2020-09-28 10:07:58,616 Epoch: 5, loss: 1.975, time (seconds): 54.60.
2020-09-28 10:07:58,617 **Evaluating.**
2020-09-28 10:08:12,660 NMI: 29.935
2020-09-28 10:08:14,845 R@1 : 49.422
2020-09-28 10:08:14,947 R@2 : 60.379
2020-09-28 10:08:15,048 R@4 : 70.536
2020-09-28 10:08:15,149 R@8 : 79.579
2020-09-28 10:09:09,995 Epoch: 6, loss: 1.970, time (seconds): 54.84.
2020-09-28 10:09:09,996 **Evaluating.**
2020-09-28 10:09:25,127 NMI: 29.803
2020-09-28 10:09:27,375 R@1 : 48.370
2020-09-28 10:09:27,477 R@2 : 59.895
2020-09-28 10:09:27,579 R@4 : 70.326
2020-09-28 10:09:27,682 R@8 : 80.042
2020-09-28 10:10:24,005 Epoch: 7, loss: 1.959, time (seconds): 56.32.
2020-09-28 10:10:24,006 **Evaluating.**
2020-09-28 10:10:39,104 NMI: 28.705
2020-09-28 10:10:41,377 R@1 : 48.833
2020-09-28 10:10:41,483 R@2 : 59.474
2020-09-28 10:10:41,587 R@4 : 70.389
2020-09-28 10:10:41,689 R@8 : 79.327
2020-09-28 10:11:38,092 Epoch: 8, loss: 1.953, time (seconds): 56.40.
2020-09-28 10:11:38,093 **Evaluating.**
2020-09-28 10:11:53,123 NMI: 29.222
2020-09-28 10:11:55,375 R@1 : 47.802
2020-09-28 10:11:55,491 R@2 : 58.885
2020-09-28 10:11:55,610 R@4 : 70.599
2020-09-28 10:11:55,723 R@8 : 79.243
2020-09-28 10:12:52,234 Epoch: 9, loss: 1.910, time (seconds): 56.51.
2020-09-28 10:12:52,235 **Evaluating.**
2020-09-28 10:13:07,195 NMI: 28.109
2020-09-28 10:13:09,421 R@1 : 47.129
2020-09-28 10:13:09,523 R@2 : 59.054
2020-09-28 10:13:09,626 R@4 : 70.305
2020-09-28 10:13:09,728 R@8 : 78.759
2020-09-28 10:14:06,151 Epoch: 10, loss: 1.902, time (seconds): 56.42.
2020-09-28 10:14:06,151 **Evaluating.**
2020-09-28 10:14:21,072 NMI: 27.486
2020-09-28 10:14:23,388 R@1 : 45.973
2020-09-28 10:14:23,491 R@2 : 57.182
2020-09-28 10:14:23,594 R@4 : 67.971
2020-09-28 10:14:23,695 R@8 : 77.518
2020-09-28 10:15:19,932 Epoch: 11, loss: 1.903, time (seconds): 56.23.
2020-09-28 10:15:19,933 **Evaluating.**
2020-09-28 10:15:34,805 NMI: 28.178
2020-09-28 10:15:37,052 R@1 : 46.183
2020-09-28 10:15:37,156 R@2 : 58.612
2020-09-28 10:15:37,262 R@4 : 69.295
2020-09-28 10:15:37,368 R@8 : 78.297
2020-09-28 10:16:33,840 Epoch: 12, loss: 1.878, time (seconds): 56.47.
2020-09-28 10:16:33,841 **Evaluating.**
2020-09-28 10:16:48,765 NMI: 27.631
2020-09-28 10:16:51,060 R@1 : 46.793
2020-09-28 10:16:51,171 R@2 : 58.297
2020-09-28 10:16:51,273 R@4 : 69.590
2020-09-28 10:16:51,385 R@8 : 78.675
2020-09-28 10:17:47,985 Epoch: 13, loss: 1.859, time (seconds): 56.60.
2020-09-28 10:17:47,986 **Evaluating.**
2020-09-28 10:18:02,932 NMI: 26.912
2020-09-28 10:18:05,221 R@1 : 44.879
2020-09-28 10:18:05,330 R@2 : 56.488
2020-09-28 10:18:05,433 R@4 : 68.433
2020-09-28 10:18:05,535 R@8 : 77.792
2020-09-28 10:19:01,863 Epoch: 14, loss: 1.841, time (seconds): 56.33.
2020-09-28 10:19:01,864 **Evaluating.**
2020-09-28 10:19:16,741 NMI: 27.227
2020-09-28 10:19:19,018 R@1 : 44.669
2020-09-28 10:19:19,121 R@2 : 55.668
2020-09-28 10:19:19,224 R@4 : 68.412
2020-09-28 10:19:19,327 R@8 : 77.813
2020-09-28 10:20:15,709 Epoch: 15, loss: 1.884, time (seconds): 56.38.
2020-09-28 10:20:15,709 **Evaluating.**
2020-09-28 10:20:30,518 NMI: 27.837
2020-09-28 10:20:32,802 R@1 : 44.311
2020-09-28 10:20:32,905 R@2 : 56.151
2020-09-28 10:20:33,013 R@4 : 67.234
2020-09-28 10:20:33,116 R@8 : 77.056
2020-09-28 10:21:29,419 Epoch: 16, loss: 1.849, time (seconds): 56.30.
2020-09-28 10:21:29,420 **Evaluating.**
2020-09-28 10:21:44,463 NMI: 27.059
2020-09-28 10:21:46,713 R@1 : 44.185
2020-09-28 10:21:46,816 R@2 : 56.593
2020-09-28 10:21:46,919 R@4 : 67.739
2020-09-28 10:21:47,023 R@8 : 77.266
2020-09-28 10:22:43,362 Epoch: 17, loss: 1.862, time (seconds): 56.34.
2020-09-28 10:22:43,363 **Evaluating.**
2020-09-28 10:22:58,343 NMI: 26.960
2020-09-28 10:23:00,590 R@1 : 44.311
2020-09-28 10:23:00,696 R@2 : 56.004
2020-09-28 10:23:00,802 R@4 : 67.382
2020-09-28 10:23:00,905 R@8 : 77.287
2020-09-28 10:23:57,369 Epoch: 18, loss: 1.849, time (seconds): 56.46.
2020-09-28 10:23:57,370 **Evaluating.**
2020-09-28 10:24:12,229 NMI: 26.258
2020-09-28 10:24:14,550 R@1 : 42.944
2020-09-28 10:24:14,652 R@2 : 54.953
2020-09-28 10:24:14,755 R@4 : 66.288
2020-09-28 10:24:14,857 R@8 : 76.677
2020-09-28 10:25:11,112 Epoch: 19, loss: 1.851, time (seconds): 56.25.
2020-09-28 10:25:11,113 **Evaluating.**
2020-09-28 10:25:25,996 NMI: 27.008
2020-09-28 10:25:28,241 R@1 : 44.080
2020-09-28 10:25:28,351 R@2 : 55.563
2020-09-28 10:25:28,455 R@4 : 66.246
2020-09-28 10:25:28,564 R@8 : 76.193
2020-09-28 10:25:28,566 Total training time (minutes): 24.64.
2020-09-28 10:25:29,346 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-100047', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 80), 'eval_classes': range(80, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 10:25:29,347 Training for 20 epochs
2020-09-28 10:25:29,349 **Evaluating initial model.**
2020-09-28 10:25:44,559 NMI: 25.113
2020-09-28 10:25:46,951 R@1 : 42.839
2020-09-28 10:25:47,061 R@2 : 53.544
2020-09-28 10:25:47,170 R@4 : 65.131
2020-09-28 10:25:47,273 R@8 : 76.761
2020-09-28 10:26:43,725 Epoch: 0, loss: 1.752, time (seconds): 56.45.
2020-09-28 10:26:43,726 **Evaluating.**
2020-09-28 10:26:58,592 NMI: 33.651
2020-09-28 10:27:00,876 R@1 : 51.567
2020-09-28 10:27:00,979 R@2 : 62.503
2020-09-28 10:27:01,082 R@4 : 72.744
2020-09-28 10:27:01,185 R@8 : 81.598
2020-09-28 10:27:57,610 Epoch: 1, loss: 1.576, time (seconds): 56.42.
2020-09-28 10:27:57,611 **Evaluating.**
2020-09-28 10:28:12,637 NMI: 35.773
2020-09-28 10:28:14,973 R@1 : 53.943
2020-09-28 10:28:15,075 R@2 : 64.311
2020-09-28 10:28:15,178 R@4 : 73.628
2020-09-28 10:28:15,280 R@8 : 82.208
2020-09-28 10:29:11,663 Epoch: 2, loss: 1.455, time (seconds): 56.38.
2020-09-28 10:29:11,664 **Evaluating.**
2020-09-28 10:29:26,668 NMI: 37.414
2020-09-28 10:29:28,970 R@1 : 53.943
2020-09-28 10:29:29,080 R@2 : 64.585
2020-09-28 10:29:29,189 R@4 : 74.027
2020-09-28 10:29:29,298 R@8 : 82.166
2020-09-28 10:30:25,886 Epoch: 3, loss: 1.447, time (seconds): 56.58.
2020-09-28 10:30:25,887 **Evaluating.**
2020-09-28 10:30:40,894 NMI: 35.655
2020-09-28 10:30:43,203 R@1 : 54.301
2020-09-28 10:30:43,305 R@2 : 65.489
2020-09-28 10:30:43,409 R@4 : 75.605
2020-09-28 10:30:43,512 R@8 : 83.113
2020-09-28 10:31:39,543 Epoch: 4, loss: 1.392, time (seconds): 56.03.
2020-09-28 10:31:39,544 **Evaluating.**
2020-09-28 10:31:53,727 NMI: 36.022
2020-09-28 10:31:56,001 R@1 : 53.796
2020-09-28 10:31:56,103 R@2 : 65.237
2020-09-28 10:31:56,205 R@4 : 75.247
2020-09-28 10:31:56,309 R@8 : 83.134
2020-09-28 10:32:51,304 Epoch: 5, loss: 1.326, time (seconds): 54.99.
2020-09-28 10:32:51,305 **Evaluating.**
2020-09-28 10:33:05,431 NMI: 32.921
2020-09-28 10:33:07,617 R@1 : 53.817
2020-09-28 10:33:07,725 R@2 : 64.122
2020-09-28 10:33:07,828 R@4 : 74.301
2020-09-28 10:33:07,931 R@8 : 82.524
2020-09-28 10:34:03,076 Epoch: 6, loss: 1.291, time (seconds): 55.14.
2020-09-28 10:34:03,077 **Evaluating.**
2020-09-28 10:34:17,360 NMI: 34.474
2020-09-28 10:34:19,591 R@1 : 52.871
2020-09-28 10:34:19,694 R@2 : 65.089
2020-09-28 10:34:19,802 R@4 : 74.595
2020-09-28 10:34:19,910 R@8 : 82.713
2020-09-28 10:35:15,127 Epoch: 7, loss: 1.249, time (seconds): 55.21.
2020-09-28 10:35:15,128 **Evaluating.**
2020-09-28 10:35:29,441 NMI: 31.139
2020-09-28 10:35:31,692 R@1 : 51.693
2020-09-28 10:35:31,795 R@2 : 63.617
2020-09-28 10:35:31,898 R@4 : 73.670
2020-09-28 10:35:32,001 R@8 : 82.019
2020-09-28 10:36:27,158 Epoch: 8, loss: 1.205, time (seconds): 55.15.
2020-09-28 10:36:27,159 **Evaluating.**
2020-09-28 10:36:41,553 NMI: 33.049
2020-09-28 10:36:43,771 R@1 : 51.504
2020-09-28 10:36:43,879 R@2 : 63.281
2020-09-28 10:36:43,981 R@4 : 73.712
2020-09-28 10:36:44,089 R@8 : 81.914
2020-09-28 10:37:39,269 Epoch: 9, loss: 1.182, time (seconds): 55.18.
2020-09-28 10:37:39,270 **Evaluating.**
2020-09-28 10:37:53,338 NMI: 31.695
2020-09-28 10:37:55,580 R@1 : 51.420
2020-09-28 10:37:55,687 R@2 : 62.797
2020-09-28 10:37:55,789 R@4 : 73.649
2020-09-28 10:37:55,897 R@8 : 81.535
2020-09-28 10:38:51,188 Epoch: 10, loss: 1.164, time (seconds): 55.29.
2020-09-28 10:38:51,189 **Evaluating.**
2020-09-28 10:39:05,418 NMI: 29.982
2020-09-28 10:39:07,652 R@1 : 49.148
2020-09-28 10:39:07,759 R@2 : 61.304
2020-09-28 10:39:07,866 R@4 : 71.651
2020-09-28 10:39:07,969 R@8 : 80.526
2020-09-28 10:40:02,637 Epoch: 11, loss: 1.138, time (seconds): 54.66.
2020-09-28 10:40:02,637 **Evaluating.**
2020-09-28 10:40:17,002 NMI: 32.015
2020-09-28 10:40:19,250 R@1 : 50.662
2020-09-28 10:40:19,352 R@2 : 62.019
2020-09-28 10:40:19,455 R@4 : 71.882
2020-09-28 10:40:19,557 R@8 : 80.694
2020-09-28 10:41:14,631 Epoch: 12, loss: 1.121, time (seconds): 55.07.
2020-09-28 10:41:14,631 **Evaluating.**
2020-09-28 10:41:28,751 NMI: 29.782
2020-09-28 10:41:31,006 R@1 : 49.485
2020-09-28 10:41:31,110 R@2 : 61.661
2020-09-28 10:41:31,213 R@4 : 72.744
2020-09-28 10:41:31,314 R@8 : 81.556
2020-09-28 10:42:26,331 Epoch: 13, loss: 1.073, time (seconds): 55.02.
2020-09-28 10:42:26,332 **Evaluating.**
2020-09-28 10:42:40,564 NMI: 29.173
2020-09-28 10:42:42,813 R@1 : 48.433
2020-09-28 10:42:42,922 R@2 : 59.937
2020-09-28 10:42:43,031 R@4 : 71.041
2020-09-28 10:42:43,139 R@8 : 80.336
2020-09-28 10:43:38,832 Epoch: 14, loss: 1.047, time (seconds): 55.69.
2020-09-28 10:43:38,833 **Evaluating.**
2020-09-28 10:43:52,926 NMI: 29.515
2020-09-28 10:43:55,171 R@1 : 49.001
2020-09-28 10:43:55,275 R@2 : 60.799
2020-09-28 10:43:55,378 R@4 : 71.041
2020-09-28 10:43:55,481 R@8 : 80.315
2020-09-28 10:44:50,612 Epoch: 15, loss: 1.068, time (seconds): 55.13.
2020-09-28 10:44:50,612 **Evaluating.**
2020-09-28 10:45:04,865 NMI: 30.595
2020-09-28 10:45:07,154 R@1 : 48.412
2020-09-28 10:45:07,257 R@2 : 59.748
2020-09-28 10:45:07,364 R@4 : 70.557
2020-09-28 10:45:07,469 R@8 : 80.168
2020-09-28 10:46:02,370 Epoch: 16, loss: 1.035, time (seconds): 54.90.
2020-09-28 10:46:02,371 **Evaluating.**
2020-09-28 10:46:16,537 NMI: 28.837
2020-09-28 10:46:18,758 R@1 : 48.265
2020-09-28 10:46:18,867 R@2 : 60.084
2020-09-28 10:46:18,974 R@4 : 70.326
2020-09-28 10:46:19,082 R@8 : 79.495
2020-09-28 10:47:13,856 Epoch: 17, loss: 1.023, time (seconds): 54.77.
2020-09-28 10:47:13,857 **Evaluating.**
2020-09-28 10:47:27,999 NMI: 27.961
2020-09-28 10:47:30,308 R@1 : 48.265
2020-09-28 10:47:30,409 R@2 : 58.507
2020-09-28 10:47:30,512 R@4 : 69.422
2020-09-28 10:47:30,613 R@8 : 78.864
2020-09-28 10:48:25,783 Epoch: 18, loss: 1.000, time (seconds): 55.17.
2020-09-28 10:48:25,784 **Evaluating.**
2020-09-28 10:48:39,942 NMI: 27.440
2020-09-28 10:48:42,227 R@1 : 46.456
2020-09-28 10:48:42,336 R@2 : 57.371
2020-09-28 10:48:42,447 R@4 : 68.728
2020-09-28 10:48:42,555 R@8 : 78.801
2020-09-28 10:49:37,600 Epoch: 19, loss: 0.996, time (seconds): 55.04.
2020-09-28 10:49:37,601 **Evaluating.**
2020-09-28 10:49:51,845 NMI: 26.946
2020-09-28 10:49:54,064 R@1 : 46.667
2020-09-28 10:49:54,167 R@2 : 57.518
2020-09-28 10:49:54,270 R@4 : 68.454
2020-09-28 10:49:54,373 R@8 : 78.654
2020-09-28 10:49:54,375 Total training time (minutes): 24.42.
2020-09-28 10:49:55,141 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-100047', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 80), 'eval_classes': range(80, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 10:49:55,141 Training for 20 epochs
2020-09-28 10:49:55,143 **Evaluating initial model.**
2020-09-28 10:50:09,373 NMI: 25.113
2020-09-28 10:50:11,611 R@1 : 42.839
2020-09-28 10:50:11,713 R@2 : 53.544
2020-09-28 10:50:11,817 R@4 : 65.131
2020-09-28 10:50:11,921 R@8 : 76.761
2020-09-28 10:51:07,103 Epoch: 0, loss: 2.143, time (seconds): 55.18.
2020-09-28 10:51:07,104 **Evaluating.**
2020-09-28 10:51:21,284 NMI: 24.821
2020-09-28 10:51:23,366 R@1 : 43.638
2020-09-28 10:51:23,470 R@2 : 55.100
2020-09-28 10:51:23,575 R@4 : 67.340
2020-09-28 10:51:23,677 R@8 : 78.591
2020-09-28 10:52:18,846 Epoch: 1, loss: 1.677, time (seconds): 55.17.
2020-09-28 10:52:18,847 **Evaluating.**
2020-09-28 10:52:33,185 NMI: 33.051
2020-09-28 10:52:35,348 R@1 : 51.798
2020-09-28 10:52:35,449 R@2 : 63.218
2020-09-28 10:52:35,552 R@4 : 74.027
2020-09-28 10:52:35,655 R@8 : 82.461
2020-09-28 10:53:30,504 Epoch: 2, loss: 1.517, time (seconds): 54.85.
2020-09-28 10:53:30,505 **Evaluating.**
2020-09-28 10:53:44,877 NMI: 35.829
2020-09-28 10:53:47,049 R@1 : 53.733
2020-09-28 10:53:47,157 R@2 : 64.732
2020-09-28 10:53:47,264 R@4 : 73.838
2020-09-28 10:53:47,371 R@8 : 82.355
2020-09-28 10:54:42,202 Epoch: 3, loss: 1.498, time (seconds): 54.83.
2020-09-28 10:54:42,203 **Evaluating.**
2020-09-28 10:54:56,479 NMI: 35.684
2020-09-28 10:54:58,721 R@1 : 54.175
2020-09-28 10:54:58,823 R@2 : 64.501
2020-09-28 10:54:58,926 R@4 : 74.154
2020-09-28 10:54:59,028 R@8 : 82.650
2020-09-28 10:55:54,184 Epoch: 4, loss: 1.411, time (seconds): 55.15.
2020-09-28 10:55:54,185 **Evaluating.**
2020-09-28 10:56:08,415 NMI: 35.638
2020-09-28 10:56:10,639 R@1 : 53.628
2020-09-28 10:56:10,743 R@2 : 65.363
2020-09-28 10:56:10,845 R@4 : 75.352
2020-09-28 10:56:10,947 R@8 : 83.323
2020-09-28 10:57:05,937 Epoch: 5, loss: 1.329, time (seconds): 54.99.
2020-09-28 10:57:05,938 **Evaluating.**
2020-09-28 10:57:20,145 NMI: 35.354
2020-09-28 10:57:22,322 R@1 : 54.006
2020-09-28 10:57:22,442 R@2 : 65.657
2020-09-28 10:57:22,557 R@4 : 75.268
2020-09-28 10:57:22,671 R@8 : 83.596
2020-09-28 10:58:17,626 Epoch: 6, loss: 1.288, time (seconds): 54.95.
2020-09-28 10:58:17,627 **Evaluating.**
2020-09-28 10:58:31,738 NMI: 36.957
2020-09-28 10:58:33,993 R@1 : 54.679
2020-09-28 10:58:34,099 R@2 : 65.846
2020-09-28 10:58:34,201 R@4 : 75.289
2020-09-28 10:58:34,308 R@8 : 83.491
2020-09-28 10:59:29,723 Epoch: 7, loss: 1.236, time (seconds): 55.41.
2020-09-28 10:59:29,724 **Evaluating.**
2020-09-28 10:59:43,786 NMI: 36.301
2020-09-28 10:59:46,010 R@1 : 54.364
2020-09-28 10:59:46,118 R@2 : 65.152
2020-09-28 10:59:46,226 R@4 : 75.100
2020-09-28 10:59:46,334 R@8 : 83.049
2020-09-28 11:00:41,393 Epoch: 8, loss: 1.196, time (seconds): 55.06.
2020-09-28 11:00:41,393 **Evaluating.**
2020-09-28 11:00:55,729 NMI: 37.348
2020-09-28 11:00:57,932 R@1 : 53.502
2020-09-28 11:00:58,034 R@2 : 64.627
2020-09-28 11:00:58,136 R@4 : 74.890
2020-09-28 11:00:58,238 R@8 : 83.449
2020-09-28 11:01:53,342 Epoch: 9, loss: 1.156, time (seconds): 55.10.
2020-09-28 11:01:53,343 **Evaluating.**
2020-09-28 11:02:07,687 NMI: 36.808
2020-09-28 11:02:09,987 R@1 : 53.039
2020-09-28 11:02:10,103 R@2 : 64.164
2020-09-28 11:02:10,219 R@4 : 74.637
2020-09-28 11:02:10,333 R@8 : 82.397
2020-09-28 11:03:05,391 Epoch: 10, loss: 1.131, time (seconds): 55.06.
2020-09-28 11:03:05,392 **Evaluating.**
2020-09-28 11:03:19,611 NMI: 35.205
2020-09-28 11:03:21,823 R@1 : 52.366
2020-09-28 11:03:21,931 R@2 : 63.849
2020-09-28 11:03:22,039 R@4 : 73.586
2020-09-28 11:03:22,145 R@8 : 81.830
2020-09-28 11:04:17,186 Epoch: 11, loss: 1.095, time (seconds): 55.04.
2020-09-28 11:04:17,187 **Evaluating.**
2020-09-28 11:04:31,501 NMI: 36.699
2020-09-28 11:04:33,766 R@1 : 52.955
2020-09-28 11:04:33,870 R@2 : 64.479
2020-09-28 11:04:33,973 R@4 : 73.775
2020-09-28 11:04:34,076 R@8 : 82.145
2020-09-28 11:05:29,014 Epoch: 12, loss: 1.068, time (seconds): 54.94.
2020-09-28 11:05:29,015 **Evaluating.**
2020-09-28 11:05:43,133 NMI: 35.838
2020-09-28 11:05:45,444 R@1 : 53.228
2020-09-28 11:05:45,546 R@2 : 64.038
2020-09-28 11:05:45,650 R@4 : 73.523
2020-09-28 11:05:45,753 R@8 : 81.556
2020-09-28 11:06:40,509 Epoch: 13, loss: 1.024, time (seconds): 54.75.
2020-09-28 11:06:40,510 **Evaluating.**
2020-09-28 11:06:54,765 NMI: 36.568
2020-09-28 11:06:57,000 R@1 : 52.871
2020-09-28 11:06:57,103 R@2 : 63.575
2020-09-28 11:06:57,211 R@4 : 73.081
2020-09-28 11:06:57,313 R@8 : 82.440
2020-09-28 11:07:52,216 Epoch: 14, loss: 0.997, time (seconds): 54.90.
2020-09-28 11:07:52,217 **Evaluating.**
2020-09-28 11:08:06,528 NMI: 36.271
2020-09-28 11:08:08,853 R@1 : 52.744
2020-09-28 11:08:08,955 R@2 : 63.407
2020-09-28 11:08:09,063 R@4 : 73.291
2020-09-28 11:08:09,170 R@8 : 82.019
2020-09-28 11:09:04,404 Epoch: 15, loss: 1.003, time (seconds): 55.23.
2020-09-28 11:09:04,405 **Evaluating.**
2020-09-28 11:09:18,640 NMI: 36.136
2020-09-28 11:09:20,863 R@1 : 52.387
2020-09-28 11:09:20,967 R@2 : 63.070
2020-09-28 11:09:21,069 R@4 : 73.354
2020-09-28 11:09:21,172 R@8 : 82.019
2020-09-28 11:10:16,008 Epoch: 16, loss: 0.964, time (seconds): 54.83.
2020-09-28 11:10:16,008 **Evaluating.**
2020-09-28 11:10:30,208 NMI: 34.872
2020-09-28 11:10:32,446 R@1 : 50.894
2020-09-28 11:10:32,547 R@2 : 61.788
2020-09-28 11:10:32,649 R@4 : 72.177
2020-09-28 11:10:32,751 R@8 : 80.925
2020-09-28 11:11:27,628 Epoch: 17, loss: 0.965, time (seconds): 54.88.
2020-09-28 11:11:27,629 **Evaluating.**
2020-09-28 11:11:41,763 NMI: 34.670
2020-09-28 11:11:44,084 R@1 : 50.683
2020-09-28 11:11:44,192 R@2 : 62.187
2020-09-28 11:11:44,301 R@4 : 72.408
2020-09-28 11:11:44,409 R@8 : 81.430
2020-09-28 11:12:39,559 Epoch: 18, loss: 0.943, time (seconds): 55.15.
2020-09-28 11:12:39,559 **Evaluating.**
2020-09-28 11:12:53,947 NMI: 34.391
2020-09-28 11:12:56,205 R@1 : 50.641
2020-09-28 11:12:56,307 R@2 : 61.556
2020-09-28 11:12:56,410 R@4 : 71.293
2020-09-28 11:12:56,514 R@8 : 80.799
2020-09-28 11:13:51,576 Epoch: 19, loss: 0.934, time (seconds): 55.06.
2020-09-28 11:13:51,577 **Evaluating.**
2020-09-28 11:14:05,745 NMI: 34.225
2020-09-28 11:14:08,015 R@1 : 50.936
2020-09-28 11:14:08,123 R@2 : 61.809
2020-09-28 11:14:08,231 R@4 : 71.945
2020-09-28 11:14:08,336 R@8 : 80.715
2020-09-28 11:14:08,338 Total training time (minutes): 24.22.
2020-09-28 11:14:09,087 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-100047', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 80), 'eval_classes': range(80, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 11:14:09,087 Training for 20 epochs
2020-09-28 11:14:09,089 **Evaluating initial model.**
2020-09-28 11:14:23,304 NMI: 25.113
2020-09-28 11:14:25,564 R@1 : 42.839
2020-09-28 11:14:25,666 R@2 : 53.544
2020-09-28 11:14:25,768 R@4 : 65.131
2020-09-28 11:14:25,872 R@8 : 76.761
2020-09-28 11:15:21,019 Epoch: 0, loss: 1.753, time (seconds): 55.15.
2020-09-28 11:15:21,020 **Evaluating.**
2020-09-28 11:15:35,141 NMI: 33.366
2020-09-28 11:15:37,324 R@1 : 51.293
2020-09-28 11:15:37,426 R@2 : 62.503
2020-09-28 11:15:37,529 R@4 : 72.934
2020-09-28 11:15:37,632 R@8 : 81.682
2020-09-28 11:16:32,604 Epoch: 1, loss: 1.577, time (seconds): 54.97.
2020-09-28 11:16:32,605 **Evaluating.**
2020-09-28 11:16:46,896 NMI: 36.255
2020-09-28 11:16:49,083 R@1 : 53.922
2020-09-28 11:16:49,185 R@2 : 64.648
2020-09-28 11:16:49,287 R@4 : 73.691
2020-09-28 11:16:49,391 R@8 : 82.250
2020-09-28 11:17:44,533 Epoch: 2, loss: 1.455, time (seconds): 55.14.
2020-09-28 11:17:44,534 **Evaluating.**
2020-09-28 11:17:58,708 NMI: 35.963
2020-09-28 11:18:00,946 R@1 : 54.196
2020-09-28 11:18:01,051 R@2 : 65.005
2020-09-28 11:18:01,159 R@4 : 74.574
2020-09-28 11:18:01,267 R@8 : 82.313
2020-09-28 11:18:56,188 Epoch: 3, loss: 1.447, time (seconds): 54.92.
2020-09-28 11:18:56,189 **Evaluating.**
2020-09-28 11:19:10,300 NMI: 35.836
2020-09-28 11:19:12,505 R@1 : 54.238
2020-09-28 11:19:12,609 R@2 : 65.615
2020-09-28 11:19:12,713 R@4 : 75.563
2020-09-28 11:19:12,816 R@8 : 83.344
2020-09-28 11:20:07,720 Epoch: 4, loss: 1.394, time (seconds): 54.90.
2020-09-28 11:20:07,721 **Evaluating.**
2020-09-28 11:20:21,748 NMI: 36.280
2020-09-28 11:20:23,928 R@1 : 53.502
2020-09-28 11:20:24,029 R@2 : 64.564
2020-09-28 11:20:24,132 R@4 : 74.637
2020-09-28 11:20:24,234 R@8 : 83.386
2020-09-28 11:21:19,258 Epoch: 5, loss: 1.326, time (seconds): 55.02.
2020-09-28 11:21:19,258 **Evaluating.**
2020-09-28 11:21:33,536 NMI: 34.197
2020-09-28 11:21:35,777 R@1 : 53.523
2020-09-28 11:21:35,880 R@2 : 64.543
2020-09-28 11:21:35,985 R@4 : 74.532
2020-09-28 11:21:36,090 R@8 : 81.998
2020-09-28 11:22:31,090 Epoch: 6, loss: 1.290, time (seconds): 55.00.
2020-09-28 11:22:31,090 **Evaluating.**
2020-09-28 11:22:45,299 NMI: 35.409
2020-09-28 11:22:47,471 R@1 : 52.892
2020-09-28 11:22:47,575 R@2 : 64.774
2020-09-28 11:22:47,682 R@4 : 74.511
2020-09-28 11:22:47,785 R@8 : 82.040
2020-09-28 11:23:42,819 Epoch: 7, loss: 1.247, time (seconds): 55.03.
2020-09-28 11:23:42,820 **Evaluating.**
2020-09-28 11:23:56,995 NMI: 32.155
2020-09-28 11:23:59,216 R@1 : 51.504
2020-09-28 11:23:59,319 R@2 : 63.365
2020-09-28 11:23:59,423 R@4 : 73.985
2020-09-28 11:23:59,525 R@8 : 82.271
2020-09-28 11:24:54,622 Epoch: 8, loss: 1.207, time (seconds): 55.09.
2020-09-28 11:24:54,622 **Evaluating.**
2020-09-28 11:25:08,788 NMI: 33.556
2020-09-28 11:25:11,052 R@1 : 51.588
2020-09-28 11:25:11,154 R@2 : 63.134
2020-09-28 11:25:11,255 R@4 : 73.985
2020-09-28 11:25:11,358 R@8 : 82.124
2020-09-28 11:26:11,353 Epoch: 9, loss: 1.184, time (seconds): 59.99.
2020-09-28 11:26:11,354 **Evaluating.**
2020-09-28 11:26:33,020 NMI: 30.715
2020-09-28 11:26:35,228 R@1 : 50.936
2020-09-28 11:26:35,338 R@2 : 62.292
2020-09-28 11:26:35,442 R@4 : 72.681
2020-09-28 11:26:35,545 R@8 : 81.052
2020-09-28 11:27:36,158 Epoch: 10, loss: 1.163, time (seconds): 60.61.
2020-09-28 11:27:36,159 **Evaluating.**
2020-09-28 11:27:50,365 NMI: 31.330
2020-09-28 11:27:52,595 R@1 : 49.527
2020-09-28 11:27:52,697 R@2 : 61.325
2020-09-28 11:27:52,799 R@4 : 72.177
2020-09-28 11:27:52,907 R@8 : 80.273
2020-09-28 11:28:47,614 Epoch: 11, loss: 1.140, time (seconds): 54.70.
2020-09-28 11:28:47,615 **Evaluating.**
2020-09-28 11:29:02,032 NMI: 30.802
2020-09-28 11:29:04,225 R@1 : 49.884
2020-09-28 11:29:04,328 R@2 : 62.166
2020-09-28 11:29:04,432 R@4 : 72.324
2020-09-28 11:29:04,534 R@8 : 81.262
2020-09-28 11:29:59,357 Epoch: 12, loss: 1.120, time (seconds): 54.82.
2020-09-28 11:29:59,358 **Evaluating.**
2020-09-28 11:30:13,576 NMI: 31.178
2020-09-28 11:30:15,822 R@1 : 48.623
2020-09-28 11:30:15,923 R@2 : 60.904
2020-09-28 11:30:16,026 R@4 : 72.219
2020-09-28 11:30:16,128 R@8 : 80.778
2020-09-28 11:31:12,110 Epoch: 13, loss: 1.075, time (seconds): 55.98.
2020-09-28 11:31:12,110 **Evaluating.**
2020-09-28 11:31:27,262 NMI: 30.135
2020-09-28 11:31:29,802 R@1 : 48.454
2020-09-28 11:31:29,912 R@2 : 59.895
2020-09-28 11:31:30,015 R@4 : 70.515
2020-09-28 11:31:30,138 R@8 : 80.105
2020-09-28 11:32:25,954 Epoch: 14, loss: 1.047, time (seconds): 55.81.
2020-09-28 11:32:25,955 **Evaluating.**
2020-09-28 11:32:40,321 NMI: 29.122
2020-09-28 11:32:42,603 R@1 : 48.749
2020-09-28 11:32:42,715 R@2 : 60.189
2020-09-28 11:32:42,824 R@4 : 70.915
2020-09-28 11:32:42,938 R@8 : 79.327
2020-09-28 11:33:38,335 Epoch: 15, loss: 1.068, time (seconds): 55.39.
2020-09-28 11:33:38,336 **Evaluating.**
2020-09-28 11:33:53,175 NMI: 29.700
2020-09-28 11:33:55,533 R@1 : 48.433
2020-09-28 11:33:55,636 R@2 : 60.421
2020-09-28 11:33:55,738 R@4 : 70.810
2020-09-28 11:33:55,841 R@8 : 80.358
2020-09-28 11:34:51,772 Epoch: 16, loss: 1.031, time (seconds): 55.93.
2020-09-28 11:34:51,773 **Evaluating.**
2020-09-28 11:35:06,738 NMI: 28.418
2020-09-28 11:35:09,077 R@1 : 48.770
2020-09-28 11:35:09,189 R@2 : 59.495
2020-09-28 11:35:09,292 R@4 : 70.074
2020-09-28 11:35:09,401 R@8 : 79.516
2020-09-28 11:36:05,314 Epoch: 17, loss: 1.023, time (seconds): 55.91.
2020-09-28 11:36:05,315 **Evaluating.**
2020-09-28 11:36:20,278 NMI: 27.514
2020-09-28 11:36:22,611 R@1 : 48.097
2020-09-28 11:36:22,715 R@2 : 58.885
2020-09-28 11:36:22,818 R@4 : 69.253
2020-09-28 11:36:22,925 R@8 : 79.138
2020-09-28 11:37:18,998 Epoch: 18, loss: 1.001, time (seconds): 56.07.
2020-09-28 11:37:18,999 **Evaluating.**
2020-09-28 11:37:33,942 NMI: 27.735
2020-09-28 11:37:36,325 R@1 : 47.066
2020-09-28 11:37:36,434 R@2 : 58.633
2020-09-28 11:37:36,545 R@4 : 69.211
2020-09-28 11:37:36,656 R@8 : 78.191
2020-09-28 11:38:32,629 Epoch: 19, loss: 0.991, time (seconds): 55.97.
2020-09-28 11:38:32,630 **Evaluating.**
2020-09-28 11:38:47,953 NMI: 27.715
2020-09-28 11:38:50,235 R@1 : 46.730
2020-09-28 11:38:50,337 R@2 : 58.128
2020-09-28 11:38:50,441 R@4 : 69.485
2020-09-28 11:38:50,542 R@8 : 78.023
2020-09-28 11:38:50,544 Total training time (minutes): 24.69.
2020-09-28 11:38:51,325 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-100047', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 80), 'eval_classes': range(80, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 11:38:51,326 Training for 20 epochs
2020-09-28 11:38:51,327 **Evaluating initial model.**
2020-09-28 11:39:05,954 NMI: 25.113
2020-09-28 11:39:08,273 R@1 : 42.839
2020-09-28 11:39:08,378 R@2 : 53.544
2020-09-28 11:39:08,485 R@4 : 65.131
2020-09-28 11:39:08,593 R@8 : 76.761
2020-09-28 11:40:04,127 Epoch: 0, loss: 2.190, time (seconds): 55.53.
2020-09-28 11:40:04,128 **Evaluating.**
2020-09-28 11:40:19,131 NMI: 23.621
2020-09-28 11:40:21,320 R@1 : 43.134
2020-09-28 11:40:21,422 R@2 : 55.394
2020-09-28 11:40:21,523 R@4 : 67.298
2020-09-28 11:40:21,624 R@8 : 77.834
2020-09-28 11:41:17,618 Epoch: 1, loss: 1.718, time (seconds): 55.99.
2020-09-28 11:41:17,618 **Evaluating.**
2020-09-28 11:41:32,597 NMI: 32.120
2020-09-28 11:41:34,859 R@1 : 51.125
2020-09-28 11:41:34,962 R@2 : 62.397
2020-09-28 11:41:35,066 R@4 : 73.333
2020-09-28 11:41:35,169 R@8 : 82.187
2020-09-28 11:42:31,411 Epoch: 2, loss: 1.542, time (seconds): 56.24.
2020-09-28 11:42:31,412 **Evaluating.**
2020-09-28 11:42:46,356 NMI: 34.683
2020-09-28 11:42:48,636 R@1 : 53.186
2020-09-28 11:42:48,745 R@2 : 64.606
2020-09-28 11:42:48,848 R@4 : 74.006
2020-09-28 11:42:48,951 R@8 : 82.397
2020-09-28 11:43:45,096 Epoch: 3, loss: 1.522, time (seconds): 56.14.
2020-09-28 11:43:45,096 **Evaluating.**
2020-09-28 11:44:00,042 NMI: 35.356
2020-09-28 11:44:02,322 R@1 : 53.754
2020-09-28 11:44:02,425 R@2 : 64.332
2020-09-28 11:44:02,527 R@4 : 73.417
2020-09-28 11:44:02,630 R@8 : 81.872
2020-09-28 11:44:58,741 Epoch: 4, loss: 1.427, time (seconds): 56.11.
2020-09-28 11:44:58,742 **Evaluating.**
2020-09-28 11:45:13,687 NMI: 36.226
2020-09-28 11:45:16,024 R@1 : 54.048
2020-09-28 11:45:16,127 R@2 : 65.846
2020-09-28 11:45:16,229 R@4 : 75.058
2020-09-28 11:45:16,333 R@8 : 83.176
2020-09-28 11:46:12,536 Epoch: 5, loss: 1.343, time (seconds): 56.20.
2020-09-28 11:46:12,537 **Evaluating.**
2020-09-28 11:46:27,511 NMI: 35.547
2020-09-28 11:46:29,786 R@1 : 53.754
2020-09-28 11:46:29,892 R@2 : 65.489
2020-09-28 11:46:30,000 R@4 : 75.731
2020-09-28 11:46:30,105 R@8 : 83.386
2020-09-28 11:47:26,393 Epoch: 6, loss: 1.311, time (seconds): 56.29.
2020-09-28 11:47:26,394 **Evaluating.**
2020-09-28 11:47:41,286 NMI: 36.343
2020-09-28 11:47:43,633 R@1 : 54.322
2020-09-28 11:47:43,737 R@2 : 65.237
2020-09-28 11:47:43,840 R@4 : 74.911
2020-09-28 11:47:43,942 R@8 : 83.281
2020-09-28 11:48:40,129 Epoch: 7, loss: 1.260, time (seconds): 56.18.
2020-09-28 11:48:40,129 **Evaluating.**
2020-09-28 11:48:55,189 NMI: 36.098
2020-09-28 11:48:57,546 R@1 : 53.291
2020-09-28 11:48:57,648 R@2 : 64.921
2020-09-28 11:48:57,752 R@4 : 75.289
2020-09-28 11:48:57,855 R@8 : 83.470
2020-09-28 11:49:53,938 Epoch: 8, loss: 1.210, time (seconds): 56.08.
2020-09-28 11:49:53,939 **Evaluating.**
2020-09-28 11:50:09,043 NMI: 37.772
2020-09-28 11:50:11,380 R@1 : 53.922
2020-09-28 11:50:11,495 R@2 : 64.900
2020-09-28 11:50:11,610 R@4 : 75.247
2020-09-28 11:50:11,725 R@8 : 83.554
2020-09-28 11:51:07,424 Epoch: 9, loss: 1.170, time (seconds): 55.70.
2020-09-28 11:51:07,425 **Evaluating.**
2020-09-28 11:51:22,338 NMI: 36.439
2020-09-28 11:51:24,698 R@1 : 53.417
2020-09-28 11:51:24,807 R@2 : 64.164
2020-09-28 11:51:24,909 R@4 : 74.490
2020-09-28 11:51:25,017 R@8 : 83.239
2020-09-28 11:52:21,371 Epoch: 10, loss: 1.147, time (seconds): 56.35.
2020-09-28 11:52:21,372 **Evaluating.**
2020-09-28 11:52:36,476 NMI: 35.746
2020-09-28 11:52:38,796 R@1 : 52.450
2020-09-28 11:52:38,904 R@2 : 63.807
2020-09-28 11:52:39,008 R@4 : 73.396
2020-09-28 11:52:39,111 R@8 : 81.956
2020-09-28 11:53:35,381 Epoch: 11, loss: 1.111, time (seconds): 56.27.
2020-09-28 11:53:35,382 **Evaluating.**
2020-09-28 11:53:50,306 NMI: 36.086
2020-09-28 11:53:52,645 R@1 : 51.504
2020-09-28 11:53:52,752 R@2 : 63.386
2020-09-28 11:53:52,856 R@4 : 73.817
2020-09-28 11:53:52,959 R@8 : 82.902
2020-09-28 11:54:49,164 Epoch: 12, loss: 1.085, time (seconds): 56.20.
2020-09-28 11:54:49,165 **Evaluating.**
2020-09-28 11:55:04,255 NMI: 36.635
2020-09-28 11:55:06,612 R@1 : 53.060
2020-09-28 11:55:06,714 R@2 : 64.311
2020-09-28 11:55:06,818 R@4 : 73.649
2020-09-28 11:55:06,921 R@8 : 82.334
2020-09-28 11:56:03,100 Epoch: 13, loss: 1.039, time (seconds): 56.18.
2020-09-28 11:56:03,101 **Evaluating.**
2020-09-28 11:56:18,047 NMI: 35.461
2020-09-28 11:56:20,460 R@1 : 51.735
2020-09-28 11:56:20,576 R@2 : 62.839
2020-09-28 11:56:20,690 R@4 : 72.555
2020-09-28 11:56:20,799 R@8 : 81.703
2020-09-28 11:57:17,214 Epoch: 14, loss: 1.007, time (seconds): 56.41.
2020-09-28 11:57:17,215 **Evaluating.**
2020-09-28 11:57:32,352 NMI: 35.888
2020-09-28 11:57:34,706 R@1 : 51.609
2020-09-28 11:57:34,809 R@2 : 62.587
2020-09-28 11:57:34,919 R@4 : 73.417
2020-09-28 11:57:35,023 R@8 : 81.682
2020-09-28 11:58:31,325 Epoch: 15, loss: 1.012, time (seconds): 56.30.
2020-09-28 11:58:31,326 **Evaluating.**
2020-09-28 11:58:46,265 NMI: 35.915
2020-09-28 11:58:48,578 R@1 : 51.230
2020-09-28 11:58:48,692 R@2 : 61.977
2020-09-28 11:58:48,808 R@4 : 72.976
2020-09-28 11:58:48,924 R@8 : 81.514
2020-09-28 11:59:43,761 Epoch: 16, loss: 0.972, time (seconds): 54.83.
2020-09-28 11:59:43,761 **Evaluating.**
2020-09-28 11:59:57,890 NMI: 33.865
2020-09-28 12:00:00,135 R@1 : 52.114
2020-09-28 12:00:00,239 R@2 : 63.113
2020-09-28 12:00:00,347 R@4 : 72.303
2020-09-28 12:00:00,455 R@8 : 81.115
2020-09-28 12:00:55,779 Epoch: 17, loss: 0.975, time (seconds): 55.32.
2020-09-28 12:00:55,779 **Evaluating.**
2020-09-28 12:01:09,739 NMI: 34.352
2020-09-28 12:01:12,026 R@1 : 49.821
2020-09-28 12:01:12,139 R@2 : 61.178
2020-09-28 12:01:12,254 R@4 : 71.651
2020-09-28 12:01:12,367 R@8 : 80.778
2020-09-28 12:02:07,386 Epoch: 18, loss: 0.953, time (seconds): 55.02.
2020-09-28 12:02:07,387 **Evaluating.**
2020-09-28 12:02:21,483 NMI: 34.083
2020-09-28 12:02:23,756 R@1 : 49.968
2020-09-28 12:02:23,864 R@2 : 61.661
2020-09-28 12:02:23,966 R@4 : 72.156
2020-09-28 12:02:24,067 R@8 : 81.556
2020-09-28 12:03:19,373 Epoch: 19, loss: 0.943, time (seconds): 55.30.
2020-09-28 12:03:19,374 **Evaluating.**
2020-09-28 12:03:33,521 NMI: 33.459
2020-09-28 12:03:35,750 R@1 : 50.831
2020-09-28 12:03:35,869 R@2 : 61.998
2020-09-28 12:03:35,989 R@4 : 72.345
2020-09-28 12:03:36,103 R@8 : 80.757
2020-09-28 12:03:36,105 Total training time (minutes): 24.75.
2020-09-28 12:03:36,862 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-100047', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 80), 'eval_classes': range(80, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 12:03:36,863 Training for 20 epochs
2020-09-28 12:03:36,865 **Evaluating initial model.**
2020-09-28 12:03:51,236 NMI: 25.113
2020-09-28 12:03:53,467 R@1 : 42.839
2020-09-28 12:03:53,569 R@2 : 53.544
2020-09-28 12:03:53,672 R@4 : 65.131
2020-09-28 12:03:53,775 R@8 : 76.761
2020-09-28 12:04:48,866 Epoch: 0, loss: 2.481, time (seconds): 55.09.
2020-09-28 12:04:48,866 **Evaluating.**
2020-09-28 12:05:03,319 NMI: 22.959
2020-09-28 12:05:05,434 R@1 : 41.577
2020-09-28 12:05:05,539 R@2 : 53.291
2020-09-28 12:05:05,645 R@4 : 65.089
2020-09-28 12:05:05,750 R@8 : 77.098
2020-09-28 12:06:00,745 Epoch: 1, loss: 1.947, time (seconds): 54.99.
2020-09-28 12:06:00,746 **Evaluating.**
2020-09-28 12:06:15,015 NMI: 29.571
2020-09-28 12:06:17,145 R@1 : 47.361
2020-09-28 12:06:17,252 R@2 : 59.642
2020-09-28 12:06:17,359 R@4 : 70.536
2020-09-28 12:06:17,461 R@8 : 80.484
2020-09-28 12:07:12,364 Epoch: 2, loss: 1.775, time (seconds): 54.90.
2020-09-28 12:07:12,365 **Evaluating.**
2020-09-28 12:07:26,544 NMI: 30.994
2020-09-28 12:07:28,706 R@1 : 49.506
2020-09-28 12:07:28,809 R@2 : 60.526
2020-09-28 12:07:28,912 R@4 : 71.777
2020-09-28 12:07:29,015 R@8 : 80.946
2020-09-28 12:08:24,184 Epoch: 3, loss: 1.674, time (seconds): 55.17.
2020-09-28 12:08:24,185 **Evaluating.**
2020-09-28 12:08:38,559 NMI: 32.529
2020-09-28 12:08:40,669 R@1 : 48.749
2020-09-28 12:08:40,778 R@2 : 61.556
2020-09-28 12:08:40,886 R@4 : 72.029
2020-09-28 12:08:40,994 R@8 : 81.367
2020-09-28 12:09:36,189 Epoch: 4, loss: 1.578, time (seconds): 55.19.
2020-09-28 12:09:36,190 **Evaluating.**
2020-09-28 12:09:50,312 NMI: 32.639
2020-09-28 12:09:52,493 R@1 : 50.011
2020-09-28 12:09:52,595 R@2 : 61.725
2020-09-28 12:09:52,696 R@4 : 72.492
2020-09-28 12:09:52,798 R@8 : 81.977
2020-09-28 12:10:47,573 Epoch: 5, loss: 1.527, time (seconds): 54.77.
2020-09-28 12:10:47,574 **Evaluating.**
2020-09-28 12:11:01,978 NMI: 33.024
2020-09-28 12:11:04,097 R@1 : 50.641
2020-09-28 12:11:04,198 R@2 : 62.103
2020-09-28 12:11:04,300 R@4 : 72.450
2020-09-28 12:11:04,402 R@8 : 81.598
2020-09-28 12:11:59,503 Epoch: 6, loss: 1.431, time (seconds): 55.10.
2020-09-28 12:11:59,503 **Evaluating.**
2020-09-28 12:12:13,572 NMI: 33.655
2020-09-28 12:12:15,776 R@1 : 51.272
2020-09-28 12:12:15,878 R@2 : 62.419
2020-09-28 12:12:15,980 R@4 : 72.850
2020-09-28 12:12:16,082 R@8 : 82.124
2020-09-28 12:13:11,153 Epoch: 7, loss: 1.403, time (seconds): 55.07.
2020-09-28 12:13:11,154 **Evaluating.**
2020-09-28 12:13:25,345 NMI: 33.564
2020-09-28 12:13:27,510 R@1 : 50.936
2020-09-28 12:13:27,618 R@2 : 62.461
2020-09-28 12:13:27,731 R@4 : 73.586
2020-09-28 12:13:27,844 R@8 : 81.893
2020-09-28 12:14:22,972 Epoch: 8, loss: 1.334, time (seconds): 55.13.
2020-09-28 12:14:22,973 **Evaluating.**
2020-09-28 12:14:37,011 NMI: 34.395
2020-09-28 12:14:39,194 R@1 : 50.726
2020-09-28 12:14:39,296 R@2 : 62.397
2020-09-28 12:14:39,398 R@4 : 72.934
2020-09-28 12:14:39,500 R@8 : 82.124
2020-09-28 12:15:34,587 Epoch: 9, loss: 1.264, time (seconds): 55.09.
2020-09-28 12:15:34,588 **Evaluating.**
2020-09-28 12:15:48,646 NMI: 34.388
2020-09-28 12:15:50,889 R@1 : 50.873
2020-09-28 12:15:50,992 R@2 : 62.671
2020-09-28 12:15:51,094 R@4 : 73.312
2020-09-28 12:15:51,197 R@8 : 82.440
2020-09-28 12:16:46,160 Epoch: 10, loss: 1.255, time (seconds): 54.96.
2020-09-28 12:16:46,161 **Evaluating.**
2020-09-28 12:17:00,362 NMI: 32.890
2020-09-28 12:17:02,563 R@1 : 49.295
2020-09-28 12:17:02,666 R@2 : 61.451
2020-09-28 12:17:02,769 R@4 : 72.282
2020-09-28 12:17:02,873 R@8 : 81.682
2020-09-28 12:17:57,934 Epoch: 11, loss: 1.242, time (seconds): 55.06.
2020-09-28 12:17:57,935 **Evaluating.**
2020-09-28 12:18:12,188 NMI: 32.819
2020-09-28 12:18:14,396 R@1 : 49.001
2020-09-28 12:18:14,498 R@2 : 61.346
2020-09-28 12:18:14,601 R@4 : 71.504
2020-09-28 12:18:14,703 R@8 : 81.052
2020-09-28 12:19:09,918 Epoch: 12, loss: 1.205, time (seconds): 55.21.
2020-09-28 12:19:09,919 **Evaluating.**
2020-09-28 12:19:24,027 NMI: 32.659
2020-09-28 12:19:26,276 R@1 : 50.221
2020-09-28 12:19:26,380 R@2 : 62.250
2020-09-28 12:19:26,482 R@4 : 73.481
2020-09-28 12:19:26,584 R@8 : 82.587
2020-09-28 12:20:21,569 Epoch: 13, loss: 1.129, time (seconds): 54.98.
2020-09-28 12:20:21,570 **Evaluating.**
2020-09-28 12:20:35,696 NMI: 32.020
2020-09-28 12:20:37,905 R@1 : 49.653
2020-09-28 12:20:38,006 R@2 : 61.178
2020-09-28 12:20:38,109 R@4 : 72.093
2020-09-28 12:20:38,211 R@8 : 81.809
2020-09-28 12:21:33,103 Epoch: 14, loss: 1.105, time (seconds): 54.89.
2020-09-28 12:21:33,104 **Evaluating.**
2020-09-28 12:21:47,318 NMI: 33.167
2020-09-28 12:21:49,542 R@1 : 49.947
2020-09-28 12:21:49,646 R@2 : 61.725
2020-09-28 12:21:49,754 R@4 : 72.135
2020-09-28 12:21:49,856 R@8 : 81.514
2020-09-28 12:22:45,168 Epoch: 15, loss: 1.130, time (seconds): 55.31.
2020-09-28 12:22:45,168 **Evaluating.**
2020-09-28 12:22:59,333 NMI: 31.729
2020-09-28 12:23:01,593 R@1 : 49.863
2020-09-28 12:23:01,695 R@2 : 61.619
2020-09-28 12:23:01,803 R@4 : 71.903
2020-09-28 12:23:01,904 R@8 : 81.451
2020-09-28 12:23:57,108 Epoch: 16, loss: 1.066, time (seconds): 55.20.
2020-09-28 12:23:57,108 **Evaluating.**
2020-09-28 12:24:11,351 NMI: 33.215
2020-09-28 12:24:13,574 R@1 : 49.653
2020-09-28 12:24:13,682 R@2 : 60.988
2020-09-28 12:24:13,790 R@4 : 72.744
2020-09-28 12:24:13,904 R@8 : 82.082
2020-09-28 12:25:09,168 Epoch: 17, loss: 1.062, time (seconds): 55.26.
2020-09-28 12:25:09,169 **Evaluating.**
2020-09-28 12:25:23,411 NMI: 31.593
2020-09-28 12:25:25,674 R@1 : 49.611
2020-09-28 12:25:25,782 R@2 : 61.661
2020-09-28 12:25:25,890 R@4 : 71.462
2020-09-28 12:25:25,992 R@8 : 80.925
2020-09-28 12:26:20,935 Epoch: 18, loss: 1.043, time (seconds): 54.94.
2020-09-28 12:26:20,935 **Evaluating.**
2020-09-28 12:26:35,029 NMI: 31.766
2020-09-28 12:26:37,259 R@1 : 49.464
2020-09-28 12:26:37,361 R@2 : 61.241
2020-09-28 12:26:37,463 R@4 : 71.966
2020-09-28 12:26:37,565 R@8 : 81.367
2020-09-28 12:27:32,799 Epoch: 19, loss: 1.013, time (seconds): 55.23.
2020-09-28 12:27:32,800 **Evaluating.**
2020-09-28 12:27:47,016 NMI: 31.330
2020-09-28 12:27:49,243 R@1 : 48.728
2020-09-28 12:27:49,345 R@2 : 60.442
2020-09-28 12:27:49,447 R@4 : 71.167
2020-09-28 12:27:49,550 R@8 : 80.946
2020-09-28 12:27:49,552 Total training time (minutes): 24.21.
2020-09-28 12:27:50,256 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-100047', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 80), 'eval_classes': range(80, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 12:27:50,257 Training for 20 epochs
2020-09-28 12:27:50,258 **Evaluating initial model.**
2020-09-28 12:28:04,592 NMI: 25.113
2020-09-28 12:28:06,841 R@1 : 42.839
2020-09-28 12:28:06,943 R@2 : 53.544
2020-09-28 12:28:07,045 R@4 : 65.131
2020-09-28 12:28:07,153 R@8 : 76.761
2020-09-28 12:29:02,335 Epoch: 0, loss: 2.143, time (seconds): 55.18.
2020-09-28 12:29:02,336 **Evaluating.**
2020-09-28 12:29:16,770 NMI: 24.595
2020-09-28 12:29:18,931 R@1 : 43.449
2020-09-28 12:29:19,039 R@2 : 55.121
2020-09-28 12:29:19,148 R@4 : 67.613
2020-09-28 12:29:19,256 R@8 : 78.275
2020-09-28 12:30:14,480 Epoch: 1, loss: 1.677, time (seconds): 55.22.
2020-09-28 12:30:14,480 **Evaluating.**
2020-09-28 12:30:28,668 NMI: 32.710
2020-09-28 12:30:30,795 R@1 : 51.840
2020-09-28 12:30:30,897 R@2 : 63.028
2020-09-28 12:30:30,999 R@4 : 73.838
2020-09-28 12:30:31,108 R@8 : 82.334
2020-09-28 12:31:26,634 Epoch: 2, loss: 1.516, time (seconds): 55.52.
2020-09-28 12:31:26,635 **Evaluating.**
2020-09-28 12:31:40,965 NMI: 35.647
2020-09-28 12:31:43,217 R@1 : 53.228
2020-09-28 12:31:43,331 R@2 : 64.984
2020-09-28 12:31:43,446 R@4 : 74.343
2020-09-28 12:31:43,559 R@8 : 82.524
2020-09-28 12:32:38,424 Epoch: 3, loss: 1.495, time (seconds): 54.86.
2020-09-28 12:32:38,425 **Evaluating.**
2020-09-28 12:32:52,672 NMI: 34.915
2020-09-28 12:32:54,904 R@1 : 54.048
2020-09-28 12:32:55,006 R@2 : 64.963
2020-09-28 12:32:55,108 R@4 : 74.364
2020-09-28 12:32:55,211 R@8 : 82.187
2020-09-28 12:33:50,309 Epoch: 4, loss: 1.413, time (seconds): 55.10.
2020-09-28 12:33:50,310 **Evaluating.**
2020-09-28 12:34:04,446 NMI: 36.291
2020-09-28 12:34:06,645 R@1 : 53.691
2020-09-28 12:34:06,747 R@2 : 65.089
2020-09-28 12:34:06,849 R@4 : 74.238
2020-09-28 12:34:06,952 R@8 : 82.944
2020-09-28 12:35:02,792 Epoch: 5, loss: 1.329, time (seconds): 55.84.
2020-09-28 12:35:02,793 **Evaluating.**
2020-09-28 12:35:17,009 NMI: 36.392
2020-09-28 12:35:19,271 R@1 : 53.438
2020-09-28 12:35:19,374 R@2 : 65.110
2020-09-28 12:35:19,476 R@4 : 75.605
2020-09-28 12:35:19,578 R@8 : 83.512
2020-09-28 12:36:14,551 Epoch: 6, loss: 1.295, time (seconds): 54.97.
2020-09-28 12:36:14,552 **Evaluating.**
2020-09-28 12:36:28,636 NMI: 36.923
2020-09-28 12:36:30,832 R@1 : 54.132
2020-09-28 12:36:30,940 R@2 : 64.816
2020-09-28 12:36:31,041 R@4 : 75.247
2020-09-28 12:36:31,143 R@8 : 83.807
2020-09-28 12:37:26,419 Epoch: 7, loss: 1.238, time (seconds): 55.27.
2020-09-28 12:37:26,420 **Evaluating.**
2020-09-28 12:37:40,596 NMI: 35.973
2020-09-28 12:37:42,879 R@1 : 53.649
2020-09-28 12:37:42,982 R@2 : 65.636
2020-09-28 12:37:43,085 R@4 : 75.289
2020-09-28 12:37:43,188 R@8 : 83.680
2020-09-28 12:38:38,360 Epoch: 8, loss: 1.200, time (seconds): 55.17.
2020-09-28 12:38:38,362 **Evaluating.**
2020-09-28 12:38:52,583 NMI: 38.658
2020-09-28 12:38:54,843 R@1 : 53.754
2020-09-28 12:38:54,951 R@2 : 64.816
2020-09-28 12:38:55,059 R@4 : 74.784
2020-09-28 12:38:55,168 R@8 : 83.091
2020-09-28 12:39:50,160 Epoch: 9, loss: 1.156, time (seconds): 54.99.
2020-09-28 12:39:50,160 **Evaluating.**
2020-09-28 12:40:04,378 NMI: 35.899
2020-09-28 12:40:06,618 R@1 : 53.775
2020-09-28 12:40:06,722 R@2 : 64.858
2020-09-28 12:40:06,830 R@4 : 74.259
2020-09-28 12:40:06,933 R@8 : 82.040
2020-09-28 12:41:02,061 Epoch: 10, loss: 1.132, time (seconds): 55.13.
2020-09-28 12:41:02,062 **Evaluating.**
2020-09-28 12:41:16,044 NMI: 35.817
2020-09-28 12:41:18,267 R@1 : 52.702
2020-09-28 12:41:18,370 R@2 : 64.143
2020-09-28 12:41:18,477 R@4 : 73.880
2020-09-28 12:41:18,579 R@8 : 82.061
2020-09-28 12:42:13,468 Epoch: 11, loss: 1.097, time (seconds): 54.89.
2020-09-28 12:42:13,469 **Evaluating.**
2020-09-28 12:42:27,475 NMI: 37.308
2020-09-28 12:42:29,732 R@1 : 52.744
2020-09-28 12:42:29,834 R@2 : 64.143
2020-09-28 12:42:29,936 R@4 : 73.964
2020-09-28 12:42:30,038 R@8 : 82.292
2020-09-28 12:43:25,110 Epoch: 12, loss: 1.074, time (seconds): 55.07.
2020-09-28 12:43:25,111 **Evaluating.**
2020-09-28 12:43:39,064 NMI: 36.551
2020-09-28 12:43:41,268 R@1 : 52.513
2020-09-28 12:43:41,375 R@2 : 64.206
2020-09-28 12:43:41,480 R@4 : 73.586
2020-09-28 12:43:41,586 R@8 : 81.851
2020-09-28 12:44:36,541 Epoch: 13, loss: 1.027, time (seconds): 54.95.
2020-09-28 12:44:36,542 **Evaluating.**
2020-09-28 12:44:50,773 NMI: 37.218
2020-09-28 12:44:53,034 R@1 : 51.819
2020-09-28 12:44:53,142 R@2 : 63.155
2020-09-28 12:44:53,250 R@4 : 73.565
2020-09-28 12:44:53,357 R@8 : 81.809
2020-09-28 12:45:48,568 Epoch: 14, loss: 0.994, time (seconds): 55.21.
2020-09-28 12:45:48,569 **Evaluating.**
2020-09-28 12:46:03,079 NMI: 35.520
2020-09-28 12:46:05,300 R@1 : 52.345
2020-09-28 12:46:05,402 R@2 : 63.365
2020-09-28 12:46:05,505 R@4 : 73.018
2020-09-28 12:46:05,607 R@8 : 82.082
2020-09-28 12:47:00,659 Epoch: 15, loss: 1.004, time (seconds): 55.05.
2020-09-28 12:47:00,659 **Evaluating.**
2020-09-28 12:47:14,877 NMI: 36.113
2020-09-28 12:47:17,109 R@1 : 51.987
2020-09-28 12:47:17,211 R@2 : 63.197
2020-09-28 12:47:17,312 R@4 : 73.354
2020-09-28 12:47:17,415 R@8 : 81.493
2020-09-28 12:48:12,291 Epoch: 16, loss: 0.968, time (seconds): 54.87.
2020-09-28 12:48:12,292 **Evaluating.**
2020-09-28 12:48:26,570 NMI: 34.776
2020-09-28 12:48:28,855 R@1 : 51.588
2020-09-28 12:48:28,957 R@2 : 62.503
2020-09-28 12:48:29,058 R@4 : 72.408
2020-09-28 12:48:29,160 R@8 : 81.157
2020-09-28 12:49:24,207 Epoch: 17, loss: 0.965, time (seconds): 55.05.
2020-09-28 12:49:24,207 **Evaluating.**
2020-09-28 12:49:38,490 NMI: 34.339
2020-09-28 12:49:40,756 R@1 : 51.420
2020-09-28 12:49:40,858 R@2 : 62.124
2020-09-28 12:49:40,960 R@4 : 72.408
2020-09-28 12:49:41,061 R@8 : 81.598
2020-09-28 12:50:36,095 Epoch: 18, loss: 0.944, time (seconds): 55.03.
2020-09-28 12:50:36,096 **Evaluating.**
2020-09-28 12:50:50,299 NMI: 34.357
2020-09-28 12:50:52,543 R@1 : 51.146
2020-09-28 12:50:52,645 R@2 : 62.208
2020-09-28 12:50:52,748 R@4 : 72.787
2020-09-28 12:50:52,851 R@8 : 81.640
2020-09-28 12:51:47,986 Epoch: 19, loss: 0.931, time (seconds): 55.13.
2020-09-28 12:51:47,987 **Evaluating.**
2020-09-28 12:52:02,256 NMI: 35.541
2020-09-28 12:52:04,539 R@1 : 51.188
2020-09-28 12:52:04,659 R@2 : 62.103
2020-09-28 12:52:04,779 R@4 : 72.408
2020-09-28 12:52:04,898 R@8 : 81.556
2020-09-28 12:52:04,899 Total training time (minutes): 24.24.
2020-09-28 12:52:05,616 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-100047', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 80), 'eval_classes': range(80, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 12:52:05,616 Training for 20 epochs
2020-09-28 12:52:05,618 **Evaluating initial model.**
2020-09-28 12:52:19,767 NMI: 25.113
2020-09-28 12:52:22,090 R@1 : 42.839
2020-09-28 12:52:22,198 R@2 : 53.544
2020-09-28 12:52:22,301 R@4 : 65.131
2020-09-28 12:52:22,402 R@8 : 76.761
2020-09-28 12:53:17,512 Epoch: 0, loss: 2.477, time (seconds): 55.11.
2020-09-28 12:53:17,513 **Evaluating.**
2020-09-28 12:53:31,803 NMI: 23.129
2020-09-28 12:53:34,003 R@1 : 40.841
2020-09-28 12:53:34,105 R@2 : 53.333
2020-09-28 12:53:34,207 R@4 : 64.858
2020-09-28 12:53:34,309 R@8 : 77.140
2020-09-28 12:54:29,245 Epoch: 1, loss: 1.946, time (seconds): 54.93.
2020-09-28 12:54:29,246 **Evaluating.**
2020-09-28 12:54:43,532 NMI: 29.032
2020-09-28 12:54:45,820 R@1 : 47.003
2020-09-28 12:54:45,951 R@2 : 59.411
2020-09-28 12:54:46,082 R@4 : 70.852
2020-09-28 12:54:46,212 R@8 : 80.736
2020-09-28 12:55:41,313 Epoch: 2, loss: 1.778, time (seconds): 55.10.
2020-09-28 12:55:41,314 **Evaluating.**
2020-09-28 12:55:55,378 NMI: 31.281
2020-09-28 12:55:57,532 R@1 : 49.232
2020-09-28 12:55:57,637 R@2 : 61.283
2020-09-28 12:55:57,741 R@4 : 71.945
2020-09-28 12:55:57,844 R@8 : 81.409
2020-09-28 12:56:53,538 Epoch: 3, loss: 1.674, time (seconds): 55.69.
2020-09-28 12:56:53,539 **Evaluating.**
2020-09-28 12:57:09,988 NMI: 31.978
2020-09-28 12:57:12,312 R@1 : 49.359
2020-09-28 12:57:12,420 R@2 : 61.409
2020-09-28 12:57:12,529 R@4 : 71.609
2020-09-28 12:57:12,637 R@8 : 81.346
2020-09-28 12:58:09,067 Epoch: 4, loss: 1.582, time (seconds): 56.43.
2020-09-28 12:58:09,067 **Evaluating.**
2020-09-28 12:58:24,579 NMI: 32.725
2020-09-28 12:58:26,886 R@1 : 50.410
2020-09-28 12:58:26,990 R@2 : 61.956
2020-09-28 12:58:27,101 R@4 : 72.808
2020-09-28 12:58:27,210 R@8 : 81.577
2020-09-28 12:59:22,486 Epoch: 5, loss: 1.519, time (seconds): 55.27.
2020-09-28 12:59:22,486 **Evaluating.**
2020-09-28 12:59:37,734 NMI: 33.233
2020-09-28 12:59:39,975 R@1 : 49.863
2020-09-28 12:59:40,081 R@2 : 61.788
2020-09-28 12:59:40,191 R@4 : 72.282
2020-09-28 12:59:40,296 R@8 : 81.030
2020-09-28 13:00:35,417 Epoch: 6, loss: 1.435, time (seconds): 55.12.
2020-09-28 13:00:35,418 **Evaluating.**
2020-09-28 13:00:50,736 NMI: 33.917
2020-09-28 13:00:53,023 R@1 : 51.251
2020-09-28 13:00:53,134 R@2 : 62.965
2020-09-28 13:00:53,243 R@4 : 72.997
2020-09-28 13:00:53,354 R@8 : 81.577
2020-09-28 13:01:48,588 Epoch: 7, loss: 1.407, time (seconds): 55.23.
2020-09-28 13:01:48,589 **Evaluating.**
2020-09-28 13:02:04,057 NMI: 32.568
2020-09-28 13:02:06,375 R@1 : 50.494
2020-09-28 13:02:06,478 R@2 : 61.998
2020-09-28 13:02:06,581 R@4 : 73.481
2020-09-28 13:02:06,684 R@8 : 82.250
2020-09-28 13:03:02,233 Epoch: 8, loss: 1.333, time (seconds): 55.55.
2020-09-28 13:03:02,233 **Evaluating.**
2020-09-28 13:03:17,719 NMI: 34.399
2020-09-28 13:03:20,010 R@1 : 51.399
2020-09-28 13:03:20,114 R@2 : 62.545
2020-09-28 13:03:20,217 R@4 : 73.396
2020-09-28 13:03:20,319 R@8 : 82.040
2020-09-28 13:04:15,944 Epoch: 9, loss: 1.265, time (seconds): 55.62.
2020-09-28 13:04:15,945 **Evaluating.**
2020-09-28 13:04:31,277 NMI: 33.128
2020-09-28 13:04:33,640 R@1 : 50.620
2020-09-28 13:04:33,751 R@2 : 62.482
2020-09-28 13:04:33,861 R@4 : 73.396
2020-09-28 13:04:33,972 R@8 : 82.292
2020-09-28 13:05:29,706 Epoch: 10, loss: 1.254, time (seconds): 55.73.
2020-09-28 13:05:29,707 **Evaluating.**
2020-09-28 13:05:45,135 NMI: 31.659
2020-09-28 13:05:47,435 R@1 : 49.422
2020-09-28 13:05:47,539 R@2 : 62.124
2020-09-28 13:05:47,642 R@4 : 72.219
2020-09-28 13:05:47,752 R@8 : 81.872
2020-09-28 13:06:43,335 Epoch: 11, loss: 1.241, time (seconds): 55.58.
2020-09-28 13:06:43,335 **Evaluating.**
2020-09-28 13:06:58,707 NMI: 33.147
2020-09-28 13:07:01,026 R@1 : 49.926
2020-09-28 13:07:01,130 R@2 : 61.388
2020-09-28 13:07:01,235 R@4 : 71.840
2020-09-28 13:07:01,344 R@8 : 81.725
2020-09-28 13:07:56,666 Epoch: 12, loss: 1.203, time (seconds): 55.32.
2020-09-28 13:07:56,667 **Evaluating.**
2020-09-28 13:08:12,004 NMI: 33.329
2020-09-28 13:08:14,373 R@1 : 50.263
2020-09-28 13:08:14,476 R@2 : 62.692
2020-09-28 13:08:14,582 R@4 : 73.523
2020-09-28 13:08:14,685 R@8 : 82.671
2020-09-28 13:09:10,488 Epoch: 13, loss: 1.126, time (seconds): 55.80.
2020-09-28 13:09:10,489 **Evaluating.**
2020-09-28 13:09:26,169 NMI: 32.462
2020-09-28 13:09:28,492 R@1 : 49.989
2020-09-28 13:09:28,595 R@2 : 61.830
2020-09-28 13:09:28,707 R@4 : 72.681
2020-09-28 13:09:28,814 R@8 : 82.103
2020-09-28 13:10:23,940 Epoch: 14, loss: 1.105, time (seconds): 55.12.
2020-09-28 13:10:23,941 **Evaluating.**
2020-09-28 13:10:39,073 NMI: 31.033
2020-09-28 13:10:41,395 R@1 : 50.137
2020-09-28 13:10:41,497 R@2 : 62.713
2020-09-28 13:10:41,600 R@4 : 72.976
2020-09-28 13:10:41,703 R@8 : 81.830
2020-09-28 13:11:37,012 Epoch: 15, loss: 1.127, time (seconds): 55.31.
2020-09-28 13:11:37,013 **Evaluating.**
2020-09-28 13:11:52,256 NMI: 32.782
2020-09-28 13:11:54,622 R@1 : 50.831
2020-09-28 13:11:54,731 R@2 : 62.229
2020-09-28 13:11:54,841 R@4 : 72.744
2020-09-28 13:11:54,944 R@8 : 81.914
2020-09-28 13:12:49,964 Epoch: 16, loss: 1.070, time (seconds): 55.02.
2020-09-28 13:12:49,965 **Evaluating.**
2020-09-28 13:13:05,412 NMI: 32.853
2020-09-28 13:13:07,782 R@1 : 49.779
2020-09-28 13:13:07,885 R@2 : 61.788
2020-09-28 13:13:07,989 R@4 : 72.597
2020-09-28 13:13:08,114 R@8 : 81.746
2020-09-28 13:14:03,209 Epoch: 17, loss: 1.059, time (seconds): 55.09.
2020-09-28 13:14:03,209 **Evaluating.**
2020-09-28 13:14:18,578 NMI: 30.599
2020-09-28 13:14:20,952 R@1 : 49.443
2020-09-28 13:14:21,054 R@2 : 61.325
2020-09-28 13:14:21,163 R@4 : 71.756
2020-09-28 13:14:21,268 R@8 : 81.640
2020-09-28 13:15:16,625 Epoch: 18, loss: 1.043, time (seconds): 55.35.
2020-09-28 13:15:16,625 **Evaluating.**
2020-09-28 13:15:31,913 NMI: 31.414
2020-09-28 13:15:34,245 R@1 : 49.779
2020-09-28 13:15:34,350 R@2 : 61.725
2020-09-28 13:15:34,453 R@4 : 71.567
2020-09-28 13:15:34,556 R@8 : 81.325
2020-09-28 13:16:29,812 Epoch: 19, loss: 1.019, time (seconds): 55.25.
2020-09-28 13:16:29,813 **Evaluating.**
2020-09-28 13:16:45,253 NMI: 31.483
2020-09-28 13:16:47,594 R@1 : 49.947
2020-09-28 13:16:47,698 R@2 : 61.199
2020-09-28 13:16:47,811 R@4 : 71.924
2020-09-28 13:16:47,918 R@8 : 81.115
2020-09-28 13:16:47,920 Total training time (minutes): 24.71.
2020-09-28 13:16:48,709 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-100047', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 80), 'eval_classes': range(80, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 13:16:48,710 Training for 20 epochs
2020-09-28 13:16:48,712 **Evaluating initial model.**
2020-09-28 13:17:04,052 NMI: 25.113
2020-09-28 13:17:06,397 R@1 : 42.839
2020-09-28 13:17:06,501 R@2 : 53.544
2020-09-28 13:17:06,605 R@4 : 65.131
2020-09-28 13:17:06,708 R@8 : 76.761
2020-09-28 13:18:01,928 Epoch: 0, loss: 9.042, time (seconds): 55.22.
2020-09-28 13:18:01,928 **Evaluating.**
2020-09-28 13:18:17,672 NMI: 20.382
2020-09-28 13:18:19,958 R@1 : 38.654
2020-09-28 13:18:20,062 R@2 : 50.747
2020-09-28 13:18:20,165 R@4 : 63.344
2020-09-28 13:18:20,278 R@8 : 75.478
2020-09-28 13:19:15,589 Epoch: 1, loss: 2.944, time (seconds): 55.31.
2020-09-28 13:19:15,590 **Evaluating.**
2020-09-28 13:19:31,321 NMI: 23.376
2020-09-28 13:19:33,740 R@1 : 42.650
2020-09-28 13:19:33,866 R@2 : 54.238
2020-09-28 13:19:34,005 R@4 : 65.910
2020-09-28 13:19:34,150 R@8 : 77.329
2020-09-28 13:20:29,926 Epoch: 2, loss: 2.161, time (seconds): 55.77.
2020-09-28 13:20:29,927 **Evaluating.**
2020-09-28 13:20:45,330 NMI: 29.250
2020-09-28 13:20:47,598 R@1 : 47.466
2020-09-28 13:20:47,719 R@2 : 59.369
2020-09-28 13:20:47,835 R@4 : 70.978
2020-09-28 13:20:47,954 R@8 : 80.400
2020-09-28 13:21:43,172 Epoch: 3, loss: 1.910, time (seconds): 55.22.
2020-09-28 13:21:43,173 **Evaluating.**
2020-09-28 13:21:58,671 NMI: 29.636
2020-09-28 13:22:01,030 R@1 : 46.877
2020-09-28 13:22:01,136 R@2 : 59.096
2020-09-28 13:22:01,240 R@4 : 71.146
2020-09-28 13:22:01,346 R@8 : 80.589
2020-09-28 13:22:56,898 Epoch: 4, loss: 1.733, time (seconds): 55.55.
2020-09-28 13:22:56,899 **Evaluating.**
2020-09-28 13:23:12,462 NMI: 30.176
2020-09-28 13:23:14,716 R@1 : 48.181
2020-09-28 13:23:14,819 R@2 : 59.874
2020-09-28 13:23:14,923 R@4 : 70.347
2020-09-28 13:23:15,027 R@8 : 80.463
2020-09-28 13:24:11,001 Epoch: 5, loss: 1.709, time (seconds): 55.97.
2020-09-28 13:24:11,002 **Evaluating.**
2020-09-28 13:24:26,222 NMI: 29.873
2020-09-28 13:24:28,489 R@1 : 48.665
2020-09-28 13:24:28,598 R@2 : 60.168
2020-09-28 13:24:28,713 R@4 : 71.483
2020-09-28 13:24:28,825 R@8 : 81.115
2020-09-28 13:25:24,026 Epoch: 6, loss: 1.572, time (seconds): 55.20.
2020-09-28 13:25:24,026 **Evaluating.**
2020-09-28 13:25:39,216 NMI: 31.244
2020-09-28 13:25:41,593 R@1 : 49.274
2020-09-28 13:25:41,695 R@2 : 61.577
2020-09-28 13:25:41,799 R@4 : 72.008
2020-09-28 13:25:41,902 R@8 : 81.598
2020-09-28 13:26:37,362 Epoch: 7, loss: 1.508, time (seconds): 55.46.
2020-09-28 13:26:37,363 **Evaluating.**
2020-09-28 13:26:52,692 NMI: 31.552
2020-09-28 13:26:54,972 R@1 : 49.380
2020-09-28 13:26:55,086 R@2 : 61.725
2020-09-28 13:26:55,206 R@4 : 73.039
2020-09-28 13:26:55,328 R@8 : 82.313
2020-09-28 13:27:50,492 Epoch: 8, loss: 1.410, time (seconds): 55.16.
2020-09-28 13:27:50,492 **Evaluating.**
2020-09-28 13:28:05,725 NMI: 31.875
2020-09-28 13:28:08,088 R@1 : 49.506
2020-09-28 13:28:08,196 R@2 : 60.631
2020-09-28 13:28:08,301 R@4 : 71.819
2020-09-28 13:28:08,404 R@8 : 81.514
2020-09-28 13:29:03,874 Epoch: 9, loss: 1.343, time (seconds): 55.47.
2020-09-28 13:29:03,874 **Evaluating.**
2020-09-28 13:29:19,119 NMI: 32.735
2020-09-28 13:29:21,444 R@1 : 50.053
2020-09-28 13:29:21,553 R@2 : 61.830
2020-09-28 13:29:21,662 R@4 : 72.534
2020-09-28 13:29:21,765 R@8 : 81.809
2020-09-28 13:30:17,169 Epoch: 10, loss: 1.321, time (seconds): 55.40.
2020-09-28 13:30:17,170 **Evaluating.**
2020-09-28 13:30:32,484 NMI: 30.617
2020-09-28 13:30:34,838 R@1 : 48.833
2020-09-28 13:30:34,945 R@2 : 61.009
2020-09-28 13:30:35,055 R@4 : 71.945
2020-09-28 13:30:35,163 R@8 : 81.346
2020-09-28 13:31:30,467 Epoch: 11, loss: 1.293, time (seconds): 55.30.
2020-09-28 13:31:30,468 **Evaluating.**
2020-09-28 13:31:46,103 NMI: 31.409
2020-09-28 13:31:48,433 R@1 : 48.328
2020-09-28 13:31:48,542 R@2 : 60.421
2020-09-28 13:31:48,645 R@4 : 71.399
2020-09-28 13:31:48,750 R@8 : 81.767
2020-09-28 13:32:44,174 Epoch: 12, loss: 1.226, time (seconds): 55.42.
2020-09-28 13:32:44,175 **Evaluating.**
2020-09-28 13:32:59,377 NMI: 32.120
2020-09-28 13:33:01,707 R@1 : 49.821
2020-09-28 13:33:01,809 R@2 : 60.673
2020-09-28 13:33:01,911 R@4 : 71.987
2020-09-28 13:33:02,013 R@8 : 81.977
2020-09-28 13:33:57,538 Epoch: 13, loss: 1.171, time (seconds): 55.52.
2020-09-28 13:33:57,539 **Evaluating.**
2020-09-28 13:34:13,055 NMI: 31.439
2020-09-28 13:34:15,376 R@1 : 49.253
2020-09-28 13:34:15,480 R@2 : 61.262
2020-09-28 13:34:15,587 R@4 : 72.198
2020-09-28 13:34:15,692 R@8 : 81.556
2020-09-28 13:35:11,398 Epoch: 14, loss: 1.162, time (seconds): 55.70.
2020-09-28 13:35:11,399 **Evaluating.**
2020-09-28 13:35:26,812 NMI: 29.416
2020-09-28 13:35:29,195 R@1 : 49.380
2020-09-28 13:35:29,298 R@2 : 60.673
2020-09-28 13:35:29,401 R@4 : 72.008
2020-09-28 13:35:29,503 R@8 : 81.262
2020-09-28 13:36:24,973 Epoch: 15, loss: 1.151, time (seconds): 55.47.
2020-09-28 13:36:24,974 **Evaluating.**
2020-09-28 13:36:40,368 NMI: 31.949
2020-09-28 13:36:42,710 R@1 : 48.665
2020-09-28 13:36:42,813 R@2 : 60.988
2020-09-28 13:36:42,917 R@4 : 71.377
2020-09-28 13:36:43,022 R@8 : 80.778
2020-09-28 13:37:38,856 Epoch: 16, loss: 1.101, time (seconds): 55.83.
2020-09-28 13:37:38,856 **Evaluating.**
2020-09-28 13:37:54,069 NMI: 30.579
2020-09-28 13:37:56,416 R@1 : 49.800
2020-09-28 13:37:56,522 R@2 : 61.073
2020-09-28 13:37:56,627 R@4 : 71.651
2020-09-28 13:37:56,736 R@8 : 80.673
2020-09-28 13:38:52,278 Epoch: 17, loss: 1.094, time (seconds): 55.54.
2020-09-28 13:38:52,279 **Evaluating.**
2020-09-28 13:39:07,457 NMI: 29.970
2020-09-28 13:39:09,812 R@1 : 48.433
2020-09-28 13:39:09,921 R@2 : 60.063
2020-09-28 13:39:10,030 R@4 : 71.251
2020-09-28 13:39:10,143 R@8 : 81.346
2020-09-28 13:40:06,315 Epoch: 18, loss: 1.073, time (seconds): 56.17.
2020-09-28 13:40:06,316 **Evaluating.**
2020-09-28 13:40:21,917 NMI: 29.520
2020-09-28 13:40:24,320 R@1 : 48.686
2020-09-28 13:40:24,428 R@2 : 60.547
2020-09-28 13:40:24,533 R@4 : 71.125
2020-09-28 13:40:24,637 R@8 : 80.484
2020-09-28 13:41:20,594 Epoch: 19, loss: 1.031, time (seconds): 55.96.
2020-09-28 13:41:20,594 **Evaluating.**
2020-09-28 13:41:36,202 NMI: 28.557
2020-09-28 13:41:38,581 R@1 : 47.508
2020-09-28 13:41:38,685 R@2 : 59.516
2020-09-28 13:41:38,787 R@4 : 71.188
2020-09-28 13:41:38,891 R@8 : 80.778
2020-09-28 13:41:38,893 Total training time (minutes): 24.84.
