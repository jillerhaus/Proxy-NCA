2020-09-17 00:23:16,306 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 40, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food-20200917-002312', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-17 00:23:16,306 Training for 40 epochs
2020-09-17 00:23:16,308 **Evaluating initial model.**
2020-09-17 00:26:09,034 NMI: 24.435
2020-09-17 00:27:43,602 R@1 : 42.006
2020-09-17 00:27:44,355 R@2 : 50.544
2020-09-17 00:27:45,107 R@4 : 59.936
2020-09-17 00:27:45,856 R@8 : 69.261
2020-09-17 00:30:33,047 Epoch: 0, loss: 2.958, time (seconds): 167.19.
2020-09-17 00:30:33,047 **Evaluating.**
2020-09-17 00:32:54,056 NMI: 27.886
2020-09-17 00:34:19,801 R@1 : 42.636
2020-09-17 00:34:20,550 R@2 : 51.897
2020-09-17 00:34:21,297 R@4 : 61.428
2020-09-17 00:34:22,042 R@8 : 70.390
2020-09-17 00:36:55,701 Epoch: 1, loss: 2.905, time (seconds): 153.65.
2020-09-17 00:36:55,701 **Evaluating.**
2020-09-17 00:39:01,549 NMI: 25.211
2020-09-17 00:40:27,411 R@1 : 39.434
2020-09-17 00:40:28,162 R@2 : 48.355
2020-09-17 00:40:28,915 R@4 : 58.125
2020-09-17 00:40:29,665 R@8 : 67.839
2020-09-17 00:43:10,722 Epoch: 2, loss: 2.847, time (seconds): 161.05.
2020-09-17 00:43:10,722 **Evaluating.**
2020-09-17 00:45:14,721 NMI: 25.017
2020-09-17 00:46:41,083 R@1 : 37.762
2020-09-17 00:46:41,834 R@2 : 47.031
2020-09-17 00:46:42,585 R@4 : 56.708
2020-09-17 00:46:43,335 R@8 : 66.573
2020-09-17 00:49:22,608 Epoch: 3, loss: 2.770, time (seconds): 159.27.
2020-09-17 00:49:22,609 **Evaluating.**
2020-09-17 00:51:28,271 NMI: 24.171
2020-09-17 00:52:53,725 R@1 : 36.139
2020-09-17 00:52:54,484 R@2 : 45.502
2020-09-17 00:52:55,233 R@4 : 55.169
2020-09-17 00:52:55,990 R@8 : 65.182
2020-09-17 00:55:35,165 Epoch: 4, loss: 2.814, time (seconds): 159.17.
2020-09-17 00:55:35,165 **Evaluating.**
2020-09-17 00:57:44,537 NMI: 24.597
2020-09-17 00:59:09,867 R@1 : 37.399
2020-09-17 00:59:10,612 R@2 : 46.314
2020-09-17 00:59:11,356 R@4 : 55.944
2020-09-17 00:59:12,101 R@8 : 65.568
2020-09-17 01:01:53,973 Epoch: 5, loss: 2.746, time (seconds): 161.87.
2020-09-17 01:01:53,973 **Evaluating.**
2020-09-17 01:03:54,323 NMI: 24.696
2020-09-17 01:05:18,541 R@1 : 36.072
2020-09-17 01:05:19,291 R@2 : 45.040
2020-09-17 01:05:20,047 R@4 : 55.015
2020-09-17 01:05:20,796 R@8 : 64.918
2020-09-17 01:07:59,520 Epoch: 6, loss: 2.718, time (seconds): 158.72.
2020-09-17 01:07:59,520 **Evaluating.**
2020-09-17 01:09:57,715 NMI: 24.603
2020-09-17 01:11:19,653 R@1 : 35.744
2020-09-17 01:11:20,447 R@2 : 44.843
2020-09-17 01:11:21,242 R@4 : 54.609
2020-09-17 01:11:22,041 R@8 : 64.674
2020-09-17 01:13:53,260 Epoch: 7, loss: 2.725, time (seconds): 151.21.
2020-09-17 01:13:53,260 **Evaluating.**
2020-09-17 01:15:56,893 NMI: 23.911
2020-09-17 01:17:21,197 R@1 : 35.686
2020-09-17 01:17:21,941 R@2 : 44.433
2020-09-17 01:17:22,692 R@4 : 54.127
2020-09-17 01:17:23,436 R@8 : 63.780
2020-09-17 01:19:54,403 Epoch: 8, loss: 2.706, time (seconds): 150.96.
2020-09-17 01:19:54,404 **Evaluating.**
2020-09-17 01:21:57,366 NMI: 23.387
2020-09-17 01:23:22,315 R@1 : 34.975
2020-09-17 01:23:23,066 R@2 : 43.757
2020-09-17 01:23:23,815 R@4 : 53.572
2020-09-17 01:23:24,569 R@8 : 63.385
2020-09-17 01:25:55,551 Epoch: 9, loss: 2.691, time (seconds): 150.98.
2020-09-17 01:25:55,551 **Evaluating.**
2020-09-17 01:27:53,599 NMI: 23.215
2020-09-17 01:29:19,291 R@1 : 34.310
2020-09-17 01:29:20,046 R@2 : 43.278
2020-09-17 01:29:20,797 R@4 : 53.564
2020-09-17 01:29:21,546 R@8 : 63.307
2020-09-17 01:31:53,091 Epoch: 10, loss: 2.683, time (seconds): 151.54.
2020-09-17 01:31:53,093 **Evaluating.**
2020-09-17 01:33:57,374 NMI: 23.302
2020-09-17 01:35:21,369 R@1 : 33.468
2020-09-17 01:35:22,120 R@2 : 42.369
2020-09-17 01:35:22,870 R@4 : 52.434
2020-09-17 01:35:23,615 R@8 : 62.793
2020-09-17 01:37:55,082 Epoch: 11, loss: 2.640, time (seconds): 151.46.
2020-09-17 01:37:55,083 **Evaluating.**
2020-09-17 01:39:58,979 NMI: 23.607
2020-09-17 01:41:22,047 R@1 : 33.747
2020-09-17 01:41:22,809 R@2 : 42.778
2020-09-17 01:41:23,557 R@4 : 52.881
2020-09-17 01:41:24,318 R@8 : 63.164
2020-09-17 01:43:55,149 Epoch: 12, loss: 2.676, time (seconds): 150.83.
2020-09-17 01:43:55,150 **Evaluating.**
2020-09-17 01:46:02,489 NMI: 23.880
2020-09-17 01:47:25,127 R@1 : 33.988
2020-09-17 01:47:25,876 R@2 : 43.269
2020-09-17 01:47:26,623 R@4 : 53.163
2020-09-17 01:47:27,369 R@8 : 63.333
2020-09-17 01:50:04,140 Epoch: 13, loss: 2.643, time (seconds): 156.77.
2020-09-17 01:50:04,141 **Evaluating.**
2020-09-17 01:52:08,533 NMI: 23.542
2020-09-17 01:53:32,700 R@1 : 34.104
2020-09-17 01:53:33,445 R@2 : 42.984
2020-09-17 01:53:34,192 R@4 : 52.736
2020-09-17 01:53:34,938 R@8 : 62.909
2020-09-17 01:56:07,864 Epoch: 14, loss: 2.610, time (seconds): 152.92.
2020-09-17 01:56:07,865 **Evaluating.**
2020-09-17 01:58:17,863 NMI: 22.899
2020-09-17 01:59:42,723 R@1 : 33.215
2020-09-17 01:59:43,477 R@2 : 41.948
2020-09-17 01:59:44,236 R@4 : 51.807
2020-09-17 01:59:44,992 R@8 : 61.939
2020-09-17 02:02:17,693 Epoch: 15, loss: 2.615, time (seconds): 152.70.
2020-09-17 02:02:17,694 **Evaluating.**
2020-09-17 02:04:14,484 NMI: 22.436
2020-09-17 02:05:37,876 R@1 : 32.051
2020-09-17 02:05:38,628 R@2 : 40.560
2020-09-17 02:05:39,379 R@4 : 50.637
2020-09-17 02:05:40,131 R@8 : 60.650
2020-09-17 02:08:09,752 Epoch: 16, loss: 2.576, time (seconds): 149.62.
2020-09-17 02:08:09,753 **Evaluating.**
2020-09-17 02:10:12,220 NMI: 22.913
2020-09-17 02:11:36,434 R@1 : 33.143
2020-09-17 02:11:37,182 R@2 : 41.855
2020-09-17 02:11:37,930 R@4 : 51.540
2020-09-17 02:11:38,676 R@8 : 61.539
2020-09-17 02:14:09,477 Epoch: 17, loss: 2.597, time (seconds): 150.80.
2020-09-17 02:14:09,477 **Evaluating.**
2020-09-17 02:16:05,685 NMI: 22.194
2020-09-17 02:17:26,598 R@1 : 32.646
2020-09-17 02:17:27,361 R@2 : 41.359
2020-09-17 02:17:28,115 R@4 : 51.047
2020-09-17 02:17:28,869 R@8 : 61.141
2020-09-17 02:20:01,038 Epoch: 18, loss: 2.584, time (seconds): 152.16.
2020-09-17 02:20:01,038 **Evaluating.**
2020-09-17 02:22:11,186 NMI: 22.759
2020-09-17 02:23:37,533 R@1 : 33.064
2020-09-17 02:23:38,287 R@2 : 41.649
2020-09-17 02:23:39,041 R@4 : 51.566
2020-09-17 02:23:39,795 R@8 : 61.710
2020-09-17 02:26:12,144 Epoch: 19, loss: 2.561, time (seconds): 152.35.
2020-09-17 02:26:12,145 **Evaluating.**
2020-09-17 02:28:24,310 NMI: 22.326
2020-09-17 02:29:49,260 R@1 : 31.796
2020-09-17 02:29:50,068 R@2 : 40.328
2020-09-17 02:29:50,864 R@4 : 50.071
2020-09-17 02:29:51,657 R@8 : 60.296
2020-09-17 02:32:23,393 Epoch: 20, loss: 2.582, time (seconds): 151.73.
2020-09-17 02:32:23,394 **Evaluating.**
2020-09-17 02:34:33,617 NMI: 22.090
2020-09-17 02:35:59,268 R@1 : 31.343
2020-09-17 02:36:00,016 R@2 : 39.686
2020-09-17 02:36:00,767 R@4 : 49.650
2020-09-17 02:36:01,514 R@8 : 60.258
2020-09-17 02:38:33,333 Epoch: 21, loss: 2.520, time (seconds): 151.82.
2020-09-17 02:38:33,333 **Evaluating.**
2020-09-17 02:40:49,050 NMI: 22.077
2020-09-17 02:42:14,965 R@1 : 32.135
2020-09-17 02:42:15,712 R@2 : 40.421
2020-09-17 02:42:16,477 R@4 : 50.141
2020-09-17 02:42:17,233 R@8 : 60.546
2020-09-17 02:44:48,061 Epoch: 22, loss: 2.543, time (seconds): 150.83.
2020-09-17 02:44:48,062 **Evaluating.**
2020-09-17 02:46:58,980 NMI: 22.168
2020-09-17 02:48:25,021 R@1 : 31.894
2020-09-17 02:48:25,813 R@2 : 40.650
2020-09-17 02:48:26,604 R@4 : 50.431
2020-09-17 02:48:27,399 R@8 : 60.314
2020-09-17 02:50:58,840 Epoch: 23, loss: 2.534, time (seconds): 151.44.
2020-09-17 02:50:58,841 **Evaluating.**
2020-09-17 02:53:06,532 NMI: 21.660
2020-09-17 02:54:32,142 R@1 : 31.613
2020-09-17 02:54:32,892 R@2 : 39.849
2020-09-17 02:54:33,640 R@4 : 49.659
2020-09-17 02:54:34,389 R@8 : 59.791
2020-09-17 02:57:08,172 Epoch: 24, loss: 2.568, time (seconds): 153.78.
2020-09-17 02:57:08,173 **Evaluating.**
2020-09-17 02:59:20,328 NMI: 22.045
2020-09-17 03:00:46,551 R@1 : 32.045
2020-09-17 03:00:47,365 R@2 : 40.331
2020-09-17 03:00:48,172 R@4 : 49.839
2020-09-17 03:00:48,968 R@8 : 59.930
2020-09-17 03:03:21,133 Epoch: 25, loss: 2.559, time (seconds): 152.16.
2020-09-17 03:03:21,134 **Evaluating.**
2020-09-17 03:05:28,691 NMI: 21.209
2020-09-17 03:06:54,098 R@1 : 30.942
2020-09-17 03:06:54,844 R@2 : 39.234
2020-09-17 03:06:55,591 R@4 : 48.869
2020-09-17 03:06:56,339 R@8 : 59.205
2020-09-17 03:09:27,422 Epoch: 26, loss: 2.530, time (seconds): 151.08.
2020-09-17 03:09:27,423 **Evaluating.**
2020-09-17 03:11:38,421 NMI: 21.047
2020-09-17 03:13:05,633 R@1 : 31.229
2020-09-17 03:13:06,377 R@2 : 39.414
2020-09-17 03:13:07,125 R@4 : 48.878
2020-09-17 03:13:07,875 R@8 : 58.874
2020-09-17 03:15:42,260 Epoch: 27, loss: 2.548, time (seconds): 154.38.
2020-09-17 03:15:42,261 **Evaluating.**
2020-09-17 03:17:40,572 NMI: 21.795
2020-09-17 03:19:02,655 R@1 : 31.601
2020-09-17 03:19:03,448 R@2 : 40.116
2020-09-17 03:19:04,239 R@4 : 49.766
2020-09-17 03:19:05,038 R@8 : 60.134
2020-09-17 03:21:37,080 Epoch: 28, loss: 2.567, time (seconds): 152.04.
2020-09-17 03:21:37,081 **Evaluating.**
2020-09-17 03:23:37,853 NMI: 22.001
2020-09-17 03:24:59,559 R@1 : 31.726
2020-09-17 03:25:00,312 R@2 : 40.049
2020-09-17 03:25:01,064 R@4 : 49.470
2020-09-17 03:25:01,816 R@8 : 59.858
2020-09-17 03:27:34,164 Epoch: 29, loss: 2.503, time (seconds): 152.35.
2020-09-17 03:27:34,165 **Evaluating.**
2020-09-17 03:29:31,169 NMI: 21.218
2020-09-17 03:30:54,718 R@1 : 30.838
2020-09-17 03:30:55,594 R@2 : 39.077
2020-09-17 03:30:56,434 R@4 : 48.561
2020-09-17 03:30:57,235 R@8 : 58.845
2020-09-17 03:33:29,018 Epoch: 30, loss: 2.560, time (seconds): 151.78.
2020-09-17 03:33:29,019 **Evaluating.**
2020-09-17 03:35:30,652 NMI: 21.757
2020-09-17 03:36:52,812 R@1 : 30.832
2020-09-17 03:36:53,562 R@2 : 39.399
2020-09-17 03:36:54,312 R@4 : 49.040
2020-09-17 03:36:55,061 R@8 : 59.167
2020-09-17 03:39:27,944 Epoch: 31, loss: 2.515, time (seconds): 152.88.
2020-09-17 03:39:27,944 **Evaluating.**
2020-09-17 03:41:25,293 NMI: 21.544
2020-09-17 03:42:48,096 R@1 : 30.608
2020-09-17 03:42:48,905 R@2 : 38.847
2020-09-17 03:42:49,705 R@4 : 48.300
2020-09-17 03:42:50,500 R@8 : 58.441
2020-09-17 03:45:20,985 Epoch: 32, loss: 2.514, time (seconds): 150.48.
2020-09-17 03:45:20,986 **Evaluating.**
2020-09-17 03:47:23,079 NMI: 21.205
2020-09-17 03:48:44,671 R@1 : 30.884
2020-09-17 03:48:45,419 R@2 : 39.100
2020-09-17 03:48:46,166 R@4 : 48.837
2020-09-17 03:48:46,920 R@8 : 59.155
2020-09-17 03:51:18,718 Epoch: 33, loss: 2.490, time (seconds): 151.80.
2020-09-17 03:51:18,719 **Evaluating.**
2020-09-17 03:53:20,994 NMI: 20.936
2020-09-17 03:54:43,240 R@1 : 30.359
2020-09-17 03:54:43,986 R@2 : 38.798
2020-09-17 03:54:44,733 R@4 : 48.312
2020-09-17 03:54:45,481 R@8 : 58.328
2020-09-17 03:57:16,445 Epoch: 34, loss: 2.452, time (seconds): 150.96.
2020-09-17 03:57:16,446 **Evaluating.**
2020-09-17 03:59:18,527 NMI: 21.396
2020-09-17 04:00:40,510 R@1 : 30.962
2020-09-17 04:00:41,307 R@2 : 39.033
2020-09-17 04:00:42,113 R@4 : 48.509
2020-09-17 04:00:42,917 R@8 : 58.662
2020-09-17 04:03:18,542 Epoch: 35, loss: 2.490, time (seconds): 155.62.
2020-09-17 04:03:18,543 **Evaluating.**
2020-09-17 04:05:20,142 NMI: 20.740
2020-09-17 04:06:41,512 R@1 : 29.801
2020-09-17 04:06:42,259 R@2 : 37.953
2020-09-17 04:06:43,006 R@4 : 47.484
2020-09-17 04:06:43,751 R@8 : 57.898
2020-09-17 04:09:15,585 Epoch: 36, loss: 2.489, time (seconds): 151.83.
2020-09-17 04:09:15,586 **Evaluating.**
2020-09-17 04:11:17,987 NMI: 21.021
2020-09-17 04:12:41,065 R@1 : 30.042
2020-09-17 04:12:41,822 R@2 : 38.188
2020-09-17 04:12:42,572 R@4 : 47.615
2020-09-17 04:12:43,321 R@8 : 57.698
2020-09-17 04:15:17,129 Epoch: 37, loss: 2.484, time (seconds): 153.80.
2020-09-17 04:15:17,129 **Evaluating.**
2020-09-17 04:17:10,701 NMI: 21.624
2020-09-17 04:18:33,398 R@1 : 30.780
2020-09-17 04:18:34,155 R@2 : 39.068
2020-09-17 04:18:34,920 R@4 : 48.506
2020-09-17 04:18:35,669 R@8 : 58.784
2020-09-17 04:21:07,097 Epoch: 38, loss: 2.463, time (seconds): 151.42.
2020-09-17 04:21:07,098 **Evaluating.**
2020-09-17 04:23:15,757 NMI: 20.424
2020-09-17 04:24:37,963 R@1 : 29.929
2020-09-17 04:24:38,709 R@2 : 38.008
2020-09-17 04:24:39,458 R@4 : 47.493
2020-09-17 04:24:40,204 R@8 : 57.976
2020-09-17 04:27:13,072 Epoch: 39, loss: 2.468, time (seconds): 152.87.
2020-09-17 04:27:13,073 **Evaluating.**
2020-09-17 04:29:11,035 NMI: 21.397
2020-09-17 04:30:33,713 R@1 : 30.257
2020-09-17 04:30:34,513 R@2 : 38.464
2020-09-17 04:30:35,315 R@4 : 47.940
2020-09-17 04:30:36,119 R@8 : 57.982
2020-09-17 04:30:36,122 Total training time (minutes): 247.33.
2020-09-17 04:30:38,550 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 40, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food-20200917-002312', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-17 04:30:38,560 Training for 40 epochs
2020-09-17 04:30:38,562 **Evaluating initial model.**
2020-09-17 04:32:27,162 NMI: 24.435
2020-09-17 04:34:02,315 R@1 : 42.006
2020-09-17 04:34:03,068 R@2 : 50.544
2020-09-17 04:34:03,816 R@4 : 59.936
2020-09-17 04:34:04,573 R@8 : 69.261
2020-09-17 04:36:18,730 Epoch: 0, loss: 3.048, time (seconds): 134.16.
2020-09-17 04:36:18,730 **Evaluating.**
2020-09-17 04:38:30,620 NMI: 29.754
2020-09-17 04:40:00,578 R@1 : 46.724
2020-09-17 04:40:01,327 R@2 : 55.430
2020-09-17 04:40:02,071 R@4 : 64.239
2020-09-17 04:40:02,822 R@8 : 73.114
2020-09-17 04:42:03,777 Epoch: 1, loss: 2.963, time (seconds): 120.95.
2020-09-17 04:42:03,778 **Evaluating.**
2020-09-17 04:44:08,652 NMI: 29.784
2020-09-17 04:45:37,065 R@1 : 45.873
2020-09-17 04:45:37,821 R@2 : 54.708
2020-09-17 04:45:38,570 R@4 : 64.041
2020-09-17 04:45:39,324 R@8 : 72.579
2020-09-17 04:47:54,662 Epoch: 2, loss: 2.915, time (seconds): 135.33.
2020-09-17 04:47:54,663 **Evaluating.**
2020-09-17 04:49:52,982 NMI: 28.982
2020-09-17 04:51:21,618 R@1 : 43.986
2020-09-17 04:51:22,370 R@2 : 53.262
2020-09-17 04:51:23,122 R@4 : 62.488
2020-09-17 04:51:23,871 R@8 : 71.322
2020-09-17 04:53:31,386 Epoch: 3, loss: 2.875, time (seconds): 127.51.
2020-09-17 04:53:31,386 **Evaluating.**
2020-09-17 04:55:33,457 NMI: 28.245
2020-09-17 04:57:01,459 R@1 : 43.095
2020-09-17 04:57:02,207 R@2 : 52.217
2020-09-17 04:57:02,956 R@4 : 61.501
2020-09-17 04:57:03,707 R@8 : 70.600
2020-09-17 04:59:10,868 Epoch: 4, loss: 2.820, time (seconds): 127.16.
2020-09-17 04:59:10,869 **Evaluating.**
2020-09-17 05:01:13,477 NMI: 27.460
2020-09-17 05:02:42,197 R@1 : 41.652
2020-09-17 05:02:42,948 R@2 : 51.009
2020-09-17 05:02:43,699 R@4 : 60.415
2020-09-17 05:02:44,449 R@8 : 69.763
2020-09-17 05:05:04,970 Epoch: 5, loss: 2.803, time (seconds): 140.52.
2020-09-17 05:05:04,971 **Evaluating.**
2020-09-17 05:07:41,589 NMI: 27.122
2020-09-17 05:09:08,979 R@1 : 41.306
2020-09-17 05:09:09,722 R@2 : 50.544
2020-09-17 05:09:10,470 R@4 : 59.675
2020-09-17 05:09:11,223 R@8 : 69.040
2020-09-17 05:11:15,932 Epoch: 6, loss: 2.795, time (seconds): 124.71.
2020-09-17 05:11:15,932 **Evaluating.**
2020-09-17 05:13:15,641 NMI: 26.163
2020-09-17 05:14:43,440 R@1 : 40.325
2020-09-17 05:14:44,188 R@2 : 49.641
2020-09-17 05:14:44,949 R@4 : 59.161
2020-09-17 05:14:45,706 R@8 : 68.251
2020-09-17 05:16:55,832 Epoch: 7, loss: 2.751, time (seconds): 130.12.
2020-09-17 05:16:55,833 **Evaluating.**
2020-09-17 05:19:00,459 NMI: 26.331
2020-09-17 05:20:27,892 R@1 : 39.686
2020-09-17 05:20:28,644 R@2 : 48.614
2020-09-17 05:20:29,395 R@4 : 58.351
2020-09-17 05:20:30,157 R@8 : 67.879
2020-09-17 05:22:35,467 Epoch: 8, loss: 2.757, time (seconds): 125.31.
2020-09-17 05:22:35,468 **Evaluating.**
2020-09-17 05:24:36,311 NMI: 26.366
2020-09-17 05:26:04,018 R@1 : 39.091
2020-09-17 05:26:04,770 R@2 : 48.300
2020-09-17 05:26:05,524 R@4 : 58.267
2020-09-17 05:26:06,278 R@8 : 67.743
2020-09-17 05:28:13,954 Epoch: 9, loss: 2.735, time (seconds): 127.67.
2020-09-17 05:28:13,954 **Evaluating.**
2020-09-17 05:30:14,792 NMI: 25.801
2020-09-17 05:31:42,037 R@1 : 38.531
2020-09-17 05:31:42,795 R@2 : 47.737
2020-09-17 05:31:43,543 R@4 : 57.288
2020-09-17 05:31:44,296 R@8 : 66.622
2020-09-17 05:33:46,706 Epoch: 10, loss: 2.711, time (seconds): 122.41.
2020-09-17 05:33:46,707 **Evaluating.**
2020-09-17 05:35:44,879 NMI: 25.464
2020-09-17 05:37:11,635 R@1 : 38.206
2020-09-17 05:37:12,387 R@2 : 47.168
2020-09-17 05:37:13,136 R@4 : 56.850
2020-09-17 05:37:13,889 R@8 : 66.433
2020-09-17 05:39:25,101 Epoch: 11, loss: 2.702, time (seconds): 131.21.
2020-09-17 05:39:25,102 **Evaluating.**
2020-09-17 05:41:27,541 NMI: 25.729
2020-09-17 05:42:54,910 R@1 : 37.463
2020-09-17 05:42:55,750 R@2 : 46.582
2020-09-17 05:42:56,591 R@4 : 56.380
2020-09-17 05:42:57,430 R@8 : 66.039
2020-09-17 05:45:03,288 Epoch: 12, loss: 2.674, time (seconds): 125.85.
2020-09-17 05:45:03,289 **Evaluating.**
2020-09-17 05:47:00,012 NMI: 25.047
2020-09-17 05:48:26,771 R@1 : 37.593
2020-09-17 05:48:27,523 R@2 : 46.497
2020-09-17 05:48:28,275 R@4 : 56.281
2020-09-17 05:48:29,026 R@8 : 65.963
2020-09-17 05:50:37,786 Epoch: 13, loss: 2.676, time (seconds): 128.76.
2020-09-17 05:50:37,787 **Evaluating.**
2020-09-17 05:52:38,899 NMI: 24.707
2020-09-17 05:54:05,428 R@1 : 37.132
2020-09-17 05:54:06,227 R@2 : 46.175
2020-09-17 05:54:07,020 R@4 : 55.895
2020-09-17 05:54:07,820 R@8 : 65.699
2020-09-17 05:56:11,484 Epoch: 14, loss: 2.654, time (seconds): 123.66.
2020-09-17 05:56:11,485 **Evaluating.**
2020-09-17 05:58:09,495 NMI: 24.400
2020-09-17 05:59:37,105 R@1 : 36.406
2020-09-17 05:59:37,860 R@2 : 45.327
2020-09-17 05:59:38,616 R@4 : 54.980
2020-09-17 05:59:39,366 R@8 : 64.877
2020-09-17 06:01:49,646 Epoch: 15, loss: 2.655, time (seconds): 130.28.
2020-09-17 06:01:49,647 **Evaluating.**
2020-09-17 06:03:52,047 NMI: 24.531
2020-09-17 06:05:18,543 R@1 : 36.116
2020-09-17 06:05:19,292 R@2 : 45.208
2020-09-17 06:05:20,044 R@4 : 55.062
2020-09-17 06:05:20,794 R@8 : 64.811
2020-09-17 06:07:24,140 Epoch: 16, loss: 2.650, time (seconds): 123.34.
2020-09-17 06:07:24,140 **Evaluating.**
2020-09-17 06:09:22,055 NMI: 24.035
2020-09-17 06:10:48,970 R@1 : 35.529
2020-09-17 06:10:49,725 R@2 : 44.366
2020-09-17 06:10:50,472 R@4 : 54.217
2020-09-17 06:10:51,223 R@8 : 63.931
2020-09-17 06:13:00,029 Epoch: 17, loss: 2.616, time (seconds): 128.80.
2020-09-17 06:13:00,030 **Evaluating.**
2020-09-17 06:15:06,434 NMI: 23.823
2020-09-17 06:16:33,473 R@1 : 35.030
2020-09-17 06:16:34,327 R@2 : 44.152
2020-09-17 06:16:35,160 R@4 : 53.892
2020-09-17 06:16:36,007 R@8 : 63.754
2020-09-17 06:18:40,826 Epoch: 18, loss: 2.662, time (seconds): 124.82.
2020-09-17 06:18:40,826 **Evaluating.**
2020-09-17 06:20:42,242 NMI: 23.695
2020-09-17 06:22:09,293 R@1 : 34.170
2020-09-17 06:22:10,047 R@2 : 43.307
2020-09-17 06:22:10,801 R@4 : 53.439
2020-09-17 06:22:11,550 R@8 : 63.077
2020-09-17 06:24:20,019 Epoch: 19, loss: 2.632, time (seconds): 128.47.
2020-09-17 06:24:20,020 **Evaluating.**
2020-09-17 06:26:24,677 NMI: 23.931
2020-09-17 06:27:52,248 R@1 : 34.681
2020-09-17 06:27:52,997 R@2 : 43.371
2020-09-17 06:27:53,756 R@4 : 53.238
2020-09-17 06:27:54,511 R@8 : 63.196
2020-09-17 06:29:59,024 Epoch: 20, loss: 2.636, time (seconds): 124.51.
2020-09-17 06:29:59,024 **Evaluating.**
2020-09-17 06:31:55,879 NMI: 23.870
2020-09-17 06:33:22,670 R@1 : 35.094
2020-09-17 06:33:23,418 R@2 : 43.911
2020-09-17 06:33:24,172 R@4 : 53.628
2020-09-17 06:33:24,926 R@8 : 63.397
2020-09-17 06:35:35,814 Epoch: 21, loss: 2.622, time (seconds): 130.89.
2020-09-17 06:35:35,815 **Evaluating.**
2020-09-17 06:37:39,202 NMI: 23.810
2020-09-17 06:39:06,439 R@1 : 34.464
2020-09-17 06:39:07,200 R@2 : 43.321
2020-09-17 06:39:07,947 R@4 : 53.088
2020-09-17 06:39:08,700 R@8 : 63.011
2020-09-17 06:41:15,902 Epoch: 22, loss: 2.603, time (seconds): 127.20.
2020-09-17 06:41:15,903 **Evaluating.**
2020-09-17 06:43:12,208 NMI: 23.829
2020-09-17 06:44:39,176 R@1 : 34.194
2020-09-17 06:44:39,920 R@2 : 42.926
2020-09-17 06:44:40,667 R@4 : 52.620
2020-09-17 06:44:41,419 R@8 : 62.595
2020-09-17 06:46:54,585 Epoch: 23, loss: 2.597, time (seconds): 133.16.
2020-09-17 06:46:54,586 **Evaluating.**
2020-09-17 06:48:57,408 NMI: 23.732
2020-09-17 06:50:24,218 R@1 : 33.822
2020-09-17 06:50:24,968 R@2 : 42.723
2020-09-17 06:50:25,718 R@4 : 52.699
2020-09-17 06:50:26,473 R@8 : 62.761
2020-09-17 06:52:31,524 Epoch: 24, loss: 2.612, time (seconds): 125.05.
2020-09-17 06:52:31,525 **Evaluating.**
2020-09-17 06:54:27,684 NMI: 23.283
2020-09-17 06:55:54,743 R@1 : 34.266
2020-09-17 06:55:55,489 R@2 : 42.851
2020-09-17 06:55:56,234 R@4 : 52.693
2020-09-17 06:55:56,986 R@8 : 62.645
2020-09-17 06:58:07,421 Epoch: 25, loss: 2.601, time (seconds): 130.43.
2020-09-17 06:58:07,422 **Evaluating.**
2020-09-17 07:00:09,538 NMI: 23.514
2020-09-17 07:01:36,551 R@1 : 33.944
2020-09-17 07:01:37,322 R@2 : 42.810
2020-09-17 07:01:38,069 R@4 : 52.519
2020-09-17 07:01:38,825 R@8 : 62.558
2020-09-17 07:03:43,586 Epoch: 26, loss: 2.584, time (seconds): 124.76.
2020-09-17 07:03:43,586 **Evaluating.**
2020-09-17 07:05:41,174 NMI: 23.304
2020-09-17 07:07:07,658 R@1 : 33.488
2020-09-17 07:07:08,416 R@2 : 42.288
2020-09-17 07:07:09,168 R@4 : 52.278
2020-09-17 07:07:09,920 R@8 : 62.262
2020-09-17 07:09:19,519 Epoch: 27, loss: 2.607, time (seconds): 129.60.
2020-09-17 07:09:19,519 **Evaluating.**
2020-09-17 07:11:22,633 NMI: 23.372
2020-09-17 07:12:49,362 R@1 : 33.781
2020-09-17 07:12:50,121 R@2 : 42.575
2020-09-17 07:12:50,873 R@4 : 52.434
2020-09-17 07:12:51,622 R@8 : 62.218
2020-09-17 07:14:57,122 Epoch: 28, loss: 2.576, time (seconds): 125.50.
2020-09-17 07:14:57,122 **Evaluating.**
2020-09-17 07:16:55,863 NMI: 22.905
2020-09-17 07:18:23,115 R@1 : 33.598
2020-09-17 07:18:23,867 R@2 : 42.204
2020-09-17 07:18:24,620 R@4 : 52.159
2020-09-17 07:18:25,399 R@8 : 62.116
2020-09-17 07:20:36,449 Epoch: 29, loss: 2.578, time (seconds): 131.05.
2020-09-17 07:20:36,450 **Evaluating.**
2020-09-17 07:22:37,989 NMI: 22.787
2020-09-17 07:24:04,436 R@1 : 33.459
2020-09-17 07:24:05,191 R@2 : 42.143
2020-09-17 07:24:05,943 R@4 : 51.717
2020-09-17 07:24:06,695 R@8 : 61.739
2020-09-17 07:26:10,427 Epoch: 30, loss: 2.573, time (seconds): 123.73.
2020-09-17 07:26:10,427 **Evaluating.**
2020-09-17 07:28:07,149 NMI: 22.906
2020-09-17 07:29:34,458 R@1 : 32.974
2020-09-17 07:29:35,264 R@2 : 41.762
2020-09-17 07:29:36,064 R@4 : 51.563
2020-09-17 07:29:36,862 R@8 : 61.405
2020-09-17 07:31:47,693 Epoch: 31, loss: 2.581, time (seconds): 130.83.
2020-09-17 07:31:47,694 **Evaluating.**
2020-09-17 07:33:49,345 NMI: 22.562
2020-09-17 07:35:16,727 R@1 : 32.748
2020-09-17 07:35:17,480 R@2 : 41.530
2020-09-17 07:35:18,228 R@4 : 51.160
2020-09-17 07:35:18,982 R@8 : 61.109
2020-09-17 07:37:22,527 Epoch: 32, loss: 2.578, time (seconds): 123.54.
2020-09-17 07:37:22,527 **Evaluating.**
2020-09-17 07:39:25,990 NMI: 22.826
2020-09-17 07:40:53,026 R@1 : 32.530
2020-09-17 07:40:53,773 R@2 : 41.388
2020-09-17 07:40:54,526 R@4 : 51.090
2020-09-17 07:40:55,281 R@8 : 61.019
2020-09-17 07:43:06,431 Epoch: 33, loss: 2.566, time (seconds): 131.15.
2020-09-17 07:43:06,432 **Evaluating.**
2020-09-17 07:45:05,629 NMI: 23.126
2020-09-17 07:46:32,221 R@1 : 32.867
2020-09-17 07:46:32,975 R@2 : 41.704
2020-09-17 07:46:33,725 R@4 : 51.619
2020-09-17 07:46:34,494 R@8 : 61.722
2020-09-17 07:48:42,288 Epoch: 34, loss: 2.547, time (seconds): 127.79.
2020-09-17 07:48:42,289 **Evaluating.**
2020-09-17 07:50:43,978 NMI: 22.637
2020-09-17 07:52:11,349 R@1 : 33.012
2020-09-17 07:52:12,275 R@2 : 41.716
2020-09-17 07:52:13,198 R@4 : 51.360
2020-09-17 07:52:14,127 R@8 : 61.391
2020-09-17 07:54:24,707 Epoch: 35, loss: 2.564, time (seconds): 130.58.
2020-09-17 07:54:24,707 **Evaluating.**
2020-09-17 07:56:22,640 NMI: 22.805
2020-09-17 07:57:49,016 R@1 : 32.937
2020-09-17 07:57:49,766 R@2 : 41.542
2020-09-17 07:57:50,516 R@4 : 51.421
2020-09-17 07:57:51,268 R@8 : 61.434
2020-09-17 07:59:57,186 Epoch: 36, loss: 2.569, time (seconds): 125.92.
2020-09-17 07:59:57,187 **Evaluating.**
2020-09-17 08:02:01,769 NMI: 22.740
2020-09-17 08:03:28,685 R@1 : 32.655
2020-09-17 08:03:29,435 R@2 : 41.356
2020-09-17 08:03:30,188 R@4 : 50.989
2020-09-17 08:03:30,938 R@8 : 61.228
2020-09-17 08:05:42,123 Epoch: 37, loss: 2.551, time (seconds): 131.18.
2020-09-17 08:05:42,123 **Evaluating.**
2020-09-17 08:07:35,769 NMI: 22.607
2020-09-17 08:09:02,817 R@1 : 31.877
2020-09-17 08:09:03,566 R@2 : 40.743
2020-09-17 08:09:04,313 R@4 : 50.347
2020-09-17 08:09:05,065 R@8 : 60.293
2020-09-17 08:11:06,187 Epoch: 38, loss: 2.546, time (seconds): 121.12.
2020-09-17 08:11:06,188 **Evaluating.**
2020-09-17 08:13:12,978 NMI: 22.388
2020-09-17 08:14:40,672 R@1 : 32.356
2020-09-17 08:14:41,422 R@2 : 41.092
2020-09-17 08:14:42,173 R@4 : 50.890
2020-09-17 08:14:42,923 R@8 : 60.868
2020-09-17 08:16:50,247 Epoch: 39, loss: 2.560, time (seconds): 127.32.
2020-09-17 08:16:50,247 **Evaluating.**
2020-09-17 08:18:44,368 NMI: 22.576
2020-09-17 08:20:12,067 R@1 : 32.429
2020-09-17 08:20:12,816 R@2 : 41.115
2020-09-17 08:20:13,582 R@4 : 50.367
2020-09-17 08:20:14,333 R@8 : 60.282
2020-09-17 08:20:14,335 Total training time (minutes): 229.60.
2020-09-17 08:20:16,602 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 40, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food-20200917-002312', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-17 08:20:16,603 Training for 40 epochs
2020-09-17 08:20:16,605 **Evaluating initial model.**
2020-09-17 08:22:22,206 NMI: 24.435
2020-09-17 08:23:57,707 R@1 : 42.006
2020-09-17 08:23:58,456 R@2 : 50.544
2020-09-17 08:23:59,203 R@4 : 59.936
2020-09-17 08:23:59,954 R@8 : 69.261
2020-09-17 08:26:32,151 Epoch: 0, loss: 2.212, time (seconds): 152.20.
2020-09-17 08:26:32,152 **Evaluating.**
2020-09-17 08:28:47,612 NMI: 28.916
2020-09-17 08:30:17,466 R@1 : 46.541
2020-09-17 08:30:18,215 R@2 : 55.384
2020-09-17 08:30:18,966 R@4 : 64.668
2020-09-17 08:30:19,713 R@8 : 73.143
2020-09-17 08:32:51,427 Epoch: 1, loss: 2.074, time (seconds): 151.71.
2020-09-17 08:32:51,428 **Evaluating.**
2020-09-17 08:35:01,770 NMI: 28.545
2020-09-17 08:36:32,241 R@1 : 47.075
2020-09-17 08:36:33,004 R@2 : 56.087
2020-09-17 08:36:33,751 R@4 : 64.964
2020-09-17 08:36:34,504 R@8 : 73.462
2020-09-17 08:39:11,799 Epoch: 2, loss: 1.948, time (seconds): 157.29.
2020-09-17 08:39:11,800 **Evaluating.**
2020-09-17 08:41:27,327 NMI: 28.050
2020-09-17 08:42:58,041 R@1 : 45.966
2020-09-17 08:42:58,792 R@2 : 55.065
2020-09-17 08:42:59,552 R@4 : 64.422
2020-09-17 08:43:00,302 R@8 : 73.192
2020-09-17 08:45:32,884 Epoch: 3, loss: 1.806, time (seconds): 152.58.
2020-09-17 08:45:32,885 **Evaluating.**
2020-09-17 08:47:42,526 NMI: 27.514
2020-09-17 08:49:12,460 R@1 : 45.812
2020-09-17 08:49:13,226 R@2 : 54.658
2020-09-17 08:49:13,982 R@4 : 63.911
2020-09-17 08:49:14,732 R@8 : 72.597
2020-09-17 08:51:52,796 Epoch: 4, loss: 1.911, time (seconds): 158.06.
2020-09-17 08:51:52,797 **Evaluating.**
2020-09-17 08:54:07,701 NMI: 27.657
2020-09-17 08:55:38,423 R@1 : 46.712
2020-09-17 08:55:39,173 R@2 : 55.613
2020-09-17 08:55:39,923 R@4 : 64.732
2020-09-17 08:55:40,671 R@8 : 73.180
2020-09-17 08:58:13,104 Epoch: 5, loss: 1.764, time (seconds): 152.43.
2020-09-17 08:58:13,105 **Evaluating.**
2020-09-17 09:00:25,764 NMI: 26.645
2020-09-17 09:01:57,385 R@1 : 45.110
2020-09-17 09:01:58,184 R@2 : 54.017
2020-09-17 09:01:58,980 R@4 : 63.208
2020-09-17 09:01:59,783 R@8 : 72.089
2020-09-17 09:04:40,788 Epoch: 6, loss: 1.664, time (seconds): 161.00.
2020-09-17 09:04:40,789 **Evaluating.**
2020-09-17 09:06:55,165 NMI: 27.139
2020-09-17 09:08:26,762 R@1 : 45.304
2020-09-17 09:08:27,514 R@2 : 54.519
2020-09-17 09:08:28,271 R@4 : 63.281
2020-09-17 09:08:29,020 R@8 : 71.685
2020-09-17 09:11:04,874 Epoch: 7, loss: 1.631, time (seconds): 155.85.
2020-09-17 09:11:04,875 **Evaluating.**
2020-09-17 09:13:13,409 NMI: 26.702
2020-09-17 09:14:44,805 R@1 : 45.052
2020-09-17 09:14:45,561 R@2 : 54.086
2020-09-17 09:14:46,309 R@4 : 63.191
2020-09-17 09:14:47,057 R@8 : 71.674
2020-09-17 09:17:20,134 Epoch: 8, loss: 1.650, time (seconds): 153.07.
2020-09-17 09:17:20,134 **Evaluating.**
2020-09-17 09:19:38,246 NMI: 26.127
2020-09-17 09:21:10,002 R@1 : 44.700
2020-09-17 09:21:10,752 R@2 : 53.816
2020-09-17 09:21:11,524 R@4 : 62.964
2020-09-17 09:21:12,273 R@8 : 71.447
2020-09-17 09:23:48,725 Epoch: 9, loss: 1.584, time (seconds): 156.45.
2020-09-17 09:23:48,725 **Evaluating.**
2020-09-17 09:25:52,154 NMI: 25.785
2020-09-17 09:27:24,123 R@1 : 44.671
2020-09-17 09:27:24,873 R@2 : 53.706
2020-09-17 09:27:25,634 R@4 : 62.807
2020-09-17 09:27:26,382 R@8 : 71.372
2020-09-17 09:30:01,387 Epoch: 10, loss: 1.603, time (seconds): 155.00.
2020-09-17 09:30:01,388 **Evaluating.**
2020-09-17 09:32:16,361 NMI: 25.679
2020-09-17 09:33:47,367 R@1 : 43.963
2020-09-17 09:33:48,119 R@2 : 52.754
2020-09-17 09:33:48,868 R@4 : 61.669
2020-09-17 09:33:49,616 R@8 : 70.489
2020-09-17 09:36:22,182 Epoch: 11, loss: 1.476, time (seconds): 152.56.
2020-09-17 09:36:22,183 **Evaluating.**
2020-09-17 09:38:31,962 NMI: 26.100
2020-09-17 09:40:03,424 R@1 : 44.096
2020-09-17 09:40:04,177 R@2 : 52.876
2020-09-17 09:40:04,928 R@4 : 61.739
2020-09-17 09:40:05,682 R@8 : 70.504
2020-09-17 09:42:43,149 Epoch: 12, loss: 1.533, time (seconds): 157.46.
2020-09-17 09:42:43,150 **Evaluating.**
2020-09-17 09:44:58,451 NMI: 25.029
2020-09-17 09:46:30,138 R@1 : 43.719
2020-09-17 09:46:30,890 R@2 : 52.658
2020-09-17 09:46:31,639 R@4 : 61.739
2020-09-17 09:46:32,399 R@8 : 70.521
2020-09-17 09:49:07,170 Epoch: 13, loss: 1.438, time (seconds): 154.77.
2020-09-17 09:49:07,170 **Evaluating.**
2020-09-17 09:51:13,958 NMI: 24.355
2020-09-17 09:52:45,800 R@1 : 42.549
2020-09-17 09:52:46,560 R@2 : 50.919
2020-09-17 09:52:47,309 R@4 : 59.878
2020-09-17 09:52:48,059 R@8 : 68.773
2020-09-17 09:55:27,720 Epoch: 14, loss: 1.357, time (seconds): 159.66.
2020-09-17 09:55:27,721 **Evaluating.**
2020-09-17 09:57:47,450 NMI: 24.667
2020-09-17 09:59:19,262 R@1 : 42.970
2020-09-17 09:59:20,028 R@2 : 51.340
2020-09-17 09:59:20,779 R@4 : 60.415
2020-09-17 09:59:21,530 R@8 : 69.099
2020-09-17 10:01:53,763 Epoch: 15, loss: 1.381, time (seconds): 152.23.
2020-09-17 10:01:53,763 **Evaluating.**
2020-09-17 10:03:58,431 NMI: 23.958
2020-09-17 10:05:30,041 R@1 : 41.428
2020-09-17 10:05:30,795 R@2 : 49.813
2020-09-17 10:05:31,549 R@4 : 58.940
2020-09-17 10:05:32,300 R@8 : 67.917
2020-09-17 10:08:03,759 Epoch: 16, loss: 1.349, time (seconds): 151.46.
2020-09-17 10:08:03,760 **Evaluating.**
2020-09-17 10:10:17,578 NMI: 23.869
2020-09-17 10:11:50,519 R@1 : 41.637
2020-09-17 10:11:51,278 R@2 : 50.074
2020-09-17 10:11:52,029 R@4 : 58.850
2020-09-17 10:11:52,778 R@8 : 67.505
2020-09-17 10:14:24,591 Epoch: 17, loss: 1.314, time (seconds): 151.81.
2020-09-17 10:14:24,592 **Evaluating.**
2020-09-17 10:16:29,892 NMI: 23.169
2020-09-17 10:18:02,154 R@1 : 41.277
2020-09-17 10:18:02,993 R@2 : 49.308
2020-09-17 10:18:03,837 R@4 : 58.090
2020-09-17 10:18:04,677 R@8 : 66.849
2020-09-17 10:20:38,111 Epoch: 18, loss: 1.260, time (seconds): 153.43.
2020-09-17 10:20:38,112 **Evaluating.**
2020-09-17 10:22:55,964 NMI: 23.821
2020-09-17 10:24:28,254 R@1 : 41.942
2020-09-17 10:24:29,006 R@2 : 50.129
2020-09-17 10:24:29,759 R@4 : 59.106
2020-09-17 10:24:30,508 R@8 : 68.167
2020-09-17 10:27:02,466 Epoch: 19, loss: 1.244, time (seconds): 151.95.
2020-09-17 10:27:02,467 **Evaluating.**
2020-09-17 10:29:10,445 NMI: 23.005
2020-09-17 10:30:43,046 R@1 : 41.141
2020-09-17 10:30:43,801 R@2 : 49.412
2020-09-17 10:30:44,553 R@4 : 58.139
2020-09-17 10:30:45,302 R@8 : 66.973
2020-09-17 10:33:19,135 Epoch: 20, loss: 1.222, time (seconds): 153.83.
2020-09-17 10:33:19,136 **Evaluating.**
2020-09-17 10:35:33,117 NMI: 22.807
2020-09-17 10:37:05,461 R@1 : 40.000
2020-09-17 10:37:06,208 R@2 : 48.114
2020-09-17 10:37:06,953 R@4 : 57.007
2020-09-17 10:37:07,705 R@8 : 66.015
2020-09-17 10:39:42,584 Epoch: 21, loss: 1.170, time (seconds): 154.88.
2020-09-17 10:39:42,585 **Evaluating.**
2020-09-17 10:41:49,457 NMI: 22.689
2020-09-17 10:43:21,676 R@1 : 40.325
2020-09-17 10:43:22,422 R@2 : 48.718
2020-09-17 10:43:23,177 R@4 : 57.271
2020-09-17 10:43:23,950 R@8 : 66.268
2020-09-17 10:46:00,845 Epoch: 22, loss: 1.214, time (seconds): 156.89.
2020-09-17 10:46:00,845 **Evaluating.**
2020-09-17 10:48:20,959 NMI: 22.034
2020-09-17 10:49:53,250 R@1 : 39.173
2020-09-17 10:49:54,056 R@2 : 47.362
2020-09-17 10:49:54,854 R@4 : 56.455
2020-09-17 10:49:55,656 R@8 : 65.304
2020-09-17 10:52:27,773 Epoch: 23, loss: 1.163, time (seconds): 152.11.
2020-09-17 10:52:27,774 **Evaluating.**
2020-09-17 10:54:37,041 NMI: 21.986
2020-09-17 10:56:10,254 R@1 : 39.236
2020-09-17 10:56:11,001 R@2 : 47.168
2020-09-17 10:56:11,763 R@4 : 56.089
2020-09-17 10:56:12,510 R@8 : 65.014
2020-09-17 10:58:45,440 Epoch: 24, loss: 1.249, time (seconds): 152.93.
2020-09-17 10:58:45,441 **Evaluating.**
2020-09-17 11:00:59,698 NMI: 22.169
2020-09-17 11:02:31,886 R@1 : 39.344
2020-09-17 11:02:32,655 R@2 : 47.310
2020-09-17 11:02:33,414 R@4 : 55.947
2020-09-17 11:02:34,164 R@8 : 64.976
2020-09-17 11:05:07,839 Epoch: 25, loss: 1.196, time (seconds): 153.67.
2020-09-17 11:05:07,840 **Evaluating.**
2020-09-17 11:07:16,776 NMI: 21.974
2020-09-17 11:08:49,097 R@1 : 38.906
2020-09-17 11:08:49,843 R@2 : 47.258
2020-09-17 11:08:50,594 R@4 : 56.426
2020-09-17 11:08:51,362 R@8 : 65.452
2020-09-17 11:11:23,945 Epoch: 26, loss: 1.175, time (seconds): 152.58.
2020-09-17 11:11:23,946 **Evaluating.**
2020-09-17 11:13:37,536 NMI: 21.476
2020-09-17 11:15:10,946 R@1 : 38.650
2020-09-17 11:15:11,712 R@2 : 46.825
2020-09-17 11:15:12,455 R@4 : 55.645
2020-09-17 11:15:13,212 R@8 : 64.712
2020-09-17 11:17:58,112 Epoch: 27, loss: 1.163, time (seconds): 164.90.
2020-09-17 11:17:58,606 **Evaluating.**
2020-09-17 11:20:25,013 NMI: 22.117
2020-09-17 11:22:00,205 R@1 : 39.033
2020-09-17 11:22:00,983 R@2 : 47.348
2020-09-17 11:22:01,762 R@4 : 56.513
2020-09-17 11:22:02,542 R@8 : 65.002
2020-09-17 11:24:54,548 Epoch: 28, loss: 1.176, time (seconds): 172.00.
2020-09-17 11:24:54,549 **Evaluating.**
2020-09-17 11:27:28,890 NMI: 21.342
2020-09-17 11:29:03,909 R@1 : 38.842
2020-09-17 11:29:04,694 R@2 : 46.721
2020-09-17 11:29:05,474 R@4 : 55.137
2020-09-17 11:29:06,253 R@8 : 64.108
2020-09-17 11:31:52,833 Epoch: 29, loss: 1.129, time (seconds): 166.58.
2020-09-17 11:31:52,834 **Evaluating.**
2020-09-17 11:34:19,457 NMI: 21.767
2020-09-17 11:35:54,522 R@1 : 38.604
2020-09-17 11:35:55,303 R@2 : 46.666
2020-09-17 11:35:56,085 R@4 : 55.517
2020-09-17 11:35:56,865 R@8 : 64.509
2020-09-17 11:38:59,717 Epoch: 30, loss: 1.201, time (seconds): 182.85.
2020-09-17 11:38:59,718 **Evaluating.**
2020-09-17 11:41:28,634 NMI: 21.562
2020-09-17 11:43:04,121 R@1 : 38.354
2020-09-17 11:43:04,898 R@2 : 46.291
2020-09-17 11:43:05,677 R@4 : 54.890
2020-09-17 11:43:06,456 R@8 : 63.780
2020-09-17 11:45:51,939 Epoch: 31, loss: 1.134, time (seconds): 165.48.
2020-09-17 11:45:51,940 **Evaluating.**
2020-09-17 11:48:12,517 NMI: 21.607
2020-09-17 11:49:47,753 R@1 : 38.252
2020-09-17 11:49:48,551 R@2 : 46.129
2020-09-17 11:49:49,333 R@4 : 54.786
2020-09-17 11:49:50,120 R@8 : 64.210
2020-09-17 11:52:45,452 Epoch: 32, loss: 1.075, time (seconds): 175.33.
2020-09-17 11:52:45,453 **Evaluating.**
2020-09-17 11:55:17,358 NMI: 21.772
2020-09-17 11:56:52,289 R@1 : 38.508
2020-09-17 11:56:53,066 R@2 : 46.413
2020-09-17 11:56:53,845 R@4 : 54.948
2020-09-17 11:56:54,624 R@8 : 63.963
2020-09-17 11:59:42,152 Epoch: 33, loss: 1.055, time (seconds): 167.53.
2020-09-17 11:59:42,153 **Evaluating.**
2020-09-17 12:02:07,566 NMI: 21.208
2020-09-17 12:03:43,500 R@1 : 37.541
2020-09-17 12:03:44,281 R@2 : 45.484
2020-09-17 12:03:45,063 R@4 : 54.069
2020-09-17 12:03:45,869 R@8 : 63.347
2020-09-17 12:06:47,878 Epoch: 34, loss: 0.996, time (seconds): 182.01.
2020-09-17 12:06:47,879 **Evaluating.**
2020-09-17 12:09:20,063 NMI: 21.649
2020-09-17 12:10:55,036 R@1 : 38.293
2020-09-17 12:10:55,835 R@2 : 46.402
2020-09-17 12:10:56,618 R@4 : 54.943
2020-09-17 12:10:57,397 R@8 : 63.974
2020-09-17 12:13:56,833 Epoch: 35, loss: 1.065, time (seconds): 179.43.
2020-09-17 12:13:56,834 **Evaluating.**
2020-09-17 12:16:16,857 NMI: 20.952
2020-09-17 12:17:51,583 R@1 : 37.338
2020-09-17 12:17:52,412 R@2 : 45.531
2020-09-17 12:17:53,247 R@4 : 54.377
2020-09-17 12:17:54,076 R@8 : 63.339
2020-09-17 12:20:49,204 Epoch: 36, loss: 1.004, time (seconds): 175.12.
2020-09-17 12:20:49,205 **Evaluating.**
2020-09-17 12:23:21,835 NMI: 20.760
2020-09-17 12:24:56,867 R@1 : 37.312
2020-09-17 12:24:57,649 R@2 : 44.927
2020-09-17 12:24:58,427 R@4 : 53.787
2020-09-17 12:24:59,207 R@8 : 62.906
2020-09-17 12:27:49,798 Epoch: 37, loss: 1.017, time (seconds): 170.59.
2020-09-17 12:27:49,799 **Evaluating.**
2020-09-17 12:30:13,213 NMI: 21.315
2020-09-17 12:31:48,366 R@1 : 37.587
2020-09-17 12:31:49,144 R@2 : 45.554
2020-09-17 12:31:49,923 R@4 : 54.356
2020-09-17 12:31:50,706 R@8 : 63.350
2020-09-17 12:34:57,016 Epoch: 38, loss: 0.978, time (seconds): 186.31.
2020-09-17 12:34:57,017 **Evaluating.**
2020-09-17 12:37:29,038 NMI: 21.202
2020-09-17 12:39:07,467 R@1 : 37.651
2020-09-17 12:39:08,264 R@2 : 45.600
2020-09-17 12:39:09,051 R@4 : 54.231
2020-09-17 12:39:09,835 R@8 : 63.614
2020-09-17 12:42:02,074 Epoch: 39, loss: 1.048, time (seconds): 172.23.
2020-09-17 12:42:02,075 **Evaluating.**
2020-09-17 12:44:39,402 NMI: 20.653
2020-09-17 12:46:17,489 R@1 : 37.280
2020-09-17 12:46:18,278 R@2 : 45.052
2020-09-17 12:46:19,059 R@4 : 53.413
2020-09-17 12:46:19,850 R@8 : 62.505
2020-09-17 12:46:19,853 Total training time (minutes): 266.05.
2020-09-17 12:46:22,634 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 40, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food-20200917-002312', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-17 12:46:22,635 Training for 40 epochs
2020-09-17 12:46:22,637 **Evaluating initial model.**
2020-09-17 12:48:28,121 NMI: 24.435
2020-09-17 12:50:06,434 R@1 : 42.006
2020-09-17 12:50:07,256 R@2 : 50.544
2020-09-17 12:50:08,076 R@4 : 59.936
2020-09-17 12:50:08,906 R@8 : 69.261
2020-09-17 12:52:31,663 Epoch: 0, loss: 2.189, time (seconds): 142.76.
2020-09-17 12:52:31,664 **Evaluating.**
2020-09-17 12:54:42,496 NMI: 31.936
2020-09-17 12:56:14,764 R@1 : 50.025
2020-09-17 12:56:15,544 R@2 : 58.818
2020-09-17 12:56:16,326 R@4 : 67.397
2020-09-17 12:56:17,106 R@8 : 75.311
2020-09-17 12:58:46,589 Epoch: 1, loss: 2.033, time (seconds): 149.48.
2020-09-17 12:58:46,591 **Evaluating.**
2020-09-17 13:01:03,909 NMI: 31.563
2020-09-17 13:02:39,382 R@1 : 50.838
2020-09-17 13:02:40,210 R@2 : 59.739
2020-09-17 13:02:41,031 R@4 : 68.257
2020-09-17 13:02:41,855 R@8 : 76.069
2020-09-17 13:05:29,678 Epoch: 2, loss: 1.938, time (seconds): 167.82.
2020-09-17 13:05:29,679 **Evaluating.**
2020-09-17 13:07:30,194 NMI: 31.413
2020-09-17 13:09:05,669 R@1 : 49.967
2020-09-17 13:09:06,456 R@2 : 58.801
2020-09-17 13:09:07,244 R@4 : 67.574
2020-09-17 13:09:08,025 R@8 : 75.448
2020-09-17 13:11:50,971 Epoch: 3, loss: 1.843, time (seconds): 162.94.
2020-09-17 13:11:50,972 **Evaluating.**
2020-09-17 13:13:49,177 NMI: 31.005
2020-09-17 13:15:24,593 R@1 : 49.479
2020-09-17 13:15:25,381 R@2 : 58.351
2020-09-17 13:15:26,171 R@4 : 67.211
2020-09-17 13:15:26,963 R@8 : 75.491
2020-09-17 13:18:13,995 Epoch: 4, loss: 1.756, time (seconds): 167.03.
2020-09-17 13:18:13,996 **Evaluating.**
2020-09-17 13:20:20,698 NMI: 30.018
2020-09-17 13:21:54,642 R@1 : 48.744
2020-09-17 13:21:55,421 R@2 : 57.381
2020-09-17 13:21:56,203 R@4 : 66.320
2020-09-17 13:21:56,981 R@8 : 74.246
2020-09-17 13:24:33,114 Epoch: 5, loss: 1.711, time (seconds): 156.13.
2020-09-17 13:24:33,115 **Evaluating.**
2020-09-17 13:26:27,119 NMI: 29.180
2020-09-17 13:28:00,266 R@1 : 48.170
2020-09-17 13:28:01,052 R@2 : 57.120
2020-09-17 13:28:01,830 R@4 : 65.812
2020-09-17 13:28:02,612 R@8 : 74.214
2020-09-17 13:30:34,455 Epoch: 6, loss: 1.686, time (seconds): 151.84.
2020-09-17 13:30:34,456 **Evaluating.**
2020-09-17 13:32:30,263 NMI: 27.970
2020-09-17 13:34:03,625 R@1 : 47.659
2020-09-17 13:34:04,409 R@2 : 56.478
2020-09-17 13:34:05,188 R@4 : 65.211
2020-09-17 13:34:05,970 R@8 : 73.265
2020-09-17 13:36:43,424 Epoch: 7, loss: 1.610, time (seconds): 157.45.
2020-09-17 13:36:43,425 **Evaluating.**
2020-09-17 13:39:08,072 NMI: 28.508
2020-09-17 13:40:46,756 R@1 : 47.481
2020-09-17 13:40:47,536 R@2 : 56.322
2020-09-17 13:40:48,323 R@4 : 65.330
2020-09-17 13:40:49,105 R@8 : 73.479
2020-09-17 13:43:46,694 Epoch: 8, loss: 1.602, time (seconds): 177.59.
2020-09-17 13:43:46,695 **Evaluating.**
2020-09-17 13:47:03,920 NMI: 27.572
2020-09-17 13:48:42,824 R@1 : 46.207
2020-09-17 13:48:43,698 R@2 : 55.166
2020-09-17 13:48:44,565 R@4 : 64.247
2020-09-17 13:48:45,408 R@8 : 72.591
2020-09-17 13:51:46,864 Epoch: 9, loss: 1.544, time (seconds): 181.45.
2020-09-17 13:51:46,865 **Evaluating.**
2020-09-17 13:55:00,151 NMI: 26.400
2020-09-17 13:56:41,144 R@1 : 45.702
2020-09-17 13:56:41,944 R@2 : 54.565
2020-09-17 13:56:42,754 R@4 : 63.446
2020-09-17 13:56:43,558 R@8 : 71.799
2020-09-17 13:59:37,259 Epoch: 10, loss: 1.492, time (seconds): 173.67.
2020-09-17 13:59:37,260 **Evaluating.**
2020-09-17 14:02:51,887 NMI: 26.805
2020-09-17 14:04:29,373 R@1 : 46.027
2020-09-17 14:04:30,156 R@2 : 54.684
2020-09-17 14:04:30,937 R@4 : 63.484
2020-09-17 14:04:31,716 R@8 : 72.124
2020-09-17 14:07:21,791 Epoch: 11, loss: 1.468, time (seconds): 170.07.
2020-09-17 14:07:21,792 **Evaluating.**
2020-09-17 14:09:26,258 NMI: 26.695
2020-09-17 14:11:01,119 R@1 : 45.362
2020-09-17 14:11:01,902 R@2 : 54.365
2020-09-17 14:11:02,679 R@4 : 63.368
2020-09-17 14:11:03,462 R@8 : 71.819
2020-09-17 14:13:46,784 Epoch: 12, loss: 1.419, time (seconds): 163.27.
2020-09-17 14:13:46,785 **Evaluating.**
2020-09-17 14:15:45,051 NMI: 26.365
2020-09-17 14:17:22,253 R@1 : 45.104
2020-09-17 14:17:23,055 R@2 : 54.005
2020-09-17 14:17:23,840 R@4 : 62.831
2020-09-17 14:17:24,628 R@8 : 71.079
2020-09-17 14:20:07,854 Epoch: 13, loss: 1.402, time (seconds): 163.21.
2020-09-17 14:20:07,855 **Evaluating.**
2020-09-17 14:22:07,275 NMI: 26.110
2020-09-17 14:23:44,320 R@1 : 44.663
2020-09-17 14:23:45,117 R@2 : 53.398
2020-09-17 14:23:45,908 R@4 : 62.564
2020-09-17 14:23:46,717 R@8 : 70.878
2020-09-17 14:26:28,368 Epoch: 14, loss: 1.373, time (seconds): 161.63.
2020-09-17 14:26:28,369 **Evaluating.**
2020-09-17 14:28:27,621 NMI: 25.506
2020-09-17 14:30:04,386 R@1 : 43.902
2020-09-17 14:30:05,174 R@2 : 52.751
2020-09-17 14:30:05,982 R@4 : 61.817
2020-09-17 14:30:06,764 R@8 : 70.361
2020-09-17 14:32:49,222 Epoch: 15, loss: 1.342, time (seconds): 162.45.
2020-09-17 14:32:49,223 **Evaluating.**
2020-09-17 14:34:49,051 NMI: 25.155
2020-09-17 14:36:25,936 R@1 : 43.318
2020-09-17 14:36:26,726 R@2 : 52.019
2020-09-17 14:36:27,511 R@4 : 61.094
2020-09-17 14:36:28,292 R@8 : 69.714
2020-09-17 14:39:14,408 Epoch: 16, loss: 1.347, time (seconds): 166.10.
2020-09-17 14:39:14,409 **Evaluating.**
2020-09-17 14:41:12,545 NMI: 24.723
2020-09-17 14:42:49,924 R@1 : 42.982
2020-09-17 14:42:50,709 R@2 : 51.523
2020-09-17 14:42:51,501 R@4 : 60.377
2020-09-17 14:42:52,283 R@8 : 69.009
2020-09-17 14:45:29,083 Epoch: 17, loss: 1.280, time (seconds): 156.77.
2020-09-17 14:45:29,085 **Evaluating.**
2020-09-17 14:47:48,936 NMI: 24.528
2020-09-17 14:49:24,200 R@1 : 42.508
2020-09-17 14:49:24,975 R@2 : 51.052
2020-09-17 14:49:25,752 R@4 : 59.980
2020-09-17 14:49:26,533 R@8 : 68.689
2020-09-17 14:52:03,210 Epoch: 18, loss: 1.328, time (seconds): 156.16.
2020-09-17 14:52:03,211 **Evaluating.**
2020-09-17 14:53:58,140 NMI: 24.172
2020-09-17 14:55:33,143 R@1 : 41.608
2020-09-17 14:55:33,921 R@2 : 50.295
2020-09-17 14:55:34,702 R@4 : 59.390
2020-09-17 14:55:35,483 R@8 : 68.210
2020-09-17 14:58:05,187 Epoch: 19, loss: 1.305, time (seconds): 149.70.
2020-09-17 14:58:05,188 **Evaluating.**
2020-09-17 15:00:01,616 NMI: 24.155
2020-09-17 15:01:36,336 R@1 : 41.751
2020-09-17 15:01:37,169 R@2 : 49.929
2020-09-17 15:01:37,992 R@4 : 59.001
2020-09-17 15:01:38,819 R@8 : 68.039
2020-09-17 15:04:04,812 Epoch: 20, loss: 1.288, time (seconds): 145.98.
2020-09-17 15:04:04,813 **Evaluating.**
2020-09-17 15:06:26,596 NMI: 24.097
2020-09-17 15:08:01,620 R@1 : 41.899
2020-09-17 15:08:02,408 R@2 : 50.385
2020-09-17 15:08:03,191 R@4 : 59.170
2020-09-17 15:08:03,979 R@8 : 68.024
2020-09-17 15:10:33,903 Epoch: 21, loss: 1.276, time (seconds): 149.91.
2020-09-17 15:10:33,904 **Evaluating.**
2020-09-17 15:12:37,953 NMI: 24.087
2020-09-17 15:14:13,034 R@1 : 41.457
2020-09-17 15:14:13,823 R@2 : 50.167
2020-09-17 15:14:14,608 R@4 : 59.097
2020-09-17 15:14:15,397 R@8 : 68.059
2020-09-17 15:16:44,417 Epoch: 22, loss: 1.246, time (seconds): 149.00.
2020-09-17 15:16:44,418 **Evaluating.**
2020-09-17 15:19:01,196 NMI: 24.281
2020-09-17 15:20:36,216 R@1 : 41.640
2020-09-17 15:20:36,997 R@2 : 50.057
2020-09-17 15:20:37,779 R@4 : 58.955
2020-09-17 15:20:38,559 R@8 : 67.699
2020-09-17 15:23:01,052 Epoch: 23, loss: 1.219, time (seconds): 142.49.
2020-09-17 15:23:01,053 **Evaluating.**
2020-09-17 15:25:12,223 NMI: 24.155
2020-09-17 15:26:47,193 R@1 : 41.240
2020-09-17 15:26:47,982 R@2 : 49.920
2020-09-17 15:26:48,772 R@4 : 59.056
2020-09-17 15:26:49,555 R@8 : 68.106
2020-09-17 15:29:20,749 Epoch: 24, loss: 1.229, time (seconds): 151.19.
2020-09-17 15:29:20,750 **Evaluating.**
2020-09-17 15:31:30,504 NMI: 23.728
2020-09-17 15:33:05,414 R@1 : 41.103
2020-09-17 15:33:06,196 R@2 : 49.929
2020-09-17 15:33:06,976 R@4 : 58.816
2020-09-17 15:33:07,763 R@8 : 67.490
2020-09-17 15:35:24,810 Epoch: 25, loss: 1.205, time (seconds): 137.04.
2020-09-17 15:35:24,811 **Evaluating.**
2020-09-17 15:37:34,946 NMI: 23.757
2020-09-17 15:39:09,003 R@1 : 40.929
2020-09-17 15:39:09,781 R@2 : 49.310
2020-09-17 15:39:10,559 R@4 : 58.287
2020-09-17 15:39:11,340 R@8 : 67.264
2020-09-17 15:41:44,844 Epoch: 26, loss: 1.183, time (seconds): 153.50.
2020-09-17 15:41:44,845 **Evaluating.**
2020-09-17 15:44:01,316 NMI: 23.318
2020-09-17 15:45:36,539 R@1 : 40.717
2020-09-17 15:45:37,329 R@2 : 49.142
2020-09-17 15:45:38,105 R@4 : 58.096
2020-09-17 15:45:38,883 R@8 : 67.061
2020-09-17 15:47:59,152 Epoch: 27, loss: 1.222, time (seconds): 140.27.
2020-09-17 15:47:59,154 **Evaluating.**
2020-09-17 15:50:13,030 NMI: 23.015
2020-09-17 15:51:46,542 R@1 : 40.705
2020-09-17 15:51:47,298 R@2 : 48.901
2020-09-17 15:51:48,052 R@4 : 57.817
2020-09-17 15:51:48,803 R@8 : 66.747
2020-09-17 15:54:03,995 Epoch: 28, loss: 1.163, time (seconds): 135.19.
2020-09-17 15:54:03,996 **Evaluating.**
2020-09-17 15:56:03,039 NMI: 23.100
2020-09-17 15:57:38,304 R@1 : 40.142
2020-09-17 15:57:39,256 R@2 : 48.649
2020-09-17 15:57:40,219 R@4 : 57.402
2020-09-17 15:57:41,177 R@8 : 66.390
2020-09-17 15:59:58,436 Epoch: 29, loss: 1.168, time (seconds): 137.25.
2020-09-17 15:59:58,437 **Evaluating.**
2020-09-17 16:02:11,437 NMI: 22.749
2020-09-17 16:03:46,183 R@1 : 39.872
2020-09-17 16:03:46,979 R@2 : 48.286
2020-09-17 16:03:47,755 R@4 : 57.149
2020-09-17 16:03:48,537 R@8 : 66.166
2020-09-17 16:06:23,492 Epoch: 30, loss: 1.172, time (seconds): 154.95.
2020-09-17 16:06:23,494 **Evaluating.**
2020-09-17 16:08:21,344 NMI: 22.617
2020-09-17 16:09:56,934 R@1 : 39.358
2020-09-17 16:09:57,727 R@2 : 47.894
2020-09-17 16:09:58,509 R@4 : 56.966
2020-09-17 16:09:59,293 R@8 : 65.908
2020-09-17 16:12:40,311 Epoch: 31, loss: 1.167, time (seconds): 161.01.
2020-09-17 16:12:40,312 **Evaluating.**
2020-09-17 16:14:35,711 NMI: 22.810
2020-09-17 16:16:11,097 R@1 : 39.588
2020-09-17 16:16:11,877 R@2 : 47.931
2020-09-17 16:16:12,661 R@4 : 56.603
2020-09-17 16:16:13,449 R@8 : 65.748
2020-09-17 16:18:52,883 Epoch: 32, loss: 1.174, time (seconds): 159.43.
2020-09-17 16:18:52,884 **Evaluating.**
2020-09-17 16:20:50,016 NMI: 22.678
2020-09-17 16:22:24,975 R@1 : 39.579
2020-09-17 16:22:25,769 R@2 : 48.111
2020-09-17 16:22:26,550 R@4 : 56.917
2020-09-17 16:22:27,335 R@8 : 65.832
2020-09-17 16:25:08,653 Epoch: 33, loss: 1.147, time (seconds): 161.32.
2020-09-17 16:25:08,654 **Evaluating.**
2020-09-17 16:27:04,678 NMI: 22.610
2020-09-17 16:28:40,385 R@1 : 39.173
2020-09-17 16:28:41,167 R@2 : 47.920
2020-09-17 16:28:41,948 R@4 : 57.172
2020-09-17 16:28:42,729 R@8 : 66.187
2020-09-17 16:31:18,585 Epoch: 34, loss: 1.142, time (seconds): 155.85.
2020-09-17 16:31:18,586 **Evaluating.**
2020-09-17 16:33:13,860 NMI: 22.643
2020-09-17 16:34:48,715 R@1 : 39.570
2020-09-17 16:34:49,546 R@2 : 47.873
2020-09-17 16:34:50,382 R@4 : 56.769
2020-09-17 16:34:51,218 R@8 : 65.737
2020-09-17 16:37:32,921 Epoch: 35, loss: 1.140, time (seconds): 161.70.
2020-09-17 16:37:32,922 **Evaluating.**
2020-09-17 16:39:27,672 NMI: 22.849
2020-09-17 16:41:02,475 R@1 : 39.318
2020-09-17 16:41:03,253 R@2 : 47.516
2020-09-17 16:41:04,040 R@4 : 56.397
2020-09-17 16:41:04,819 R@8 : 65.467
2020-09-17 16:43:42,453 Epoch: 36, loss: 1.144, time (seconds): 157.63.
2020-09-17 16:43:42,454 **Evaluating.**
2020-09-17 16:45:35,088 NMI: 22.408
2020-09-17 16:47:10,313 R@1 : 39.039
2020-09-17 16:47:11,091 R@2 : 47.348
2020-09-17 16:47:11,873 R@4 : 56.307
2020-09-17 16:47:12,654 R@8 : 65.345
2020-09-17 16:49:55,164 Epoch: 37, loss: 1.108, time (seconds): 162.51.
2020-09-17 16:49:55,165 **Evaluating.**
2020-09-17 16:51:49,998 NMI: 22.551
2020-09-17 16:53:25,731 R@1 : 38.804
2020-09-17 16:53:26,510 R@2 : 46.994
2020-09-17 16:53:27,310 R@4 : 56.281
2020-09-17 16:53:28,095 R@8 : 65.200
2020-09-17 16:56:07,765 Epoch: 38, loss: 1.094, time (seconds): 159.67.
2020-09-17 16:56:07,766 **Evaluating.**
2020-09-17 16:58:03,663 NMI: 22.288
2020-09-17 16:59:38,733 R@1 : 38.667
2020-09-17 16:59:39,563 R@2 : 47.078
2020-09-17 16:59:40,391 R@4 : 56.191
2020-09-17 16:59:41,221 R@8 : 65.205
2020-09-17 17:02:21,350 Epoch: 39, loss: 1.123, time (seconds): 160.13.
2020-09-17 17:02:21,352 **Evaluating.**
2020-09-17 17:04:16,743 NMI: 22.214
2020-09-17 17:05:53,942 R@1 : 38.670
2020-09-17 17:05:54,765 R@2 : 46.982
2020-09-17 17:05:55,587 R@4 : 55.831
2020-09-17 17:05:56,411 R@8 : 64.805
2020-09-17 17:05:56,413 Total training time (minutes): 259.56.
2020-09-17 17:05:59,560 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 40, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200917-002312', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-17 17:05:59,561 Training for 40 epochs
2020-09-17 17:05:59,564 **Evaluating initial model.**
2020-09-17 17:09:18,721 NMI: 24.435
2020-09-17 17:10:55,589 R@1 : 42.006
2020-09-17 17:10:56,415 R@2 : 50.544
2020-09-17 17:10:57,243 R@4 : 59.936
2020-09-17 17:10:58,075 R@8 : 69.261
2020-09-17 17:14:12,248 Epoch: 0, loss: 2.305, time (seconds): 194.17.
2020-09-17 17:14:12,249 **Evaluating.**
2020-09-17 17:16:55,178 NMI: 28.595
2020-09-17 17:18:26,701 R@1 : 45.185
2020-09-17 17:18:27,479 R@2 : 54.144
2020-09-17 17:18:28,264 R@4 : 63.754
2020-09-17 17:18:29,051 R@8 : 72.948
2020-09-17 17:21:25,218 Epoch: 1, loss: 2.162, time (seconds): 176.16.
2020-09-17 17:21:25,220 **Evaluating.**
2020-09-17 17:23:57,754 NMI: 29.661
2020-09-17 17:25:30,620 R@1 : 47.238
2020-09-17 17:25:31,397 R@2 : 56.499
2020-09-17 17:25:32,181 R@4 : 65.737
2020-09-17 17:25:32,961 R@8 : 74.594
2020-09-17 17:28:32,007 Epoch: 2, loss: 1.999, time (seconds): 179.04.
2020-09-17 17:28:32,009 **Evaluating.**
2020-09-17 17:30:55,024 NMI: 28.953
2020-09-17 17:32:32,386 R@1 : 47.249
2020-09-17 17:32:33,204 R@2 : 56.179
2020-09-17 17:32:34,005 R@4 : 65.025
2020-09-17 17:32:34,801 R@8 : 73.596
2020-09-17 17:35:27,187 Epoch: 3, loss: 1.855, time (seconds): 172.38.
2020-09-17 17:35:27,188 **Evaluating.**
2020-09-17 17:38:09,113 NMI: 29.567
2020-09-17 17:39:44,035 R@1 : 48.469
2020-09-17 17:39:44,828 R@2 : 57.573
2020-09-17 17:39:45,610 R@4 : 66.402
2020-09-17 17:39:46,395 R@8 : 74.917
