2020-09-23 15:53:43,001 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 10, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 15.0, 'lr_proxynca': 1, 'log_filename': 'food-20200923-155336', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 1, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-23 15:53:43,002 Training for 10 epochs
2020-09-23 15:53:43,004 **Evaluating initial model.**
2020-09-23 15:57:03,504 NMI: 24.435
2020-09-23 15:58:42,414 R@1 : 42.006
2020-09-23 15:58:43,155 R@2 : 50.544
2020-09-23 15:58:43,892 R@4 : 59.936
2020-09-23 15:58:44,633 R@8 : 69.261
2020-09-23 16:01:53,531 Epoch: 0, loss: 2.478, time (seconds): 188.89.
2020-09-23 16:01:53,532 **Evaluating.**
2020-09-23 16:05:06,819 NMI: 27.907
2020-09-23 16:06:38,641 R@1 : 43.162
2020-09-23 16:06:39,427 R@2 : 52.603
2020-09-23 16:06:40,230 R@4 : 62.424
2020-09-23 16:06:41,018 R@8 : 71.598
2020-09-23 16:09:40,511 Epoch: 1, loss: 2.278, time (seconds): 179.48.
2020-09-23 16:09:40,512 **Evaluating.**
2020-09-23 16:12:51,948 NMI: 28.437
2020-09-23 16:14:25,311 R@1 : 45.356
2020-09-23 16:14:26,044 R@2 : 54.493
2020-09-23 16:14:26,794 R@4 : 64.189
2020-09-23 16:14:27,527 R@8 : 73.015
2020-09-23 16:17:32,506 Epoch: 2, loss: 2.099, time (seconds): 184.97.
2020-09-23 16:17:32,507 **Evaluating.**
2020-09-23 16:20:40,778 NMI: 29.245
2020-09-23 16:22:15,748 R@1 : 46.489
2020-09-23 16:22:16,541 R@2 : 55.381
2020-09-23 16:22:17,323 R@4 : 64.930
2020-09-23 16:22:18,104 R@8 : 73.448
2020-09-23 16:25:20,927 Epoch: 3, loss: 1.903, time (seconds): 182.82.
2020-09-23 16:25:20,928 **Evaluating.**
2020-09-23 16:28:30,645 NMI: 29.427
2020-09-23 16:30:04,073 R@1 : 47.551
2020-09-23 16:30:04,805 R@2 : 56.528
2020-09-23 16:30:05,539 R@4 : 65.644
2020-09-23 16:30:06,269 R@8 : 74.348
2020-09-23 16:32:59,374 Epoch: 4, loss: 1.924, time (seconds): 173.10.
2020-09-23 16:32:59,375 **Evaluating.**
2020-09-23 16:36:02,661 NMI: 29.574
2020-09-23 16:37:37,629 R@1 : 47.534
2020-09-23 16:37:38,398 R@2 : 56.554
2020-09-23 16:37:39,142 R@4 : 65.876
2020-09-23 16:37:39,876 R@8 : 74.539
2020-09-23 16:40:32,780 Epoch: 5, loss: 1.768, time (seconds): 172.90.
2020-09-23 16:40:32,781 **Evaluating.**
2020-09-23 16:43:25,108 NMI: 28.661
2020-09-23 16:45:00,419 R@1 : 47.037
2020-09-23 16:45:01,154 R@2 : 56.127
2020-09-23 16:45:01,884 R@4 : 65.519
2020-09-23 16:45:02,624 R@8 : 74.554
2020-09-23 16:47:58,765 Epoch: 6, loss: 1.835, time (seconds): 176.14.
2020-09-23 16:47:58,765 **Evaluating.**
2020-09-23 16:50:32,272 NMI: 28.760
2020-09-23 16:52:08,892 R@1 : 46.857
2020-09-23 16:52:09,621 R@2 : 55.808
2020-09-23 16:52:10,356 R@4 : 65.057
2020-09-23 16:52:11,085 R@8 : 74.133
2020-09-23 16:55:06,318 Epoch: 7, loss: 1.716, time (seconds): 175.23.
2020-09-23 16:55:06,318 **Evaluating.**
2020-09-23 16:57:21,574 NMI: 29.287
2020-09-23 16:58:57,745 R@1 : 47.998
2020-09-23 16:58:58,483 R@2 : 56.609
2020-09-23 16:58:59,221 R@4 : 65.606
2020-09-23 16:58:59,952 R@8 : 74.165
2020-09-23 17:01:55,375 Epoch: 8, loss: 1.705, time (seconds): 175.42.
2020-09-23 17:01:55,376 **Evaluating.**
2020-09-23 17:03:56,379 NMI: 29.166
2020-09-23 17:05:27,167 R@1 : 48.303
2020-09-23 17:05:27,898 R@2 : 57.399
2020-09-23 17:05:28,632 R@4 : 66.288
2020-09-23 17:05:29,366 R@8 : 74.475
2020-09-23 17:08:14,272 Epoch: 9, loss: 1.615, time (seconds): 164.90.
2020-09-23 17:08:14,273 **Evaluating.**
2020-09-23 17:10:23,395 NMI: 28.614
2020-09-23 17:11:54,054 R@1 : 48.196
2020-09-23 17:11:54,786 R@2 : 57.155
2020-09-23 17:11:55,517 R@4 : 66.062
2020-09-23 17:11:56,248 R@8 : 74.371
2020-09-23 17:11:56,251 Total training time (minutes): 78.22.
2020-09-23 17:11:59,029 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 10, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 15.0, 'lr_proxynca': 1, 'log_filename': 'food-20200923-155336', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 1, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-23 17:11:59,030 Training for 10 epochs
2020-09-23 17:11:59,045 **Evaluating initial model.**
2020-09-23 17:13:55,249 NMI: 24.435
2020-09-23 17:15:31,135 R@1 : 42.006
2020-09-23 17:15:31,868 R@2 : 50.544
2020-09-23 17:15:32,607 R@4 : 59.936
2020-09-23 17:15:33,341 R@8 : 69.261
2020-09-23 17:17:50,379 Epoch: 0, loss: 2.661, time (seconds): 137.04.
2020-09-23 17:17:50,379 **Evaluating.**
2020-09-23 17:20:01,102 NMI: 27.274
2020-09-23 17:21:26,342 R@1 : 43.167
2020-09-23 17:21:27,091 R@2 : 52.426
2020-09-23 17:21:27,820 R@4 : 62.099
2020-09-23 17:21:28,550 R@8 : 71.462
2020-09-23 17:23:34,364 Epoch: 1, loss: 2.252, time (seconds): 125.81.
2020-09-23 17:23:34,365 **Evaluating.**
2020-09-23 17:25:43,706 NMI: 29.645
2020-09-23 17:27:11,454 R@1 : 46.822
2020-09-23 17:27:12,230 R@2 : 56.261
2020-09-23 17:27:13,007 R@4 : 65.713
2020-09-23 17:27:13,789 R@8 : 74.275
2020-09-23 17:29:28,342 Epoch: 2, loss: 2.101, time (seconds): 134.55.
2020-09-23 17:29:28,343 **Evaluating.**
2020-09-23 17:31:28,677 NMI: 31.140
2020-09-23 17:32:57,188 R@1 : 48.355
2020-09-23 17:32:57,920 R@2 : 57.878
2020-09-23 17:32:58,660 R@4 : 66.953
2020-09-23 17:32:59,418 R@8 : 75.250
2020-09-23 17:35:16,740 Epoch: 3, loss: 1.961, time (seconds): 137.32.
2020-09-23 17:35:16,741 **Evaluating.**
2020-09-23 17:37:20,041 NMI: 31.502
2020-09-23 17:38:48,986 R@1 : 48.715
2020-09-23 17:38:49,753 R@2 : 58.023
2020-09-23 17:38:50,492 R@4 : 67.310
2020-09-23 17:38:51,239 R@8 : 75.570
2020-09-23 17:40:53,517 Epoch: 4, loss: 1.864, time (seconds): 122.27.
2020-09-23 17:40:53,517 **Evaluating.**
2020-09-23 17:43:05,931 NMI: 30.791
2020-09-23 17:44:36,566 R@1 : 48.840
2020-09-23 17:44:37,321 R@2 : 58.055
2020-09-23 17:44:38,059 R@4 : 67.174
2020-09-23 17:44:38,797 R@8 : 75.494
2020-09-23 17:46:54,765 Epoch: 5, loss: 1.797, time (seconds): 135.97.
2020-09-23 17:46:54,765 **Evaluating.**
2020-09-23 17:48:52,620 NMI: 30.756
2020-09-23 17:50:23,741 R@1 : 48.942
2020-09-23 17:50:24,483 R@2 : 58.104
2020-09-23 17:50:25,223 R@4 : 67.313
2020-09-23 17:50:25,964 R@8 : 75.483
2020-09-23 17:52:42,279 Epoch: 6, loss: 1.752, time (seconds): 136.31.
2020-09-23 17:52:42,280 **Evaluating.**
2020-09-23 17:54:43,205 NMI: 30.657
2020-09-23 17:56:14,666 R@1 : 49.000
2020-09-23 17:56:15,405 R@2 : 58.000
2020-09-23 17:56:16,144 R@4 : 67.325
2020-09-23 17:56:16,878 R@8 : 75.697
2020-09-23 17:58:20,956 Epoch: 7, loss: 1.691, time (seconds): 124.07.
2020-09-23 17:58:20,957 **Evaluating.**
2020-09-23 18:00:27,860 NMI: 31.842
2020-09-23 18:01:59,741 R@1 : 49.502
2020-09-23 18:02:00,521 R@2 : 58.662
2020-09-23 18:02:01,304 R@4 : 67.583
2020-09-23 18:02:02,085 R@8 : 76.113
2020-09-23 18:04:18,671 Epoch: 8, loss: 1.667, time (seconds): 136.58.
2020-09-23 18:04:18,671 **Evaluating.**
2020-09-23 18:06:15,348 NMI: 30.883
2020-09-23 18:07:48,503 R@1 : 48.863
2020-09-23 18:07:49,243 R@2 : 58.020
2020-09-23 18:07:49,993 R@4 : 67.313
2020-09-23 18:07:50,729 R@8 : 75.671
2020-09-23 18:10:12,062 Epoch: 9, loss: 1.594, time (seconds): 141.33.
2020-09-23 18:10:12,063 **Evaluating.**
2020-09-23 18:12:13,385 NMI: 30.202
2020-09-23 18:13:46,053 R@1 : 48.422
2020-09-23 18:13:46,833 R@2 : 57.616
2020-09-23 18:13:47,616 R@4 : 66.912
2020-09-23 18:13:48,399 R@8 : 75.277
2020-09-23 18:13:48,401 Total training time (minutes): 61.82.
2020-09-23 18:13:50,880 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 10, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 15.0, 'lr_proxynca': 1, 'log_filename': 'food-20200923-155336', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 2, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-23 18:13:50,880 Training for 10 epochs
2020-09-23 18:13:50,882 **Evaluating initial model.**
2020-09-23 18:16:06,504 NMI: 24.435
2020-09-23 18:17:41,911 R@1 : 42.006
2020-09-23 18:17:42,691 R@2 : 50.544
2020-09-23 18:17:43,473 R@4 : 59.936
2020-09-23 18:17:44,272 R@8 : 69.261
2020-09-23 18:20:24,741 Epoch: 0, loss: 2.478, time (seconds): 160.47.
2020-09-23 18:20:24,754 **Evaluating.**
2020-09-23 18:22:47,894 NMI: 27.907
2020-09-23 18:24:16,125 R@1 : 43.162
2020-09-23 18:24:16,862 R@2 : 52.603
2020-09-23 18:24:17,592 R@4 : 62.424
2020-09-23 18:24:18,328 R@8 : 71.598
2020-09-23 18:26:53,688 Epoch: 1, loss: 2.278, time (seconds): 155.36.
2020-09-23 18:26:53,689 **Evaluating.**
2020-09-23 18:29:13,620 NMI: 28.437
2020-09-23 18:30:43,441 R@1 : 45.356
2020-09-23 18:30:44,173 R@2 : 54.493
2020-09-23 18:30:44,906 R@4 : 64.189
2020-09-23 18:30:45,639 R@8 : 73.015
2020-09-23 18:33:23,617 Epoch: 2, loss: 2.099, time (seconds): 157.97.
2020-09-23 18:33:23,618 **Evaluating.**
2020-09-23 18:35:34,988 NMI: 29.245
2020-09-23 18:37:05,991 R@1 : 46.489
2020-09-23 18:37:06,749 R@2 : 55.381
2020-09-23 18:37:07,496 R@4 : 64.930
2020-09-23 18:37:08,232 R@8 : 73.448
2020-09-23 18:39:47,188 Epoch: 3, loss: 1.903, time (seconds): 158.95.
2020-09-23 18:39:47,189 **Evaluating.**
2020-09-23 18:42:00,995 NMI: 29.427
2020-09-23 18:43:30,148 R@1 : 47.551
2020-09-23 18:43:30,881 R@2 : 56.528
2020-09-23 18:43:31,616 R@4 : 65.644
2020-09-23 18:43:32,383 R@8 : 74.348
2020-09-23 18:46:01,525 Epoch: 4, loss: 1.924, time (seconds): 149.14.
2020-09-23 18:46:01,525 **Evaluating.**
2020-09-23 18:48:25,095 NMI: 29.574
2020-09-23 18:49:54,409 R@1 : 47.534
2020-09-23 18:49:55,164 R@2 : 56.554
2020-09-23 18:49:55,907 R@4 : 65.876
2020-09-23 18:49:56,640 R@8 : 74.539
