2020-09-27 16:08:27,919 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200927-160823', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(80, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-27 16:08:27,920 Training for 20 epochs
2020-09-27 16:08:27,922 **Evaluating initial model.**
2020-09-27 16:09:29,154 NMI: 25.644
2020-09-27 16:09:47,203 R@1 : 53.321
2020-09-27 16:09:47,530 R@2 : 63.279
2020-09-27 16:09:47,834 R@4 : 72.619
2020-09-27 16:09:48,141 R@8 : 81.503
2020-09-27 16:11:31,294 Epoch: 0, loss: 2.389, time (seconds): 103.15.
2020-09-27 16:11:31,295 **Evaluating.**
2020-09-27 16:12:14,224 NMI: 32.729
2020-09-27 16:12:30,816 R@1 : 57.741
2020-09-27 16:12:31,124 R@2 : 67.679
2020-09-27 16:12:31,436 R@4 : 76.794
2020-09-27 16:12:31,750 R@8 : 84.215
2020-09-27 16:14:13,297 Epoch: 1, loss: 2.100, time (seconds): 101.54.
2020-09-27 16:14:13,298 **Evaluating.**
2020-09-27 16:14:55,554 NMI: 37.164
2020-09-27 16:15:12,600 R@1 : 62.183
2020-09-27 16:15:12,921 R@2 : 71.839
2020-09-27 16:15:13,244 R@4 : 79.858
2020-09-27 16:15:13,556 R@8 : 86.556
2020-09-27 16:16:55,454 Epoch: 2, loss: 1.986, time (seconds): 101.89.
2020-09-27 16:16:55,455 **Evaluating.**
2020-09-27 16:17:37,279 NMI: 38.590
2020-09-27 16:17:54,155 R@1 : 62.815
2020-09-27 16:17:54,472 R@2 : 72.141
2020-09-27 16:17:54,783 R@4 : 80.132
2020-09-27 16:17:55,098 R@8 : 86.359
2020-09-27 16:19:35,048 Epoch: 3, loss: 1.857, time (seconds): 99.95.
2020-09-27 16:19:35,048 **Evaluating.**
2020-09-27 16:20:17,548 NMI: 37.291
2020-09-27 16:20:34,666 R@1 : 63.399
2020-09-27 16:20:34,978 R@2 : 72.647
2020-09-27 16:20:35,283 R@4 : 80.526
2020-09-27 16:20:35,591 R@8 : 86.928
2020-09-27 16:22:17,374 Epoch: 4, loss: 1.781, time (seconds): 101.78.
2020-09-27 16:22:17,374 **Evaluating.**
2020-09-27 16:22:59,466 NMI: 37.259
2020-09-27 16:23:16,590 R@1 : 62.963
2020-09-27 16:23:16,895 R@2 : 72.514
2020-09-27 16:23:17,199 R@4 : 80.181
2020-09-27 16:23:17,506 R@8 : 86.598
2020-09-27 16:24:59,076 Epoch: 5, loss: 1.723, time (seconds): 101.57.
2020-09-27 16:24:59,077 **Evaluating.**
2020-09-27 16:25:41,269 NMI: 36.622
2020-09-27 16:25:58,414 R@1 : 63.096
2020-09-27 16:25:58,720 R@2 : 72.050
2020-09-27 16:25:59,040 R@4 : 80.181
2020-09-27 16:25:59,345 R@8 : 86.682
2020-09-27 16:27:40,728 Epoch: 6, loss: 1.675, time (seconds): 101.38.
2020-09-27 16:27:40,729 **Evaluating.**
2020-09-27 16:28:23,260 NMI: 35.497
2020-09-27 16:28:40,612 R@1 : 63.272
2020-09-27 16:28:40,916 R@2 : 72.233
2020-09-27 16:28:41,230 R@4 : 80.104
2020-09-27 16:28:41,535 R@8 : 86.844
2020-09-27 16:30:22,983 Epoch: 7, loss: 1.613, time (seconds): 101.45.
2020-09-27 16:30:22,983 **Evaluating.**
2020-09-27 16:31:05,356 NMI: 38.396
2020-09-27 16:31:22,678 R@1 : 63.757
2020-09-27 16:31:22,986 R@2 : 72.711
2020-09-27 16:31:23,294 R@4 : 80.385
2020-09-27 16:31:23,602 R@8 : 86.773
2020-09-27 16:33:04,905 Epoch: 8, loss: 1.579, time (seconds): 101.30.
2020-09-27 16:33:04,906 **Evaluating.**
2020-09-27 16:33:47,053 NMI: 37.189
2020-09-27 16:34:04,487 R@1 : 62.422
2020-09-27 16:34:04,796 R@2 : 71.734
2020-09-27 16:34:05,119 R@4 : 79.717
2020-09-27 16:34:05,428 R@8 : 86.345
2020-09-27 16:35:46,301 Epoch: 9, loss: 1.510, time (seconds): 100.87.
2020-09-27 16:35:46,302 **Evaluating.**
2020-09-27 16:36:28,460 NMI: 35.590
2020-09-27 16:36:45,980 R@1 : 62.211
2020-09-27 16:36:46,283 R@2 : 71.439
2020-09-27 16:36:46,596 R@4 : 79.689
2020-09-27 16:36:46,905 R@8 : 86.338
2020-09-27 16:38:28,287 Epoch: 10, loss: 1.455, time (seconds): 101.38.
2020-09-27 16:38:28,287 **Evaluating.**
2020-09-27 16:39:10,715 NMI: 36.104
2020-09-27 16:39:28,260 R@1 : 61.817
2020-09-27 16:39:28,568 R@2 : 71.453
2020-09-27 16:39:28,886 R@4 : 79.788
2020-09-27 16:39:29,206 R@8 : 86.429
2020-09-27 16:41:10,598 Epoch: 11, loss: 1.439, time (seconds): 101.39.
2020-09-27 16:41:10,599 **Evaluating.**
2020-09-27 16:41:53,008 NMI: 36.364
2020-09-27 16:42:10,798 R@1 : 61.824
2020-09-27 16:42:11,120 R@2 : 71.031
2020-09-27 16:42:11,430 R@4 : 79.071
2020-09-27 16:42:11,738 R@8 : 85.832
2020-09-27 16:43:52,698 Epoch: 12, loss: 1.366, time (seconds): 100.96.
2020-09-27 16:43:52,699 **Evaluating.**
2020-09-27 16:44:35,716 NMI: 37.079
2020-09-27 16:44:53,327 R@1 : 61.930
2020-09-27 16:44:53,652 R@2 : 70.947
2020-09-27 16:44:53,980 R@4 : 79.282
2020-09-27 16:44:54,303 R@8 : 85.993
2020-09-27 16:46:35,773 Epoch: 13, loss: 1.351, time (seconds): 101.47.
2020-09-27 16:46:35,774 **Evaluating.**
2020-09-27 16:47:18,305 NMI: 35.878
2020-09-27 16:47:36,176 R@1 : 61.515
2020-09-27 16:47:36,496 R@2 : 71.136
2020-09-27 16:47:36,813 R@4 : 79.197
2020-09-27 16:47:37,118 R@8 : 85.747
2020-09-27 16:49:19,014 Epoch: 14, loss: 1.327, time (seconds): 101.89.
2020-09-27 16:49:19,015 **Evaluating.**
2020-09-27 16:50:01,911 NMI: 34.965
2020-09-27 16:50:19,606 R@1 : 61.614
2020-09-27 16:50:19,930 R@2 : 70.968
2020-09-27 16:50:20,244 R@4 : 79.071
2020-09-27 16:50:20,562 R@8 : 85.754
2020-09-27 16:52:02,868 Epoch: 15, loss: 1.313, time (seconds): 102.30.
2020-09-27 16:52:02,869 **Evaluating.**
2020-09-27 16:52:48,312 NMI: 34.997
2020-09-27 16:53:06,095 R@1 : 60.377
2020-09-27 16:53:06,411 R@2 : 70.082
2020-09-27 16:53:06,732 R@4 : 78.298
2020-09-27 16:53:07,040 R@8 : 85.192
2020-09-27 16:54:48,783 Epoch: 16, loss: 1.285, time (seconds): 101.74.
2020-09-27 16:54:48,785 **Evaluating.**
2020-09-27 16:55:31,700 NMI: 34.440
2020-09-27 16:55:49,863 R@1 : 60.559
2020-09-27 16:55:50,193 R@2 : 69.590
2020-09-27 16:55:50,519 R@4 : 77.750
2020-09-27 16:55:50,852 R@8 : 85.002
2020-09-27 16:57:33,179 Epoch: 17, loss: 1.226, time (seconds): 102.32.
2020-09-27 16:57:33,179 **Evaluating.**
2020-09-27 16:58:17,493 NMI: 33.592
2020-09-27 16:58:35,479 R@1 : 59.892
2020-09-27 16:58:35,787 R@2 : 68.691
2020-09-27 16:58:36,093 R@4 : 77.700
2020-09-27 16:58:36,409 R@8 : 84.609
2020-09-27 17:00:17,998 Epoch: 18, loss: 1.256, time (seconds): 101.59.
2020-09-27 17:00:17,998 **Evaluating.**
2020-09-27 17:01:00,370 NMI: 33.173
2020-09-27 17:01:18,225 R@1 : 59.829
2020-09-27 17:01:18,533 R@2 : 68.930
2020-09-27 17:01:18,844 R@4 : 77.405
2020-09-27 17:01:19,160 R@8 : 84.503
2020-09-27 17:03:00,869 Epoch: 19, loss: 1.231, time (seconds): 101.71.
2020-09-27 17:03:00,870 **Evaluating.**
2020-09-27 17:03:44,191 NMI: 33.394
2020-09-27 17:04:02,289 R@1 : 59.224
2020-09-27 17:04:02,615 R@2 : 68.740
2020-09-27 17:04:02,926 R@4 : 77.223
2020-09-27 17:04:03,235 R@8 : 84.532
2020-09-27 17:04:03,237 Total training time (minutes): 55.59.
2020-09-27 17:04:05,097 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200927-160823', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 80), 'eval_classes': range(80, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-27 17:04:05,098 Training for 20 epochs
2020-09-27 17:04:05,100 **Evaluating initial model.**
2020-09-27 17:04:48,577 NMI: 25.644
2020-09-27 17:05:06,948 R@1 : 53.321
2020-09-27 17:05:07,256 R@2 : 63.279
2020-09-27 17:05:07,565 R@4 : 72.619
2020-09-27 17:05:07,869 R@8 : 81.503
2020-09-27 17:07:50,472 Epoch: 0, loss: 1.585, time (seconds): 162.60.
2020-09-27 17:07:50,473 **Evaluating.**
2020-09-27 17:08:38,712 NMI: 36.506
2020-09-27 17:08:55,838 R@1 : 62.063
2020-09-27 17:08:56,144 R@2 : 71.389
2020-09-27 17:08:56,446 R@4 : 79.500
2020-09-27 17:08:56,752 R@8 : 86.303
2020-09-27 17:11:38,030 Epoch: 1, loss: 1.505, time (seconds): 161.28.
2020-09-27 17:11:38,031 **Evaluating.**
2020-09-27 17:12:25,504 NMI: 38.725
2020-09-27 17:12:42,776 R@1 : 63.673
2020-09-27 17:12:43,084 R@2 : 72.570
2020-09-27 17:12:43,404 R@4 : 80.568
2020-09-27 17:12:43,717 R@8 : 86.781
2020-09-27 17:15:26,061 Epoch: 2, loss: 1.374, time (seconds): 162.34.
2020-09-27 17:15:26,062 **Evaluating.**
2020-09-27 17:16:14,125 NMI: 37.085
2020-09-27 17:16:31,471 R@1 : 62.984
2020-09-27 17:16:31,791 R@2 : 72.718
2020-09-27 17:16:32,103 R@4 : 80.561
2020-09-27 17:16:32,420 R@8 : 86.851
2020-09-27 17:19:14,443 Epoch: 3, loss: 1.345, time (seconds): 162.02.
2020-09-27 17:19:14,444 **Evaluating.**
2020-09-27 17:20:01,880 NMI: 38.613
2020-09-27 17:20:19,025 R@1 : 63.891
2020-09-27 17:20:19,330 R@2 : 72.795
2020-09-27 17:20:19,641 R@4 : 80.455
2020-09-27 17:20:19,955 R@8 : 86.809
2020-09-27 17:23:01,945 Epoch: 4, loss: 1.292, time (seconds): 161.99.
2020-09-27 17:23:01,946 **Evaluating.**
2020-09-27 17:23:48,906 NMI: 38.525
2020-09-27 17:24:06,309 R@1 : 63.244
2020-09-27 17:24:06,625 R@2 : 72.247
2020-09-27 17:24:06,948 R@4 : 79.985
2020-09-27 17:24:07,258 R@8 : 86.443
2020-09-27 17:26:49,398 Epoch: 5, loss: 1.220, time (seconds): 162.14.
2020-09-27 17:26:49,399 **Evaluating.**
2020-09-27 17:27:37,508 NMI: 37.032
2020-09-27 17:27:55,669 R@1 : 62.590
2020-09-27 17:27:55,975 R@2 : 71.797
2020-09-27 17:27:56,289 R@4 : 79.907
2020-09-27 17:27:56,597 R@8 : 86.450
2020-09-27 17:30:39,616 Epoch: 6, loss: 1.187, time (seconds): 163.02.
2020-09-27 17:30:39,617 **Evaluating.**
2020-09-27 17:31:27,843 NMI: 36.174
2020-09-27 17:31:45,680 R@1 : 62.513
2020-09-27 17:31:46,005 R@2 : 71.909
2020-09-27 17:31:46,317 R@4 : 79.970
2020-09-27 17:31:46,622 R@8 : 85.895
2020-09-27 17:34:29,549 Epoch: 7, loss: 1.129, time (seconds): 162.92.
2020-09-27 17:34:29,550 **Evaluating.**
2020-09-27 17:35:17,401 NMI: 37.405
2020-09-27 17:35:34,917 R@1 : 62.590
2020-09-27 17:35:35,225 R@2 : 71.368
2020-09-27 17:35:35,530 R@4 : 79.162
2020-09-27 17:35:35,836 R@8 : 85.473
2020-09-27 17:38:16,421 Epoch: 8, loss: 1.151, time (seconds): 160.58.
2020-09-27 17:38:16,422 **Evaluating.**
2020-09-27 17:39:04,247 NMI: 36.794
2020-09-27 17:39:21,782 R@1 : 62.239
2020-09-27 17:39:22,115 R@2 : 71.291
2020-09-27 17:39:22,428 R@4 : 79.282
2020-09-27 17:39:22,738 R@8 : 85.740
2020-09-27 17:42:03,633 Epoch: 9, loss: 1.104, time (seconds): 160.89.
2020-09-27 17:42:03,634 **Evaluating.**
2020-09-27 17:42:51,406 NMI: 34.861
2020-09-27 17:43:08,971 R@1 : 61.733
2020-09-27 17:43:09,280 R@2 : 70.427
2020-09-27 17:43:09,588 R@4 : 78.368
2020-09-27 17:43:09,902 R@8 : 85.241
2020-09-27 17:45:50,445 Epoch: 10, loss: 1.079, time (seconds): 160.54.
2020-09-27 17:45:50,446 **Evaluating.**
2020-09-27 17:46:38,175 NMI: 34.400
2020-09-27 17:46:55,893 R@1 : 60.925
2020-09-27 17:46:56,205 R@2 : 69.900
2020-09-27 17:46:56,508 R@4 : 78.122
2020-09-27 17:46:56,818 R@8 : 84.560
2020-09-27 17:49:38,302 Epoch: 11, loss: 1.072, time (seconds): 161.48.
2020-09-27 17:49:38,302 **Evaluating.**
2020-09-27 17:50:25,981 NMI: 34.900
2020-09-27 17:50:43,656 R@1 : 60.904
2020-09-27 17:50:43,974 R@2 : 69.907
2020-09-27 17:50:44,278 R@4 : 78.052
2020-09-27 17:50:44,589 R@8 : 85.031
2020-09-27 17:53:25,688 Epoch: 12, loss: 1.019, time (seconds): 161.10.
2020-09-27 17:53:25,690 **Evaluating.**
2020-09-27 17:54:12,727 NMI: 33.862
2020-09-27 17:54:30,485 R@1 : 60.538
2020-09-27 17:54:30,799 R@2 : 69.611
2020-09-27 17:54:31,108 R@4 : 77.469
2020-09-27 17:54:31,411 R@8 : 84.581
2020-09-27 17:57:13,000 Epoch: 13, loss: 1.039, time (seconds): 161.59.
2020-09-27 17:57:13,001 **Evaluating.**
2020-09-27 17:58:01,426 NMI: 34.259
2020-09-27 17:58:19,297 R@1 : 59.048
2020-09-27 17:58:19,606 R@2 : 67.918
2020-09-27 17:58:19,916 R@4 : 76.260
2020-09-27 17:58:20,222 R@8 : 83.400
2020-09-27 18:01:02,252 Epoch: 14, loss: 1.014, time (seconds): 162.03.
2020-09-27 18:01:02,253 **Evaluating.**
2020-09-27 18:01:50,304 NMI: 33.961
2020-09-27 18:02:08,217 R@1 : 59.210
2020-09-27 18:02:08,525 R@2 : 68.417
2020-09-27 18:02:08,844 R@4 : 76.513
2020-09-27 18:02:09,156 R@8 : 83.674
2020-09-27 18:04:51,388 Epoch: 15, loss: 0.984, time (seconds): 162.23.
2020-09-27 18:04:51,389 **Evaluating.**
2020-09-27 18:05:39,611 NMI: 33.610
2020-09-27 18:05:57,354 R@1 : 59.948
2020-09-27 18:05:57,670 R@2 : 68.803
2020-09-27 18:05:57,993 R@4 : 76.752
2020-09-27 18:05:58,297 R@8 : 83.976
2020-09-27 18:08:40,038 Epoch: 16, loss: 0.972, time (seconds): 161.74.
2020-09-27 18:08:40,039 **Evaluating.**
2020-09-27 18:09:27,402 NMI: 32.522
2020-09-27 18:09:45,820 R@1 : 59.154
2020-09-27 18:09:46,146 R@2 : 68.325
2020-09-27 18:09:46,454 R@4 : 76.428
2020-09-27 18:09:46,770 R@8 : 83.351
2020-09-27 18:12:27,488 Epoch: 17, loss: 0.988, time (seconds): 160.72.
2020-09-27 18:12:27,490 **Evaluating.**
2020-09-27 18:13:14,414 NMI: 32.793
2020-09-27 18:13:32,219 R@1 : 59.294
2020-09-27 18:13:32,524 R@2 : 68.002
2020-09-27 18:13:32,827 R@4 : 76.218
2020-09-27 18:13:33,133 R@8 : 83.506
2020-09-27 18:16:13,621 Epoch: 18, loss: 0.963, time (seconds): 160.49.
2020-09-27 18:16:13,622 **Evaluating.**
2020-09-27 18:17:01,333 NMI: 33.458
2020-09-27 18:17:19,190 R@1 : 59.041
2020-09-27 18:17:19,499 R@2 : 68.234
2020-09-27 18:17:19,807 R@4 : 76.295
2020-09-27 18:17:20,123 R@8 : 83.386
2020-09-27 18:20:02,057 Epoch: 19, loss: 0.922, time (seconds): 161.93.
2020-09-27 18:20:02,058 **Evaluating.**
2020-09-27 18:20:49,535 NMI: 31.743
2020-09-27 18:21:07,445 R@1 : 58.507
2020-09-27 18:21:07,751 R@2 : 67.384
2020-09-27 18:21:08,057 R@4 : 75.634
2020-09-27 18:21:08,359 R@8 : 82.985
2020-09-27 18:21:08,361 Total training time (minutes): 77.05.
