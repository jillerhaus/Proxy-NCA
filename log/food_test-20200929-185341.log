2020-09-29 18:53:46,433 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200929-185341', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(0, 50), 'p_c': 1, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-29 18:53:46,434 Training for 20 epochs
2020-09-29 18:53:46,436 **Evaluating initial model.**
2020-09-29 18:54:46,327 NMI: 23.078
2020-09-29 18:54:58,160 R@1 : 32.135
2020-09-29 18:54:58,404 R@2 : 41.975
2020-09-29 18:54:58,645 R@4 : 53.323
2020-09-29 18:54:58,893 R@8 : 65.251
2020-09-29 18:55:32,045 Epoch: 0, loss: 3.315, time (seconds): 33.15.
2020-09-29 18:55:32,046 **Evaluating.**
2020-09-29 18:56:05,676 NMI: 42.619
2020-09-29 18:56:16,329 R@1 : 49.987
2020-09-29 18:56:16,573 R@2 : 60.567
2020-09-29 18:56:16,817 R@4 : 69.542
2020-09-29 18:56:17,058 R@8 : 76.983
2020-09-29 18:56:50,022 Epoch: 1, loss: 3.161, time (seconds): 32.96.
2020-09-29 18:56:50,023 **Evaluating.**
2020-09-29 18:57:25,636 NMI: 48.372
2020-09-29 18:57:36,073 R@1 : 54.688
2020-09-29 18:57:36,313 R@2 : 64.457
2020-09-29 18:57:36,553 R@4 : 72.121
2020-09-29 18:57:36,793 R@8 : 79.026
2020-09-29 18:58:09,898 Epoch: 2, loss: 3.047, time (seconds): 33.10.
2020-09-29 18:58:09,899 **Evaluating.**
2020-09-29 18:58:42,913 NMI: 51.315
2020-09-29 18:58:53,127 R@1 : 56.954
2020-09-29 18:58:53,372 R@2 : 66.795
2020-09-29 18:58:53,611 R@4 : 74.369
2020-09-29 18:58:53,860 R@8 : 80.560
2020-09-29 18:59:26,887 Epoch: 3, loss: 3.006, time (seconds): 33.02.
2020-09-29 18:59:26,887 **Evaluating.**
2020-09-29 19:00:01,754 NMI: 53.987
2020-09-29 19:00:12,130 R@1 : 58.640
2020-09-29 19:00:12,382 R@2 : 68.445
2020-09-29 19:00:12,625 R@4 : 75.814
2020-09-29 19:00:12,865 R@8 : 81.551
2020-09-29 19:00:47,184 Epoch: 4, loss: 2.973, time (seconds): 34.32.
2020-09-29 19:00:47,185 **Evaluating.**
2020-09-29 19:01:21,410 NMI: 55.245
2020-09-29 19:01:31,585 R@1 : 59.604
2020-09-29 19:01:31,829 R@2 : 69.364
2020-09-29 19:01:32,078 R@4 : 77.152
2020-09-29 19:01:32,322 R@8 : 82.496
2020-09-29 19:02:06,939 Epoch: 5, loss: 2.932, time (seconds): 34.62.
2020-09-29 19:02:06,940 **Evaluating.**
2020-09-29 19:02:41,423 NMI: 57.113
2020-09-29 19:02:51,568 R@1 : 60.897
2020-09-29 19:02:51,809 R@2 : 70.506
2020-09-29 19:02:52,051 R@4 : 77.340
2020-09-29 19:02:52,294 R@8 : 82.942
2020-09-29 19:03:26,642 Epoch: 6, loss: 2.911, time (seconds): 34.35.
2020-09-29 19:03:26,643 **Evaluating.**
2020-09-29 19:04:00,811 NMI: 58.498
2020-09-29 19:04:10,982 R@1 : 61.540
2020-09-29 19:04:11,223 R@2 : 71.193
2020-09-29 19:04:11,466 R@4 : 78.044
2020-09-29 19:04:11,708 R@8 : 83.424
2020-09-29 19:04:46,438 Epoch: 7, loss: 2.898, time (seconds): 34.73.
2020-09-29 19:04:46,439 **Evaluating.**
2020-09-29 19:05:20,360 NMI: 59.726
2020-09-29 19:05:30,311 R@1 : 63.128
2020-09-29 19:05:30,556 R@2 : 72.165
2020-09-29 19:05:30,815 R@4 : 78.821
2020-09-29 19:05:31,062 R@8 : 84.022
2020-09-29 19:06:05,599 Epoch: 8, loss: 2.874, time (seconds): 34.54.
2020-09-29 19:06:05,600 **Evaluating.**
2020-09-29 19:06:39,801 NMI: 61.744
2020-09-29 19:06:49,699 R@1 : 64.368
2020-09-29 19:06:49,940 R@2 : 73.637
2020-09-29 19:06:50,184 R@4 : 79.980
2020-09-29 19:06:50,426 R@8 : 84.637
2020-09-29 19:07:24,838 Epoch: 9, loss: 2.841, time (seconds): 34.41.
2020-09-29 19:07:24,838 **Evaluating.**
2020-09-29 19:07:59,063 NMI: 62.592
2020-09-29 19:08:08,928 R@1 : 65.358
2020-09-29 19:08:09,170 R@2 : 74.512
2020-09-29 19:08:09,410 R@4 : 80.462
2020-09-29 19:08:09,650 R@8 : 85.208
2020-09-29 19:08:44,072 Epoch: 10, loss: 2.836, time (seconds): 34.42.
2020-09-29 19:08:44,073 **Evaluating.**
2020-09-29 19:09:17,874 NMI: 63.689
2020-09-29 19:09:27,678 R@1 : 66.232
2020-09-29 19:09:27,921 R@2 : 75.270
2020-09-29 19:09:28,172 R@4 : 81.452
2020-09-29 19:09:28,437 R@8 : 85.922
2020-09-29 19:10:02,802 Epoch: 11, loss: 2.814, time (seconds): 34.36.
2020-09-29 19:10:02,803 **Evaluating.**
2020-09-29 19:10:36,628 NMI: 64.178
2020-09-29 19:10:46,414 R@1 : 66.545
2020-09-29 19:10:46,658 R@2 : 75.698
2020-09-29 19:10:46,906 R@4 : 81.470
2020-09-29 19:10:47,152 R@8 : 86.136
2020-09-29 19:11:21,637 Epoch: 12, loss: 2.818, time (seconds): 34.48.
2020-09-29 19:11:21,639 **Evaluating.**
2020-09-29 19:11:55,715 NMI: 65.430
2020-09-29 19:12:05,506 R@1 : 67.776
2020-09-29 19:12:05,756 R@2 : 76.635
2020-09-29 19:12:05,998 R@4 : 82.478
2020-09-29 19:12:06,239 R@8 : 86.404
2020-09-29 19:12:40,580 Epoch: 13, loss: 2.804, time (seconds): 34.34.
2020-09-29 19:12:40,580 **Evaluating.**
2020-09-29 19:13:15,350 NMI: 66.154
2020-09-29 19:13:25,112 R@1 : 68.418
2020-09-29 19:13:25,358 R@2 : 77.277
2020-09-29 19:13:25,609 R@4 : 82.862
2020-09-29 19:13:25,855 R@8 : 87.037
2020-09-29 19:14:00,466 Epoch: 14, loss: 2.793, time (seconds): 34.61.
2020-09-29 19:14:00,467 **Evaluating.**
2020-09-29 19:14:34,427 NMI: 67.083
2020-09-29 19:14:44,077 R@1 : 69.230
2020-09-29 19:14:44,325 R@2 : 77.634
2020-09-29 19:14:44,568 R@4 : 83.165
2020-09-29 19:14:44,809 R@8 : 86.966
2020-09-29 19:15:20,399 Epoch: 15, loss: 2.783, time (seconds): 35.59.
2020-09-29 19:15:20,400 **Evaluating.**
2020-09-29 19:15:56,991 NMI: 67.692
2020-09-29 19:16:06,830 R@1 : 69.765
2020-09-29 19:16:07,077 R@2 : 78.018
2020-09-29 19:16:07,324 R@4 : 83.567
2020-09-29 19:16:07,574 R@8 : 87.376
2020-09-29 19:16:42,068 Epoch: 16, loss: 2.757, time (seconds): 34.49.
2020-09-29 19:16:42,070 **Evaluating.**
2020-09-29 19:17:15,961 NMI: 68.387
2020-09-29 19:17:25,646 R@1 : 70.515
2020-09-29 19:17:25,917 R@2 : 78.830
2020-09-29 19:17:26,161 R@4 : 84.173
2020-09-29 19:17:26,434 R@8 : 87.876
2020-09-29 19:18:01,118 Epoch: 17, loss: 2.747, time (seconds): 34.68.
2020-09-29 19:18:01,118 **Evaluating.**
2020-09-29 19:18:35,274 NMI: 69.662
2020-09-29 19:18:44,852 R@1 : 70.550
2020-09-29 19:18:45,096 R@2 : 79.365
2020-09-29 19:18:45,341 R@4 : 84.557
2020-09-29 19:18:45,587 R@8 : 88.420
2020-09-29 19:19:20,493 Epoch: 18, loss: 2.771, time (seconds): 34.90.
2020-09-29 19:19:20,495 **Evaluating.**
2020-09-29 19:19:54,519 NMI: 70.730
2020-09-29 19:20:04,086 R@1 : 71.755
2020-09-29 19:20:04,355 R@2 : 80.105
2020-09-29 19:20:04,623 R@4 : 85.164
2020-09-29 19:20:04,893 R@8 : 88.723
2020-09-29 19:20:39,345 Epoch: 19, loss: 2.743, time (seconds): 34.45.
2020-09-29 19:20:39,346 **Evaluating.**
2020-09-29 19:21:13,138 NMI: 70.225
2020-09-29 19:21:22,613 R@1 : 71.853
2020-09-29 19:21:22,864 R@2 : 80.150
2020-09-29 19:21:23,109 R@4 : 85.128
2020-09-29 19:21:23,354 R@8 : 88.590
2020-09-29 19:21:23,356 Total training time (minutes): 27.62.
