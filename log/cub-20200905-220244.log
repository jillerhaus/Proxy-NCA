2020-09-05 22:02:46,696 Training parameters: {'__module__': '__main__', 'dataset': 'cub', 'config': 'configcub.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 50, 'log_filename': 'cub-20200905-220244', 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 1.0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'lr_procynca': 1}
2020-09-05 22:02:46,698 Training for 50 epochs
2020-09-05 22:02:46,700 **Evaluating initial model.**
2020-09-05 22:03:04,024 NMI: 47.033
2020-09-05 22:03:07,486 R@1 : 32.849
2020-09-05 22:03:07,621 R@2 : 45.273
2020-09-05 22:03:07,754 R@4 : 58.997
2020-09-05 22:03:07,888 R@8 : 71.810
2020-09-05 22:03:33,168 Epoch: 0, loss: 4.085, time (seconds): 25.28.
2020-09-05 22:03:33,169 **Evaluating.**
2020-09-05 22:03:50,138 NMI: 48.346
2020-09-05 22:03:53,088 R@1 : 32.883
2020-09-05 22:03:53,213 R@2 : 44.294
2020-09-05 22:03:53,340 R@4 : 57.647
2020-09-05 22:03:53,467 R@8 : 70.695
2020-09-05 22:04:18,779 Epoch: 1, loss: 2.693, time (seconds): 25.31.
2020-09-05 22:04:18,780 **Evaluating.**
2020-09-05 22:04:35,434 NMI: 51.760
2020-09-05 22:04:38,494 R@1 : 37.340
2020-09-05 22:04:38,620 R@2 : 49.578
2020-09-05 22:04:38,746 R@4 : 62.745
2020-09-05 22:04:38,871 R@8 : 74.494
2020-09-05 22:05:04,238 Epoch: 2, loss: 2.174, time (seconds): 25.36.
2020-09-05 22:05:04,239 **Evaluating.**
2020-09-05 22:05:20,916 NMI: 55.785
2020-09-05 22:05:24,082 R@1 : 42.927
2020-09-05 22:05:24,209 R@2 : 55.908
2020-09-05 22:05:24,336 R@4 : 68.552
2020-09-05 22:05:24,464 R@8 : 79.321
2020-09-05 22:05:49,935 Epoch: 3, loss: 2.067, time (seconds): 25.47.
2020-09-05 22:05:49,936 **Evaluating.**
2020-09-05 22:06:06,938 NMI: 57.507
2020-09-05 22:06:10,205 R@1 : 45.375
2020-09-05 22:06:10,331 R@2 : 58.542
2020-09-05 22:06:10,458 R@4 : 70.088
2020-09-05 22:06:10,584 R@8 : 80.722
2020-09-05 22:06:36,272 Epoch: 4, loss: 1.928, time (seconds): 25.69.
2020-09-05 22:06:36,273 **Evaluating.**
2020-09-05 22:06:52,868 NMI: 57.460
2020-09-05 22:06:55,998 R@1 : 47.637
2020-09-05 22:06:56,125 R@2 : 60.550
2020-09-05 22:06:56,252 R@4 : 72.890
2020-09-05 22:06:56,378 R@8 : 82.360
2020-09-05 22:07:21,956 Epoch: 5, loss: 1.708, time (seconds): 25.58.
2020-09-05 22:07:21,957 **Evaluating.**
2020-09-05 22:07:39,272 NMI: 58.755
2020-09-05 22:07:42,593 R@1 : 49.375
2020-09-05 22:07:42,723 R@2 : 63.082
2020-09-05 22:07:42,852 R@4 : 74.612
2020-09-05 22:07:42,983 R@8 : 83.795
2020-09-05 22:08:08,830 Epoch: 6, loss: 1.683, time (seconds): 25.84.
2020-09-05 22:08:08,830 **Evaluating.**
2020-09-05 22:08:25,695 NMI: 58.370
2020-09-05 22:08:29,047 R@1 : 47.941
2020-09-05 22:08:29,176 R@2 : 61.310
2020-09-05 22:08:29,309 R@4 : 73.160
2020-09-05 22:08:29,438 R@8 : 82.647
2020-09-05 22:08:55,259 Epoch: 7, loss: 1.607, time (seconds): 25.82.
2020-09-05 22:08:55,260 **Evaluating.**
2020-09-05 22:09:11,839 NMI: 59.034
2020-09-05 22:09:15,205 R@1 : 50.219
2020-09-05 22:09:15,334 R@2 : 63.555
2020-09-05 22:09:15,464 R@4 : 74.916
2020-09-05 22:09:15,594 R@8 : 83.879
2020-09-05 22:09:41,303 Epoch: 8, loss: 1.574, time (seconds): 25.71.
2020-09-05 22:09:41,304 **Evaluating.**
2020-09-05 22:09:58,539 NMI: 59.888
2020-09-05 22:10:02,159 R@1 : 51.300
2020-09-05 22:10:02,305 R@2 : 64.078
2020-09-05 22:10:02,434 R@4 : 75.625
2020-09-05 22:10:02,560 R@8 : 84.571
2020-09-05 22:10:29,162 Epoch: 9, loss: 1.527, time (seconds): 26.60.
2020-09-05 22:10:29,163 **Evaluating.**
2020-09-05 22:10:46,362 NMI: 60.180
2020-09-05 22:10:49,955 R@1 : 52.178
2020-09-05 22:10:50,109 R@2 : 64.770
2020-09-05 22:10:50,255 R@4 : 75.540
2020-09-05 22:10:50,412 R@8 : 83.795
2020-09-05 22:11:16,798 Epoch: 10, loss: 1.435, time (seconds): 26.38.
2020-09-05 22:11:16,799 **Evaluating.**
2020-09-05 22:11:34,656 NMI: 61.569
2020-09-05 22:11:38,300 R@1 : 53.798
2020-09-05 22:11:38,451 R@2 : 65.817
2020-09-05 22:11:38,610 R@4 : 76.587
2020-09-05 22:11:38,752 R@8 : 84.976
2020-09-05 22:12:05,251 Epoch: 11, loss: 1.387, time (seconds): 26.50.
2020-09-05 22:12:05,252 **Evaluating.**
2020-09-05 22:12:22,831 NMI: 60.579
2020-09-05 22:12:26,538 R@1 : 51.587
2020-09-05 22:12:26,693 R@2 : 63.859
2020-09-05 22:12:26,858 R@4 : 74.713
2020-09-05 22:12:27,014 R@8 : 83.896
2020-09-05 22:12:53,590 Epoch: 12, loss: 1.372, time (seconds): 26.57.
2020-09-05 22:12:53,591 **Evaluating.**
2020-09-05 22:13:10,864 NMI: 60.045
2020-09-05 22:13:14,633 R@1 : 52.059
2020-09-05 22:13:14,819 R@2 : 65.209
2020-09-05 22:13:14,992 R@4 : 76.199
2020-09-05 22:13:15,166 R@8 : 85.145
2020-09-05 22:13:41,559 Epoch: 13, loss: 1.316, time (seconds): 26.39.
2020-09-05 22:13:41,560 **Evaluating.**
2020-09-05 22:13:59,652 NMI: 58.928
2020-09-05 22:14:03,320 R@1 : 50.338
2020-09-05 22:14:03,479 R@2 : 62.795
2020-09-05 22:14:03,632 R@4 : 74.443
2020-09-05 22:14:03,780 R@8 : 83.373
2020-09-05 22:14:30,267 Epoch: 14, loss: 1.346, time (seconds): 26.48.
2020-09-05 22:14:30,268 **Evaluating.**
2020-09-05 22:14:47,428 NMI: 60.871
2020-09-05 22:14:51,101 R@1 : 50.591
2020-09-05 22:14:51,275 R@2 : 63.268
2020-09-05 22:14:51,453 R@4 : 74.662
2020-09-05 22:14:51,614 R@8 : 83.103
2020-09-05 22:15:18,018 Epoch: 15, loss: 1.364, time (seconds): 26.40.
2020-09-05 22:15:18,019 **Evaluating.**
2020-09-05 22:15:35,093 NMI: 58.983
2020-09-05 22:15:38,687 R@1 : 50.895
2020-09-05 22:15:38,842 R@2 : 62.930
2020-09-05 22:15:39,002 R@4 : 74.460
2020-09-05 22:15:39,144 R@8 : 83.153
2020-09-05 22:16:05,520 Epoch: 16, loss: 1.308, time (seconds): 26.37.
2020-09-05 22:16:05,521 **Evaluating.**
2020-09-05 22:16:22,824 NMI: 59.302
2020-09-05 22:16:26,522 R@1 : 50.979
2020-09-05 22:16:26,673 R@2 : 63.454
2020-09-05 22:16:26,817 R@4 : 75.338
2020-09-05 22:16:26,966 R@8 : 83.356
2020-09-05 22:16:53,391 Epoch: 17, loss: 1.297, time (seconds): 26.42.
2020-09-05 22:16:53,392 **Evaluating.**
2020-09-05 22:17:10,707 NMI: 59.720
2020-09-05 22:17:14,416 R@1 : 51.148
2020-09-05 22:17:14,592 R@2 : 63.285
2020-09-05 22:17:14,763 R@4 : 74.932
2020-09-05 22:17:14,931 R@8 : 84.166
2020-09-05 22:17:41,888 Epoch: 18, loss: 1.303, time (seconds): 26.95.
2020-09-05 22:17:41,889 **Evaluating.**
2020-09-05 22:17:59,512 NMI: 60.710
2020-09-05 22:18:02,891 R@1 : 52.600
2020-09-05 22:18:03,018 R@2 : 64.720
2020-09-05 22:18:03,147 R@4 : 75.557
2020-09-05 22:18:03,276 R@8 : 84.200
2020-09-05 22:18:29,380 Epoch: 19, loss: 1.221, time (seconds): 26.10.
2020-09-05 22:18:29,381 **Evaluating.**
2020-09-05 22:18:46,229 NMI: 59.765
2020-09-05 22:18:49,579 R@1 : 51.519
2020-09-05 22:18:49,706 R@2 : 63.859
2020-09-05 22:18:49,832 R@4 : 74.797
2020-09-05 22:18:49,958 R@8 : 83.423
2020-09-05 22:19:15,811 Epoch: 20, loss: 1.243, time (seconds): 25.85.
2020-09-05 22:19:15,811 **Evaluating.**
2020-09-05 22:19:32,815 NMI: 60.135
2020-09-05 22:19:36,277 R@1 : 51.891
2020-09-05 22:19:36,412 R@2 : 64.298
2020-09-05 22:19:36,540 R@4 : 74.865
2020-09-05 22:19:36,668 R@8 : 83.896
2020-09-05 22:20:02,468 Epoch: 21, loss: 1.187, time (seconds): 25.80.
2020-09-05 22:20:02,469 **Evaluating.**
2020-09-05 22:20:18,764 NMI: 59.739
2020-09-05 22:20:21,934 R@1 : 51.806
2020-09-05 22:20:22,062 R@2 : 64.230
2020-09-05 22:20:22,188 R@4 : 74.848
2020-09-05 22:20:22,315 R@8 : 83.508
2020-09-05 22:20:47,623 Epoch: 22, loss: 1.185, time (seconds): 25.31.
2020-09-05 22:20:47,624 **Evaluating.**
2020-09-05 22:21:03,779 NMI: 60.632
2020-09-05 22:21:06,983 R@1 : 52.346
2020-09-05 22:21:07,110 R@2 : 64.298
2020-09-05 22:21:07,236 R@4 : 75.506
2020-09-05 22:21:07,362 R@8 : 83.795
2020-09-05 22:21:32,845 Epoch: 23, loss: 1.214, time (seconds): 25.48.
2020-09-05 22:21:32,845 **Evaluating.**
2020-09-05 22:21:49,079 NMI: 59.353
2020-09-05 22:21:52,337 R@1 : 51.502
2020-09-05 22:21:52,463 R@2 : 63.032
2020-09-05 22:21:52,589 R@4 : 73.835
2020-09-05 22:21:52,715 R@8 : 83.018
2020-09-05 22:22:18,031 Epoch: 24, loss: 1.196, time (seconds): 25.31.
2020-09-05 22:22:18,032 **Evaluating.**
2020-09-05 22:22:34,477 NMI: 61.466
2020-09-05 22:22:37,666 R@1 : 51.789
2020-09-05 22:22:37,793 R@2 : 64.011
2020-09-05 22:22:37,920 R@4 : 75.641
2020-09-05 22:22:38,046 R@8 : 84.234
2020-09-05 22:23:03,722 Epoch: 25, loss: 1.236, time (seconds): 25.67.
2020-09-05 22:23:03,723 **Evaluating.**
2020-09-05 22:23:20,274 NMI: 58.877
2020-09-05 22:23:23,439 R@1 : 49.561
2020-09-05 22:23:23,565 R@2 : 61.479
2020-09-05 22:23:23,692 R@4 : 72.755
2020-09-05 22:23:23,817 R@8 : 82.546
2020-09-05 22:23:49,256 Epoch: 26, loss: 1.195, time (seconds): 25.44.
2020-09-05 22:23:49,257 **Evaluating.**
2020-09-05 22:24:05,866 NMI: 60.011
2020-09-05 22:24:09,116 R@1 : 50.591
2020-09-05 22:24:09,242 R@2 : 63.285
2020-09-05 22:24:09,368 R@4 : 74.257
2020-09-05 22:24:09,495 R@8 : 82.833
2020-09-05 22:24:34,889 Epoch: 27, loss: 1.113, time (seconds): 25.39.
2020-09-05 22:24:34,890 **Evaluating.**
2020-09-05 22:24:51,057 NMI: 60.578
2020-09-05 22:24:54,270 R@1 : 52.161
2020-09-05 22:24:54,395 R@2 : 63.808
2020-09-05 22:24:54,523 R@4 : 75.034
2020-09-05 22:24:54,648 R@8 : 83.086
2020-09-05 22:25:20,280 Epoch: 28, loss: 1.137, time (seconds): 25.63.
2020-09-05 22:25:20,281 **Evaluating.**
2020-09-05 22:25:36,532 NMI: 59.445
2020-09-05 22:25:39,872 R@1 : 50.760
2020-09-05 22:25:40,025 R@2 : 62.812
2020-09-05 22:25:40,163 R@4 : 73.903
2020-09-05 22:25:40,311 R@8 : 82.714
2020-09-05 22:26:06,805 Epoch: 29, loss: 1.115, time (seconds): 26.49.
2020-09-05 22:26:06,806 **Evaluating.**
2020-09-05 22:26:23,845 NMI: 60.345
2020-09-05 22:26:27,670 R@1 : 51.553
2020-09-05 22:26:27,817 R@2 : 62.373
2020-09-05 22:26:27,967 R@4 : 73.447
2020-09-05 22:26:28,122 R@8 : 82.647
2020-09-05 22:26:54,903 Epoch: 30, loss: 1.127, time (seconds): 26.78.
2020-09-05 22:26:54,904 **Evaluating.**
2020-09-05 22:27:12,155 NMI: 59.798
2020-09-05 22:27:15,860 R@1 : 51.587
2020-09-05 22:27:16,013 R@2 : 63.504
2020-09-05 22:27:16,154 R@4 : 73.801
2020-09-05 22:27:16,313 R@8 : 83.001
2020-09-05 22:27:42,685 Epoch: 31, loss: 1.106, time (seconds): 26.37.
2020-09-05 22:27:42,686 **Evaluating.**
2020-09-05 22:28:00,017 NMI: 59.205
2020-09-05 22:28:03,737 R@1 : 50.506
2020-09-05 22:28:03,898 R@2 : 62.154
2020-09-05 22:28:04,049 R@4 : 72.789
2020-09-05 22:28:04,185 R@8 : 81.955
2020-09-05 22:28:30,353 Epoch: 32, loss: 1.146, time (seconds): 26.17.
2020-09-05 22:28:30,354 **Evaluating.**
2020-09-05 22:28:47,466 NMI: 60.186
2020-09-05 22:28:51,110 R@1 : 51.063
2020-09-05 22:28:51,261 R@2 : 63.268
2020-09-05 22:28:51,413 R@4 : 74.578
2020-09-05 22:28:51,569 R@8 : 83.255
2020-09-05 22:29:17,939 Epoch: 33, loss: 1.135, time (seconds): 26.37.
2020-09-05 22:29:17,940 **Evaluating.**
2020-09-05 22:29:35,534 NMI: 59.868
2020-09-05 22:29:39,242 R@1 : 51.384
2020-09-05 22:29:39,403 R@2 : 63.116
2020-09-05 22:29:39,569 R@4 : 74.409
2020-09-05 22:29:39,735 R@8 : 83.373
2020-09-05 22:30:06,627 Epoch: 34, loss: 1.128, time (seconds): 26.89.
2020-09-05 22:30:06,628 **Evaluating.**
2020-09-05 22:30:23,806 NMI: 60.558
2020-09-05 22:30:27,602 R@1 : 50.912
2020-09-05 22:30:27,765 R@2 : 63.352
2020-09-05 22:30:27,921 R@4 : 74.004
2020-09-05 22:30:28,077 R@8 : 82.917
2020-09-05 22:30:54,851 Epoch: 35, loss: 1.142, time (seconds): 26.77.
2020-09-05 22:30:54,853 **Evaluating.**
2020-09-05 22:31:12,519 NMI: 59.673
2020-09-05 22:31:16,288 R@1 : 51.182
2020-09-05 22:31:16,451 R@2 : 64.078
2020-09-05 22:31:16,612 R@4 : 74.223
2020-09-05 22:31:16,769 R@8 : 83.356
2020-09-05 22:31:42,774 Epoch: 36, loss: 1.122, time (seconds): 26.00.
2020-09-05 22:31:42,775 **Evaluating.**
2020-09-05 22:32:00,192 NMI: 59.972
2020-09-05 22:32:03,927 R@1 : 50.709
2020-09-05 22:32:04,095 R@2 : 63.150
2020-09-05 22:32:04,256 R@4 : 74.004
2020-09-05 22:32:04,403 R@8 : 83.170
2020-09-05 22:32:30,416 Epoch: 37, loss: 1.123, time (seconds): 26.01.
2020-09-05 22:32:30,417 **Evaluating.**
2020-09-05 22:32:47,511 NMI: 59.437
2020-09-05 22:32:51,279 R@1 : 50.034
2020-09-05 22:32:51,445 R@2 : 62.660
2020-09-05 22:32:51,595 R@4 : 73.751
2020-09-05 22:32:51,746 R@8 : 83.288
2020-09-05 22:33:17,675 Epoch: 38, loss: 1.110, time (seconds): 25.93.
2020-09-05 22:33:17,675 **Evaluating.**
2020-09-05 22:33:35,378 NMI: 60.146
2020-09-05 22:33:39,137 R@1 : 50.760
2020-09-05 22:33:39,293 R@2 : 63.268
2020-09-05 22:33:39,441 R@4 : 74.105
2020-09-05 22:33:39,598 R@8 : 83.271
2020-09-05 22:34:05,513 Epoch: 39, loss: 1.042, time (seconds): 25.91.
2020-09-05 22:34:05,514 **Evaluating.**
2020-09-05 22:34:23,311 NMI: 59.695
2020-09-05 22:34:27,003 R@1 : 51.654
2020-09-05 22:34:27,166 R@2 : 63.285
2020-09-05 22:34:27,322 R@4 : 74.139
2020-09-05 22:34:27,490 R@8 : 83.069
2020-09-05 22:34:53,486 Epoch: 40, loss: 1.111, time (seconds): 25.99.
2020-09-05 22:34:53,486 **Evaluating.**
2020-09-05 22:35:11,348 NMI: 59.519
2020-09-05 22:35:15,075 R@1 : 50.422
2020-09-05 22:35:15,239 R@2 : 62.930
2020-09-05 22:35:15,401 R@4 : 73.261
2020-09-05 22:35:15,542 R@8 : 82.917
2020-09-05 22:35:41,613 Epoch: 41, loss: 1.085, time (seconds): 26.07.
2020-09-05 22:35:41,614 **Evaluating.**
2020-09-05 22:35:59,127 NMI: 60.480
2020-09-05 22:36:02,421 R@1 : 51.367
2020-09-05 22:36:02,549 R@2 : 63.589
2020-09-05 22:36:02,678 R@4 : 75.051
2020-09-05 22:36:02,805 R@8 : 83.255
2020-09-05 22:36:28,031 Epoch: 42, loss: 1.086, time (seconds): 25.22.
2020-09-05 22:36:28,033 **Evaluating.**
2020-09-05 22:36:45,094 NMI: 59.853
2020-09-05 22:36:48,336 R@1 : 51.131
2020-09-05 22:36:48,464 R@2 : 63.589
2020-09-05 22:36:48,594 R@4 : 74.139
2020-09-05 22:36:48,722 R@8 : 82.731
2020-09-05 22:37:13,765 Epoch: 43, loss: 1.117, time (seconds): 25.04.
2020-09-05 22:37:13,766 **Evaluating.**
2020-09-05 22:37:30,316 NMI: 60.609
2020-09-05 22:37:33,566 R@1 : 53.174
2020-09-05 22:37:33,707 R@2 : 64.855
2020-09-05 22:37:33,849 R@4 : 75.101
2020-09-05 22:37:33,990 R@8 : 83.744
2020-09-05 22:37:59,135 Epoch: 44, loss: 1.075, time (seconds): 25.14.
2020-09-05 22:37:59,135 **Evaluating.**
2020-09-05 22:38:15,480 NMI: 59.129
2020-09-05 22:38:18,814 R@1 : 50.186
2020-09-05 22:38:18,941 R@2 : 62.593
2020-09-05 22:38:19,073 R@4 : 73.211
2020-09-05 22:38:19,203 R@8 : 82.208
2020-09-05 22:38:44,520 Epoch: 45, loss: 1.066, time (seconds): 25.31.
2020-09-05 22:38:44,521 **Evaluating.**
2020-09-05 22:39:00,863 NMI: 59.833
2020-09-05 22:39:04,068 R@1 : 52.043
2020-09-05 22:39:04,203 R@2 : 64.433
2020-09-05 22:39:04,330 R@4 : 74.831
2020-09-05 22:39:04,462 R@8 : 84.048
2020-09-05 22:39:29,691 Epoch: 46, loss: 1.103, time (seconds): 25.23.
2020-09-05 22:39:29,692 **Evaluating.**
2020-09-05 22:39:46,419 NMI: 60.165
2020-09-05 22:39:49,622 R@1 : 51.637
2020-09-05 22:39:49,748 R@2 : 63.386
2020-09-05 22:39:49,875 R@4 : 73.903
2020-09-05 22:39:50,002 R@8 : 82.849
2020-09-05 22:40:15,216 Epoch: 47, loss: 1.060, time (seconds): 25.21.
2020-09-05 22:40:15,217 **Evaluating.**
2020-09-05 22:40:31,650 NMI: 58.805
2020-09-05 22:40:34,917 R@1 : 50.000
2020-09-05 22:40:35,043 R@2 : 63.099
2020-09-05 22:40:35,168 R@4 : 74.173
2020-09-05 22:40:35,295 R@8 : 82.883
2020-09-05 22:41:00,392 Epoch: 48, loss: 1.099, time (seconds): 25.10.
2020-09-05 22:41:00,392 **Evaluating.**
2020-09-05 22:41:17,005 NMI: 59.509
2020-09-05 22:41:20,283 R@1 : 51.232
2020-09-05 22:41:20,411 R@2 : 63.454
2020-09-05 22:41:20,548 R@4 : 74.072
2020-09-05 22:41:20,675 R@8 : 82.562
2020-09-05 22:41:45,849 Epoch: 49, loss: 1.084, time (seconds): 25.17.
2020-09-05 22:41:45,850 **Evaluating.**
2020-09-05 22:42:03,345 NMI: 59.716
2020-09-05 22:42:06,631 R@1 : 51.317
2020-09-05 22:42:06,758 R@2 : 63.234
2020-09-05 22:42:06,885 R@4 : 74.190
2020-09-05 22:42:07,011 R@8 : 82.444
2020-09-05 22:42:07,013 Total training time (minutes): 39.34.
