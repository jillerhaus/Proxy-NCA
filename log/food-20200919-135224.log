2020-09-19 13:52:28,608 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 40, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food-20200919-135224', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None, 'sz_embeddings': 64}
2020-09-19 13:52:28,609 Training for 40 epochs
2020-09-19 13:52:28,611 **Evaluating initial model.**
2020-09-19 13:55:13,154 NMI: 24.435
2020-09-19 13:56:44,069 R@1 : 42.006
2020-09-19 13:56:44,790 R@2 : 50.544
2020-09-19 13:56:45,513 R@4 : 59.936
2020-09-19 13:56:46,240 R@8 : 69.261
2020-09-19 13:59:24,143 Epoch: 0, loss: 2.305, time (seconds): 157.90.
2020-09-19 13:59:24,144 **Evaluating.**
2020-09-19 14:01:30,476 NMI: 28.771
2020-09-19 14:02:55,261 R@1 : 45.220
2020-09-19 14:02:55,987 R@2 : 54.345
2020-09-19 14:02:56,711 R@4 : 63.513
2020-09-19 14:02:57,437 R@8 : 73.027
2020-09-19 14:05:29,738 Epoch: 1, loss: 2.157, time (seconds): 152.29.
2020-09-19 14:05:29,739 **Evaluating.**
2020-09-19 14:07:34,486 NMI: 29.655
2020-09-19 14:09:01,274 R@1 : 47.830
2020-09-19 14:09:01,995 R@2 : 57.027
2020-09-19 14:09:02,714 R@4 : 66.137
2020-09-19 14:09:03,439 R@8 : 74.812
2020-09-19 14:11:34,773 Epoch: 2, loss: 2.015, time (seconds): 151.33.
2020-09-19 14:11:34,774 **Evaluating.**
2020-09-19 14:13:34,633 NMI: 30.119
2020-09-19 14:14:58,877 R@1 : 48.271
2020-09-19 14:14:59,691 R@2 : 57.091
2020-09-19 14:15:00,500 R@4 : 66.207
2020-09-19 14:15:01,308 R@8 : 74.678
2020-09-19 14:17:26,189 Epoch: 3, loss: 1.836, time (seconds): 144.88.
2020-09-19 14:17:26,189 **Evaluating.**
2020-09-19 14:19:14,430 NMI: 29.760
2020-09-19 14:20:39,437 R@1 : 48.384
2020-09-19 14:20:40,162 R@2 : 57.582
2020-09-19 14:20:40,882 R@4 : 66.582
2020-09-19 14:20:41,608 R@8 : 74.844
2020-09-19 14:23:05,450 Epoch: 4, loss: 1.911, time (seconds): 143.84.
2020-09-19 14:23:05,451 **Evaluating.**
2020-09-19 14:24:50,842 NMI: 30.281
2020-09-19 14:26:17,154 R@1 : 48.916
2020-09-19 14:26:17,877 R@2 : 58.415
2020-09-19 14:26:18,602 R@4 : 67.299
2020-09-19 14:26:19,326 R@8 : 75.506
2020-09-19 14:28:45,940 Epoch: 5, loss: 1.709, time (seconds): 146.61.
2020-09-19 14:28:45,941 **Evaluating.**
2020-09-19 14:30:30,431 NMI: 30.349
2020-09-19 14:31:56,491 R@1 : 48.431
2020-09-19 14:31:57,222 R@2 : 57.686
2020-09-19 14:31:57,946 R@4 : 66.825
2020-09-19 14:31:58,676 R@8 : 75.250
2020-09-19 14:34:26,620 Epoch: 6, loss: 1.678, time (seconds): 147.94.
2020-09-19 14:34:26,621 **Evaluating.**
