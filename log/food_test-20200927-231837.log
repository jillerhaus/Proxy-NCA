2020-09-27 23:18:40,417 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-27 23:18:40,417 Training for 20 epochs
2020-09-27 23:18:40,419 **Evaluating initial model.**
2020-09-27 23:19:14,090 NMI: 25.916
2020-09-27 23:19:25,760 R@1 : 32.493
2020-09-27 23:19:26,039 R@2 : 41.514
2020-09-27 23:19:26,314 R@4 : 51.994
2020-09-27 23:19:26,596 R@8 : 62.736
2020-09-27 23:20:01,273 Epoch: 0, loss: 3.315, time (seconds): 34.68.
2020-09-27 23:20:01,274 **Evaluating.**
2020-09-27 23:20:34,393 NMI: 30.626
2020-09-27 23:20:45,437 R@1 : 37.455
2020-09-27 23:20:45,686 R@2 : 47.293
2020-09-27 23:20:45,934 R@4 : 57.782
2020-09-27 23:20:46,184 R@8 : 67.941
2020-09-27 23:21:20,754 Epoch: 1, loss: 3.161, time (seconds): 34.57.
2020-09-27 23:21:20,755 **Evaluating.**
2020-09-27 23:21:54,434 NMI: 30.721
2020-09-27 23:22:05,527 R@1 : 38.177
2020-09-27 23:22:05,775 R@2 : 48.084
2020-09-27 23:22:06,027 R@4 : 58.408
2020-09-27 23:22:06,274 R@8 : 68.072
2020-09-27 23:22:41,218 Epoch: 2, loss: 3.047, time (seconds): 34.94.
2020-09-27 23:22:41,218 **Evaluating.**
2020-09-27 23:23:21,814 NMI: 30.759
2020-09-27 23:23:32,806 R@1 : 37.621
2020-09-27 23:23:33,084 R@2 : 48.040
2020-09-27 23:23:33,374 R@4 : 57.973
2020-09-27 23:23:33,653 R@8 : 67.654
2020-09-27 23:24:18,907 Epoch: 3, loss: 3.006, time (seconds): 45.25.
2020-09-27 23:24:18,908 **Evaluating.**
2020-09-27 23:25:02,182 NMI: 30.352
2020-09-27 23:25:13,241 R@1 : 37.108
2020-09-27 23:25:13,507 R@2 : 47.302
2020-09-27 23:25:13,769 R@4 : 57.513
2020-09-27 23:25:14,041 R@8 : 67.672
2020-09-27 23:25:48,063 Epoch: 4, loss: 2.973, time (seconds): 34.02.
2020-09-27 23:25:48,064 **Evaluating.**
2020-09-27 23:26:20,542 NMI: 29.929
2020-09-27 23:26:31,281 R@1 : 37.316
2020-09-27 23:26:31,559 R@2 : 47.432
2020-09-27 23:26:31,837 R@4 : 57.513
2020-09-27 23:26:32,115 R@8 : 67.263
2020-09-27 23:27:05,735 Epoch: 5, loss: 2.932, time (seconds): 33.62.
2020-09-27 23:27:05,736 **Evaluating.**
2020-09-27 23:27:38,587 NMI: 29.948
2020-09-27 23:27:49,221 R@1 : 36.752
2020-09-27 23:27:49,500 R@2 : 47.076
2020-09-27 23:27:49,780 R@4 : 57.165
2020-09-27 23:27:50,058 R@8 : 67.072
2020-09-27 23:28:23,559 Epoch: 6, loss: 2.911, time (seconds): 33.50.
2020-09-27 23:28:23,560 **Evaluating.**
2020-09-27 23:28:56,176 NMI: 29.998
2020-09-27 23:29:06,753 R@1 : 36.326
2020-09-27 23:29:07,000 R@2 : 46.172
2020-09-27 23:29:07,245 R@4 : 56.148
2020-09-27 23:29:07,490 R@8 : 66.142
2020-09-27 23:29:41,292 Epoch: 7, loss: 2.898, time (seconds): 33.80.
2020-09-27 23:29:41,293 **Evaluating.**
2020-09-27 23:30:13,744 NMI: 29.815
2020-09-27 23:30:24,276 R@1 : 35.735
2020-09-27 23:30:24,554 R@2 : 46.068
2020-09-27 23:30:24,830 R@4 : 56.348
2020-09-27 23:30:25,107 R@8 : 66.368
2020-09-27 23:30:59,383 Epoch: 8, loss: 2.874, time (seconds): 34.27.
2020-09-27 23:30:59,383 **Evaluating.**
2020-09-27 23:31:33,207 NMI: 28.988
2020-09-27 23:31:44,070 R@1 : 35.144
2020-09-27 23:31:44,324 R@2 : 45.268
2020-09-27 23:31:44,582 R@4 : 55.922
2020-09-27 23:31:44,839 R@8 : 66.012
2020-09-27 23:32:20,234 Epoch: 9, loss: 2.841, time (seconds): 35.39.
2020-09-27 23:32:20,235 **Evaluating.**
2020-09-27 23:32:53,834 NMI: 29.430
2020-09-27 23:33:04,736 R@1 : 34.701
2020-09-27 23:33:05,017 R@2 : 44.886
2020-09-27 23:33:05,302 R@4 : 54.810
2020-09-27 23:33:05,587 R@8 : 65.082
2020-09-27 23:33:40,969 Epoch: 10, loss: 2.836, time (seconds): 35.38.
2020-09-27 23:33:40,970 **Evaluating.**
2020-09-27 23:34:14,332 NMI: 28.661
2020-09-27 23:34:25,037 R@1 : 33.275
2020-09-27 23:34:25,308 R@2 : 43.799
2020-09-27 23:34:25,572 R@4 : 54.836
2020-09-27 23:34:25,835 R@8 : 64.865
2020-09-27 23:35:01,003 Epoch: 11, loss: 2.814, time (seconds): 35.17.
2020-09-27 23:35:01,004 **Evaluating.**
2020-09-27 23:35:34,849 NMI: 28.531
2020-09-27 23:35:45,727 R@1 : 33.362
2020-09-27 23:35:45,975 R@2 : 43.487
2020-09-27 23:35:46,228 R@4 : 54.271
2020-09-27 23:35:46,475 R@8 : 64.804
2020-09-27 23:36:21,483 Epoch: 12, loss: 2.818, time (seconds): 35.01.
2020-09-27 23:36:21,484 **Evaluating.**
2020-09-27 23:36:54,672 NMI: 28.259
2020-09-27 23:37:05,402 R@1 : 32.702
2020-09-27 23:37:05,651 R@2 : 43.226
2020-09-27 23:37:05,900 R@4 : 54.515
2020-09-27 23:37:06,155 R@8 : 64.665
2020-09-27 23:37:41,632 Epoch: 13, loss: 2.804, time (seconds): 35.47.
2020-09-27 23:37:41,632 **Evaluating.**
2020-09-27 23:38:15,348 NMI: 27.881
2020-09-27 23:38:26,208 R@1 : 32.963
2020-09-27 23:38:26,455 R@2 : 42.991
2020-09-27 23:38:26,703 R@4 : 53.750
2020-09-27 23:38:26,957 R@8 : 64.465
2020-09-27 23:39:02,428 Epoch: 14, loss: 2.793, time (seconds): 35.47.
2020-09-27 23:39:02,429 **Evaluating.**
2020-09-27 23:39:35,899 NMI: 27.732
2020-09-27 23:39:46,739 R@1 : 31.763
2020-09-27 23:39:47,022 R@2 : 42.140
2020-09-27 23:39:47,300 R@4 : 53.150
2020-09-27 23:39:47,584 R@8 : 63.318
2020-09-27 23:40:23,160 Epoch: 15, loss: 2.783, time (seconds): 35.57.
2020-09-27 23:40:23,161 **Evaluating.**
2020-09-27 23:40:56,383 NMI: 27.379
2020-09-27 23:41:07,259 R@1 : 31.190
2020-09-27 23:41:07,542 R@2 : 41.679
2020-09-27 23:41:07,823 R@4 : 52.907
2020-09-27 23:41:08,102 R@8 : 63.301
2020-09-27 23:41:43,661 Epoch: 16, loss: 2.757, time (seconds): 35.56.
2020-09-27 23:41:43,661 **Evaluating.**
2020-09-27 23:42:17,360 NMI: 27.877
2020-09-27 23:42:28,287 R@1 : 31.572
2020-09-27 23:42:28,555 R@2 : 42.131
2020-09-27 23:42:28,826 R@4 : 52.646
2020-09-27 23:42:29,105 R@8 : 63.492
2020-09-27 23:43:04,861 Epoch: 17, loss: 2.747, time (seconds): 35.75.
2020-09-27 23:43:04,862 **Evaluating.**
2020-09-27 23:43:38,626 NMI: 27.291
2020-09-27 23:43:49,553 R@1 : 30.364
2020-09-27 23:43:49,821 R@2 : 40.680
2020-09-27 23:43:50,097 R@4 : 51.682
2020-09-27 23:43:50,371 R@8 : 62.484
2020-09-27 23:44:26,040 Epoch: 18, loss: 2.771, time (seconds): 35.67.
2020-09-27 23:44:26,040 **Evaluating.**
2020-09-27 23:44:59,181 NMI: 27.105
2020-09-27 23:45:10,105 R@1 : 30.408
2020-09-27 23:45:10,352 R@2 : 40.375
2020-09-27 23:45:10,602 R@4 : 51.134
2020-09-27 23:45:10,852 R@8 : 62.466
2020-09-27 23:45:46,228 Epoch: 19, loss: 2.743, time (seconds): 35.37.
2020-09-27 23:45:46,229 **Evaluating.**
2020-09-27 23:46:19,675 NMI: 27.022
2020-09-27 23:46:30,566 R@1 : 30.329
2020-09-27 23:46:30,817 R@2 : 40.358
2020-09-27 23:46:31,065 R@4 : 51.212
2020-09-27 23:46:31,321 R@8 : 62.162
2020-09-27 23:46:31,323 Total training time (minutes): 27.85.
2020-09-27 23:46:32,059 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-27 23:46:32,059 Training for 20 epochs
2020-09-27 23:46:32,061 **Evaluating initial model.**
2020-09-27 23:47:05,752 NMI: 25.916
2020-09-27 23:47:17,286 R@1 : 32.493
2020-09-27 23:47:17,543 R@2 : 41.514
2020-09-27 23:47:17,792 R@4 : 51.994
2020-09-27 23:47:18,049 R@8 : 62.736
2020-09-27 23:47:53,630 Epoch: 0, loss: 2.770, time (seconds): 35.58.
2020-09-27 23:47:53,631 **Evaluating.**
2020-09-27 23:48:27,168 NMI: 30.288
2020-09-27 23:48:38,256 R@1 : 37.847
2020-09-27 23:48:38,543 R@2 : 47.867
2020-09-27 23:48:38,821 R@4 : 58.417
2020-09-27 23:48:39,100 R@8 : 68.445
2020-09-27 23:49:14,506 Epoch: 1, loss: 2.366, time (seconds): 35.40.
2020-09-27 23:49:14,507 **Evaluating.**
2020-09-27 23:49:48,513 NMI: 32.927
2020-09-27 23:49:59,639 R@1 : 40.506
2020-09-27 23:49:59,891 R@2 : 50.647
2020-09-27 23:50:00,141 R@4 : 60.833
2020-09-27 23:50:00,399 R@8 : 70.531
2020-09-27 23:50:36,381 Epoch: 2, loss: 2.139, time (seconds): 35.98.
2020-09-27 23:50:36,382 **Evaluating.**
2020-09-27 23:51:10,114 NMI: 33.689
2020-09-27 23:51:21,309 R@1 : 40.627
2020-09-27 23:51:21,559 R@2 : 51.030
2020-09-27 23:51:21,808 R@4 : 61.050
2020-09-27 23:51:22,058 R@8 : 70.835
2020-09-27 23:51:57,545 Epoch: 3, loss: 2.069, time (seconds): 35.49.
2020-09-27 23:51:57,546 **Evaluating.**
2020-09-27 23:52:30,744 NMI: 32.970
2020-09-27 23:52:41,913 R@1 : 41.036
2020-09-27 23:52:42,173 R@2 : 51.603
2020-09-27 23:52:42,435 R@4 : 61.623
2020-09-27 23:52:42,694 R@8 : 71.131
2020-09-27 23:53:18,482 Epoch: 4, loss: 1.986, time (seconds): 35.79.
2020-09-27 23:53:18,482 **Evaluating.**
2020-09-27 23:53:51,714 NMI: 31.898
2020-09-27 23:54:02,848 R@1 : 40.167
2020-09-27 23:54:03,106 R@2 : 50.786
2020-09-27 23:54:03,359 R@4 : 61.032
2020-09-27 23:54:03,613 R@8 : 70.488
2020-09-27 23:54:39,159 Epoch: 5, loss: 1.866, time (seconds): 35.54.
2020-09-27 23:54:39,160 **Evaluating.**
2020-09-27 23:55:12,814 NMI: 31.652
2020-09-27 23:55:23,930 R@1 : 40.445
2020-09-27 23:55:24,180 R@2 : 50.500
2020-09-27 23:55:24,440 R@4 : 60.937
2020-09-27 23:55:24,694 R@8 : 70.922
2020-09-27 23:56:00,007 Epoch: 6, loss: 1.822, time (seconds): 35.31.
2020-09-27 23:56:00,007 **Evaluating.**
2020-09-27 23:56:33,472 NMI: 30.657
2020-09-27 23:56:44,732 R@1 : 39.185
2020-09-27 23:56:45,000 R@2 : 49.535
2020-09-27 23:56:45,278 R@4 : 59.990
2020-09-27 23:56:45,548 R@8 : 69.506
2020-09-27 23:57:21,208 Epoch: 7, loss: 1.772, time (seconds): 35.66.
2020-09-27 23:57:21,209 **Evaluating.**
2020-09-27 23:57:54,732 NMI: 30.963
2020-09-27 23:58:05,946 R@1 : 39.263
2020-09-27 23:58:06,212 R@2 : 49.274
2020-09-27 23:58:06,486 R@4 : 60.033
2020-09-27 23:58:06,752 R@8 : 70.201
2020-09-27 23:58:42,288 Epoch: 8, loss: 1.716, time (seconds): 35.53.
2020-09-27 23:58:42,289 **Evaluating.**
2020-09-27 23:59:15,582 NMI: 30.055
2020-09-27 23:59:26,780 R@1 : 38.168
2020-09-27 23:59:27,058 R@2 : 48.614
2020-09-27 23:59:27,343 R@4 : 58.756
2020-09-27 23:59:27,627 R@8 : 68.723
2020-09-28 00:00:02,815 Epoch: 9, loss: 1.643, time (seconds): 35.19.
2020-09-28 00:00:02,816 **Evaluating.**
2020-09-28 00:00:36,500 NMI: 30.072
2020-09-28 00:00:47,769 R@1 : 38.125
2020-09-28 00:00:48,015 R@2 : 48.744
2020-09-28 00:00:48,262 R@4 : 59.242
2020-09-28 00:00:48,510 R@8 : 69.245
2020-09-28 00:01:23,562 Epoch: 10, loss: 1.624, time (seconds): 35.05.
2020-09-28 00:01:23,563 **Evaluating.**
2020-09-28 00:01:56,979 NMI: 29.653
2020-09-28 00:02:08,175 R@1 : 36.995
2020-09-28 00:02:08,424 R@2 : 47.319
2020-09-28 00:02:08,682 R@4 : 58.391
2020-09-28 00:02:08,941 R@8 : 68.602
2020-09-28 00:02:44,219 Epoch: 11, loss: 1.555, time (seconds): 35.28.
2020-09-28 00:02:44,220 **Evaluating.**
2020-09-28 00:03:17,478 NMI: 28.162
2020-09-28 00:03:28,754 R@1 : 36.065
2020-09-28 00:03:29,004 R@2 : 46.285
2020-09-28 00:03:29,261 R@4 : 57.087
2020-09-28 00:03:29,509 R@8 : 67.646
2020-09-28 00:04:04,748 Epoch: 12, loss: 1.575, time (seconds): 35.24.
2020-09-28 00:04:04,749 **Evaluating.**
2020-09-28 00:04:37,734 NMI: 28.550
2020-09-28 00:04:48,986 R@1 : 36.022
2020-09-28 00:04:49,248 R@2 : 46.485
2020-09-28 00:04:49,512 R@4 : 56.774
2020-09-28 00:04:49,775 R@8 : 67.220
2020-09-28 00:05:25,192 Epoch: 13, loss: 1.525, time (seconds): 35.42.
2020-09-28 00:05:25,193 **Evaluating.**
2020-09-28 00:05:58,672 NMI: 28.971
2020-09-28 00:06:09,874 R@1 : 35.830
2020-09-28 00:06:10,123 R@2 : 46.467
2020-09-28 00:06:10,371 R@4 : 56.913
2020-09-28 00:06:10,632 R@8 : 67.376
2020-09-28 00:06:46,118 Epoch: 14, loss: 1.501, time (seconds): 35.48.
2020-09-28 00:06:46,119 **Evaluating.**
2020-09-28 00:07:19,599 NMI: 27.961
2020-09-28 00:07:30,976 R@1 : 35.335
2020-09-28 00:07:31,231 R@2 : 45.737
2020-09-28 00:07:31,492 R@4 : 56.531
2020-09-28 00:07:31,743 R@8 : 66.924
2020-09-28 00:08:07,291 Epoch: 15, loss: 1.455, time (seconds): 35.55.
2020-09-28 00:08:07,292 **Evaluating.**
2020-09-28 00:08:40,595 NMI: 27.282
2020-09-28 00:08:51,860 R@1 : 34.961
2020-09-28 00:08:52,115 R@2 : 45.285
2020-09-28 00:08:52,362 R@4 : 55.401
2020-09-28 00:08:52,609 R@8 : 65.664
2020-09-28 00:09:27,763 Epoch: 16, loss: 1.420, time (seconds): 35.15.
2020-09-28 00:09:27,764 **Evaluating.**
2020-09-28 00:10:01,695 NMI: 27.875
2020-09-28 00:10:12,989 R@1 : 35.448
2020-09-28 00:10:13,249 R@2 : 45.268
2020-09-28 00:10:13,510 R@4 : 55.575
2020-09-28 00:10:13,763 R@8 : 65.934
2020-09-28 00:10:49,476 Epoch: 17, loss: 1.375, time (seconds): 35.71.
2020-09-28 00:10:49,477 **Evaluating.**
2020-09-28 00:11:22,601 NMI: 26.332
2020-09-28 00:11:33,895 R@1 : 34.553
2020-09-28 00:11:34,155 R@2 : 44.399
2020-09-28 00:11:34,416 R@4 : 54.662
2020-09-28 00:11:34,676 R@8 : 64.856
2020-09-28 00:12:09,868 Epoch: 18, loss: 1.426, time (seconds): 35.19.
2020-09-28 00:12:09,869 **Evaluating.**
2020-09-28 00:12:43,009 NMI: 26.997
2020-09-28 00:12:54,227 R@1 : 34.866
2020-09-28 00:12:54,476 R@2 : 44.512
2020-09-28 00:12:54,723 R@4 : 54.506
2020-09-28 00:12:54,973 R@8 : 64.674
2020-09-28 00:13:30,344 Epoch: 19, loss: 1.365, time (seconds): 35.37.
2020-09-28 00:13:30,345 **Evaluating.**
2020-09-28 00:14:03,513 NMI: 27.204
2020-09-28 00:14:14,741 R@1 : 34.796
2020-09-28 00:14:14,993 R@2 : 44.243
2020-09-28 00:14:15,241 R@4 : 54.402
2020-09-28 00:14:15,492 R@8 : 64.543
2020-09-28 00:14:15,494 Total training time (minutes): 27.72.
2020-09-28 00:14:16,212 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 00:14:16,212 Training for 20 epochs
2020-09-28 00:14:16,214 **Evaluating initial model.**
2020-09-28 00:14:54,408 NMI: 25.916
2020-09-28 00:15:05,823 R@1 : 32.493
2020-09-28 00:15:06,074 R@2 : 41.514
2020-09-28 00:15:06,321 R@4 : 51.994
2020-09-28 00:15:06,572 R@8 : 62.736
2020-09-28 00:16:01,132 Epoch: 0, loss: 2.729, time (seconds): 54.56.
2020-09-28 00:16:01,133 **Evaluating.**
2020-09-28 00:16:38,978 NMI: 27.167
2020-09-28 00:16:49,667 R@1 : 31.746
2020-09-28 00:16:49,919 R@2 : 42.148
2020-09-28 00:16:50,176 R@4 : 53.350
2020-09-28 00:16:50,431 R@8 : 64.370
2020-09-28 00:17:44,434 Epoch: 1, loss: 2.368, time (seconds): 54.00.
2020-09-28 00:17:44,435 **Evaluating.**
2020-09-28 00:18:21,757 NMI: 28.867
2020-09-28 00:18:32,711 R@1 : 35.292
2020-09-28 00:18:32,981 R@2 : 45.398
2020-09-28 00:18:33,252 R@4 : 56.348
2020-09-28 00:18:33,522 R@8 : 67.150
2020-09-28 00:19:27,107 Epoch: 2, loss: 2.161, time (seconds): 53.58.
2020-09-28 00:19:27,107 **Evaluating.**
2020-09-28 00:20:04,272 NMI: 30.296
2020-09-28 00:20:15,259 R@1 : 36.621
2020-09-28 00:20:15,506 R@2 : 47.258
2020-09-28 00:20:15,755 R@4 : 58.269
2020-09-28 00:20:16,000 R@8 : 68.506
2020-09-28 00:21:10,633 Epoch: 3, loss: 2.201, time (seconds): 54.63.
2020-09-28 00:21:10,634 **Evaluating.**
2020-09-28 00:21:47,954 NMI: 29.216
2020-09-28 00:21:58,984 R@1 : 37.117
2020-09-28 00:21:59,248 R@2 : 47.771
2020-09-28 00:21:59,510 R@4 : 58.504
2020-09-28 00:21:59,774 R@8 : 68.541
2020-09-28 00:22:53,994 Epoch: 4, loss: 1.939, time (seconds): 54.22.
2020-09-28 00:22:53,994 **Evaluating.**
2020-09-28 00:23:31,309 NMI: 29.714
2020-09-28 00:23:42,400 R@1 : 36.699
2020-09-28 00:23:42,647 R@2 : 46.745
2020-09-28 00:23:42,893 R@4 : 57.930
2020-09-28 00:23:43,139 R@8 : 68.298
2020-09-28 00:24:37,100 Epoch: 5, loss: 1.949, time (seconds): 53.96.
2020-09-28 00:24:37,102 **Evaluating.**
2020-09-28 00:25:14,004 NMI: 29.544
2020-09-28 00:25:25,153 R@1 : 37.308
2020-09-28 00:25:25,416 R@2 : 47.389
2020-09-28 00:25:25,679 R@4 : 58.069
2020-09-28 00:25:25,942 R@8 : 68.437
2020-09-28 00:26:19,549 Epoch: 6, loss: 1.751, time (seconds): 53.61.
2020-09-28 00:26:19,550 **Evaluating.**
2020-09-28 00:26:57,375 NMI: 30.130
2020-09-28 00:27:08,535 R@1 : 37.360
2020-09-28 00:27:08,785 R@2 : 47.910
2020-09-28 00:27:09,031 R@4 : 59.034
2020-09-28 00:27:09,278 R@8 : 69.297
2020-09-28 00:28:03,143 Epoch: 7, loss: 1.701, time (seconds): 53.86.
2020-09-28 00:28:03,144 **Evaluating.**
2020-09-28 00:28:39,504 NMI: 30.770
2020-09-28 00:28:50,687 R@1 : 37.742
2020-09-28 00:28:50,949 R@2 : 48.092
2020-09-28 00:28:51,220 R@4 : 58.869
2020-09-28 00:28:51,489 R@8 : 69.679
2020-09-28 00:29:45,128 Epoch: 8, loss: 1.627, time (seconds): 53.64.
2020-09-28 00:29:45,129 **Evaluating.**
2020-09-28 00:30:22,418 NMI: 30.279
2020-09-28 00:30:33,582 R@1 : 37.403
2020-09-28 00:30:33,830 R@2 : 48.006
2020-09-28 00:30:34,077 R@4 : 58.121
2020-09-28 00:30:34,324 R@8 : 68.628
2020-09-28 00:31:27,851 Epoch: 9, loss: 1.665, time (seconds): 53.53.
2020-09-28 00:31:27,851 **Evaluating.**
2020-09-28 00:32:05,455 NMI: 30.243
2020-09-28 00:32:16,846 R@1 : 37.629
2020-09-28 00:32:17,097 R@2 : 47.736
2020-09-28 00:32:17,345 R@4 : 58.981
2020-09-28 00:32:17,591 R@8 : 69.549
2020-09-28 00:33:11,224 Epoch: 10, loss: 1.555, time (seconds): 53.63.
2020-09-28 00:33:11,225 **Evaluating.**
2020-09-28 00:33:49,174 NMI: 30.139
2020-09-28 00:34:00,432 R@1 : 38.125
2020-09-28 00:34:00,679 R@2 : 48.388
2020-09-28 00:34:00,924 R@4 : 58.695
2020-09-28 00:34:01,174 R@8 : 69.253
2020-09-28 00:34:55,022 Epoch: 11, loss: 1.500, time (seconds): 53.85.
2020-09-28 00:34:55,024 **Evaluating.**
2020-09-28 00:35:31,806 NMI: 30.256
2020-09-28 00:35:43,163 R@1 : 37.681
2020-09-28 00:35:43,411 R@2 : 47.719
2020-09-28 00:35:43,658 R@4 : 58.634
2020-09-28 00:35:43,905 R@8 : 69.245
2020-09-28 00:36:38,266 Epoch: 12, loss: 1.415, time (seconds): 54.36.
2020-09-28 00:36:38,267 **Evaluating.**
2020-09-28 00:37:15,290 NMI: 29.319
2020-09-28 00:37:26,610 R@1 : 36.891
2020-09-28 00:37:26,889 R@2 : 47.163
2020-09-28 00:37:27,164 R@4 : 57.869
2020-09-28 00:37:27,443 R@8 : 67.863
2020-09-28 00:38:21,716 Epoch: 13, loss: 1.443, time (seconds): 54.27.
2020-09-28 00:38:21,717 **Evaluating.**
2020-09-28 00:38:58,394 NMI: 29.309
2020-09-28 00:39:09,676 R@1 : 37.264
2020-09-28 00:39:09,923 R@2 : 46.893
2020-09-28 00:39:10,171 R@4 : 57.930
2020-09-28 00:39:10,418 R@8 : 68.002
2020-09-28 00:40:04,191 Epoch: 14, loss: 1.403, time (seconds): 53.77.
2020-09-28 00:40:04,191 **Evaluating.**
2020-09-28 00:40:41,366 NMI: 29.678
2020-09-28 00:40:52,680 R@1 : 36.534
2020-09-28 00:40:52,927 R@2 : 46.267
2020-09-28 00:40:53,173 R@4 : 56.922
2020-09-28 00:40:53,422 R@8 : 67.429
2020-09-28 00:41:47,117 Epoch: 15, loss: 1.324, time (seconds): 53.69.
2020-09-28 00:41:47,118 **Evaluating.**
2020-09-28 00:42:25,009 NMI: 29.183
2020-09-28 00:42:36,308 R@1 : 35.796
2020-09-28 00:42:36,556 R@2 : 45.763
2020-09-28 00:42:36,804 R@4 : 56.583
2020-09-28 00:42:37,052 R@8 : 67.185
2020-09-28 00:43:31,130 Epoch: 16, loss: 1.281, time (seconds): 54.08.
2020-09-28 00:43:31,131 **Evaluating.**
2020-09-28 00:44:08,542 NMI: 28.119
2020-09-28 00:44:19,799 R@1 : 35.587
2020-09-28 00:44:20,046 R@2 : 46.042
2020-09-28 00:44:20,294 R@4 : 56.314
2020-09-28 00:44:20,543 R@8 : 67.133
2020-09-28 00:45:15,196 Epoch: 17, loss: 1.273, time (seconds): 54.65.
2020-09-28 00:45:15,197 **Evaluating.**
2020-09-28 00:45:52,620 NMI: 28.414
2020-09-28 00:46:03,959 R@1 : 35.570
2020-09-28 00:46:04,206 R@2 : 45.312
2020-09-28 00:46:04,452 R@4 : 55.801
2020-09-28 00:46:04,699 R@8 : 66.334
2020-09-28 00:46:59,343 Epoch: 18, loss: 1.201, time (seconds): 54.64.
2020-09-28 00:46:59,344 **Evaluating.**
2020-09-28 00:47:36,191 NMI: 29.370
2020-09-28 00:47:47,537 R@1 : 36.665
2020-09-28 00:47:47,785 R@2 : 46.198
2020-09-28 00:47:48,033 R@4 : 56.870
2020-09-28 00:47:48,282 R@8 : 67.507
2020-09-28 00:48:42,708 Epoch: 19, loss: 1.164, time (seconds): 54.42.
2020-09-28 00:48:42,709 **Evaluating.**
2020-09-28 00:49:21,039 NMI: 28.473
2020-09-28 00:49:32,349 R@1 : 35.405
2020-09-28 00:49:32,612 R@2 : 44.903
2020-09-28 00:49:32,874 R@4 : 55.340
2020-09-28 00:49:33,140 R@8 : 66.351
2020-09-28 00:49:33,142 Total training time (minutes): 35.28.
2020-09-28 00:49:33,891 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 1.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 00:49:33,891 Training for 20 epochs
2020-09-28 00:49:33,893 **Evaluating initial model.**
2020-09-28 00:50:07,950 NMI: 25.916
2020-09-28 00:50:19,345 R@1 : 32.493
2020-09-28 00:50:19,619 R@2 : 41.514
2020-09-28 00:50:19,893 R@4 : 51.994
2020-09-28 00:50:20,170 R@8 : 62.736
2020-09-28 00:50:55,959 Epoch: 0, loss: 3.464, time (seconds): 35.79.
2020-09-28 00:50:55,960 **Evaluating.**
2020-09-28 00:51:29,762 NMI: 23.528
2020-09-28 00:51:40,358 R@1 : 30.277
2020-09-28 00:51:40,634 R@2 : 40.280
2020-09-28 00:51:40,910 R@4 : 51.195
2020-09-28 00:51:41,194 R@8 : 63.170
2020-09-28 00:52:16,312 Epoch: 1, loss: 2.689, time (seconds): 35.12.
2020-09-28 00:52:16,312 **Evaluating.**
2020-09-28 00:52:50,269 NMI: 28.252
2020-09-28 00:53:00,833 R@1 : 34.761
2020-09-28 00:53:01,084 R@2 : 45.346
2020-09-28 00:53:01,337 R@4 : 56.192
2020-09-28 00:53:01,589 R@8 : 67.107
2020-09-28 00:53:36,863 Epoch: 2, loss: 2.326, time (seconds): 35.27.
2020-09-28 00:53:36,864 **Evaluating.**
2020-09-28 00:54:10,715 NMI: 30.807
2020-09-28 00:54:21,425 R@1 : 38.177
2020-09-28 00:54:21,671 R@2 : 48.597
2020-09-28 00:54:21,920 R@4 : 59.364
2020-09-28 00:54:22,167 R@8 : 69.497
2020-09-28 00:54:57,317 Epoch: 3, loss: 2.180, time (seconds): 35.15.
2020-09-28 00:54:57,318 **Evaluating.**
2020-09-28 00:55:30,936 NMI: 32.481
2020-09-28 00:55:41,831 R@1 : 39.315
2020-09-28 00:55:42,086 R@2 : 50.178
2020-09-28 00:55:42,333 R@4 : 60.876
2020-09-28 00:55:42,590 R@8 : 70.757
2020-09-28 00:56:17,980 Epoch: 4, loss: 2.061, time (seconds): 35.39.
2020-09-28 00:56:17,981 **Evaluating.**
2020-09-28 00:56:51,769 NMI: 33.081
2020-09-28 00:57:02,688 R@1 : 40.723
2020-09-28 00:57:02,939 R@2 : 50.960
2020-09-28 00:57:03,191 R@4 : 61.423
2020-09-28 00:57:03,449 R@8 : 71.548
2020-09-28 00:57:38,899 Epoch: 5, loss: 1.909, time (seconds): 35.45.
2020-09-28 00:57:38,900 **Evaluating.**
2020-09-28 00:58:12,835 NMI: 32.945
2020-09-28 00:58:23,956 R@1 : 40.202
2020-09-28 00:58:24,209 R@2 : 50.986
2020-09-28 00:58:24,465 R@4 : 61.745
2020-09-28 00:58:24,726 R@8 : 71.539
2020-09-28 00:59:00,195 Epoch: 6, loss: 1.845, time (seconds): 35.47.
2020-09-28 00:59:00,196 **Evaluating.**
2020-09-28 00:59:34,186 NMI: 32.721
2020-09-28 00:59:45,243 R@1 : 40.323
2020-09-28 00:59:45,492 R@2 : 51.160
2020-09-28 00:59:45,740 R@4 : 61.919
2020-09-28 00:59:45,994 R@8 : 71.539
2020-09-28 01:00:21,527 Epoch: 7, loss: 1.759, time (seconds): 35.53.
2020-09-28 01:00:21,528 **Evaluating.**
2020-09-28 01:00:55,516 NMI: 33.204
2020-09-28 01:01:06,590 R@1 : 41.131
2020-09-28 01:01:06,849 R@2 : 51.829
2020-09-28 01:01:07,099 R@4 : 62.301
2020-09-28 01:01:07,352 R@8 : 72.043
2020-09-28 01:01:42,528 Epoch: 8, loss: 1.691, time (seconds): 35.17.
2020-09-28 01:01:42,529 **Evaluating.**
2020-09-28 01:02:16,138 NMI: 32.183
2020-09-28 01:02:27,226 R@1 : 40.419
2020-09-28 01:02:27,483 R@2 : 51.056
2020-09-28 01:02:27,736 R@4 : 61.606
2020-09-28 01:02:27,993 R@8 : 71.435
2020-09-28 01:03:03,903 Epoch: 9, loss: 1.603, time (seconds): 35.91.
2020-09-28 01:03:03,903 **Evaluating.**
2020-09-28 01:03:37,474 NMI: 33.254
2020-09-28 01:03:48,647 R@1 : 40.845
2020-09-28 01:03:48,892 R@2 : 51.543
2020-09-28 01:03:49,138 R@4 : 62.345
2020-09-28 01:03:49,394 R@8 : 71.704
2020-09-28 01:04:24,909 Epoch: 10, loss: 1.571, time (seconds): 35.51.
2020-09-28 01:04:24,910 **Evaluating.**
2020-09-28 01:04:58,389 NMI: 32.129
2020-09-28 01:05:09,560 R@1 : 40.445
2020-09-28 01:05:09,809 R@2 : 51.099
2020-09-28 01:05:10,056 R@4 : 61.919
2020-09-28 01:05:10,303 R@8 : 71.782
2020-09-28 01:05:46,096 Epoch: 11, loss: 1.477, time (seconds): 35.79.
2020-09-28 01:05:46,096 **Evaluating.**
2020-09-28 01:06:19,730 NMI: 32.138
2020-09-28 01:06:30,918 R@1 : 39.506
2020-09-28 01:06:31,177 R@2 : 49.909
2020-09-28 01:06:31,437 R@4 : 60.850
2020-09-28 01:06:31,693 R@8 : 71.244
2020-09-28 01:07:07,120 Epoch: 12, loss: 1.511, time (seconds): 35.42.
2020-09-28 01:07:07,121 **Evaluating.**
2020-09-28 01:07:41,062 NMI: 31.785
2020-09-28 01:07:52,241 R@1 : 39.689
2020-09-28 01:07:52,517 R@2 : 50.465
2020-09-28 01:07:52,793 R@4 : 60.911
2020-09-28 01:07:53,073 R@8 : 71.052
2020-09-28 01:08:28,412 Epoch: 13, loss: 1.436, time (seconds): 35.34.
2020-09-28 01:08:28,413 **Evaluating.**
2020-09-28 01:09:02,050 NMI: 32.198
2020-09-28 01:09:13,271 R@1 : 39.967
2020-09-28 01:09:13,521 R@2 : 50.726
2020-09-28 01:09:13,767 R@4 : 61.649
2020-09-28 01:09:14,026 R@8 : 71.435
2020-09-28 01:09:49,688 Epoch: 14, loss: 1.396, time (seconds): 35.66.
2020-09-28 01:09:49,688 **Evaluating.**
2020-09-28 01:10:23,611 NMI: 31.952
2020-09-28 01:10:34,887 R@1 : 39.619
2020-09-28 01:10:35,135 R@2 : 50.291
2020-09-28 01:10:35,387 R@4 : 60.693
2020-09-28 01:10:35,644 R@8 : 70.887
2020-09-28 01:11:11,029 Epoch: 15, loss: 1.357, time (seconds): 35.38.
2020-09-28 01:11:11,030 **Evaluating.**
2020-09-28 01:11:44,820 NMI: 31.396
2020-09-28 01:11:56,264 R@1 : 39.350
2020-09-28 01:11:56,541 R@2 : 49.726
2020-09-28 01:11:56,822 R@4 : 60.198
2020-09-28 01:11:57,100 R@8 : 70.183
2020-09-28 01:12:31,909 Epoch: 16, loss: 1.329, time (seconds): 34.81.
2020-09-28 01:12:31,909 **Evaluating.**
2020-09-28 01:13:05,744 NMI: 31.781
2020-09-28 01:13:16,925 R@1 : 39.532
2020-09-28 01:13:17,174 R@2 : 49.944
2020-09-28 01:13:17,429 R@4 : 60.737
2020-09-28 01:13:17,686 R@8 : 70.783
2020-09-28 01:13:52,850 Epoch: 17, loss: 1.261, time (seconds): 35.16.
2020-09-28 01:13:52,850 **Evaluating.**
2020-09-28 01:14:26,800 NMI: 31.485
2020-09-28 01:14:37,953 R@1 : 39.437
2020-09-28 01:14:38,207 R@2 : 49.770
2020-09-28 01:14:38,466 R@4 : 60.441
2020-09-28 01:14:38,715 R@8 : 70.635
2020-09-28 01:15:14,200 Epoch: 18, loss: 1.312, time (seconds): 35.48.
2020-09-28 01:15:14,201 **Evaluating.**
2020-09-28 01:15:47,819 NMI: 31.283
2020-09-28 01:15:59,082 R@1 : 39.663
2020-09-28 01:15:59,338 R@2 : 49.613
2020-09-28 01:15:59,596 R@4 : 60.189
2020-09-28 01:15:59,847 R@8 : 70.131
2020-09-28 01:16:35,255 Epoch: 19, loss: 1.258, time (seconds): 35.41.
2020-09-28 01:16:35,256 **Evaluating.**
2020-09-28 01:17:09,011 NMI: 30.741
2020-09-28 01:17:20,251 R@1 : 38.394
2020-09-28 01:17:20,538 R@2 : 49.318
2020-09-28 01:17:20,822 R@4 : 60.024
2020-09-28 01:17:21,103 R@8 : 70.010
2020-09-28 01:17:21,105 Total training time (minutes): 27.79.
2020-09-28 01:17:21,818 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 01:17:21,819 Training for 20 epochs
2020-09-28 01:17:21,820 **Evaluating initial model.**
2020-09-28 01:17:59,703 NMI: 25.916
2020-09-28 01:18:11,021 R@1 : 32.493
2020-09-28 01:18:11,270 R@2 : 41.514
2020-09-28 01:18:11,519 R@4 : 51.994
2020-09-28 01:18:11,767 R@8 : 62.736
2020-09-28 01:19:06,593 Epoch: 0, loss: 2.490, time (seconds): 54.83.
2020-09-28 01:19:06,594 **Evaluating.**
2020-09-28 01:19:43,466 NMI: 29.662
2020-09-28 01:19:54,335 R@1 : 37.447
2020-09-28 01:19:54,606 R@2 : 47.719
2020-09-28 01:19:54,875 R@4 : 58.564
2020-09-28 01:19:55,150 R@8 : 68.663
2020-09-28 01:20:49,520 Epoch: 1, loss: 2.235, time (seconds): 54.37.
2020-09-28 01:20:49,521 **Evaluating.**
2020-09-28 01:21:26,114 NMI: 30.108
2020-09-28 01:21:37,093 R@1 : 37.429
2020-09-28 01:21:37,339 R@2 : 47.693
2020-09-28 01:21:37,592 R@4 : 58.782
2020-09-28 01:21:37,842 R@8 : 69.062
2020-09-28 01:22:32,665 Epoch: 2, loss: 2.112, time (seconds): 54.82.
2020-09-28 01:22:32,666 **Evaluating.**
2020-09-28 01:23:09,085 NMI: 29.878
2020-09-28 01:23:20,026 R@1 : 36.586
2020-09-28 01:23:20,280 R@2 : 47.580
2020-09-28 01:23:20,527 R@4 : 58.504
2020-09-28 01:23:20,780 R@8 : 68.419
2020-09-28 01:24:15,088 Epoch: 3, loss: 2.065, time (seconds): 54.31.
2020-09-28 01:24:15,089 **Evaluating.**
2020-09-28 01:24:51,749 NMI: 29.080
2020-09-28 01:25:02,946 R@1 : 37.508
2020-09-28 01:25:03,201 R@2 : 47.206
2020-09-28 01:25:03,455 R@4 : 57.617
2020-09-28 01:25:03,707 R@8 : 67.263
2020-09-28 01:25:57,954 Epoch: 4, loss: 1.884, time (seconds): 54.25.
2020-09-28 01:25:57,955 **Evaluating.**
2020-09-28 01:26:34,453 NMI: 27.554
2020-09-28 01:26:45,565 R@1 : 35.422
2020-09-28 01:26:45,842 R@2 : 45.155
2020-09-28 01:26:46,118 R@4 : 55.297
2020-09-28 01:26:46,396 R@8 : 65.977
2020-09-28 01:27:40,746 Epoch: 5, loss: 1.859, time (seconds): 54.35.
2020-09-28 01:27:40,747 **Evaluating.**
2020-09-28 01:28:17,242 NMI: 26.829
2020-09-28 01:28:28,312 R@1 : 35.630
2020-09-28 01:28:28,597 R@2 : 45.329
2020-09-28 01:28:28,879 R@4 : 55.349
2020-09-28 01:28:29,165 R@8 : 65.404
2020-09-28 01:29:22,875 Epoch: 6, loss: 1.733, time (seconds): 53.71.
2020-09-28 01:29:22,876 **Evaluating.**
2020-09-28 01:29:59,610 NMI: 26.806
2020-09-28 01:30:10,676 R@1 : 34.848
2020-09-28 01:30:10,931 R@2 : 44.364
2020-09-28 01:30:11,179 R@4 : 55.071
2020-09-28 01:30:11,429 R@8 : 65.447
2020-09-28 01:31:05,611 Epoch: 7, loss: 1.705, time (seconds): 54.18.
2020-09-28 01:31:05,612 **Evaluating.**
2020-09-28 01:31:42,169 NMI: 27.441
2020-09-28 01:31:53,287 R@1 : 34.709
2020-09-28 01:31:53,564 R@2 : 44.747
2020-09-28 01:31:53,843 R@4 : 55.140
2020-09-28 01:31:54,127 R@8 : 65.647
2020-09-28 01:32:47,933 Epoch: 8, loss: 1.614, time (seconds): 53.80.
2020-09-28 01:32:47,933 **Evaluating.**
2020-09-28 01:33:24,737 NMI: 27.154
2020-09-28 01:33:35,816 R@1 : 34.779
2020-09-28 01:33:36,065 R@2 : 44.512
2020-09-28 01:33:36,318 R@4 : 55.401
2020-09-28 01:33:36,570 R@8 : 65.169
2020-09-28 01:34:31,092 Epoch: 9, loss: 1.627, time (seconds): 54.52.
2020-09-28 01:34:31,093 **Evaluating.**
2020-09-28 01:35:07,615 NMI: 26.693
2020-09-28 01:35:18,659 R@1 : 33.814
2020-09-28 01:35:18,906 R@2 : 43.339
2020-09-28 01:35:19,156 R@4 : 54.402
2020-09-28 01:35:19,405 R@8 : 64.882
2020-09-28 01:36:13,570 Epoch: 10, loss: 1.577, time (seconds): 54.16.
2020-09-28 01:36:13,571 **Evaluating.**
2020-09-28 01:36:51,048 NMI: 26.074
2020-09-28 01:37:02,205 R@1 : 33.693
2020-09-28 01:37:02,458 R@2 : 43.078
2020-09-28 01:37:02,708 R@4 : 52.724
2020-09-28 01:37:02,955 R@8 : 63.726
2020-09-28 01:37:57,165 Epoch: 11, loss: 1.520, time (seconds): 54.21.
2020-09-28 01:37:57,166 **Evaluating.**
2020-09-28 01:38:34,572 NMI: 25.525
2020-09-28 01:38:45,717 R@1 : 32.963
2020-09-28 01:38:45,966 R@2 : 42.366
2020-09-28 01:38:46,212 R@4 : 52.629
2020-09-28 01:38:46,460 R@8 : 62.684
2020-09-28 01:39:40,897 Epoch: 12, loss: 1.442, time (seconds): 54.43.
2020-09-28 01:39:40,898 **Evaluating.**
2020-09-28 01:40:17,322 NMI: 24.757
2020-09-28 01:40:28,361 R@1 : 32.033
2020-09-28 01:40:28,609 R@2 : 41.609
2020-09-28 01:40:28,858 R@4 : 51.204
2020-09-28 01:40:29,106 R@8 : 61.510
2020-09-28 01:41:23,545 Epoch: 13, loss: 1.469, time (seconds): 54.44.
2020-09-28 01:41:23,545 **Evaluating.**
2020-09-28 01:41:59,658 NMI: 24.574
2020-09-28 01:42:10,922 R@1 : 32.719
2020-09-28 01:42:11,166 R@2 : 42.192
2020-09-28 01:42:11,413 R@4 : 52.481
2020-09-28 01:42:11,659 R@8 : 62.910
2020-09-28 01:43:06,188 Epoch: 14, loss: 1.399, time (seconds): 54.53.
2020-09-28 01:43:06,189 **Evaluating.**
2020-09-28 01:43:42,566 NMI: 24.275
2020-09-28 01:43:53,768 R@1 : 31.381
2020-09-28 01:43:54,041 R@2 : 40.758
2020-09-28 01:43:54,315 R@4 : 51.351
2020-09-28 01:43:54,589 R@8 : 61.528
2020-09-28 01:44:48,712 Epoch: 15, loss: 1.355, time (seconds): 54.12.
2020-09-28 01:44:48,713 **Evaluating.**
2020-09-28 01:45:25,203 NMI: 24.215
2020-09-28 01:45:36,269 R@1 : 31.485
2020-09-28 01:45:36,515 R@2 : 41.010
2020-09-28 01:45:36,762 R@4 : 50.500
2020-09-28 01:45:37,009 R@8 : 60.850
2020-09-28 01:46:31,299 Epoch: 16, loss: 1.319, time (seconds): 54.29.
2020-09-28 01:46:31,299 **Evaluating.**
2020-09-28 01:47:07,146 NMI: 24.212
2020-09-28 01:47:18,291 R@1 : 30.329
2020-09-28 01:47:18,539 R@2 : 39.880
2020-09-28 01:47:18,799 R@4 : 50.430
2020-09-28 01:47:19,047 R@8 : 61.189
2020-09-28 01:48:13,398 Epoch: 17, loss: 1.268, time (seconds): 54.35.
2020-09-28 01:48:13,399 **Evaluating.**
2020-09-28 01:48:49,556 NMI: 23.299
2020-09-28 01:49:00,689 R@1 : 30.295
2020-09-28 01:49:00,938 R@2 : 39.289
2020-09-28 01:49:01,185 R@4 : 48.962
2020-09-28 01:49:01,435 R@8 : 59.746
2020-09-28 01:49:54,893 Epoch: 18, loss: 1.219, time (seconds): 53.46.
2020-09-28 01:49:54,894 **Evaluating.**
2020-09-28 01:50:31,434 NMI: 23.083
2020-09-28 01:50:42,725 R@1 : 29.478
2020-09-28 01:50:43,007 R@2 : 38.942
2020-09-28 01:50:43,295 R@4 : 49.196
2020-09-28 01:50:43,571 R@8 : 59.720
2020-09-28 01:51:37,443 Epoch: 19, loss: 1.224, time (seconds): 53.87.
2020-09-28 01:51:37,444 **Evaluating.**
2020-09-28 01:52:13,827 NMI: 23.691
2020-09-28 01:52:25,040 R@1 : 29.730
2020-09-28 01:52:25,287 R@2 : 38.881
2020-09-28 01:52:25,534 R@4 : 48.866
2020-09-28 01:52:25,780 R@8 : 59.651
2020-09-28 01:52:25,782 Total training time (minutes): 35.07.
2020-09-28 01:52:26,505 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 01:52:26,506 Training for 20 epochs
2020-09-28 01:52:26,507 **Evaluating initial model.**
2020-09-28 01:53:00,134 NMI: 25.916
2020-09-28 01:53:11,611 R@1 : 32.493
2020-09-28 01:53:11,858 R@2 : 41.514
2020-09-28 01:53:12,104 R@4 : 51.994
2020-09-28 01:53:12,352 R@8 : 62.736
2020-09-28 01:53:47,641 Epoch: 0, loss: 2.770, time (seconds): 35.29.
2020-09-28 01:53:47,643 **Evaluating.**
2020-09-28 01:54:21,825 NMI: 30.300
2020-09-28 01:54:32,760 R@1 : 37.881
2020-09-28 01:54:33,034 R@2 : 47.727
2020-09-28 01:54:33,310 R@4 : 58.304
2020-09-28 01:54:33,585 R@8 : 68.471
2020-09-28 01:55:08,786 Epoch: 1, loss: 2.366, time (seconds): 35.20.
2020-09-28 01:55:08,787 **Evaluating.**
2020-09-28 01:55:42,624 NMI: 32.870
2020-09-28 01:55:53,590 R@1 : 40.401
2020-09-28 01:55:53,835 R@2 : 50.587
2020-09-28 01:55:54,089 R@4 : 60.693
2020-09-28 01:55:54,350 R@8 : 70.401
2020-09-28 01:56:30,684 Epoch: 2, loss: 2.140, time (seconds): 36.33.
2020-09-28 01:56:30,685 **Evaluating.**
2020-09-28 01:57:04,850 NMI: 33.242
2020-09-28 01:57:16,234 R@1 : 40.410
2020-09-28 01:57:16,483 R@2 : 50.656
2020-09-28 01:57:16,744 R@4 : 61.250
2020-09-28 01:57:17,005 R@8 : 70.748
2020-09-28 01:57:52,428 Epoch: 3, loss: 2.067, time (seconds): 35.42.
2020-09-28 01:57:52,429 **Evaluating.**
2020-09-28 01:58:25,922 NMI: 32.671
2020-09-28 01:58:36,984 R@1 : 41.045
2020-09-28 01:58:37,234 R@2 : 51.334
2020-09-28 01:58:37,482 R@4 : 61.736
2020-09-28 01:58:37,734 R@8 : 70.896
2020-09-28 01:59:13,267 Epoch: 4, loss: 1.985, time (seconds): 35.53.
2020-09-28 01:59:13,267 **Evaluating.**
2020-09-28 01:59:46,748 NMI: 31.725
2020-09-28 01:59:57,803 R@1 : 40.410
2020-09-28 01:59:58,051 R@2 : 50.813
2020-09-28 01:59:58,302 R@4 : 61.154
2020-09-28 01:59:58,563 R@8 : 70.583
2020-09-28 02:00:33,928 Epoch: 5, loss: 1.867, time (seconds): 35.36.
2020-09-28 02:00:33,928 **Evaluating.**
2020-09-28 02:01:07,743 NMI: 31.839
2020-09-28 02:01:18,720 R@1 : 40.202
2020-09-28 02:01:18,969 R@2 : 50.274
2020-09-28 02:01:19,217 R@4 : 60.641
2020-09-28 02:01:19,465 R@8 : 71.035
2020-09-28 02:01:54,924 Epoch: 6, loss: 1.822, time (seconds): 35.46.
2020-09-28 02:01:54,925 **Evaluating.**
2020-09-28 02:02:28,314 NMI: 30.762
2020-09-28 02:02:39,431 R@1 : 39.689
2020-09-28 02:02:39,677 R@2 : 49.718
2020-09-28 02:02:39,931 R@4 : 59.990
2020-09-28 02:02:40,185 R@8 : 69.731
2020-09-28 02:03:15,823 Epoch: 7, loss: 1.773, time (seconds): 35.64.
2020-09-28 02:03:15,824 **Evaluating.**
2020-09-28 02:03:49,052 NMI: 30.578
2020-09-28 02:04:00,136 R@1 : 38.924
2020-09-28 02:04:00,417 R@2 : 49.214
2020-09-28 02:04:00,697 R@4 : 60.094
2020-09-28 02:04:00,989 R@8 : 70.001
2020-09-28 02:04:36,393 Epoch: 8, loss: 1.715, time (seconds): 35.40.
2020-09-28 02:04:36,394 **Evaluating.**
2020-09-28 02:05:10,328 NMI: 29.663
2020-09-28 02:05:21,452 R@1 : 38.324
2020-09-28 02:05:21,714 R@2 : 48.344
2020-09-28 02:05:21,979 R@4 : 58.782
2020-09-28 02:05:22,255 R@8 : 69.080
2020-09-28 02:05:57,654 Epoch: 9, loss: 1.640, time (seconds): 35.40.
2020-09-28 02:05:57,655 **Evaluating.**
2020-09-28 02:06:30,948 NMI: 30.575
2020-09-28 02:06:42,087 R@1 : 37.986
2020-09-28 02:06:42,336 R@2 : 48.753
2020-09-28 02:06:42,589 R@4 : 59.216
2020-09-28 02:06:42,843 R@8 : 69.523
2020-09-28 02:07:18,382 Epoch: 10, loss: 1.628, time (seconds): 35.54.
2020-09-28 02:07:18,382 **Evaluating.**
2020-09-28 02:07:52,119 NMI: 29.385
2020-09-28 02:08:03,230 R@1 : 37.021
2020-09-28 02:08:03,492 R@2 : 47.362
2020-09-28 02:08:03,738 R@4 : 58.104
2020-09-28 02:08:03,993 R@8 : 68.680
2020-09-28 02:08:39,349 Epoch: 11, loss: 1.555, time (seconds): 35.35.
2020-09-28 02:08:39,350 **Evaluating.**
2020-09-28 02:09:12,947 NMI: 29.311
2020-09-28 02:09:24,197 R@1 : 35.995
2020-09-28 02:09:24,475 R@2 : 46.502
2020-09-28 02:09:24,756 R@4 : 57.643
2020-09-28 02:09:25,038 R@8 : 67.767
2020-09-28 02:10:00,668 Epoch: 12, loss: 1.571, time (seconds): 35.63.
2020-09-28 02:10:00,669 **Evaluating.**
2020-09-28 02:10:34,143 NMI: 28.416
2020-09-28 02:10:45,261 R@1 : 36.187
2020-09-28 02:10:45,507 R@2 : 46.580
2020-09-28 02:10:45,755 R@4 : 57.382
2020-09-28 02:10:46,008 R@8 : 67.350
2020-09-28 02:11:21,307 Epoch: 13, loss: 1.524, time (seconds): 35.30.
2020-09-28 02:11:21,308 **Evaluating.**
2020-09-28 02:11:54,706 NMI: 28.365
2020-09-28 02:12:05,907 R@1 : 36.387
2020-09-28 02:12:06,189 R@2 : 46.372
2020-09-28 02:12:06,463 R@4 : 57.191
2020-09-28 02:12:06,739 R@8 : 66.890
2020-09-28 02:12:42,117 Epoch: 14, loss: 1.501, time (seconds): 35.38.
2020-09-28 02:12:42,118 **Evaluating.**
2020-09-28 02:13:15,321 NMI: 28.331
2020-09-28 02:13:26,600 R@1 : 35.639
2020-09-28 02:13:26,848 R@2 : 46.015
2020-09-28 02:13:27,095 R@4 : 56.783
2020-09-28 02:13:27,341 R@8 : 66.699
2020-09-28 02:14:02,549 Epoch: 15, loss: 1.457, time (seconds): 35.21.
2020-09-28 02:14:02,550 **Evaluating.**
2020-09-28 02:14:35,757 NMI: 28.007
2020-09-28 02:14:47,083 R@1 : 34.788
2020-09-28 02:14:47,335 R@2 : 44.695
2020-09-28 02:14:47,583 R@4 : 55.340
2020-09-28 02:14:47,829 R@8 : 65.656
2020-09-28 02:15:22,720 Epoch: 16, loss: 1.420, time (seconds): 34.89.
2020-09-28 02:15:22,721 **Evaluating.**
2020-09-28 02:15:55,934 NMI: 27.695
2020-09-28 02:16:07,150 R@1 : 34.892
2020-09-28 02:16:07,410 R@2 : 45.355
2020-09-28 02:16:07,669 R@4 : 55.922
2020-09-28 02:16:07,932 R@8 : 66.221
2020-09-28 02:16:43,696 Epoch: 17, loss: 1.376, time (seconds): 35.76.
2020-09-28 02:16:43,697 **Evaluating.**
2020-09-28 02:17:16,746 NMI: 26.205
2020-09-28 02:17:28,059 R@1 : 34.327
2020-09-28 02:17:28,316 R@2 : 44.469
2020-09-28 02:17:28,566 R@4 : 54.967
2020-09-28 02:17:28,814 R@8 : 65.047
2020-09-28 02:18:03,926 Epoch: 18, loss: 1.428, time (seconds): 35.11.
2020-09-28 02:18:03,927 **Evaluating.**
2020-09-28 02:18:37,214 NMI: 26.867
2020-09-28 02:18:48,650 R@1 : 35.040
2020-09-28 02:18:48,921 R@2 : 44.747
2020-09-28 02:18:49,184 R@4 : 54.758
2020-09-28 02:18:49,446 R@8 : 64.874
2020-09-28 02:19:24,874 Epoch: 19, loss: 1.365, time (seconds): 35.43.
2020-09-28 02:19:24,875 **Evaluating.**
2020-09-28 02:19:58,014 NMI: 27.126
2020-09-28 02:20:09,240 R@1 : 34.640
2020-09-28 02:20:09,486 R@2 : 44.555
2020-09-28 02:20:09,739 R@4 : 54.332
2020-09-28 02:20:09,993 R@8 : 64.717
2020-09-28 02:20:09,994 Total training time (minutes): 27.72.
2020-09-28 02:20:10,734 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 02:20:10,735 Training for 20 epochs
2020-09-28 02:20:10,736 **Evaluating initial model.**
2020-09-28 02:20:47,575 NMI: 25.916
2020-09-28 02:20:58,869 R@1 : 32.493
2020-09-28 02:20:59,127 R@2 : 41.514
2020-09-28 02:20:59,388 R@4 : 51.994
2020-09-28 02:20:59,642 R@8 : 62.736
2020-09-28 02:21:53,275 Epoch: 0, loss: 2.805, time (seconds): 53.63.
2020-09-28 02:21:53,275 **Evaluating.**
2020-09-28 02:22:31,525 NMI: 27.106
2020-09-28 02:22:42,052 R@1 : 31.059
2020-09-28 02:22:42,314 R@2 : 41.914
2020-09-28 02:22:42,577 R@4 : 53.428
2020-09-28 02:22:42,855 R@8 : 64.882
2020-09-28 02:23:37,267 Epoch: 1, loss: 2.435, time (seconds): 54.41.
2020-09-28 02:23:37,267 **Evaluating.**
2020-09-28 02:24:14,721 NMI: 28.738
2020-09-28 02:24:25,552 R@1 : 34.614
2020-09-28 02:24:25,797 R@2 : 44.564
2020-09-28 02:24:26,041 R@4 : 56.331
2020-09-28 02:24:26,286 R@8 : 67.837
2020-09-28 02:25:20,357 Epoch: 2, loss: 2.234, time (seconds): 54.07.
2020-09-28 02:25:20,358 **Evaluating.**
2020-09-28 02:25:57,571 NMI: 29.756
2020-09-28 02:26:08,563 R@1 : 36.413
2020-09-28 02:26:08,809 R@2 : 47.032
2020-09-28 02:26:09,055 R@4 : 57.887
2020-09-28 02:26:09,306 R@8 : 68.367
2020-09-28 02:27:03,378 Epoch: 3, loss: 2.208, time (seconds): 54.07.
2020-09-28 02:27:03,378 **Evaluating.**
2020-09-28 02:27:40,498 NMI: 29.390
2020-09-28 02:27:51,462 R@1 : 36.456
2020-09-28 02:27:51,708 R@2 : 46.885
2020-09-28 02:27:51,954 R@4 : 58.095
2020-09-28 02:27:52,201 R@8 : 68.880
2020-09-28 02:28:46,233 Epoch: 4, loss: 1.972, time (seconds): 54.03.
2020-09-28 02:28:46,234 **Evaluating.**
2020-09-28 02:29:22,607 NMI: 29.647
2020-09-28 02:29:33,600 R@1 : 36.908
2020-09-28 02:29:33,845 R@2 : 47.554
2020-09-28 02:29:34,091 R@4 : 58.530
2020-09-28 02:29:34,337 R@8 : 68.584
2020-09-28 02:30:27,664 Epoch: 5, loss: 1.983, time (seconds): 53.33.
2020-09-28 02:30:27,665 **Evaluating.**
2020-09-28 02:31:04,443 NMI: 28.582
2020-09-28 02:31:15,468 R@1 : 36.082
2020-09-28 02:31:15,714 R@2 : 46.259
2020-09-28 02:31:15,960 R@4 : 56.965
2020-09-28 02:31:16,206 R@8 : 67.237
2020-09-28 02:32:09,827 Epoch: 6, loss: 1.734, time (seconds): 53.62.
2020-09-28 02:32:09,828 **Evaluating.**
2020-09-28 02:32:47,773 NMI: 28.753
2020-09-28 02:32:58,927 R@1 : 36.213
2020-09-28 02:32:59,208 R@2 : 46.520
2020-09-28 02:32:59,487 R@4 : 57.235
2020-09-28 02:32:59,762 R@8 : 68.046
2020-09-28 02:33:54,092 Epoch: 7, loss: 1.750, time (seconds): 54.33.
2020-09-28 02:33:54,093 **Evaluating.**
2020-09-28 02:34:30,657 NMI: 30.518
2020-09-28 02:34:41,774 R@1 : 38.794
2020-09-28 02:34:42,036 R@2 : 49.109
2020-09-28 02:34:42,300 R@4 : 59.320
2020-09-28 02:34:42,562 R@8 : 69.705
2020-09-28 02:35:37,223 Epoch: 8, loss: 1.650, time (seconds): 54.66.
2020-09-28 02:35:37,224 **Evaluating.**
2020-09-28 02:36:14,114 NMI: 30.515
2020-09-28 02:36:25,245 R@1 : 36.743
2020-09-28 02:36:25,523 R@2 : 47.736
2020-09-28 02:36:25,802 R@4 : 58.556
2020-09-28 02:36:26,079 R@8 : 69.123
2020-09-28 02:37:20,309 Epoch: 9, loss: 1.696, time (seconds): 54.23.
2020-09-28 02:37:20,310 **Evaluating.**
2020-09-28 02:37:58,144 NMI: 30.499
2020-09-28 02:38:09,404 R@1 : 37.838
2020-09-28 02:38:09,651 R@2 : 47.919
2020-09-28 02:38:09,900 R@4 : 58.556
2020-09-28 02:38:10,158 R@8 : 68.645
2020-09-28 02:39:04,767 Epoch: 10, loss: 1.598, time (seconds): 54.61.
2020-09-28 02:39:04,768 **Evaluating.**
2020-09-28 02:39:42,614 NMI: 30.343
2020-09-28 02:39:53,872 R@1 : 38.368
2020-09-28 02:39:54,148 R@2 : 48.588
2020-09-28 02:39:54,424 R@4 : 59.312
2020-09-28 02:39:54,701 R@8 : 69.488
2020-09-28 02:40:48,877 Epoch: 11, loss: 1.496, time (seconds): 54.17.
2020-09-28 02:40:48,878 **Evaluating.**
2020-09-28 02:41:25,801 NMI: 30.234
2020-09-28 02:41:37,052 R@1 : 37.820
2020-09-28 02:41:37,328 R@2 : 47.910
2020-09-28 02:41:37,607 R@4 : 58.747
2020-09-28 02:41:37,885 R@8 : 69.036
2020-09-28 02:42:31,316 Epoch: 12, loss: 1.418, time (seconds): 53.43.
2020-09-28 02:42:31,316 **Evaluating.**
2020-09-28 02:43:08,533 NMI: 29.026
2020-09-28 02:43:19,749 R@1 : 36.943
2020-09-28 02:43:19,998 R@2 : 47.397
2020-09-28 02:43:20,248 R@4 : 58.017
2020-09-28 02:43:20,501 R@8 : 68.011
2020-09-28 02:44:14,465 Epoch: 13, loss: 1.434, time (seconds): 53.96.
2020-09-28 02:44:14,465 **Evaluating.**
2020-09-28 02:44:52,052 NMI: 29.610
2020-09-28 02:45:03,383 R@1 : 37.282
2020-09-28 02:45:03,661 R@2 : 47.684
2020-09-28 02:45:03,940 R@4 : 57.887
2020-09-28 02:45:04,218 R@8 : 68.228
2020-09-28 02:45:58,857 Epoch: 14, loss: 1.371, time (seconds): 54.64.
2020-09-28 02:45:58,858 **Evaluating.**
2020-09-28 02:46:35,585 NMI: 29.747
2020-09-28 02:46:46,808 R@1 : 36.743
2020-09-28 02:46:47,054 R@2 : 46.598
2020-09-28 02:46:47,301 R@4 : 57.426
2020-09-28 02:46:47,552 R@8 : 67.933
2020-09-28 02:47:40,502 Epoch: 15, loss: 1.302, time (seconds): 52.95.
2020-09-28 02:47:40,502 **Evaluating.**
2020-09-28 02:48:18,260 NMI: 28.709
2020-09-28 02:48:29,548 R@1 : 36.508
2020-09-28 02:48:29,795 R@2 : 46.354
2020-09-28 02:48:30,049 R@4 : 56.774
2020-09-28 02:48:30,297 R@8 : 66.907
2020-09-28 02:49:25,135 Epoch: 16, loss: 1.288, time (seconds): 54.84.
2020-09-28 02:49:25,136 **Evaluating.**
2020-09-28 02:50:02,952 NMI: 28.868
2020-09-28 02:50:14,128 R@1 : 36.004
2020-09-28 02:50:14,377 R@2 : 45.981
2020-09-28 02:50:14,634 R@4 : 56.235
2020-09-28 02:50:14,882 R@8 : 66.881
2020-09-28 02:51:10,428 Epoch: 17, loss: 1.256, time (seconds): 55.54.
2020-09-28 02:51:10,429 **Evaluating.**
2020-09-28 02:51:47,267 NMI: 27.439
2020-09-28 02:51:58,630 R@1 : 35.239
2020-09-28 02:51:58,890 R@2 : 45.364
2020-09-28 02:51:59,149 R@4 : 55.601
2020-09-28 02:51:59,405 R@8 : 66.299
2020-09-28 02:52:54,752 Epoch: 18, loss: 1.201, time (seconds): 55.34.
2020-09-28 02:52:54,753 **Evaluating.**
2020-09-28 02:53:31,804 NMI: 27.584
2020-09-28 02:53:43,037 R@1 : 35.066
2020-09-28 02:53:43,284 R@2 : 45.042
2020-09-28 02:53:43,546 R@4 : 55.453
2020-09-28 02:53:43,795 R@8 : 66.273
2020-09-28 02:54:37,908 Epoch: 19, loss: 1.163, time (seconds): 54.11.
2020-09-28 02:54:37,908 **Evaluating.**
2020-09-28 02:55:14,602 NMI: 27.504
2020-09-28 02:55:26,000 R@1 : 35.309
2020-09-28 02:55:26,291 R@2 : 44.668
2020-09-28 02:55:26,580 R@4 : 55.010
2020-09-28 02:55:26,864 R@8 : 66.064
2020-09-28 02:55:26,866 Total training time (minutes): 35.27.
2020-09-28 02:55:27,633 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 02:55:27,634 Training for 20 epochs
2020-09-28 02:55:27,636 **Evaluating initial model.**
2020-09-28 02:56:01,493 NMI: 25.916
2020-09-28 02:56:13,026 R@1 : 32.493
2020-09-28 02:56:13,288 R@2 : 41.514
2020-09-28 02:56:13,550 R@4 : 51.994
2020-09-28 02:56:13,813 R@8 : 62.736
2020-09-28 02:56:49,330 Epoch: 0, loss: 3.496, time (seconds): 35.52.
2020-09-28 02:56:49,331 **Evaluating.**
2020-09-28 02:57:23,678 NMI: 23.543
2020-09-28 02:57:34,094 R@1 : 29.817
2020-09-28 02:57:34,340 R@2 : 39.672
2020-09-28 02:57:34,587 R@4 : 51.125
2020-09-28 02:57:34,833 R@8 : 62.788
2020-09-28 02:58:10,508 Epoch: 1, loss: 2.781, time (seconds): 35.67.
2020-09-28 02:58:10,508 **Evaluating.**
2020-09-28 02:58:44,832 NMI: 27.423
2020-09-28 02:58:55,438 R@1 : 33.701
2020-09-28 02:58:55,685 R@2 : 44.043
2020-09-28 02:58:55,930 R@4 : 55.436
2020-09-28 02:58:56,176 R@8 : 66.238
2020-09-28 02:59:31,971 Epoch: 2, loss: 2.390, time (seconds): 35.79.
2020-09-28 02:59:31,972 **Evaluating.**
2020-09-28 03:00:06,093 NMI: 29.994
2020-09-28 03:00:16,793 R@1 : 36.899
2020-09-28 03:00:17,039 R@2 : 47.128
2020-09-28 03:00:17,285 R@4 : 58.391
2020-09-28 03:00:17,531 R@8 : 68.697
2020-09-28 03:00:52,888 Epoch: 3, loss: 2.234, time (seconds): 35.35.
2020-09-28 03:00:52,889 **Evaluating.**
2020-09-28 03:01:26,880 NMI: 31.645
2020-09-28 03:01:37,859 R@1 : 38.090
2020-09-28 03:01:38,113 R@2 : 48.875
2020-09-28 03:01:38,364 R@4 : 60.068
2020-09-28 03:01:38,615 R@8 : 70.262
2020-09-28 03:02:13,946 Epoch: 4, loss: 2.120, time (seconds): 35.33.
2020-09-28 03:02:13,947 **Evaluating.**
2020-09-28 03:02:47,240 NMI: 32.463
2020-09-28 03:02:58,196 R@1 : 39.837
2020-09-28 03:02:58,445 R@2 : 50.482
2020-09-28 03:02:58,695 R@4 : 60.876
2020-09-28 03:02:58,943 R@8 : 70.774
2020-09-28 03:03:34,057 Epoch: 5, loss: 1.950, time (seconds): 35.11.
2020-09-28 03:03:34,058 **Evaluating.**
2020-09-28 03:04:08,189 NMI: 32.424
2020-09-28 03:04:19,287 R@1 : 39.428
2020-09-28 03:04:19,534 R@2 : 50.369
2020-09-28 03:04:19,779 R@4 : 61.137
2020-09-28 03:04:20,030 R@8 : 71.330
2020-09-28 03:04:55,362 Epoch: 6, loss: 1.891, time (seconds): 35.33.
2020-09-28 03:04:55,363 **Evaluating.**
2020-09-28 03:05:29,259 NMI: 32.847
2020-09-28 03:05:40,258 R@1 : 39.654
2020-09-28 03:05:40,519 R@2 : 50.465
2020-09-28 03:05:40,780 R@4 : 61.050
2020-09-28 03:05:41,042 R@8 : 71.348
2020-09-28 03:06:16,375 Epoch: 7, loss: 1.806, time (seconds): 35.33.
2020-09-28 03:06:16,376 **Evaluating.**
2020-09-28 03:06:49,804 NMI: 32.706
2020-09-28 03:07:00,864 R@1 : 41.045
2020-09-28 03:07:01,141 R@2 : 51.595
2020-09-28 03:07:01,416 R@4 : 61.858
2020-09-28 03:07:01,699 R@8 : 71.244
2020-09-28 03:07:37,060 Epoch: 8, loss: 1.734, time (seconds): 35.36.
2020-09-28 03:07:37,061 **Evaluating.**
2020-09-28 03:08:10,995 NMI: 32.853
2020-09-28 03:08:22,191 R@1 : 40.010
2020-09-28 03:08:22,437 R@2 : 51.456
2020-09-28 03:08:22,684 R@4 : 61.684
2020-09-28 03:08:22,932 R@8 : 71.374
2020-09-28 03:08:58,521 Epoch: 9, loss: 1.645, time (seconds): 35.59.
2020-09-28 03:08:58,522 **Evaluating.**
2020-09-28 03:09:32,656 NMI: 32.331
2020-09-28 03:09:43,850 R@1 : 39.967
2020-09-28 03:09:44,112 R@2 : 50.665
2020-09-28 03:09:44,381 R@4 : 61.502
2020-09-28 03:09:44,645 R@8 : 71.226
2020-09-28 03:10:20,037 Epoch: 10, loss: 1.605, time (seconds): 35.39.
2020-09-28 03:10:20,037 **Evaluating.**
2020-09-28 03:10:53,697 NMI: 32.667
2020-09-28 03:11:04,835 R@1 : 40.141
2020-09-28 03:11:05,084 R@2 : 51.369
2020-09-28 03:11:05,336 R@4 : 61.658
2020-09-28 03:11:05,583 R@8 : 71.591
2020-09-28 03:11:41,002 Epoch: 11, loss: 1.512, time (seconds): 35.42.
2020-09-28 03:11:41,003 **Evaluating.**
2020-09-28 03:12:14,512 NMI: 32.413
2020-09-28 03:12:25,739 R@1 : 38.976
2020-09-28 03:12:25,993 R@2 : 50.013
2020-09-28 03:12:26,250 R@4 : 60.780
2020-09-28 03:12:26,499 R@8 : 70.800
2020-09-28 03:13:02,000 Epoch: 12, loss: 1.541, time (seconds): 35.50.
2020-09-28 03:13:02,001 **Evaluating.**
2020-09-28 03:13:35,385 NMI: 31.871
2020-09-28 03:13:46,580 R@1 : 38.672
2020-09-28 03:13:46,834 R@2 : 49.248
2020-09-28 03:13:47,088 R@4 : 60.363
2020-09-28 03:13:47,347 R@8 : 70.149
2020-09-28 03:14:23,057 Epoch: 13, loss: 1.472, time (seconds): 35.71.
2020-09-28 03:14:23,058 **Evaluating.**
2020-09-28 03:14:56,586 NMI: 32.255
2020-09-28 03:15:07,911 R@1 : 39.880
2020-09-28 03:15:08,158 R@2 : 50.526
2020-09-28 03:15:08,416 R@4 : 61.849
2020-09-28 03:15:08,666 R@8 : 71.556
2020-09-28 03:15:44,055 Epoch: 14, loss: 1.440, time (seconds): 35.39.
2020-09-28 03:15:44,056 **Evaluating.**
2020-09-28 03:16:17,912 NMI: 32.085
2020-09-28 03:16:29,149 R@1 : 39.376
2020-09-28 03:16:29,396 R@2 : 50.222
2020-09-28 03:16:29,647 R@4 : 60.946
2020-09-28 03:16:29,896 R@8 : 71.035
2020-09-28 03:17:05,326 Epoch: 15, loss: 1.393, time (seconds): 35.43.
2020-09-28 03:17:05,327 **Evaluating.**
2020-09-28 03:17:38,933 NMI: 31.878
2020-09-28 03:17:50,234 R@1 : 38.707
2020-09-28 03:17:50,489 R@2 : 49.309
2020-09-28 03:17:50,749 R@4 : 59.877
2020-09-28 03:17:51,004 R@8 : 70.001
2020-09-28 03:18:26,773 Epoch: 16, loss: 1.359, time (seconds): 35.77.
2020-09-28 03:18:26,774 **Evaluating.**
2020-09-28 03:19:01,016 NMI: 31.354
2020-09-28 03:19:12,305 R@1 : 38.846
2020-09-28 03:19:12,556 R@2 : 49.622
2020-09-28 03:19:12,802 R@4 : 60.433
2020-09-28 03:19:13,057 R@8 : 70.792
2020-09-28 03:19:48,180 Epoch: 17, loss: 1.293, time (seconds): 35.12.
2020-09-28 03:19:48,181 **Evaluating.**
2020-09-28 03:20:22,034 NMI: 31.422
2020-09-28 03:20:33,243 R@1 : 38.750
2020-09-28 03:20:33,496 R@2 : 49.092
2020-09-28 03:20:33,743 R@4 : 60.146
2020-09-28 03:20:33,994 R@8 : 70.244
2020-09-28 03:21:09,609 Epoch: 18, loss: 1.334, time (seconds): 35.61.
2020-09-28 03:21:09,609 **Evaluating.**
2020-09-28 03:21:43,007 NMI: 31.477
2020-09-28 03:21:54,223 R@1 : 38.863
2020-09-28 03:21:54,475 R@2 : 49.587
2020-09-28 03:21:54,722 R@4 : 59.833
2020-09-28 03:21:54,971 R@8 : 69.844
2020-09-28 03:22:30,125 Epoch: 19, loss: 1.288, time (seconds): 35.15.
2020-09-28 03:22:30,126 **Evaluating.**
2020-09-28 03:23:04,421 NMI: 31.021
2020-09-28 03:23:15,676 R@1 : 38.585
2020-09-28 03:23:15,927 R@2 : 48.996
2020-09-28 03:23:16,179 R@4 : 59.416
2020-09-28 03:23:16,430 R@8 : 69.592
2020-09-28 03:23:16,432 Total training time (minutes): 27.81.
2020-09-28 03:23:17,166 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 03:23:17,167 Training for 20 epochs
2020-09-28 03:23:17,169 **Evaluating initial model.**
2020-09-28 03:23:54,012 NMI: 25.916
2020-09-28 03:24:05,328 R@1 : 32.493
2020-09-28 03:24:05,604 R@2 : 41.514
2020-09-28 03:24:05,883 R@4 : 51.994
2020-09-28 03:24:06,161 R@8 : 62.736
2020-09-28 03:25:00,659 Epoch: 0, loss: 3.411, time (seconds): 54.50.
2020-09-28 03:25:00,659 **Evaluating.**
2020-09-28 03:25:38,757 NMI: 25.110
2020-09-28 03:25:49,290 R@1 : 27.974
2020-09-28 03:25:49,559 R@2 : 38.081
2020-09-28 03:25:49,825 R@4 : 49.535
2020-09-28 03:25:50,092 R@8 : 61.788
2020-09-28 03:26:44,905 Epoch: 1, loss: 2.728, time (seconds): 54.81.
2020-09-28 03:26:44,905 **Evaluating.**
2020-09-28 03:27:22,070 NMI: 26.483
2020-09-28 03:27:32,865 R@1 : 30.825
2020-09-28 03:27:33,113 R@2 : 40.480
2020-09-28 03:27:33,368 R@4 : 52.003
2020-09-28 03:27:33,622 R@8 : 64.031
2020-09-28 03:28:28,243 Epoch: 2, loss: 2.410, time (seconds): 54.62.
2020-09-28 03:28:28,244 **Evaluating.**
2020-09-28 03:29:04,913 NMI: 28.789
2020-09-28 03:29:15,732 R@1 : 33.475
2020-09-28 03:29:15,982 R@2 : 43.947
2020-09-28 03:29:16,231 R@4 : 54.741
2020-09-28 03:29:16,477 R@8 : 66.003
2020-09-28 03:30:11,397 Epoch: 3, loss: 2.444, time (seconds): 54.92.
2020-09-28 03:30:11,398 **Evaluating.**
2020-09-28 03:30:48,900 NMI: 27.947
2020-09-28 03:30:59,798 R@1 : 33.484
2020-09-28 03:31:00,046 R@2 : 44.451
2020-09-28 03:31:00,303 R@4 : 55.540
2020-09-28 03:31:00,563 R@8 : 66.568
2020-09-28 03:31:54,990 Epoch: 4, loss: 2.169, time (seconds): 54.43.
2020-09-28 03:31:54,991 **Evaluating.**
2020-09-28 03:32:32,087 NMI: 26.866
2020-09-28 03:32:43,086 R@1 : 33.345
2020-09-28 03:32:43,334 R@2 : 43.947
2020-09-28 03:32:43,583 R@4 : 54.567
2020-09-28 03:32:43,836 R@8 : 65.873
2020-09-28 03:33:38,258 Epoch: 5, loss: 2.136, time (seconds): 54.42.
2020-09-28 03:33:38,259 **Evaluating.**
2020-09-28 03:34:15,552 NMI: 28.391
2020-09-28 03:34:26,418 R@1 : 35.231
2020-09-28 03:34:26,665 R@2 : 45.277
2020-09-28 03:34:26,913 R@4 : 56.175
2020-09-28 03:34:27,161 R@8 : 66.881
2020-09-28 03:35:21,307 Epoch: 6, loss: 1.905, time (seconds): 54.14.
2020-09-28 03:35:21,307 **Evaluating.**
2020-09-28 03:35:57,916 NMI: 27.229
2020-09-28 03:36:08,957 R@1 : 34.118
2020-09-28 03:36:09,203 R@2 : 44.747
2020-09-28 03:36:09,452 R@4 : 55.775
2020-09-28 03:36:09,698 R@8 : 66.768
2020-09-28 03:37:04,157 Epoch: 7, loss: 1.869, time (seconds): 54.46.
2020-09-28 03:37:04,158 **Evaluating.**
2020-09-28 03:37:41,431 NMI: 28.787
2020-09-28 03:37:52,431 R@1 : 35.622
2020-09-28 03:37:52,677 R@2 : 46.137
2020-09-28 03:37:52,923 R@4 : 57.669
2020-09-28 03:37:53,168 R@8 : 68.550
2020-09-28 03:38:47,050 Epoch: 8, loss: 1.765, time (seconds): 53.88.
2020-09-28 03:38:47,051 **Evaluating.**
2020-09-28 03:39:24,278 NMI: 28.911
2020-09-28 03:39:35,303 R@1 : 35.830
2020-09-28 03:39:35,550 R@2 : 46.155
2020-09-28 03:39:35,800 R@4 : 56.957
2020-09-28 03:39:36,059 R@8 : 67.602
2020-09-28 03:40:30,687 Epoch: 9, loss: 1.775, time (seconds): 54.63.
2020-09-28 03:40:30,688 **Evaluating.**
2020-09-28 03:41:08,017 NMI: 27.763
2020-09-28 03:41:19,109 R@1 : 35.787
2020-09-28 03:41:19,364 R@2 : 45.537
2020-09-28 03:41:19,618 R@4 : 56.409
2020-09-28 03:41:19,867 R@8 : 67.263
2020-09-28 03:42:13,187 Epoch: 10, loss: 1.696, time (seconds): 53.32.
2020-09-28 03:42:13,188 **Evaluating.**
2020-09-28 03:42:50,133 NMI: 29.212
2020-09-28 03:43:01,283 R@1 : 35.613
2020-09-28 03:43:01,536 R@2 : 46.459
2020-09-28 03:43:01,786 R@4 : 57.391
2020-09-28 03:43:02,035 R@8 : 67.906
2020-09-28 03:43:56,432 Epoch: 11, loss: 1.586, time (seconds): 54.39.
2020-09-28 03:43:56,432 **Evaluating.**
2020-09-28 03:44:33,323 NMI: 28.220
2020-09-28 03:44:44,433 R@1 : 35.448
2020-09-28 03:44:44,711 R@2 : 45.398
2020-09-28 03:44:44,995 R@4 : 56.053
2020-09-28 03:44:45,276 R@8 : 66.794
2020-09-28 03:45:38,783 Epoch: 12, loss: 1.555, time (seconds): 53.51.
2020-09-28 03:45:38,784 **Evaluating.**
2020-09-28 03:46:16,239 NMI: 27.536
2020-09-28 03:46:27,392 R@1 : 35.205
2020-09-28 03:46:27,658 R@2 : 45.181
2020-09-28 03:46:27,925 R@4 : 56.400
2020-09-28 03:46:28,195 R@8 : 67.515
2020-09-28 03:47:21,861 Epoch: 13, loss: 1.547, time (seconds): 53.66.
2020-09-28 03:47:21,862 **Evaluating.**
2020-09-28 03:47:59,658 NMI: 27.215
2020-09-28 03:48:10,893 R@1 : 34.701
2020-09-28 03:48:11,174 R@2 : 45.268
2020-09-28 03:48:11,459 R@4 : 55.497
2020-09-28 03:48:11,739 R@8 : 66.507
2020-09-28 03:49:05,535 Epoch: 14, loss: 1.498, time (seconds): 53.79.
2020-09-28 03:49:05,535 **Evaluating.**
2020-09-28 03:49:42,235 NMI: 27.326
2020-09-28 03:49:53,506 R@1 : 34.761
2020-09-28 03:49:53,757 R@2 : 44.529
2020-09-28 03:49:54,009 R@4 : 55.245
2020-09-28 03:49:54,264 R@8 : 65.916
2020-09-28 03:50:48,184 Epoch: 15, loss: 1.452, time (seconds): 53.92.
2020-09-28 03:50:48,185 **Evaluating.**
2020-09-28 03:51:25,118 NMI: 26.498
2020-09-28 03:51:36,245 R@1 : 34.058
2020-09-28 03:51:36,512 R@2 : 44.616
2020-09-28 03:51:36,782 R@4 : 55.818
2020-09-28 03:51:37,051 R@8 : 66.403
2020-09-28 03:52:31,090 Epoch: 16, loss: 1.363, time (seconds): 54.04.
2020-09-28 03:52:31,091 **Evaluating.**
2020-09-28 03:53:07,884 NMI: 27.228
2020-09-28 03:53:19,052 R@1 : 34.049
2020-09-28 03:53:19,299 R@2 : 44.190
2020-09-28 03:53:19,553 R@4 : 54.836
2020-09-28 03:53:19,803 R@8 : 65.960
2020-09-28 03:54:13,866 Epoch: 17, loss: 1.312, time (seconds): 54.06.
2020-09-28 03:54:13,867 **Evaluating.**
2020-09-28 03:54:50,080 NMI: 25.352
2020-09-28 03:55:01,346 R@1 : 32.676
2020-09-28 03:55:01,599 R@2 : 42.166
2020-09-28 03:55:01,847 R@4 : 52.933
2020-09-28 03:55:02,098 R@8 : 64.265
2020-09-28 03:55:56,224 Epoch: 18, loss: 1.277, time (seconds): 54.12.
2020-09-28 03:55:56,225 **Evaluating.**
2020-09-28 03:56:33,821 NMI: 26.142
2020-09-28 03:56:45,119 R@1 : 33.310
2020-09-28 03:56:45,373 R@2 : 43.104
2020-09-28 03:56:45,626 R@4 : 53.672
2020-09-28 03:56:45,877 R@8 : 64.639
2020-09-28 03:57:40,293 Epoch: 19, loss: 1.249, time (seconds): 54.42.
2020-09-28 03:57:40,294 **Evaluating.**
2020-09-28 03:58:17,984 NMI: 25.385
2020-09-28 03:58:29,231 R@1 : 32.389
2020-09-28 03:58:29,481 R@2 : 42.183
2020-09-28 03:58:29,730 R@4 : 53.202
2020-09-28 03:58:29,981 R@8 : 64.456
2020-09-28 03:58:29,983 Total training time (minutes): 35.21.
2020-09-28 03:58:30,716 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 3.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 03:58:30,717 Training for 20 epochs
2020-09-28 03:58:30,718 **Evaluating initial model.**
2020-09-28 03:59:04,617 NMI: 25.916
2020-09-28 03:59:16,138 R@1 : 32.493
2020-09-28 03:59:16,419 R@2 : 41.514
2020-09-28 03:59:16,692 R@4 : 51.994
2020-09-28 03:59:16,970 R@8 : 62.736
2020-09-28 03:59:52,470 Epoch: 0, loss: 4.260, time (seconds): 35.50.
2020-09-28 03:59:52,472 **Evaluating.**
2020-09-28 04:00:26,243 NMI: 22.731
2020-09-28 04:00:36,853 R@1 : 28.635
2020-09-28 04:00:37,098 R@2 : 38.090
2020-09-28 04:00:37,342 R@4 : 49.318
2020-09-28 04:00:37,588 R@8 : 61.719
2020-09-28 04:01:12,895 Epoch: 1, loss: 3.143, time (seconds): 35.30.
2020-09-28 04:01:12,896 **Evaluating.**
2020-09-28 04:01:47,395 NMI: 26.207
2020-09-28 04:01:58,057 R@1 : 32.050
2020-09-28 04:01:58,319 R@2 : 42.513
2020-09-28 04:01:58,589 R@4 : 53.576
2020-09-28 04:01:58,863 R@8 : 65.004
2020-09-28 04:02:34,564 Epoch: 2, loss: 2.733, time (seconds): 35.70.
2020-09-28 04:02:34,564 **Evaluating.**
2020-09-28 04:03:08,258 NMI: 27.466
2020-09-28 04:03:18,872 R@1 : 33.519
2020-09-28 04:03:19,148 R@2 : 44.182
2020-09-28 04:03:19,416 R@4 : 55.062
2020-09-28 04:03:19,688 R@8 : 66.108
2020-09-28 04:03:55,191 Epoch: 3, loss: 2.532, time (seconds): 35.50.
2020-09-28 04:03:55,192 **Evaluating.**
2020-09-28 04:04:29,586 NMI: 29.048
2020-09-28 04:04:40,269 R@1 : 34.970
2020-09-28 04:04:40,522 R@2 : 45.564
2020-09-28 04:04:40,772 R@4 : 56.696
2020-09-28 04:04:41,021 R@8 : 67.663
2020-09-28 04:05:16,401 Epoch: 4, loss: 2.415, time (seconds): 35.38.
2020-09-28 04:05:16,401 **Evaluating.**
2020-09-28 04:05:50,140 NMI: 29.667
2020-09-28 04:06:00,929 R@1 : 35.900
2020-09-28 04:06:01,177 R@2 : 46.337
2020-09-28 04:06:01,438 R@4 : 57.061
2020-09-28 04:06:01,693 R@8 : 67.576
2020-09-28 04:06:37,251 Epoch: 5, loss: 2.216, time (seconds): 35.56.
2020-09-28 04:06:37,253 **Evaluating.**
2020-09-28 04:07:11,117 NMI: 30.058
2020-09-28 04:07:21,967 R@1 : 35.943
2020-09-28 04:07:22,225 R@2 : 46.563
2020-09-28 04:07:22,486 R@4 : 57.678
2020-09-28 04:07:22,743 R@8 : 68.558
2020-09-28 04:07:58,245 Epoch: 6, loss: 2.185, time (seconds): 35.50.
2020-09-28 04:07:58,246 **Evaluating.**
2020-09-28 04:08:31,990 NMI: 30.574
2020-09-28 04:08:42,876 R@1 : 35.770
2020-09-28 04:08:43,134 R@2 : 46.641
2020-09-28 04:08:43,389 R@4 : 58.095
2020-09-28 04:08:43,644 R@8 : 68.776
2020-09-28 04:09:19,268 Epoch: 7, loss: 2.042, time (seconds): 35.62.
2020-09-28 04:09:19,269 **Evaluating.**
2020-09-28 04:09:53,214 NMI: 30.038
2020-09-28 04:10:04,350 R@1 : 36.413
2020-09-28 04:10:04,623 R@2 : 47.084
2020-09-28 04:10:04,898 R@4 : 57.930
2020-09-28 04:10:05,178 R@8 : 68.558
2020-09-28 04:10:40,214 Epoch: 8, loss: 1.965, time (seconds): 35.03.
2020-09-28 04:10:40,215 **Evaluating.**
2020-09-28 04:11:14,564 NMI: 30.435
2020-09-28 04:11:25,521 R@1 : 36.013
2020-09-28 04:11:25,768 R@2 : 46.650
2020-09-28 04:11:26,019 R@4 : 57.869
2020-09-28 04:11:26,268 R@8 : 68.636
2020-09-28 04:12:01,795 Epoch: 9, loss: 1.848, time (seconds): 35.52.
2020-09-28 04:12:01,796 **Evaluating.**
2020-09-28 04:12:35,248 NMI: 30.127
2020-09-28 04:12:46,277 R@1 : 36.369
2020-09-28 04:12:46,527 R@2 : 47.336
2020-09-28 04:12:46,776 R@4 : 58.434
2020-09-28 04:12:47,024 R@8 : 68.889
2020-09-28 04:13:22,311 Epoch: 10, loss: 1.783, time (seconds): 35.29.
2020-09-28 04:13:22,312 **Evaluating.**
2020-09-28 04:13:56,220 NMI: 30.751
2020-09-28 04:14:07,217 R@1 : 35.231
2020-09-28 04:14:07,464 R@2 : 46.511
2020-09-28 04:14:07,711 R@4 : 57.304
2020-09-28 04:14:07,965 R@8 : 68.819
2020-09-28 04:14:43,664 Epoch: 11, loss: 1.707, time (seconds): 35.69.
2020-09-28 04:14:43,664 **Evaluating.**
2020-09-28 04:15:17,255 NMI: 29.372
2020-09-28 04:15:28,199 R@1 : 35.961
2020-09-28 04:15:28,449 R@2 : 46.624
2020-09-28 04:15:28,707 R@4 : 57.374
2020-09-28 04:15:28,959 R@8 : 68.132
2020-09-28 04:16:04,376 Epoch: 12, loss: 1.725, time (seconds): 35.41.
2020-09-28 04:16:04,377 **Evaluating.**
2020-09-28 04:16:38,103 NMI: 29.728
2020-09-28 04:16:49,187 R@1 : 35.987
2020-09-28 04:16:49,449 R@2 : 46.641
2020-09-28 04:16:49,721 R@4 : 57.800
2020-09-28 04:16:49,993 R@8 : 68.489
2020-09-28 04:17:25,514 Epoch: 13, loss: 1.669, time (seconds): 35.52.
2020-09-28 04:17:25,515 **Evaluating.**
2020-09-28 04:17:59,298 NMI: 29.256
2020-09-28 04:18:10,424 R@1 : 35.013
2020-09-28 04:18:10,685 R@2 : 45.781
2020-09-28 04:18:10,943 R@4 : 56.965
2020-09-28 04:18:11,207 R@8 : 68.124
2020-09-28 04:18:46,987 Epoch: 14, loss: 1.633, time (seconds): 35.78.
2020-09-28 04:18:46,988 **Evaluating.**
2020-09-28 04:19:20,431 NMI: 29.573
2020-09-28 04:19:31,480 R@1 : 35.813
2020-09-28 04:19:31,756 R@2 : 46.111
2020-09-28 04:19:32,038 R@4 : 57.209
2020-09-28 04:19:32,318 R@8 : 68.141
2020-09-28 04:20:08,034 Epoch: 15, loss: 1.592, time (seconds): 35.71.
2020-09-28 04:20:08,035 **Evaluating.**
2020-09-28 04:20:42,061 NMI: 29.109
2020-09-28 04:20:53,208 R@1 : 34.927
2020-09-28 04:20:53,456 R@2 : 45.068
2020-09-28 04:20:53,704 R@4 : 56.348
2020-09-28 04:20:53,955 R@8 : 67.489
2020-09-28 04:21:29,053 Epoch: 16, loss: 1.533, time (seconds): 35.10.
2020-09-28 04:21:29,054 **Evaluating.**
2020-09-28 04:22:02,779 NMI: 29.228
2020-09-28 04:22:13,822 R@1 : 34.840
2020-09-28 04:22:14,080 R@2 : 45.729
2020-09-28 04:22:14,336 R@4 : 57.052
2020-09-28 04:22:14,597 R@8 : 68.211
2020-09-28 04:22:50,062 Epoch: 17, loss: 1.486, time (seconds): 35.46.
2020-09-28 04:22:50,063 **Evaluating.**
2020-09-28 04:23:23,592 NMI: 29.036
2020-09-28 04:23:34,845 R@1 : 35.083
2020-09-28 04:23:35,090 R@2 : 45.164
2020-09-28 04:23:35,343 R@4 : 56.418
2020-09-28 04:23:35,596 R@8 : 67.411
2020-09-28 04:24:11,028 Epoch: 18, loss: 1.530, time (seconds): 35.43.
2020-09-28 04:24:11,029 **Evaluating.**
2020-09-28 04:24:44,659 NMI: 29.125
2020-09-28 04:24:55,781 R@1 : 34.249
2020-09-28 04:24:56,025 R@2 : 44.860
2020-09-28 04:24:56,273 R@4 : 56.175
2020-09-28 04:24:56,520 R@8 : 67.498
2020-09-28 04:25:31,983 Epoch: 19, loss: 1.472, time (seconds): 35.46.
2020-09-28 04:25:31,984 **Evaluating.**
2020-09-28 04:26:05,692 NMI: 28.498
2020-09-28 04:26:16,969 R@1 : 35.109
2020-09-28 04:26:17,235 R@2 : 45.068
2020-09-28 04:26:17,506 R@4 : 56.461
2020-09-28 04:26:17,772 R@8 : 67.402
2020-09-28 04:26:17,774 Total training time (minutes): 27.78.
2020-09-28 04:26:18,488 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 04:26:18,488 Training for 20 epochs
2020-09-28 04:26:18,490 **Evaluating initial model.**
2020-09-28 04:26:55,623 NMI: 25.916
2020-09-28 04:27:06,989 R@1 : 32.493
2020-09-28 04:27:07,240 R@2 : 41.514
2020-09-28 04:27:07,491 R@4 : 51.994
2020-09-28 04:27:07,745 R@8 : 62.736
2020-09-28 04:28:02,101 Epoch: 0, loss: 2.753, time (seconds): 54.36.
2020-09-28 04:28:02,102 **Evaluating.**
2020-09-28 04:28:40,311 NMI: 27.841
2020-09-28 04:28:51,050 R@1 : 32.963
2020-09-28 04:28:51,312 R@2 : 43.226
2020-09-28 04:28:51,574 R@4 : 54.654
2020-09-28 04:28:51,825 R@8 : 65.664
2020-09-28 04:29:46,260 Epoch: 1, loss: 2.362, time (seconds): 54.43.
2020-09-28 04:29:46,260 **Evaluating.**
2020-09-28 04:30:23,656 NMI: 28.636
2020-09-28 04:30:34,588 R@1 : 34.961
2020-09-28 04:30:34,834 R@2 : 45.398
2020-09-28 04:30:35,095 R@4 : 56.400
2020-09-28 04:30:35,354 R@8 : 67.168
2020-09-28 04:31:29,224 Epoch: 2, loss: 2.203, time (seconds): 53.87.
2020-09-28 04:31:29,225 **Evaluating.**
2020-09-28 04:32:06,476 NMI: 29.789
2020-09-28 04:32:17,407 R@1 : 36.595
2020-09-28 04:32:17,654 R@2 : 47.432
2020-09-28 04:32:17,907 R@4 : 58.469
2020-09-28 04:32:18,168 R@8 : 68.445
2020-09-28 04:33:12,620 Epoch: 3, loss: 2.192, time (seconds): 54.45.
2020-09-28 04:33:12,621 **Evaluating.**
2020-09-28 04:33:49,941 NMI: 29.911
2020-09-28 04:34:01,034 R@1 : 37.360
2020-09-28 04:34:01,281 R@2 : 47.310
2020-09-28 04:34:01,527 R@4 : 58.017
2020-09-28 04:34:01,773 R@8 : 68.132
2020-09-28 04:34:55,658 Epoch: 4, loss: 1.954, time (seconds): 53.88.
2020-09-28 04:34:55,659 **Evaluating.**
2020-09-28 04:35:33,736 NMI: 29.564
2020-09-28 04:35:44,871 R@1 : 36.560
2020-09-28 04:35:45,119 R@2 : 46.997
2020-09-28 04:35:45,369 R@4 : 57.678
2020-09-28 04:35:45,622 R@8 : 68.367
2020-09-28 04:36:39,181 Epoch: 5, loss: 1.940, time (seconds): 53.56.
2020-09-28 04:36:39,182 **Evaluating.**
2020-09-28 04:37:15,949 NMI: 29.332
2020-09-28 04:37:26,995 R@1 : 36.612
2020-09-28 04:37:27,244 R@2 : 47.502
2020-09-28 04:37:27,491 R@4 : 57.774
2020-09-28 04:37:27,741 R@8 : 68.480
2020-09-28 04:38:21,767 Epoch: 6, loss: 1.749, time (seconds): 54.02.
2020-09-28 04:38:21,767 **Evaluating.**
2020-09-28 04:38:58,257 NMI: 29.434
2020-09-28 04:39:09,285 R@1 : 37.117
2020-09-28 04:39:09,539 R@2 : 47.467
2020-09-28 04:39:09,789 R@4 : 58.382
2020-09-28 04:39:10,041 R@8 : 68.776
2020-09-28 04:40:03,799 Epoch: 7, loss: 1.721, time (seconds): 53.76.
2020-09-28 04:40:03,800 **Evaluating.**
2020-09-28 04:40:41,699 NMI: 30.822
2020-09-28 04:40:52,932 R@1 : 38.829
2020-09-28 04:40:53,179 R@2 : 48.649
2020-09-28 04:40:53,431 R@4 : 59.964
2020-09-28 04:40:53,677 R@8 : 70.088
2020-09-28 04:41:47,868 Epoch: 8, loss: 1.639, time (seconds): 54.19.
2020-09-28 04:41:47,870 **Evaluating.**
2020-09-28 04:42:25,470 NMI: 30.555
2020-09-28 04:42:36,623 R@1 : 38.455
2020-09-28 04:42:36,870 R@2 : 48.770
2020-09-28 04:42:37,121 R@4 : 59.520
2020-09-28 04:42:37,373 R@8 : 69.601
2020-09-28 04:43:31,382 Epoch: 9, loss: 1.662, time (seconds): 54.01.
2020-09-28 04:43:31,383 **Evaluating.**
2020-09-28 04:44:08,579 NMI: 30.528
2020-09-28 04:44:19,685 R@1 : 38.081
2020-09-28 04:44:19,932 R@2 : 48.623
2020-09-28 04:44:20,187 R@4 : 59.173
2020-09-28 04:44:20,442 R@8 : 69.514
2020-09-28 04:45:15,348 Epoch: 10, loss: 1.590, time (seconds): 54.90.
2020-09-28 04:45:15,349 **Evaluating.**
2020-09-28 04:45:52,032 NMI: 30.358
2020-09-28 04:46:03,334 R@1 : 37.586
2020-09-28 04:46:03,581 R@2 : 47.736
2020-09-28 04:46:03,832 R@4 : 58.295
2020-09-28 04:46:04,080 R@8 : 69.193
2020-09-28 04:46:59,333 Epoch: 11, loss: 1.484, time (seconds): 55.25.
2020-09-28 04:46:59,334 **Evaluating.**
2020-09-28 04:47:37,387 NMI: 30.038
2020-09-28 04:47:48,560 R@1 : 37.742
2020-09-28 04:47:48,806 R@2 : 48.457
2020-09-28 04:47:49,054 R@4 : 58.816
2020-09-28 04:47:49,303 R@8 : 69.340
2020-09-28 04:48:43,567 Epoch: 12, loss: 1.416, time (seconds): 54.26.
2020-09-28 04:48:43,568 **Evaluating.**
2020-09-28 04:49:20,086 NMI: 29.146
2020-09-28 04:49:31,484 R@1 : 36.630
2020-09-28 04:49:31,731 R@2 : 47.015
2020-09-28 04:49:31,977 R@4 : 57.017
2020-09-28 04:49:32,225 R@8 : 67.498
2020-09-28 04:50:25,999 Epoch: 13, loss: 1.425, time (seconds): 53.77.
2020-09-28 04:50:26,000 **Evaluating.**
2020-09-28 04:51:03,118 NMI: 28.779
2020-09-28 04:51:14,330 R@1 : 37.030
2020-09-28 04:51:14,576 R@2 : 46.806
2020-09-28 04:51:14,823 R@4 : 57.982
2020-09-28 04:51:15,070 R@8 : 68.132
2020-09-28 04:52:08,951 Epoch: 14, loss: 1.392, time (seconds): 53.88.
2020-09-28 04:52:08,952 **Evaluating.**
2020-09-28 04:52:46,607 NMI: 29.468
2020-09-28 04:52:57,932 R@1 : 37.508
2020-09-28 04:52:58,179 R@2 : 47.649
2020-09-28 04:52:58,427 R@4 : 57.739
2020-09-28 04:52:58,674 R@8 : 68.072
2020-09-28 04:53:52,334 Epoch: 15, loss: 1.320, time (seconds): 53.66.
2020-09-28 04:53:52,335 **Evaluating.**
2020-09-28 04:54:28,880 NMI: 28.114
2020-09-28 04:54:40,137 R@1 : 37.143
2020-09-28 04:54:40,383 R@2 : 47.215
2020-09-28 04:54:40,630 R@4 : 57.634
2020-09-28 04:54:40,877 R@8 : 67.594
2020-09-28 04:55:35,514 Epoch: 16, loss: 1.303, time (seconds): 54.64.
2020-09-28 04:55:35,515 **Evaluating.**
2020-09-28 04:56:12,010 NMI: 28.429
2020-09-28 04:56:23,339 R@1 : 36.404
2020-09-28 04:56:23,614 R@2 : 45.833
2020-09-28 04:56:23,890 R@4 : 55.792
2020-09-28 04:56:24,168 R@8 : 66.777
2020-09-28 04:57:19,053 Epoch: 17, loss: 1.205, time (seconds): 54.88.
2020-09-28 04:57:19,053 **Evaluating.**
2020-09-28 04:57:56,703 NMI: 28.007
2020-09-28 04:58:08,044 R@1 : 35.900
2020-09-28 04:58:08,294 R@2 : 45.659
2020-09-28 04:58:08,555 R@4 : 55.836
2020-09-28 04:58:08,811 R@8 : 66.160
2020-09-28 04:59:03,671 Epoch: 18, loss: 1.195, time (seconds): 54.86.
2020-09-28 04:59:03,671 **Evaluating.**
2020-09-28 04:59:41,032 NMI: 28.008
2020-09-28 04:59:52,304 R@1 : 36.387
2020-09-28 04:59:52,552 R@2 : 46.433
2020-09-28 04:59:52,802 R@4 : 56.427
2020-09-28 04:59:53,054 R@8 : 66.855
2020-09-28 05:00:46,386 Epoch: 19, loss: 1.184, time (seconds): 53.33.
2020-09-28 05:00:46,386 **Evaluating.**
2020-09-28 05:01:23,231 NMI: 28.871
2020-09-28 05:01:34,497 R@1 : 36.421
2020-09-28 05:01:34,743 R@2 : 46.146
2020-09-28 05:01:35,000 R@4 : 56.244
2020-09-28 05:01:35,246 R@8 : 66.064
2020-09-28 05:01:35,248 Total training time (minutes): 35.28.
2020-09-28 05:01:35,953 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 05:01:35,953 Training for 20 epochs
2020-09-28 05:01:35,955 **Evaluating initial model.**
2020-09-28 05:02:10,130 NMI: 25.916
2020-09-28 05:02:21,634 R@1 : 32.493
2020-09-28 05:02:21,882 R@2 : 41.514
2020-09-28 05:02:22,132 R@4 : 51.994
2020-09-28 05:02:22,387 R@8 : 62.736
2020-09-28 05:02:57,954 Epoch: 0, loss: 3.464, time (seconds): 35.57.
2020-09-28 05:02:57,955 **Evaluating.**
2020-09-28 05:03:32,447 NMI: 23.480
2020-09-28 05:03:43,048 R@1 : 30.216
2020-09-28 05:03:43,323 R@2 : 40.115
2020-09-28 05:03:43,600 R@4 : 51.178
2020-09-28 05:03:43,877 R@8 : 63.283
2020-09-28 05:04:19,057 Epoch: 1, loss: 2.689, time (seconds): 35.18.
2020-09-28 05:04:19,058 **Evaluating.**
2020-09-28 05:04:53,418 NMI: 28.216
2020-09-28 05:05:03,992 R@1 : 34.805
2020-09-28 05:05:04,247 R@2 : 45.164
2020-09-28 05:05:04,507 R@4 : 55.940
2020-09-28 05:05:04,768 R@8 : 66.829
2020-09-28 05:05:40,378 Epoch: 2, loss: 2.325, time (seconds): 35.61.
2020-09-28 05:05:40,379 **Evaluating.**
2020-09-28 05:06:14,742 NMI: 30.622
2020-09-28 05:06:25,512 R@1 : 37.864
2020-09-28 05:06:25,758 R@2 : 48.518
2020-09-28 05:06:26,004 R@4 : 59.190
2020-09-28 05:06:26,252 R@8 : 69.401
2020-09-28 05:07:01,812 Epoch: 3, loss: 2.182, time (seconds): 35.56.
2020-09-28 05:07:01,813 **Evaluating.**
2020-09-28 05:07:35,688 NMI: 31.971
2020-09-28 05:07:46,500 R@1 : 39.419
2020-09-28 05:07:46,748 R@2 : 50.213
2020-09-28 05:07:46,997 R@4 : 60.963
2020-09-28 05:07:47,247 R@8 : 70.913
2020-09-28 05:08:22,331 Epoch: 4, loss: 2.063, time (seconds): 35.08.
2020-09-28 05:08:22,332 **Evaluating.**
2020-09-28 05:08:56,192 NMI: 32.850
2020-09-28 05:09:07,175 R@1 : 40.593
2020-09-28 05:09:07,423 R@2 : 50.943
2020-09-28 05:09:07,669 R@4 : 61.693
2020-09-28 05:09:07,917 R@8 : 71.348
2020-09-28 05:09:43,135 Epoch: 5, loss: 1.912, time (seconds): 35.22.
2020-09-28 05:09:43,135 **Evaluating.**
2020-09-28 05:10:16,517 NMI: 32.786
2020-09-28 05:10:27,572 R@1 : 40.115
2020-09-28 05:10:27,818 R@2 : 51.238
2020-09-28 05:10:28,065 R@4 : 61.823
2020-09-28 05:10:28,315 R@8 : 71.626
2020-09-28 05:11:03,879 Epoch: 6, loss: 1.847, time (seconds): 35.56.
2020-09-28 05:11:03,881 **Evaluating.**
2020-09-28 05:11:37,568 NMI: 32.873
2020-09-28 05:11:48,706 R@1 : 40.845
2020-09-28 05:11:48,952 R@2 : 51.725
2020-09-28 05:11:49,199 R@4 : 61.806
2020-09-28 05:11:49,447 R@8 : 71.339
2020-09-28 05:12:24,861 Epoch: 7, loss: 1.759, time (seconds): 35.41.
2020-09-28 05:12:24,861 **Evaluating.**
2020-09-28 05:12:58,523 NMI: 33.315
2020-09-28 05:13:09,688 R@1 : 41.001
2020-09-28 05:13:09,934 R@2 : 51.456
2020-09-28 05:13:10,183 R@4 : 61.962
2020-09-28 05:13:10,435 R@8 : 71.826
2020-09-28 05:13:45,934 Epoch: 8, loss: 1.682, time (seconds): 35.50.
2020-09-28 05:13:45,935 **Evaluating.**
2020-09-28 05:14:19,775 NMI: 32.204
2020-09-28 05:14:30,839 R@1 : 40.523
2020-09-28 05:14:31,087 R@2 : 50.839
2020-09-28 05:14:31,338 R@4 : 61.641
2020-09-28 05:14:31,588 R@8 : 71.357
2020-09-28 05:15:07,024 Epoch: 9, loss: 1.609, time (seconds): 35.43.
2020-09-28 05:15:07,026 **Evaluating.**
2020-09-28 05:15:40,552 NMI: 33.111
2020-09-28 05:15:51,618 R@1 : 40.567
2020-09-28 05:15:51,869 R@2 : 51.317
2020-09-28 05:15:52,120 R@4 : 61.841
2020-09-28 05:15:52,375 R@8 : 71.661
2020-09-28 05:16:27,675 Epoch: 10, loss: 1.569, time (seconds): 35.30.
2020-09-28 05:16:27,676 **Evaluating.**
2020-09-28 05:17:01,048 NMI: 32.762
2020-09-28 05:17:12,134 R@1 : 40.853
2020-09-28 05:17:12,394 R@2 : 51.369
2020-09-28 05:17:12,647 R@4 : 62.136
2020-09-28 05:17:12,899 R@8 : 71.617
2020-09-28 05:17:48,262 Epoch: 11, loss: 1.475, time (seconds): 35.36.
2020-09-28 05:17:48,263 **Evaluating.**
2020-09-28 05:18:21,988 NMI: 32.711
2020-09-28 05:18:33,161 R@1 : 39.532
2020-09-28 05:18:33,408 R@2 : 50.482
2020-09-28 05:18:33,657 R@4 : 61.032
2020-09-28 05:18:33,907 R@8 : 71.383
2020-09-28 05:19:08,924 Epoch: 12, loss: 1.505, time (seconds): 35.02.
2020-09-28 05:19:08,925 **Evaluating.**
2020-09-28 05:19:42,013 NMI: 31.293
2020-09-28 05:19:53,322 R@1 : 39.046
2020-09-28 05:19:53,568 R@2 : 49.935
2020-09-28 05:19:53,814 R@4 : 60.624
2020-09-28 05:19:54,060 R@8 : 70.870
2020-09-28 05:20:29,298 Epoch: 13, loss: 1.438, time (seconds): 35.24.
2020-09-28 05:20:29,299 **Evaluating.**
2020-09-28 05:21:02,613 NMI: 32.329
2020-09-28 05:21:13,764 R@1 : 40.210
2020-09-28 05:21:14,014 R@2 : 51.291
2020-09-28 05:21:14,264 R@4 : 61.389
2020-09-28 05:21:14,511 R@8 : 71.365
2020-09-28 05:21:50,456 Epoch: 14, loss: 1.400, time (seconds): 35.94.
2020-09-28 05:21:50,457 **Evaluating.**
2020-09-28 05:22:24,293 NMI: 32.172
2020-09-28 05:22:35,569 R@1 : 39.107
2020-09-28 05:22:35,831 R@2 : 49.987
2020-09-28 05:22:36,094 R@4 : 60.615
2020-09-28 05:22:36,357 R@8 : 70.392
2020-09-28 05:23:11,798 Epoch: 15, loss: 1.358, time (seconds): 35.44.
2020-09-28 05:23:11,799 **Evaluating.**
2020-09-28 05:23:45,259 NMI: 31.304
2020-09-28 05:23:56,638 R@1 : 39.541
2020-09-28 05:23:56,920 R@2 : 49.483
2020-09-28 05:23:57,196 R@4 : 59.990
2020-09-28 05:23:57,471 R@8 : 70.070
2020-09-28 05:24:32,504 Epoch: 16, loss: 1.319, time (seconds): 35.03.
2020-09-28 05:24:32,505 **Evaluating.**
2020-09-28 05:25:06,503 NMI: 31.370
2020-09-28 05:25:17,786 R@1 : 39.402
2020-09-28 05:25:18,034 R@2 : 50.152
2020-09-28 05:25:18,294 R@4 : 60.607
2020-09-28 05:25:18,546 R@8 : 70.470
2020-09-28 05:25:53,994 Epoch: 17, loss: 1.261, time (seconds): 35.45.
2020-09-28 05:25:53,995 **Evaluating.**
2020-09-28 05:26:27,859 NMI: 31.013
2020-09-28 05:26:39,313 R@1 : 39.081
2020-09-28 05:26:39,569 R@2 : 49.205
2020-09-28 05:26:39,821 R@4 : 59.807
2020-09-28 05:26:40,080 R@8 : 70.036
2020-09-28 05:27:15,483 Epoch: 18, loss: 1.312, time (seconds): 35.40.
2020-09-28 05:27:15,484 **Evaluating.**
2020-09-28 05:27:48,893 NMI: 31.930
2020-09-28 05:28:00,182 R@1 : 39.515
2020-09-28 05:28:00,456 R@2 : 49.518
2020-09-28 05:28:00,730 R@4 : 59.964
2020-09-28 05:28:01,006 R@8 : 70.018
2020-09-28 05:28:36,238 Epoch: 19, loss: 1.260, time (seconds): 35.23.
2020-09-28 05:28:36,239 **Evaluating.**
2020-09-28 05:29:09,949 NMI: 30.850
2020-09-28 05:29:21,124 R@1 : 38.881
2020-09-28 05:29:21,375 R@2 : 49.361
2020-09-28 05:29:21,627 R@4 : 59.729
2020-09-28 05:29:21,877 R@8 : 70.227
2020-09-28 05:29:21,879 Total training time (minutes): 27.77.
2020-09-28 05:29:22,635 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 05:29:22,636 Training for 20 epochs
2020-09-28 05:29:22,638 **Evaluating initial model.**
2020-09-28 05:29:59,502 NMI: 25.916
2020-09-28 05:30:10,952 R@1 : 32.493
2020-09-28 05:30:11,204 R@2 : 41.514
2020-09-28 05:30:11,450 R@4 : 51.994
2020-09-28 05:30:11,702 R@8 : 62.736
2020-09-28 05:31:07,588 Epoch: 0, loss: 3.382, time (seconds): 55.89.
2020-09-28 05:31:07,589 **Evaluating.**
2020-09-28 05:31:45,133 NMI: 25.306
2020-09-28 05:31:55,800 R@1 : 28.809
2020-09-28 05:31:56,047 R@2 : 38.420
2020-09-28 05:31:56,294 R@4 : 49.483
2020-09-28 05:31:56,543 R@8 : 61.502
2020-09-28 05:32:52,115 Epoch: 1, loss: 2.750, time (seconds): 55.57.
2020-09-28 05:32:52,116 **Evaluating.**
2020-09-28 05:33:29,752 NMI: 28.111
2020-09-28 05:33:40,460 R@1 : 31.520
2020-09-28 05:33:40,713 R@2 : 41.636
2020-09-28 05:33:40,966 R@4 : 53.437
2020-09-28 05:33:41,220 R@8 : 64.943
2020-09-28 05:34:36,857 Epoch: 2, loss: 2.490, time (seconds): 55.64.
2020-09-28 05:34:36,858 **Evaluating.**
2020-09-28 05:35:14,621 NMI: 28.506
2020-09-28 05:35:25,375 R@1 : 33.215
2020-09-28 05:35:25,626 R@2 : 43.391
2020-09-28 05:35:25,875 R@4 : 55.036
2020-09-28 05:35:26,128 R@8 : 65.821
2020-09-28 05:36:21,452 Epoch: 3, loss: 2.458, time (seconds): 55.32.
2020-09-28 05:36:21,453 **Evaluating.**
2020-09-28 05:36:58,799 NMI: 28.316
2020-09-28 05:37:09,620 R@1 : 34.084
2020-09-28 05:37:09,872 R@2 : 44.086
2020-09-28 05:37:10,128 R@4 : 54.862
2020-09-28 05:37:10,384 R@8 : 66.055
2020-09-28 05:38:06,120 Epoch: 4, loss: 2.154, time (seconds): 55.73.
2020-09-28 05:38:06,121 **Evaluating.**
2020-09-28 05:38:42,648 NMI: 27.761
2020-09-28 05:38:53,684 R@1 : 34.701
2020-09-28 05:38:53,936 R@2 : 45.025
2020-09-28 05:38:54,189 R@4 : 56.279
2020-09-28 05:38:54,443 R@8 : 67.637
2020-09-28 05:39:49,267 Epoch: 5, loss: 2.143, time (seconds): 54.82.
2020-09-28 05:39:49,268 **Evaluating.**
2020-09-28 05:40:26,160 NMI: 28.518
2020-09-28 05:40:37,058 R@1 : 34.301
2020-09-28 05:40:37,311 R@2 : 44.382
2020-09-28 05:40:37,558 R@4 : 55.471
2020-09-28 05:40:37,809 R@8 : 66.881
2020-09-28 05:41:33,212 Epoch: 6, loss: 1.914, time (seconds): 55.40.
2020-09-28 05:41:33,213 **Evaluating.**
2020-09-28 05:42:10,233 NMI: 27.878
2020-09-28 05:42:21,270 R@1 : 34.753
2020-09-28 05:42:21,524 R@2 : 44.842
2020-09-28 05:42:21,773 R@4 : 55.584
2020-09-28 05:42:22,021 R@8 : 66.959
2020-09-28 05:43:17,437 Epoch: 7, loss: 1.930, time (seconds): 55.41.
2020-09-28 05:43:17,438 **Evaluating.**
2020-09-28 05:43:54,245 NMI: 28.774
2020-09-28 05:44:05,184 R@1 : 35.005
2020-09-28 05:44:05,462 R@2 : 45.060
2020-09-28 05:44:05,742 R@4 : 56.652
2020-09-28 05:44:06,025 R@8 : 67.976
2020-09-28 05:45:01,581 Epoch: 8, loss: 1.793, time (seconds): 55.55.
2020-09-28 05:45:01,582 **Evaluating.**
2020-09-28 05:45:38,626 NMI: 28.087
2020-09-28 05:45:49,611 R@1 : 35.300
2020-09-28 05:45:49,860 R@2 : 45.390
2020-09-28 05:45:50,109 R@4 : 56.461
2020-09-28 05:45:50,359 R@8 : 67.203
2020-09-28 05:46:45,964 Epoch: 9, loss: 1.804, time (seconds): 55.60.
2020-09-28 05:46:45,964 **Evaluating.**
2020-09-28 05:47:22,859 NMI: 28.239
2020-09-28 05:47:33,954 R@1 : 35.179
2020-09-28 05:47:34,202 R@2 : 45.451
2020-09-28 05:47:34,455 R@4 : 56.618
2020-09-28 05:47:34,707 R@8 : 67.741
2020-09-28 05:48:30,366 Epoch: 10, loss: 1.696, time (seconds): 55.66.
2020-09-28 05:48:30,366 **Evaluating.**
2020-09-28 05:49:07,604 NMI: 29.349
2020-09-28 05:49:18,699 R@1 : 34.927
2020-09-28 05:49:18,946 R@2 : 45.312
2020-09-28 05:49:19,200 R@4 : 56.383
2020-09-28 05:49:19,455 R@8 : 66.968
2020-09-28 05:50:14,436 Epoch: 11, loss: 1.590, time (seconds): 54.98.
2020-09-28 05:50:14,437 **Evaluating.**
2020-09-28 05:50:51,415 NMI: 27.594
2020-09-28 05:51:02,524 R@1 : 34.023
2020-09-28 05:51:02,772 R@2 : 44.390
2020-09-28 05:51:03,024 R@4 : 55.384
2020-09-28 05:51:03,281 R@8 : 66.447
2020-09-28 05:51:58,142 Epoch: 12, loss: 1.531, time (seconds): 54.86.
2020-09-28 05:51:58,143 **Evaluating.**
2020-09-28 05:52:35,238 NMI: 28.181
2020-09-28 05:52:46,368 R@1 : 34.292
2020-09-28 05:52:46,616 R@2 : 44.521
2020-09-28 05:52:46,867 R@4 : 56.044
2020-09-28 05:52:47,118 R@8 : 67.446
2020-09-28 05:53:41,002 Epoch: 13, loss: 1.538, time (seconds): 53.88.
2020-09-28 05:53:41,003 **Evaluating.**
2020-09-28 05:54:17,970 NMI: 26.812
2020-09-28 05:54:29,158 R@1 : 34.005
2020-09-28 05:54:29,412 R@2 : 44.286
2020-09-28 05:54:29,658 R@4 : 55.975
2020-09-28 05:54:29,913 R@8 : 66.281
2020-09-28 05:55:23,210 Epoch: 14, loss: 1.476, time (seconds): 53.30.
2020-09-28 05:55:23,211 **Evaluating.**
2020-09-28 05:56:00,492 NMI: 27.459
2020-09-28 05:56:11,686 R@1 : 35.066
2020-09-28 05:56:11,935 R@2 : 45.511
2020-09-28 05:56:12,191 R@4 : 56.201
2020-09-28 05:56:12,444 R@8 : 66.855
2020-09-28 05:57:07,099 Epoch: 15, loss: 1.406, time (seconds): 54.65.
2020-09-28 05:57:07,100 **Evaluating.**
2020-09-28 05:57:44,560 NMI: 27.610
2020-09-28 05:57:55,706 R@1 : 33.745
2020-09-28 05:57:55,977 R@2 : 43.808
2020-09-28 05:57:56,253 R@4 : 55.262
2020-09-28 05:57:56,525 R@8 : 66.464
2020-09-28 05:58:50,179 Epoch: 16, loss: 1.320, time (seconds): 53.65.
2020-09-28 05:58:50,180 **Evaluating.**
2020-09-28 05:59:28,057 NMI: 26.757
2020-09-28 05:59:39,169 R@1 : 34.283
2020-09-28 05:59:39,418 R@2 : 44.582
2020-09-28 05:59:39,666 R@4 : 55.106
2020-09-28 05:59:39,920 R@8 : 66.281
2020-09-28 06:00:34,265 Epoch: 17, loss: 1.328, time (seconds): 54.34.
2020-09-28 06:00:34,265 **Evaluating.**
2020-09-28 06:01:11,472 NMI: 26.298
2020-09-28 06:01:22,768 R@1 : 33.649
2020-09-28 06:01:23,017 R@2 : 44.008
2020-09-28 06:01:23,278 R@4 : 54.593
2020-09-28 06:01:23,541 R@8 : 65.491
2020-09-28 06:02:17,730 Epoch: 18, loss: 1.262, time (seconds): 54.19.
2020-09-28 06:02:17,731 **Evaluating.**
2020-09-28 06:02:54,797 NMI: 26.101
2020-09-28 06:03:05,844 R@1 : 33.223
2020-09-28 06:03:06,103 R@2 : 43.104
2020-09-28 06:03:06,359 R@4 : 54.297
2020-09-28 06:03:06,609 R@8 : 65.812
2020-09-28 06:04:00,701 Epoch: 19, loss: 1.270, time (seconds): 54.09.
2020-09-28 06:04:00,702 **Evaluating.**
2020-09-28 06:04:38,527 NMI: 26.504
2020-09-28 06:04:49,778 R@1 : 33.884
2020-09-28 06:04:50,034 R@2 : 44.173
2020-09-28 06:04:50,286 R@4 : 55.227
2020-09-28 06:04:50,536 R@8 : 66.134
2020-09-28 06:04:50,538 Total training time (minutes): 35.47.
2020-09-28 06:04:51,265 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 06:04:51,265 Training for 20 epochs
2020-09-28 06:04:51,267 **Evaluating initial model.**
2020-09-28 06:05:25,316 NMI: 25.916
2020-09-28 06:05:36,837 R@1 : 32.493
2020-09-28 06:05:37,120 R@2 : 41.514
2020-09-28 06:05:37,411 R@4 : 51.994
2020-09-28 06:05:37,696 R@8 : 62.736
2020-09-28 06:06:13,049 Epoch: 0, loss: 4.257, time (seconds): 35.35.
2020-09-28 06:06:13,050 **Evaluating.**
2020-09-28 06:06:47,474 NMI: 22.663
2020-09-28 06:06:58,201 R@1 : 28.704
2020-09-28 06:06:58,453 R@2 : 38.342
2020-09-28 06:06:58,704 R@4 : 49.552
2020-09-28 06:06:58,964 R@8 : 61.780
2020-09-28 06:07:34,430 Epoch: 1, loss: 3.138, time (seconds): 35.46.
2020-09-28 06:07:34,431 **Evaluating.**
2020-09-28 06:08:09,014 NMI: 25.977
2020-09-28 06:08:19,837 R@1 : 31.702
2020-09-28 06:08:20,117 R@2 : 42.591
2020-09-28 06:08:20,395 R@4 : 53.663
2020-09-28 06:08:20,679 R@8 : 64.595
2020-09-28 06:08:56,314 Epoch: 2, loss: 2.737, time (seconds): 35.63.
2020-09-28 06:08:56,315 **Evaluating.**
2020-09-28 06:09:31,369 NMI: 27.783
2020-09-28 06:09:42,036 R@1 : 33.597
2020-09-28 06:09:42,282 R@2 : 44.321
2020-09-28 06:09:42,528 R@4 : 55.123
2020-09-28 06:09:42,789 R@8 : 66.255
2020-09-28 06:10:18,508 Epoch: 3, loss: 2.529, time (seconds): 35.72.
2020-09-28 06:10:18,510 **Evaluating.**
2020-09-28 06:10:52,661 NMI: 28.810
2020-09-28 06:11:03,395 R@1 : 34.735
2020-09-28 06:11:03,645 R@2 : 45.381
2020-09-28 06:11:03,893 R@4 : 56.400
2020-09-28 06:11:04,139 R@8 : 67.177
2020-09-28 06:11:39,486 Epoch: 4, loss: 2.415, time (seconds): 35.34.
2020-09-28 06:11:39,487 **Evaluating.**
2020-09-28 06:12:13,795 NMI: 30.277
2020-09-28 06:12:24,620 R@1 : 35.952
2020-09-28 06:12:24,900 R@2 : 46.424
2020-09-28 06:12:25,184 R@4 : 57.339
2020-09-28 06:12:25,476 R@8 : 67.689
2020-09-28 06:13:01,128 Epoch: 5, loss: 2.218, time (seconds): 35.65.
2020-09-28 06:13:01,128 **Evaluating.**
2020-09-28 06:13:34,915 NMI: 29.835
2020-09-28 06:13:45,689 R@1 : 36.056
2020-09-28 06:13:45,937 R@2 : 46.841
2020-09-28 06:13:46,189 R@4 : 58.095
2020-09-28 06:13:46,438 R@8 : 68.541
2020-09-28 06:14:22,027 Epoch: 6, loss: 2.182, time (seconds): 35.59.
2020-09-28 06:14:22,028 **Evaluating.**
2020-09-28 06:14:55,940 NMI: 30.037
2020-09-28 06:15:06,872 R@1 : 36.030
2020-09-28 06:15:07,149 R@2 : 46.667
2020-09-28 06:15:07,440 R@4 : 58.095
2020-09-28 06:15:07,726 R@8 : 69.453
2020-09-28 06:15:43,410 Epoch: 7, loss: 2.044, time (seconds): 35.68.
2020-09-28 06:15:43,411 **Evaluating.**
2020-09-28 06:16:17,369 NMI: 30.177
2020-09-28 06:16:28,216 R@1 : 36.326
2020-09-28 06:16:28,462 R@2 : 46.754
2020-09-28 06:16:28,710 R@4 : 57.852
2020-09-28 06:16:28,959 R@8 : 68.906
2020-09-28 06:17:04,464 Epoch: 8, loss: 1.970, time (seconds): 35.50.
2020-09-28 06:17:04,465 **Evaluating.**
2020-09-28 06:17:38,359 NMI: 30.230
2020-09-28 06:17:49,360 R@1 : 35.578
2020-09-28 06:17:49,618 R@2 : 46.302
2020-09-28 06:17:49,869 R@4 : 57.243
2020-09-28 06:17:50,119 R@8 : 67.750
2020-09-28 06:18:25,679 Epoch: 9, loss: 1.849, time (seconds): 35.56.
2020-09-28 06:18:25,679 **Evaluating.**
2020-09-28 06:18:59,532 NMI: 30.249
2020-09-28 06:19:10,480 R@1 : 35.935
2020-09-28 06:19:10,729 R@2 : 46.641
2020-09-28 06:19:10,976 R@4 : 58.008
2020-09-28 06:19:11,224 R@8 : 68.723
2020-09-28 06:19:46,979 Epoch: 10, loss: 1.787, time (seconds): 35.75.
2020-09-28 06:19:46,980 **Evaluating.**
2020-09-28 06:20:20,795 NMI: 29.700
2020-09-28 06:20:31,789 R@1 : 35.961
2020-09-28 06:20:32,076 R@2 : 46.589
2020-09-28 06:20:32,365 R@4 : 57.860
2020-09-28 06:20:32,651 R@8 : 68.923
2020-09-28 06:21:07,939 Epoch: 11, loss: 1.712, time (seconds): 35.28.
2020-09-28 06:21:07,941 **Evaluating.**
2020-09-28 06:21:41,621 NMI: 29.980
2020-09-28 06:21:52,719 R@1 : 35.526
2020-09-28 06:21:52,988 R@2 : 46.241
2020-09-28 06:21:53,263 R@4 : 57.191
2020-09-28 06:21:53,541 R@8 : 68.028
2020-09-28 06:22:28,959 Epoch: 12, loss: 1.722, time (seconds): 35.42.
2020-09-28 06:22:28,960 **Evaluating.**
2020-09-28 06:23:02,895 NMI: 29.889
2020-09-28 06:23:13,961 R@1 : 35.787
2020-09-28 06:23:14,223 R@2 : 46.528
2020-09-28 06:23:14,491 R@4 : 57.626
2020-09-28 06:23:14,757 R@8 : 68.289
2020-09-28 06:23:50,175 Epoch: 13, loss: 1.665, time (seconds): 35.42.
2020-09-28 06:23:50,176 **Evaluating.**
2020-09-28 06:24:23,687 NMI: 29.381
2020-09-28 06:24:34,813 R@1 : 35.274
2020-09-28 06:24:35,062 R@2 : 45.598
2020-09-28 06:24:35,319 R@4 : 57.070
2020-09-28 06:24:35,567 R@8 : 68.263
2020-09-28 06:25:11,260 Epoch: 14, loss: 1.635, time (seconds): 35.69.
2020-09-28 06:25:11,260 **Evaluating.**
2020-09-28 06:25:45,070 NMI: 29.737
2020-09-28 06:25:56,080 R@1 : 34.961
2020-09-28 06:25:56,332 R@2 : 45.659
2020-09-28 06:25:56,592 R@4 : 56.948
2020-09-28 06:25:56,840 R@8 : 68.219
2020-09-28 06:26:31,983 Epoch: 15, loss: 1.586, time (seconds): 35.14.
2020-09-28 06:26:31,983 **Evaluating.**
2020-09-28 06:27:05,989 NMI: 29.601
2020-09-28 06:27:17,145 R@1 : 34.579
2020-09-28 06:27:17,391 R@2 : 45.564
2020-09-28 06:27:17,637 R@4 : 56.731
2020-09-28 06:27:17,888 R@8 : 67.898
2020-09-28 06:27:53,015 Epoch: 16, loss: 1.540, time (seconds): 35.12.
2020-09-28 06:27:53,016 **Evaluating.**
2020-09-28 06:28:26,882 NMI: 29.354
2020-09-28 06:28:38,079 R@1 : 35.213
2020-09-28 06:28:38,326 R@2 : 45.755
2020-09-28 06:28:38,574 R@4 : 57.296
2020-09-28 06:28:38,825 R@8 : 68.219
2020-09-28 06:29:13,995 Epoch: 17, loss: 1.488, time (seconds): 35.17.
2020-09-28 06:29:13,996 **Evaluating.**
2020-09-28 06:29:47,860 NMI: 29.016
2020-09-28 06:29:59,027 R@1 : 35.561
2020-09-28 06:29:59,284 R@2 : 45.720
2020-09-28 06:29:59,534 R@4 : 56.557
2020-09-28 06:29:59,784 R@8 : 67.481
2020-09-28 06:30:35,430 Epoch: 18, loss: 1.526, time (seconds): 35.64.
2020-09-28 06:30:35,431 **Evaluating.**
2020-09-28 06:31:09,177 NMI: 29.329
2020-09-28 06:31:20,348 R@1 : 34.570
2020-09-28 06:31:20,595 R@2 : 45.442
2020-09-28 06:31:20,845 R@4 : 56.618
2020-09-28 06:31:21,093 R@8 : 67.741
2020-09-28 06:31:56,773 Epoch: 19, loss: 1.476, time (seconds): 35.68.
2020-09-28 06:31:56,774 **Evaluating.**
2020-09-28 06:32:30,661 NMI: 28.974
2020-09-28 06:32:41,834 R@1 : 34.614
2020-09-28 06:32:42,081 R@2 : 44.981
2020-09-28 06:32:42,329 R@4 : 56.175
2020-09-28 06:32:42,582 R@8 : 67.368
2020-09-28 06:32:42,584 Total training time (minutes): 27.86.
2020-09-28 06:32:43,297 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 32, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 06:32:43,298 Training for 20 epochs
2020-09-28 06:32:43,300 **Evaluating initial model.**
2020-09-28 06:33:19,774 NMI: 25.916
2020-09-28 06:33:31,234 R@1 : 32.493
2020-09-28 06:33:31,504 R@2 : 41.514
2020-09-28 06:33:31,770 R@4 : 51.994
2020-09-28 06:33:32,035 R@8 : 62.736
2020-09-28 06:34:25,904 Epoch: 0, loss: 5.894, time (seconds): 53.87.
2020-09-28 06:34:25,905 **Evaluating.**
2020-09-28 06:35:03,630 NMI: 16.830
2020-09-28 06:35:13,207 R@1 : 16.460
2020-09-28 06:35:13,460 R@2 : 23.560
2020-09-28 06:35:13,707 R@4 : 33.771
2020-09-28 06:35:13,959 R@8 : 46.737
2020-09-28 06:36:08,212 Epoch: 1, loss: 4.055, time (seconds): 54.25.
2020-09-28 06:36:08,213 **Evaluating.**
2020-09-28 06:36:45,914 NMI: 20.713
2020-09-28 06:36:56,188 R@1 : 23.473
2020-09-28 06:36:56,456 R@2 : 32.154
2020-09-28 06:36:56,723 R@4 : 43.991
2020-09-28 06:36:56,987 R@8 : 56.557
2020-09-28 06:37:51,753 Epoch: 2, loss: 3.133, time (seconds): 54.76.
2020-09-28 06:37:51,753 **Evaluating.**
2020-09-28 06:38:29,761 NMI: 24.791
2020-09-28 06:38:40,184 R@1 : 28.244
2020-09-28 06:38:40,435 R@2 : 37.942
2020-09-28 06:38:40,685 R@4 : 49.709
2020-09-28 06:38:40,937 R@8 : 61.754
2020-09-28 06:39:35,464 Epoch: 3, loss: 2.802, time (seconds): 54.53.
2020-09-28 06:39:35,465 **Evaluating.**
2020-09-28 06:40:13,358 NMI: 24.240
2020-09-28 06:40:23,856 R@1 : 28.348
2020-09-28 06:40:24,118 R@2 : 38.603
2020-09-28 06:40:24,389 R@4 : 49.648
2020-09-28 06:40:24,659 R@8 : 62.006
2020-09-28 06:41:19,495 Epoch: 4, loss: 2.624, time (seconds): 54.84.
2020-09-28 06:41:19,495 **Evaluating.**
2020-09-28 06:41:58,318 NMI: 25.016
2020-09-28 06:42:08,910 R@1 : 30.555
2020-09-28 06:42:09,163 R@2 : 40.636
2020-09-28 06:42:09,416 R@4 : 51.734
2020-09-28 06:42:09,666 R@8 : 63.787
2020-09-28 06:43:04,189 Epoch: 5, loss: 2.514, time (seconds): 54.52.
2020-09-28 06:43:04,189 **Evaluating.**
2020-09-28 06:43:41,759 NMI: 25.952
2020-09-28 06:43:52,472 R@1 : 32.250
2020-09-28 06:43:52,753 R@2 : 42.322
2020-09-28 06:43:53,029 R@4 : 53.750
2020-09-28 06:43:53,306 R@8 : 65.169
2020-09-28 06:44:47,621 Epoch: 6, loss: 2.209, time (seconds): 54.31.
2020-09-28 06:44:47,622 **Evaluating.**
2020-09-28 06:45:25,567 NMI: 26.775
2020-09-28 06:45:36,339 R@1 : 32.711
2020-09-28 06:45:36,587 R@2 : 42.531
2020-09-28 06:45:36,841 R@4 : 54.958
2020-09-28 06:45:37,095 R@8 : 65.743
2020-09-28 06:46:31,273 Epoch: 7, loss: 2.147, time (seconds): 54.18.
2020-09-28 06:46:31,273 **Evaluating.**
2020-09-28 06:47:08,480 NMI: 27.271
2020-09-28 06:47:19,250 R@1 : 33.197
2020-09-28 06:47:19,504 R@2 : 43.122
2020-09-28 06:47:19,751 R@4 : 54.810
2020-09-28 06:47:20,004 R@8 : 66.577
2020-09-28 06:48:14,319 Epoch: 8, loss: 1.994, time (seconds): 54.31.
2020-09-28 06:48:14,320 **Evaluating.**
2020-09-28 06:48:52,097 NMI: 26.621
2020-09-28 06:49:02,836 R@1 : 32.823
2020-09-28 06:49:03,094 R@2 : 42.956
2020-09-28 06:49:03,346 R@4 : 54.045
2020-09-28 06:49:03,598 R@8 : 65.169
2020-09-28 06:49:57,686 Epoch: 9, loss: 1.981, time (seconds): 54.09.
2020-09-28 06:49:57,686 **Evaluating.**
2020-09-28 06:50:35,550 NMI: 26.463
2020-09-28 06:50:46,362 R@1 : 32.841
2020-09-28 06:50:46,612 R@2 : 43.330
2020-09-28 06:50:46,870 R@4 : 54.323
2020-09-28 06:50:47,117 R@8 : 65.864
2020-09-28 06:51:40,577 Epoch: 10, loss: 1.888, time (seconds): 53.46.
2020-09-28 06:51:40,578 **Evaluating.**
2020-09-28 06:52:18,575 NMI: 27.545
2020-09-28 06:52:29,568 R@1 : 34.136
2020-09-28 06:52:29,819 R@2 : 44.078
2020-09-28 06:52:30,069 R@4 : 55.575
2020-09-28 06:52:30,320 R@8 : 66.699
2020-09-28 06:53:24,818 Epoch: 11, loss: 1.786, time (seconds): 54.50.
2020-09-28 06:53:24,819 **Evaluating.**
2020-09-28 06:54:02,176 NMI: 27.011
2020-09-28 06:54:13,109 R@1 : 33.493
2020-09-28 06:54:13,383 R@2 : 43.999
2020-09-28 06:54:13,659 R@4 : 55.201
2020-09-28 06:54:13,935 R@8 : 66.977
2020-09-28 06:55:08,248 Epoch: 12, loss: 1.721, time (seconds): 54.31.
2020-09-28 06:55:08,248 **Evaluating.**
2020-09-28 06:55:44,934 NMI: 26.026
2020-09-28 06:55:55,852 R@1 : 33.275
2020-09-28 06:55:56,099 R@2 : 43.313
2020-09-28 06:55:56,347 R@4 : 54.323
2020-09-28 06:55:56,593 R@8 : 65.047
2020-09-28 06:56:50,575 Epoch: 13, loss: 1.760, time (seconds): 53.98.
2020-09-28 06:56:50,575 **Evaluating.**
2020-09-28 06:57:28,433 NMI: 26.357
2020-09-28 06:57:39,478 R@1 : 33.223
2020-09-28 06:57:39,760 R@2 : 43.165
2020-09-28 06:57:40,039 R@4 : 53.672
2020-09-28 06:57:40,315 R@8 : 65.282
2020-09-28 06:58:33,731 Epoch: 14, loss: 1.647, time (seconds): 53.41.
2020-09-28 06:58:33,731 **Evaluating.**
2020-09-28 06:59:10,210 NMI: 26.740
2020-09-28 06:59:21,137 R@1 : 33.501
2020-09-28 06:59:21,415 R@2 : 43.504
2020-09-28 06:59:21,691 R@4 : 54.584
2020-09-28 06:59:21,968 R@8 : 65.734
2020-09-28 07:00:16,033 Epoch: 15, loss: 1.561, time (seconds): 54.06.
2020-09-28 07:00:16,033 **Evaluating.**
2020-09-28 07:00:53,232 NMI: 25.419
2020-09-28 07:01:04,183 R@1 : 32.189
2020-09-28 07:01:04,459 R@2 : 42.287
2020-09-28 07:01:04,736 R@4 : 53.454
2020-09-28 07:01:05,013 R@8 : 65.117
2020-09-28 07:01:58,348 Epoch: 16, loss: 1.539, time (seconds): 53.33.
2020-09-28 07:01:58,348 **Evaluating.**
2020-09-28 07:02:35,314 NMI: 25.921
2020-09-28 07:02:46,319 R@1 : 33.102
2020-09-28 07:02:46,566 R@2 : 43.069
2020-09-28 07:02:46,812 R@4 : 54.219
2020-09-28 07:02:47,056 R@8 : 65.743
2020-09-28 07:03:41,644 Epoch: 17, loss: 1.458, time (seconds): 54.59.
2020-09-28 07:03:41,645 **Evaluating.**
2020-09-28 07:04:19,545 NMI: 25.650
2020-09-28 07:04:30,641 R@1 : 32.276
2020-09-28 07:04:30,893 R@2 : 42.183
2020-09-28 07:04:31,139 R@4 : 52.681
2020-09-28 07:04:31,386 R@8 : 64.031
2020-09-28 07:05:25,958 Epoch: 18, loss: 1.397, time (seconds): 54.57.
2020-09-28 07:05:25,959 **Evaluating.**
2020-09-28 07:06:03,780 NMI: 25.496
2020-09-28 07:06:14,740 R@1 : 31.572
2020-09-28 07:06:14,985 R@2 : 41.957
2020-09-28 07:06:15,231 R@4 : 53.194
2020-09-28 07:06:15,483 R@8 : 64.960
2020-09-28 07:07:08,882 Epoch: 19, loss: 1.382, time (seconds): 53.40.
2020-09-28 07:07:08,883 **Evaluating.**
2020-09-28 07:07:46,061 NMI: 25.820
2020-09-28 07:07:57,059 R@1 : 32.467
2020-09-28 07:07:57,311 R@2 : 42.392
2020-09-28 07:07:57,560 R@4 : 53.733
2020-09-28 07:07:57,809 R@8 : 65.299
2020-09-28 07:07:57,811 Total training time (minutes): 35.24.
2020-09-28 07:07:58,523 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200927-231837', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 07:07:58,523 Training for 20 epochs
2020-09-28 07:07:58,525 **Evaluating initial model.**
2020-09-28 07:08:33,010 NMI: 25.916
2020-09-28 07:08:44,571 R@1 : 32.493
2020-09-28 07:08:44,825 R@2 : 41.514
2020-09-28 07:08:45,078 R@4 : 51.994
2020-09-28 07:08:45,325 R@8 : 62.736
2020-09-28 07:09:20,852 Epoch: 0, loss: 20.689, time (seconds): 35.53.
2020-09-28 07:09:20,853 **Evaluating.**
2020-09-28 07:09:55,276 NMI: 22.523
2020-09-28 07:10:05,927 R@1 : 27.940
2020-09-28 07:10:06,202 R@2 : 37.499
2020-09-28 07:10:06,471 R@4 : 48.518
2020-09-28 07:10:06,741 R@8 : 60.937
2020-09-28 07:10:42,018 Epoch: 1, loss: 15.469, time (seconds): 35.27.
2020-09-28 07:10:42,019 **Evaluating.**
2020-09-28 07:11:16,184 NMI: 22.318
2020-09-28 07:11:26,420 R@1 : 28.800
2020-09-28 07:11:26,674 R@2 : 38.620
2020-09-28 07:11:26,927 R@4 : 49.639
2020-09-28 07:11:27,182 R@8 : 61.345
2020-09-28 07:12:02,896 Epoch: 2, loss: 5.077, time (seconds): 35.71.
2020-09-28 07:12:02,896 **Evaluating.**
2020-09-28 07:12:37,312 NMI: 20.106
2020-09-28 07:12:47,081 R@1 : 25.767
2020-09-28 07:12:47,329 R@2 : 34.770
2020-09-28 07:12:47,582 R@4 : 45.624
2020-09-28 07:12:47,832 R@8 : 57.322
2020-09-28 07:13:23,231 Epoch: 3, loss: 3.492, time (seconds): 35.40.
2020-09-28 07:13:23,232 **Evaluating.**
2020-09-28 07:13:57,504 NMI: 23.313
2020-09-28 07:14:07,888 R@1 : 29.295
2020-09-28 07:14:08,198 R@2 : 39.159
2020-09-28 07:14:08,509 R@4 : 50.239
2020-09-28 07:14:08,817 R@8 : 62.058
2020-09-28 07:14:44,436 Epoch: 4, loss: 3.094, time (seconds): 35.62.
2020-09-28 07:14:44,437 **Evaluating.**
2020-09-28 07:15:18,835 NMI: 22.779
2020-09-28 07:15:29,001 R@1 : 29.347
2020-09-28 07:15:29,281 R@2 : 39.393
2020-09-28 07:15:29,566 R@4 : 50.613
2020-09-28 07:15:29,844 R@8 : 62.423
2020-09-28 07:16:05,258 Epoch: 5, loss: 2.606, time (seconds): 35.41.
2020-09-28 07:16:05,259 **Evaluating.**
2020-09-28 07:16:39,527 NMI: 24.273
2020-09-28 07:16:49,981 R@1 : 31.381
2020-09-28 07:16:50,227 R@2 : 41.184
2020-09-28 07:16:50,477 R@4 : 52.603
2020-09-28 07:16:50,730 R@8 : 63.414
2020-09-28 07:17:25,972 Epoch: 6, loss: 2.433, time (seconds): 35.24.
2020-09-28 07:17:25,973 **Evaluating.**
2020-09-28 07:18:00,556 NMI: 25.134
2020-09-28 07:18:10,971 R@1 : 32.537
2020-09-28 07:18:11,217 R@2 : 43.287
2020-09-28 07:18:11,468 R@4 : 54.063
2020-09-28 07:18:11,715 R@8 : 64.874
2020-09-28 07:18:47,074 Epoch: 7, loss: 2.255, time (seconds): 35.36.
2020-09-28 07:18:47,075 **Evaluating.**
2020-09-28 07:19:20,627 NMI: 25.071
2020-09-28 07:19:31,233 R@1 : 32.337
2020-09-28 07:19:31,487 R@2 : 42.348
2020-09-28 07:19:31,739 R@4 : 53.541
2020-09-28 07:19:31,990 R@8 : 65.160
2020-09-28 07:20:07,316 Epoch: 8, loss: 2.188, time (seconds): 35.32.
2020-09-28 07:20:07,317 **Evaluating.**
2020-09-28 07:20:41,638 NMI: 25.253
2020-09-28 07:20:52,479 R@1 : 32.989
2020-09-28 07:20:52,755 R@2 : 43.069
2020-09-28 07:20:53,032 R@4 : 54.080
2020-09-28 07:20:53,309 R@8 : 65.682
2020-09-28 07:21:28,775 Epoch: 9, loss: 2.040, time (seconds): 35.46.
2020-09-28 07:21:28,776 **Evaluating.**
2020-09-28 07:22:03,076 NMI: 26.059
2020-09-28 07:22:13,860 R@1 : 34.023
2020-09-28 07:22:14,115 R@2 : 44.286
2020-09-28 07:22:14,367 R@4 : 55.418
2020-09-28 07:22:14,621 R@8 : 66.881
2020-09-28 07:22:49,822 Epoch: 10, loss: 1.919, time (seconds): 35.20.
2020-09-28 07:22:49,823 **Evaluating.**
2020-09-28 07:23:23,532 NMI: 25.584
2020-09-28 07:23:34,448 R@1 : 33.884
2020-09-28 07:23:34,696 R@2 : 44.912
2020-09-28 07:23:34,950 R@4 : 55.662
2020-09-28 07:23:35,202 R@8 : 66.777
2020-09-28 07:24:10,486 Epoch: 11, loss: 1.852, time (seconds): 35.28.
2020-09-28 07:24:10,487 **Evaluating.**
2020-09-28 07:24:44,024 NMI: 26.316
2020-09-28 07:24:54,901 R@1 : 33.493
2020-09-28 07:24:55,146 R@2 : 44.017
2020-09-28 07:24:55,392 R@4 : 55.731
2020-09-28 07:24:55,639 R@8 : 66.412
2020-09-28 07:25:30,828 Epoch: 12, loss: 1.810, time (seconds): 35.19.
2020-09-28 07:25:30,829 **Evaluating.**
2020-09-28 07:26:04,928 NMI: 26.649
2020-09-28 07:26:15,907 R@1 : 34.475
2020-09-28 07:26:16,153 R@2 : 44.703
2020-09-28 07:26:16,401 R@4 : 55.844
2020-09-28 07:26:16,649 R@8 : 66.672
2020-09-28 07:26:51,846 Epoch: 13, loss: 1.771, time (seconds): 35.20.
2020-09-28 07:26:51,847 **Evaluating.**
2020-09-28 07:27:25,959 NMI: 26.990
2020-09-28 07:27:36,951 R@1 : 34.101
2020-09-28 07:27:37,227 R@2 : 44.781
2020-09-28 07:27:37,502 R@4 : 55.757
2020-09-28 07:27:37,785 R@8 : 66.838
2020-09-28 07:28:13,208 Epoch: 14, loss: 1.746, time (seconds): 35.42.
2020-09-28 07:28:13,209 **Evaluating.**
2020-09-28 07:28:47,139 NMI: 26.862
2020-09-28 07:28:58,139 R@1 : 34.223
2020-09-28 07:28:58,386 R@2 : 44.634
2020-09-28 07:28:58,640 R@4 : 55.497
2020-09-28 07:28:58,890 R@8 : 66.559
2020-09-28 07:29:34,488 Epoch: 15, loss: 1.693, time (seconds): 35.60.
2020-09-28 07:29:34,489 **Evaluating.**
2020-09-28 07:30:08,865 NMI: 26.877
2020-09-28 07:30:20,065 R@1 : 34.579
2020-09-28 07:30:20,341 R@2 : 44.947
2020-09-28 07:30:20,618 R@4 : 55.870
2020-09-28 07:30:20,894 R@8 : 66.968
2020-09-28 07:30:55,850 Epoch: 16, loss: 1.630, time (seconds): 34.95.
2020-09-28 07:30:55,851 **Evaluating.**
2020-09-28 07:31:29,672 NMI: 27.297
2020-09-28 07:31:40,798 R@1 : 34.405
2020-09-28 07:31:41,048 R@2 : 44.947
2020-09-28 07:31:41,300 R@4 : 56.487
2020-09-28 07:31:41,557 R@8 : 67.263
2020-09-28 07:32:17,030 Epoch: 17, loss: 1.551, time (seconds): 35.47.
2020-09-28 07:32:17,031 **Evaluating.**
2020-09-28 07:32:50,693 NMI: 26.250
2020-09-28 07:33:01,844 R@1 : 33.519
2020-09-28 07:33:02,121 R@2 : 43.904
2020-09-28 07:33:02,402 R@4 : 55.349
2020-09-28 07:33:02,692 R@8 : 66.464
2020-09-28 07:33:38,239 Epoch: 18, loss: 1.603, time (seconds): 35.54.
2020-09-28 07:33:38,240 **Evaluating.**
2020-09-28 07:34:12,347 NMI: 26.780
2020-09-28 07:34:23,427 R@1 : 33.910
2020-09-28 07:34:23,673 R@2 : 44.590
2020-09-28 07:34:23,918 R@4 : 55.279
2020-09-28 07:34:24,165 R@8 : 66.525
2020-09-28 07:34:59,750 Epoch: 19, loss: 1.556, time (seconds): 35.58.
2020-09-28 07:34:59,751 **Evaluating.**
2020-09-28 07:35:33,921 NMI: 26.530
2020-09-28 07:35:45,081 R@1 : 34.370
2020-09-28 07:35:45,328 R@2 : 44.773
2020-09-28 07:35:45,583 R@4 : 55.523
2020-09-28 07:35:45,829 R@8 : 66.394
2020-09-28 07:35:45,831 Total training time (minutes): 27.79.
