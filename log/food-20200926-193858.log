2020-09-26 19:39:05,877 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 128, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 3.0, 'lr_proxynca': 1, 'log_filename': 'food-20200926-193858', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 3, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-26 19:39:05,877 Training for 20 epochs
2020-09-26 19:39:05,879 **Evaluating initial model.**
2020-09-26 19:41:42,725 NMI: 27.896
2020-09-26 19:44:33,737 R@1 : 47.275
2020-09-26 19:44:34,472 R@2 : 55.785
2020-09-26 19:44:35,206 R@4 : 64.523
2020-09-26 19:44:35,944 R@8 : 73.146
2020-09-26 19:46:48,077 Epoch: 0, loss: 2.769, time (seconds): 132.13.
2020-09-26 19:46:48,078 **Evaluating.**
2020-09-26 19:48:48,392 NMI: 27.464
2020-09-26 19:51:21,854 R@1 : 43.446
2020-09-26 19:51:22,587 R@2 : 52.495
2020-09-26 19:51:23,318 R@4 : 62.296
2020-09-26 19:51:24,057 R@8 : 71.624
2020-09-26 19:53:24,122 Epoch: 1, loss: 2.344, time (seconds): 120.06.
2020-09-26 19:53:24,122 **Evaluating.**
2020-09-26 19:55:22,498 NMI: 30.296
2020-09-26 19:57:59,679 R@1 : 47.275
2020-09-26 19:58:00,432 R@2 : 56.592
2020-09-26 19:58:01,162 R@4 : 65.803
2020-09-26 19:58:01,893 R@8 : 74.266
2020-09-26 20:00:02,775 Epoch: 2, loss: 2.120, time (seconds): 120.88.
2020-09-26 20:00:02,776 **Evaluating.**
2020-09-26 20:01:59,791 NMI: 31.705
2020-09-26 20:04:40,287 R@1 : 48.808
2020-09-26 20:04:41,033 R@2 : 58.069
2020-09-26 20:04:41,784 R@4 : 67.194
2020-09-26 20:04:42,521 R@8 : 75.526
2020-09-26 20:06:49,619 Epoch: 3, loss: 2.035, time (seconds): 127.09.
2020-09-26 20:06:49,619 **Evaluating.**
2020-09-26 20:08:51,235 NMI: 32.121
2020-09-26 20:11:37,881 R@1 : 49.450
2020-09-26 20:11:38,628 R@2 : 58.818
2020-09-26 20:11:39,368 R@4 : 67.876
2020-09-26 20:11:40,116 R@8 : 76.325
2020-09-26 20:13:44,263 Epoch: 4, loss: 1.877, time (seconds): 124.14.
2020-09-26 20:13:44,264 **Evaluating.**
2020-09-26 20:15:42,192 NMI: 32.273
2020-09-26 20:18:29,929 R@1 : 49.894
2020-09-26 20:18:30,666 R@2 : 59.338
2020-09-26 20:18:31,416 R@4 : 68.268
2020-09-26 20:18:32,163 R@8 : 76.342
2020-09-26 20:20:31,472 Epoch: 5, loss: 1.824, time (seconds): 119.31.
2020-09-26 20:20:31,472 **Evaluating.**
2020-09-26 20:22:30,438 NMI: 31.802
2020-09-26 20:25:19,654 R@1 : 49.194
2020-09-26 20:25:20,408 R@2 : 58.368
2020-09-26 20:25:21,149 R@4 : 67.499
2020-09-26 20:25:21,895 R@8 : 76.049
2020-09-26 20:27:22,007 Epoch: 6, loss: 1.780, time (seconds): 120.11.
2020-09-26 20:27:22,008 **Evaluating.**
2020-09-26 20:29:18,493 NMI: 31.285
2020-09-26 20:32:07,839 R@1 : 49.403
2020-09-26 20:32:08,670 R@2 : 58.580
2020-09-26 20:32:09,497 R@4 : 67.656
2020-09-26 20:32:10,325 R@8 : 76.098
2020-09-26 20:34:08,724 Epoch: 7, loss: 1.669, time (seconds): 118.40.
2020-09-26 20:34:08,725 **Evaluating.**
2020-09-26 20:36:01,501 NMI: 30.945
2020-09-26 20:38:49,877 R@1 : 49.032
2020-09-26 20:38:50,614 R@2 : 58.461
2020-09-26 20:38:51,369 R@4 : 67.479
2020-09-26 20:38:52,136 R@8 : 76.060
2020-09-26 20:40:51,112 Epoch: 8, loss: 1.627, time (seconds): 118.97.
2020-09-26 20:40:51,113 **Evaluating.**
2020-09-26 20:42:42,541 NMI: 31.907
2020-09-26 20:45:31,092 R@1 : 49.627
2020-09-26 20:45:31,837 R@2 : 58.714
2020-09-26 20:45:32,577 R@4 : 67.751
2020-09-26 20:45:33,315 R@8 : 76.127
2020-09-26 20:47:36,948 Epoch: 9, loss: 1.591, time (seconds): 123.63.
2020-09-26 20:47:36,949 **Evaluating.**
2020-09-26 20:49:30,400 NMI: 30.954
2020-09-26 20:52:21,839 R@1 : 48.779
2020-09-26 20:52:22,622 R@2 : 57.817
2020-09-26 20:52:23,436 R@4 : 66.648
2020-09-26 20:52:24,220 R@8 : 75.250
2020-09-26 20:54:38,115 Epoch: 10, loss: 1.554, time (seconds): 133.89.
2020-09-26 20:54:38,116 **Evaluating.**
2020-09-26 20:56:42,913 NMI: 30.633
2020-09-26 20:59:34,915 R@1 : 48.515
2020-09-26 20:59:35,655 R@2 : 57.590
2020-09-26 20:59:36,396 R@4 : 66.703
2020-09-26 20:59:37,132 R@8 : 75.346
2020-09-26 21:01:41,132 Epoch: 11, loss: 1.533, time (seconds): 124.00.
2020-09-26 21:01:41,146 **Evaluating.**
2020-09-26 21:03:56,564 NMI: 30.642
2020-09-26 21:06:47,707 R@1 : 48.811
2020-09-26 21:06:48,446 R@2 : 57.947
2020-09-26 21:06:49,200 R@4 : 67.040
2020-09-26 21:06:49,940 R@8 : 75.361
2020-09-26 21:09:02,190 Epoch: 12, loss: 1.483, time (seconds): 132.25.
2020-09-26 21:09:02,191 **Evaluating.**
2020-09-26 21:11:04,242 NMI: 30.203
2020-09-26 21:13:56,011 R@1 : 48.248
2020-09-26 21:13:56,760 R@2 : 57.509
2020-09-26 21:13:57,516 R@4 : 66.759
2020-09-26 21:13:58,265 R@8 : 75.253
2020-09-26 21:16:03,632 Epoch: 13, loss: 1.460, time (seconds): 125.36.
2020-09-26 21:16:03,632 **Evaluating.**
2020-09-26 21:18:06,469 NMI: 29.987
2020-09-26 21:20:58,648 R@1 : 47.830
2020-09-26 21:20:59,387 R@2 : 56.777
2020-09-26 21:21:00,122 R@4 : 65.891
2020-09-26 21:21:00,862 R@8 : 74.411
2020-09-26 21:23:08,266 Epoch: 14, loss: 1.386, time (seconds): 127.40.
2020-09-26 21:23:08,267 **Evaluating.**
2020-09-26 21:25:15,495 NMI: 30.059
2020-09-26 21:28:10,258 R@1 : 47.868
2020-09-26 21:28:11,030 R@2 : 57.123
2020-09-26 21:28:11,785 R@4 : 66.111
2020-09-26 21:28:12,543 R@8 : 74.530
2020-09-26 21:30:24,066 Epoch: 15, loss: 1.407, time (seconds): 131.52.
2020-09-26 21:30:24,066 **Evaluating.**
2020-09-26 21:32:31,231 NMI: 29.917
2020-09-26 21:35:25,418 R@1 : 47.284
2020-09-26 21:35:26,262 R@2 : 56.734
2020-09-26 21:35:27,106 R@4 : 66.015
2020-09-26 21:35:27,947 R@8 : 74.455
2020-09-26 21:37:37,888 Epoch: 16, loss: 1.367, time (seconds): 129.94.
2020-09-26 21:37:37,889 **Evaluating.**
2020-09-26 21:39:41,146 NMI: 29.862
2020-09-26 21:42:35,356 R@1 : 47.696
2020-09-26 21:42:36,116 R@2 : 56.737
2020-09-26 21:42:36,876 R@4 : 65.821
2020-09-26 21:42:37,633 R@8 : 74.574
2020-09-26 21:44:48,109 Epoch: 17, loss: 1.353, time (seconds): 130.47.
2020-09-26 21:44:48,110 **Evaluating.**
2020-09-26 21:46:51,978 NMI: 30.114
2020-09-26 21:49:47,342 R@1 : 47.926
2020-09-26 21:49:48,095 R@2 : 57.210
2020-09-26 21:49:48,851 R@4 : 66.007
2020-09-26 21:49:49,606 R@8 : 74.391
2020-09-26 21:52:03,324 Epoch: 18, loss: 1.352, time (seconds): 133.72.
2020-09-26 21:52:03,325 **Evaluating.**
2020-09-26 21:54:08,368 NMI: 29.250
2020-09-26 21:57:04,060 R@1 : 47.127
2020-09-26 21:57:04,819 R@2 : 56.287
2020-09-26 21:57:05,579 R@4 : 65.423
2020-09-26 21:57:06,343 R@8 : 74.048
2020-09-26 21:59:19,397 Epoch: 19, loss: 1.286, time (seconds): 133.05.
2020-09-26 21:59:19,398 **Evaluating.**
2020-09-26 22:01:23,409 NMI: 28.636
2020-09-26 22:04:18,824 R@1 : 46.518
2020-09-26 22:04:19,587 R@2 : 55.491
2020-09-26 22:04:20,346 R@4 : 64.599
2020-09-26 22:04:21,104 R@8 : 73.508
2020-09-26 22:04:21,107 Total training time (minutes): 145.25.
2020-09-26 22:04:23,932 Training parameters: {'__module__': '__main__', 'dataset': 'food', 'config': 'config1.json', 'sz_embedding': 128, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 8.0, 'lr_proxynca': 1, 'log_filename': 'food-20200926-193858', 'results_filename': 'food-results.csv', 'torch_version': '1.1.0', 'edition': 3, 'seed': 0, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-26 22:04:23,933 Training for 20 epochs
2020-09-26 22:04:23,948 **Evaluating initial model.**
2020-09-26 22:06:18,819 NMI: 27.896
2020-09-26 22:09:18,054 R@1 : 47.275
2020-09-26 22:09:18,812 R@2 : 55.785
2020-09-26 22:09:19,581 R@4 : 64.523
2020-09-26 22:09:20,362 R@8 : 73.146
2020-09-26 22:11:35,263 Epoch: 0, loss: 3.297, time (seconds): 134.90.
2020-09-26 22:11:35,264 **Evaluating.**
