2020-09-28 20:56:13,041 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-205607', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 0.5, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 20:56:13,042 Training for 20 epochs
2020-09-28 20:56:13,043 **Evaluating initial model.**
2020-09-28 20:56:58,312 NMI: 25.916
2020-09-28 20:57:10,237 R@1 : 32.493
2020-09-28 20:57:10,485 R@2 : 41.514
2020-09-28 20:57:10,736 R@4 : 51.994
2020-09-28 20:57:11,000 R@8 : 62.736
2020-09-28 20:57:49,944 Epoch: 0, loss: 1.467, time (seconds): 38.94.
2020-09-28 20:57:49,945 **Evaluating.**
2020-09-28 20:58:24,925 NMI: 21.765
2020-09-28 20:58:35,732 R@1 : 26.367
2020-09-28 20:58:35,982 R@2 : 35.978
2020-09-28 20:58:36,236 R@4 : 47.232
2020-09-28 20:58:36,482 R@8 : 59.729
2020-09-28 20:59:10,396 Epoch: 1, loss: 1.218, time (seconds): 33.91.
2020-09-28 20:59:10,396 **Evaluating.**
2020-09-28 20:59:43,983 NMI: 25.799
2020-09-28 20:59:54,824 R@1 : 30.390
2020-09-28 20:59:55,071 R@2 : 40.680
2020-09-28 20:59:55,316 R@4 : 51.777
2020-09-28 20:59:55,565 R@8 : 63.918
2020-09-28 21:00:29,723 Epoch: 2, loss: 1.061, time (seconds): 34.16.
2020-09-28 21:00:29,724 **Evaluating.**
2020-09-28 21:01:03,735 NMI: 28.316
2020-09-28 21:01:14,732 R@1 : 33.319
2020-09-28 21:01:14,980 R@2 : 43.791
2020-09-28 21:01:15,226 R@4 : 54.393
2020-09-28 21:01:15,473 R@8 : 65.812
2020-09-28 21:01:49,699 Epoch: 3, loss: 1.021, time (seconds): 34.22.
2020-09-28 21:01:49,700 **Evaluating.**
2020-09-28 21:02:23,550 NMI: 28.394
2020-09-28 21:02:34,709 R@1 : 33.076
2020-09-28 21:02:34,960 R@2 : 42.948
2020-09-28 21:02:35,206 R@4 : 54.297
2020-09-28 21:02:35,457 R@8 : 65.404
2020-09-28 21:03:09,595 Epoch: 4, loss: 1.004, time (seconds): 34.14.
2020-09-28 21:03:09,596 **Evaluating.**
2020-09-28 21:03:43,152 NMI: 27.988
2020-09-28 21:03:54,417 R@1 : 32.450
2020-09-28 21:03:54,664 R@2 : 42.783
2020-09-28 21:03:54,911 R@4 : 54.106
2020-09-28 21:03:55,165 R@8 : 65.777
2020-09-28 21:04:29,429 Epoch: 5, loss: 0.960, time (seconds): 34.26.
2020-09-28 21:04:29,430 **Evaluating.**
2020-09-28 21:05:03,714 NMI: 27.462
2020-09-28 21:05:15,109 R@1 : 31.841
2020-09-28 21:05:15,357 R@2 : 42.070
2020-09-28 21:05:15,603 R@4 : 53.341
2020-09-28 21:05:15,850 R@8 : 65.013
2020-09-28 21:05:50,095 Epoch: 6, loss: 0.936, time (seconds): 34.24.
2020-09-28 21:05:50,095 **Evaluating.**
2020-09-28 21:06:24,928 NMI: 26.705
2020-09-28 21:06:36,271 R@1 : 32.233
2020-09-28 21:06:36,518 R@2 : 42.357
2020-09-28 21:06:36,765 R@4 : 53.550
2020-09-28 21:06:37,011 R@8 : 64.543
2020-09-28 21:07:11,326 Epoch: 7, loss: 0.891, time (seconds): 34.31.
2020-09-28 21:07:11,327 **Evaluating.**
2020-09-28 21:07:46,120 NMI: 26.179
2020-09-28 21:07:57,734 R@1 : 30.642
2020-09-28 21:07:57,981 R@2 : 40.541
2020-09-28 21:07:58,228 R@4 : 51.621
2020-09-28 21:07:58,482 R@8 : 63.344
2020-09-28 21:08:33,141 Epoch: 8, loss: 0.851, time (seconds): 34.66.
2020-09-28 21:08:33,142 **Evaluating.**
2020-09-28 21:09:08,481 NMI: 26.165
2020-09-28 21:09:20,082 R@1 : 30.590
2020-09-28 21:09:20,328 R@2 : 40.445
2020-09-28 21:09:20,574 R@4 : 52.012
2020-09-28 21:09:20,820 R@8 : 63.344
2020-09-28 21:09:55,081 Epoch: 9, loss: 0.839, time (seconds): 34.26.
2020-09-28 21:09:55,082 **Evaluating.**
2020-09-28 21:10:29,783 NMI: 25.779
2020-09-28 21:10:41,451 R@1 : 30.164
2020-09-28 21:10:41,702 R@2 : 39.897
2020-09-28 21:10:41,958 R@4 : 50.534
2020-09-28 21:10:42,217 R@8 : 62.014
2020-09-28 21:11:16,921 Epoch: 10, loss: 0.834, time (seconds): 34.70.
2020-09-28 21:11:16,921 **Evaluating.**
2020-09-28 21:11:51,441 NMI: 24.102
2020-09-28 21:12:03,218 R@1 : 29.234
2020-09-28 21:12:03,486 R@2 : 38.481
2020-09-28 21:12:03,734 R@4 : 49.552
2020-09-28 21:12:03,984 R@8 : 61.058
2020-09-28 21:12:38,577 Epoch: 11, loss: 0.811, time (seconds): 34.59.
2020-09-28 21:12:38,578 **Evaluating.**
2020-09-28 21:13:13,647 NMI: 25.101
2020-09-28 21:13:25,711 R@1 : 29.269
2020-09-28 21:13:25,958 R@2 : 39.002
2020-09-28 21:13:26,209 R@4 : 49.900
2020-09-28 21:13:26,462 R@8 : 61.884
2020-09-28 21:14:02,462 Epoch: 12, loss: 0.767, time (seconds): 36.00.
2020-09-28 21:14:02,463 **Evaluating.**
2020-09-28 21:14:37,533 NMI: 24.121
2020-09-28 21:14:49,237 R@1 : 28.922
2020-09-28 21:14:49,485 R@2 : 38.020
2020-09-28 21:14:49,748 R@4 : 49.048
2020-09-28 21:14:49,996 R@8 : 60.563
2020-09-28 21:15:24,491 Epoch: 13, loss: 0.769, time (seconds): 34.49.
2020-09-28 21:15:24,492 **Evaluating.**
2020-09-28 21:15:59,039 NMI: 24.498
2020-09-28 21:16:10,708 R@1 : 28.652
2020-09-28 21:16:10,960 R@2 : 38.498
2020-09-28 21:16:11,221 R@4 : 49.231
2020-09-28 21:16:11,469 R@8 : 61.119
2020-09-28 21:16:45,958 Epoch: 14, loss: 0.749, time (seconds): 34.49.
2020-09-28 21:16:45,959 **Evaluating.**
2020-09-28 21:17:20,612 NMI: 24.008
2020-09-28 21:17:32,313 R@1 : 28.513
2020-09-28 21:17:32,559 R@2 : 37.386
2020-09-28 21:17:32,808 R@4 : 47.979
2020-09-28 21:17:33,075 R@8 : 59.764
2020-09-28 21:18:07,606 Epoch: 15, loss: 0.744, time (seconds): 34.53.
2020-09-28 21:18:07,607 **Evaluating.**
2020-09-28 21:18:43,601 NMI: 23.931
2020-09-28 21:18:55,555 R@1 : 28.478
2020-09-28 21:18:55,804 R@2 : 38.012
2020-09-28 21:18:56,077 R@4 : 48.362
2020-09-28 21:18:56,353 R@8 : 59.824
2020-09-28 21:19:31,879 Epoch: 16, loss: 0.726, time (seconds): 35.52.
2020-09-28 21:19:31,879 **Evaluating.**
2020-09-28 21:20:07,200 NMI: 23.606
2020-09-28 21:20:19,206 R@1 : 27.922
2020-09-28 21:20:19,471 R@2 : 37.438
2020-09-28 21:20:19,727 R@4 : 47.701
2020-09-28 21:20:19,980 R@8 : 59.286
2020-09-28 21:20:53,185 Epoch: 17, loss: 0.716, time (seconds): 33.20.
2020-09-28 21:20:53,185 **Evaluating.**
2020-09-28 21:21:27,952 NMI: 24.089
2020-09-28 21:21:39,722 R@1 : 28.122
2020-09-28 21:21:39,990 R@2 : 37.516
2020-09-28 21:21:40,263 R@4 : 48.049
2020-09-28 21:21:40,527 R@8 : 59.720
2020-09-28 21:22:15,044 Epoch: 18, loss: 0.690, time (seconds): 34.52.
2020-09-28 21:22:15,044 **Evaluating.**
2020-09-28 21:22:51,083 NMI: 23.477
2020-09-28 21:23:03,006 R@1 : 27.635
2020-09-28 21:23:03,255 R@2 : 36.552
2020-09-28 21:23:03,511 R@4 : 47.380
2020-09-28 21:23:03,759 R@8 : 58.816
2020-09-28 21:23:38,478 Epoch: 19, loss: 0.707, time (seconds): 34.72.
2020-09-28 21:23:38,478 **Evaluating.**
2020-09-28 21:24:14,117 NMI: 22.615
2020-09-28 21:24:26,032 R@1 : 26.984
2020-09-28 21:24:26,297 R@2 : 35.874
2020-09-28 21:24:26,552 R@4 : 45.911
2020-09-28 21:24:26,809 R@8 : 57.409
2020-09-28 21:24:26,812 Total training time (minutes): 28.23.
2020-09-28 21:24:27,838 Training parameters: {'__module__': '__main__', 'dataset': 'food_test', 'config': 'config1.json', 'sz_embedding': 64, 'sz_batch': 128, 'nb_epochs': 20, 'gpu_id': 0, 'nb_workers': 4, 'with_nmi': True, 'scaling_x': 8.0, 'scaling_p': 1.0, 'lr_proxynca': 1, 'log_filename': 'food_test-20200928-205607', 'results_filename': 'food_test-results.csv', 'torch_version': '1.1.0', 'edition': 0, 'seed': 0, 'train_classes': range(0, 50), 'eval_classes': range(50, 101), 'p_c': 2, '__dict__': <attribute '__dict__' of 'args' objects>, '__weakref__': <attribute '__weakref__' of 'args' objects>, '__doc__': None}
2020-09-28 21:24:27,839 Training for 20 epochs
2020-09-28 21:24:27,841 **Evaluating initial model.**
2020-09-28 21:25:02,710 NMI: 25.916
2020-09-28 21:25:14,954 R@1 : 32.493
2020-09-28 21:25:15,203 R@2 : 41.514
2020-09-28 21:25:15,459 R@4 : 51.994
2020-09-28 21:25:15,708 R@8 : 62.736
2020-09-28 21:25:50,308 Epoch: 0, loss: 3.725, time (seconds): 34.60.
2020-09-28 21:25:50,308 **Evaluating.**
2020-09-28 21:26:26,792 NMI: 24.514
2020-09-28 21:26:38,031 R@1 : 30.686
2020-09-28 21:26:38,291 R@2 : 40.488
2020-09-28 21:26:38,539 R@4 : 51.291
2020-09-28 21:26:38,791 R@8 : 62.744
2020-09-28 21:27:13,435 Epoch: 1, loss: 2.895, time (seconds): 34.64.
2020-09-28 21:27:13,435 **Evaluating.**
2020-09-28 21:27:50,020 NMI: 28.265
2020-09-28 21:28:01,004 R@1 : 33.423
2020-09-28 21:28:01,264 R@2 : 43.617
2020-09-28 21:28:01,511 R@4 : 54.463
2020-09-28 21:28:01,758 R@8 : 65.621
2020-09-28 21:28:35,155 Epoch: 2, loss: 2.541, time (seconds): 33.39.
2020-09-28 21:28:35,156 **Evaluating.**
2020-09-28 21:29:11,438 NMI: 30.850
2020-09-28 21:29:22,974 R@1 : 36.195
2020-09-28 21:29:23,231 R@2 : 46.841
2020-09-28 21:29:23,480 R@4 : 57.852
2020-09-28 21:29:23,732 R@8 : 68.749
2020-09-28 21:29:58,336 Epoch: 3, loss: 2.345, time (seconds): 34.60.
2020-09-28 21:29:58,337 **Evaluating.**
2020-09-28 21:30:34,433 NMI: 31.861
2020-09-28 21:30:45,979 R@1 : 39.063
2020-09-28 21:30:46,237 R@2 : 49.335
2020-09-28 21:30:46,486 R@4 : 60.146
2020-09-28 21:30:46,737 R@8 : 70.027
2020-09-28 21:31:21,329 Epoch: 4, loss: 2.143, time (seconds): 34.59.
2020-09-28 21:31:21,330 **Evaluating.**
2020-09-28 21:31:56,817 NMI: 33.021
2020-09-28 21:32:08,472 R@1 : 39.950
2020-09-28 21:32:08,728 R@2 : 50.891
2020-09-28 21:32:08,980 R@4 : 61.006
2020-09-28 21:32:09,235 R@8 : 70.931
2020-09-28 21:32:43,746 Epoch: 5, loss: 2.073, time (seconds): 34.51.
2020-09-28 21:32:43,747 **Evaluating.**
2020-09-28 21:33:19,135 NMI: 32.922
2020-09-28 21:33:30,532 R@1 : 40.236
2020-09-28 21:33:30,787 R@2 : 51.073
2020-09-28 21:33:31,036 R@4 : 61.328
2020-09-28 21:33:31,284 R@8 : 71.218
2020-09-28 21:34:05,205 Epoch: 6, loss: 1.959, time (seconds): 33.92.
2020-09-28 21:34:05,205 **Evaluating.**
2020-09-28 21:34:39,844 NMI: 33.375
2020-09-28 21:34:51,291 R@1 : 40.801
2020-09-28 21:34:51,539 R@2 : 51.395
2020-09-28 21:34:51,799 R@4 : 62.127
2020-09-28 21:34:52,051 R@8 : 71.417
2020-09-28 21:35:25,273 Epoch: 7, loss: 1.873, time (seconds): 33.22.
2020-09-28 21:35:25,274 **Evaluating.**
2020-09-28 21:36:00,041 NMI: 32.384
2020-09-28 21:36:11,467 R@1 : 40.228
2020-09-28 21:36:11,718 R@2 : 51.056
2020-09-28 21:36:11,978 R@4 : 61.971
2020-09-28 21:36:12,236 R@8 : 70.905
2020-09-28 21:36:45,214 Epoch: 8, loss: 1.814, time (seconds): 32.98.
2020-09-28 21:36:45,215 **Evaluating.**
2020-09-28 21:37:19,554 NMI: 33.116
2020-09-28 21:37:31,089 R@1 : 39.767
2020-09-28 21:37:31,341 R@2 : 50.317
2020-09-28 21:37:31,599 R@4 : 60.946
2020-09-28 21:37:31,856 R@8 : 71.287
2020-09-28 21:38:05,137 Epoch: 9, loss: 1.720, time (seconds): 33.28.
2020-09-28 21:38:05,138 **Evaluating.**
2020-09-28 21:38:39,215 NMI: 32.529
2020-09-28 21:38:50,800 R@1 : 39.958
2020-09-28 21:38:51,048 R@2 : 50.561
2020-09-28 21:38:51,299 R@4 : 61.250
2020-09-28 21:38:51,550 R@8 : 70.879
2020-09-28 21:39:24,705 Epoch: 10, loss: 1.684, time (seconds): 33.15.
2020-09-28 21:39:24,706 **Evaluating.**
2020-09-28 21:39:58,842 NMI: 32.264
2020-09-28 21:40:10,443 R@1 : 40.176
2020-09-28 21:40:10,693 R@2 : 50.656
2020-09-28 21:40:10,942 R@4 : 61.085
2020-09-28 21:40:11,192 R@8 : 71.165
2020-09-28 21:40:44,260 Epoch: 11, loss: 1.642, time (seconds): 33.07.
2020-09-28 21:40:44,261 **Evaluating.**
2020-09-28 21:41:18,330 NMI: 32.145
2020-09-28 21:41:29,922 R@1 : 40.393
2020-09-28 21:41:30,171 R@2 : 50.917
2020-09-28 21:41:30,428 R@4 : 61.467
2020-09-28 21:41:30,676 R@8 : 70.913
2020-09-28 21:42:04,411 Epoch: 12, loss: 1.561, time (seconds): 33.73.
2020-09-28 21:42:04,412 **Evaluating.**
2020-09-28 21:42:42,015 NMI: 32.386
2020-09-28 21:42:54,142 R@1 : 40.236
2020-09-28 21:42:54,400 R@2 : 50.882
2020-09-28 21:42:54,662 R@4 : 61.258
2020-09-28 21:42:54,920 R@8 : 70.983
2020-09-28 21:43:28,637 Epoch: 13, loss: 1.525, time (seconds): 33.71.
2020-09-28 21:43:28,638 **Evaluating.**
2020-09-28 21:44:06,594 NMI: 32.561
2020-09-28 21:44:18,797 R@1 : 40.289
2020-09-28 21:44:19,057 R@2 : 51.056
2020-09-28 21:44:19,310 R@4 : 61.406
2020-09-28 21:44:19,564 R@8 : 70.653
2020-09-28 21:44:53,514 Epoch: 14, loss: 1.489, time (seconds): 33.95.
2020-09-28 21:44:53,515 **Evaluating.**
2020-09-28 21:45:31,091 NMI: 32.770
2020-09-28 21:45:43,272 R@1 : 39.559
2020-09-28 21:45:43,528 R@2 : 50.178
2020-09-28 21:45:43,784 R@4 : 60.494
2020-09-28 21:45:44,047 R@8 : 70.409
2020-09-28 21:46:18,230 Epoch: 15, loss: 1.424, time (seconds): 34.18.
2020-09-28 21:46:18,231 **Evaluating.**
2020-09-28 21:46:56,010 NMI: 32.073
2020-09-28 21:47:08,249 R@1 : 39.698
2020-09-28 21:47:08,506 R@2 : 49.987
2020-09-28 21:47:08,769 R@4 : 59.981
2020-09-28 21:47:09,024 R@8 : 69.931
2020-09-28 21:47:42,786 Epoch: 16, loss: 1.427, time (seconds): 33.76.
2020-09-28 21:47:42,787 **Evaluating.**
2020-09-28 21:48:20,427 NMI: 31.903
2020-09-28 21:48:32,534 R@1 : 38.976
2020-09-28 21:48:32,794 R@2 : 49.318
2020-09-28 21:48:33,052 R@4 : 59.677
2020-09-28 21:48:33,317 R@8 : 69.497
2020-09-28 21:49:07,229 Epoch: 17, loss: 1.393, time (seconds): 33.91.
2020-09-28 21:49:07,230 **Evaluating.**
2020-09-28 21:49:45,063 NMI: 31.788
2020-09-28 21:49:57,112 R@1 : 39.272
2020-09-28 21:49:57,378 R@2 : 49.935
2020-09-28 21:49:57,641 R@4 : 60.728
2020-09-28 21:49:57,899 R@8 : 69.940
2020-09-28 21:50:31,843 Epoch: 18, loss: 1.338, time (seconds): 33.94.
2020-09-28 21:50:31,843 **Evaluating.**
2020-09-28 21:51:09,224 NMI: 31.317
2020-09-28 21:51:21,408 R@1 : 39.072
2020-09-28 21:51:21,672 R@2 : 49.248
2020-09-28 21:51:21,933 R@4 : 60.076
2020-09-28 21:51:22,196 R@8 : 69.749
2020-09-28 21:51:56,065 Epoch: 19, loss: 1.371, time (seconds): 33.87.
2020-09-28 21:51:56,066 **Evaluating.**
2020-09-28 21:52:33,758 NMI: 31.140
2020-09-28 21:52:45,995 R@1 : 39.081
2020-09-28 21:52:46,256 R@2 : 49.744
2020-09-28 21:52:46,516 R@4 : 60.337
2020-09-28 21:52:46,773 R@8 : 70.070
2020-09-28 21:52:46,776 Total training time (minutes): 28.32.
